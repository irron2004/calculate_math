---

# 전이(Transfer) 기반 수학 앱 PRD v1.0

## 0) 제품 개요

* **제품명(가칭)**: LensMath (렌즈수학)
* **한 줄 비전**: *같은 구조를 다른 맥락으로 본다.*
* **핵심 철학**: 모든 문제는 **구조 렌즈(🔺차분/⬛누적/➗비율/📏스케일/🎲랜덤/🔄변환/🧭벡터)**로 태깅되고, **S1→S2→S3**로 CPA(구체–그림–추상)를 왕복하며 **전이**를 유도한다.

---

## 1) 왜 이 앱인가 (배경·니즈·차별점·가치)

### 1.1 문제 정의(니즈)

* **선행의 함정**: 학년별 진도만 빠르게 밟으면 상위 개념에서 **전이가 실패**한다(예: 계산은 되지만 일차함수/그래프 해석에서 막힘).
* **현 시장 공백**: 다수 앱이 **문항 외형**(숫자/문장/그림) 중심 반복·채점에 치우쳐 **구조 언어(차분/누적/비율…)**와 **설명형 평가**가 약함.
* **현장 요구**: 교사/부모가 아이의 **개념 결함**과 **전이력**을 한눈에 파악하고 싶지만, 지금은 정오표 외에는 근거 데이터가 빈약.

### 1.2 차별점

1. **렌즈 기반 설계**: 모든 문항이 렌즈(🔺/⬛/➗/📏/🎲/🔄/🧭)와 표현(C/P/A)으로 구조화.
2. **S1→S2→S3 전이 루틴**: 같은 구조를 **생활–데이터–도형** 3맥락으로 바꿔보는 **동형 3형제(Isomorphic Triplets)** 제공.
3. **Explain-first**: 정답 전에 **설명 한 줄**을 쓰게 하여 **구조 언어**를 고정, 자동 루브릭 채점.
4. **LRC(Leap Ready Criteria)**: `정확·반응시간·설명 품질` 3축으로 **안전한 승급**.
5. **지식그래프 엔진**: 선수/전이 간선+난이도 가중으로 개인화 경로 자동 추천.
6. **Structure-Only Test**: 외형을 벗긴 **동형 검사**로 진짜 전이 여부 측정.

### 1.3 아이/부모/교사 혜택

* **아이**: 고학년 개념을 **낯설지 않게** 만나며 메타인지↑, 전이력↑, 자신감↑.
* **부모**: “이번 주 전이 증거(설명 문장/그래프)”, “다음 주 LRC 목표”를 데이터로 확인.
* **교사**: 코호트 히트맵(오개념/렌즈별 약점), 수업 악보(발문·판서) 연동.

### 1.4 교육과정 정렬 가치

* 2022 개정의 **공통수학Ⅰ·Ⅱ(행렬 신설)**, 중·고 영역과 **브리지 포인트**를 명시하여 학교 수업과 **충돌이 아닌 증폭**을 목표.

---

## 2) 범위(Scope) & 비범위(Non-goals)

### 2.1 MVP 범위

* **대상**: 초2~초6(중1까지 확장 가능한 구조)
* **스레드**(우선 6): 덧셈→등차, 비율·비례, 좌표→직선/원, 닮음→삼각비, 경우의 수→확률 씨앗, 누적→적분 직관
* **세션 구조**: 1일 15~20분(문항 8~12), 유닛 6p 흐름 유지(앱에선 화면 흐름으로 구현)
* **콘솔**: 교사/부모 리포트 1.0, 작가용 콘텐츠 스튜디오 0.9

### 2.2 비범위(초기)

* 고교 심화(미적분Ⅱ, 기하 전범위) 풀 구현, 공모전 대비 특강, 실시간 라이브 수업

---

## 3) 페르소나 & 주요 시나리오

* **P1. 초2~초4 학생**: 조작/그림 선호, 음성 설명 보조 필요
* **P2. 초5~초6 학생**: 표→식 전환 가능, 그래프 해석 훈련 필요
* **P3. 학부모**: 주당 2~3회, 15~20분 학습 확인, **질 높은 설명** 여부를 중시
* **P4. 교습소 교사**: 반(8~15명) 관리, 오개념 교정 루틴·판서 가이드 필요
* **P5. 콘텐츠 작가**: 템플릿 기반 **재저작**(구조 추출→신규 문맥) 도구 필요

---

## 4) 핵심 사용자 스토리(요약)

* **US1(학생)**: “나는 오늘의 전이 퀘스트에서 S1→S2→S3를 풀며, **설명 한 줄**을 쓰고 **게이트**를 통과하고 싶다.”
* **US2(부모)**: “이번 주 아이가 **어떤 구조**를 어느 렌즈로 배웠는지 **증거**(설명·그래프)로 보고 싶다.”
* **US3(교사)**: “코호트의 **렌즈별 히트맵**을 보고 다음 주 수업 악보를 자동 생성하고 싶다.”
* **US4(작가)**: “수능/경시/시중 교재의 **구조만 추출**해 **신규 문항**을 빠르게 생성하고 싶다.”

---

## 5) 정보 구조(IA) & 핵심 플로우

### 5.1 IA

* 홈 / 학습(세션) / 지식그래프(경로) / 리뷰(스페이싱/인터리빙) / 리포트(아이·부모)
* 교사 콘솔: 대시보드 / 코호트 / 오개념 히트맵 / 수업 악보 / 과제 배포
* 스튜디오: 노드 편집 / 템플릿 / 미리보기 / 심사·배포

### 5.2 플로우(요약)

```mermaid
flowchart LR
A[온보딩 진단 10'] --> B{시작 노드 추천}
B -->|S1| C[전이 퀘스트]
C --> D[Explain-first 입력]
D --> E[퀵체크 6문항]
E -->|LRC 통과| F[다음 스텝/노드]
E -->|미달| G[동형 3형제 재도전 + 1분 드릴]
F --> H[스페이싱 예약(2-7-21일)]
H --> I[리포트/배지]
```

---

## 6) 화면 와이어(텍스트 설명)

* **홈**: 오늘 목표, 최근 LRC 게이지(정확/RT/설명 3바), “전이 퀘스트 시작” 버튼
* **세션 상단바**: 렌즈 토글(아이콘), 표현 슬라이더(C↔P↔A), 진행 점(●●○)
* **문항 캔버스**: 좌(자극: 그림/표/그래프), 우(풀이영역: 숫자키·그리기·음성/텍스트 설명칸)
* **피드백 패널**: 정답/오답, 반례 카드(오개념 유형별), 핵심어 자동 하이라이트
* **지식그래프**: 현재 노드(굵게), 선수/전이 간선 강조, 다음 추천 1~2개
* **리포트(부모)**: “이번 주 전이 증거”(아이의 실제 설명 문장/스케치) + 다음 목표 1줄
* **교사 콘솔**: 코호트별 렌즈 히트맵(행:노드/열:렌즈), 수업 악보(발문·판서 스크립트)

---

## 7) 문제 생성 엔진(콘텐츠 디자인 핵심)

### 7.1 템플릿 DSL(데이터 구조)

```json
{
  "id": "ALG-AP-S1-002",
  "concept_node": "ALG-AP",          // 등차
  "step": "S1",                       // S1/S2/S3
  "lens": ["difference"],             // 🔺
  "representation": "C->P",           // 구체->그림
  "context_pack": ["life","table","geometry"],
  "params_schema": {
    "a1": {"type":"int","min":1,"max":5},
    "d":  {"type":"int","min":1,"max":5},
    "n":  {"type":"int","min":4,"max":8}
  },
  "constraints": [
    "unique_solution:true",
    "values_positive:true",
    "avoid_trival_sequence:(a1!=d)"
  ],
  "make_stimulus": "function(params){ /* 표/그림/문장 조립 */ }",
  "solve": "function(params){ /* 정답과 핵심문장 생성 */ }",
  "distractors": ["first_term_equals_diff","skip_one_step","sum_of_heights_not_area"],
  "tags": {
    "micro_skills": ["수직선점프","차이읽기","표→식"],
    "misconception": ["공차=첫항","높이합=면적"],
    "difficulty_est": 0.35,
    "time_s": 60
  },
  "inspiration_only": true
}
```

### 7.2 생성 규칙(예시 3개)

#### A) 등차수열(🔺)

* **S1**: 수직선 점프·칩(폭=1). `a1∈[1..5], d∈[1..5], n≤8` → 표 채우기 + “차이가 d” 설명.
* **S2**: 표→식 (a_n=a_1+d(n-1)), 좌표에 (n,a_n) 점찍기, 기울기=공차.
* **S3**: 계단 합(등차 높이) 두 방식 비교(직접식/사다리꼴 근사) + 설명형 루브릭.

#### B) 비례(➗)

* **S1**: 배합표(컵 아이콘). 단위율 말로 쓰기.
* **S2**: (y=kx), 원점 직선, **k=기울기=단위율**.
* **S3**: 반비례 (xy=c) 데이터 판별(속력×시간 상수).

#### C) 누적→면적(⬛)

* **S1**: 막대(폭=1) 높이 합=면적 직관.
* **S2**: 사다리꼴 근사, (Σ) 맛보기.
* **S3**: 곡선 아래 넓이 비교(정적분 의미 서술), 단위 체크.

### 7.3 오답(디스트랙터) 설계

* **의도적 오개념 매핑**: 공차=첫항, 단위율 누락, 높이합=면적…
* 오답 생성 함수가 해당 패턴을 **정량화**해 변형 수치 삽입(“d를 a1로 대체” 등).
* **반례 카드** 자동 생성: 오개념을 깨는 미니 데이터 표/그림.

### 7.4 난이도·유일성·품질

* **유일성 검사**: `solve()`로 다중 해 여부 체크, 단위/범위 검증.
* **difficulty_est**: 정답률 및 RT 기반 ELO-IRT 하이브리드로 실시간 재학습.
* **앵커 문항**: 스레드별 2~3개 고정, 판(에디션) 간 난이도 등가 유지.

---

## 8) 단계 승급 & 적응형 경로

### 8.1 LRC(Leap Ready Criteria)

* **기본 임계치**: `정확 ≥ 90%`(퀵체크 6문항), `RT 백분위 ≥ 60`, `설명 루브릭 ≥ 3/4`
* **승급 로직**

  * **통과**: 다음 스텝(S1→S2→S3) 또는 다음 노드
  * **근접(1개 미달)**: **동형 3형제** 재도전 + **1분 드릴**
  * **미달(2개↓)**: 해당 **원자 스킬** 드릴(예: 표→식 60초), 동일 구조로 재측정

### 8.2 마스터리 업데이트(간단 수식)

* **정답 확률 모델(IRT 2PL)**:
  $$P(\text{정답}|\theta,a,b) = \frac{1}{1 + e^{-a(\theta - b)}}$$
* **업데이트**: $$\theta_{t+1} = \theta_t + \eta \cdot (y_t - P_t)$$

  * \(\eta\): 학습률(설명 루브릭 가중, 예: 루브릭 0~1을 곱)
  * RT가 너무 빠르거나 느리면(로그-RT z-score) 가중 감쇠
* **설명 가중**: 루브릭 점수(0~1)로 \(\eta\) 보정(설명을 잘하면 \(\theta\) 상승폭↑)

### 8.3 스페이싱·인터리빙

* 통과 노드에 **2–7–21일** 복습 예약
* **페어 전이**: 비례↔일차, 등차↔변화율, 닮음↔삼각비 등 **교차 노출**

---

## 9) 평가 설계(설명형 루브릭)

| 기준    | 0점 | 1점   | 2점   | 3점            | 4점        |
| ----- | -- | ---- | ---- | ------------- | --------- |
| 핵심어   | 없음 | 1개   | 2개   | 3개            | 3개+정확 맥락  |
| 구조 언급 | 없음 | 암시   | 일부   | 명시(예: 기울기=공차) | 명시+일반화    |
| 정확성   | 오해 | 부분오류 | 거의정확 | 정확            | 정확+반례언급   |
| 일반화   | 없음 | 사례1  | 사례2  | 공식화 시도        | 공식화+다른 맥락 |

* **자동 채점**: 키워드 사전(예: 공차/기울기/단위율/면적/폭) + 패턴 문장(템플릿) 매칭
* **음성 입력**: 20초 이하 음성→STT→동일 루브릭 적용

---

## 10) 데이터 모델(요약 JSON 스키마)

```json
{
  "User": { "id": "str", "role": "student|parent|teacher|author", "grade_band": "E2-E6", "prefs": {} },
  "ConceptNode": { "id": "str", "name": "str", "lens": ["difference"], "prereq": ["id"], "transfer": ["id"] },
  "ItemTemplate": { "id":"str","node_id":"str","step":"S1|S2|S3","representation":"C|P|A|C->P","context_pack":["life","table","geometry"],"params_schema":{}, "constraints":[], "scripts": {"make_stimulus":"code","solve":"code"}, "tags":{} },
  "ItemInstance": { "id":"str","template_id":"str","params":{}, "stimulus":{}, "answers":{} },
  "Attempt": { "id":"str","user_id":"str","item_id":"str","ts":"iso","answer":{}, "correct":true, "rt_ms":12345, "explanation":"str","rubric":{"sum":3,"detail":{"keywords":1,"structure":1,"accuracy":1,"generalization":0}} },
  "Mastery": { "user_id":"str","node_id":"str","theta":0.0,"updated_at":"iso" },
  "Session": { "id":"str","user_id":"str","start":"iso","end":"iso","items":["id"],"lrc":{"acc":0.92,"rt_pct":0.65,"rubric":0.75,"passed":true} },
  "Review": { "user_id":"str","node_id":"str","due":"iso","type":"spaced|interleaved","status":"scheduled|done" },
  "Badge": { "id":"str","name":"str","criteria":"JSONLogic" },
  "SourceRef": { "id":"str","note":"영감/구조 참조", "license":"original|cleared" }
}
```

**분석 이벤트(필드 최소)**
`attempt_submitted, explanation_scored, lrc_gate_passed, node_mastery_updated, spaced_review_scheduled, item_flagged, session_completed`

---

## 11) API(간단 설계)

* `GET /nodes?user=:id` → 시작/추천 노드
* `POST /items/generate` {template_id, seed} → ItemInstance
* `POST /attempts` {item_id, answer, explanation} → {correct, rubric, rt_ms}
* `POST /lrc/evaluate` {session_id} → {passed: bool, details}
* `GET /report/parent?user=:id` → 주간 리포트(전이 증거 스냅샷 링크)
* `GET /teacher/cohort/:id/heatmap` → 렌즈×노드 히트맵

---

## 12) 콘텐츠 파이프라인 & 저작권

* **절차**: 외부 문항 **구조 서술화** → 신규 맥락/수치/표현으로 **재저작** → 내부 표절 검사(문장/수치 패턴) → `inspiration_only:true` 메타 기록.
* **이미지/표**: 자체 제작 벡터 또는 라이선스 클리어 에셋.
* **앵커 문항**: 판간 난이도 유지(IRT 파라미터).

---

## 13) 접근성 & 품질

* **저학년 UI**: 큰 버튼·음성 입력·이미지 중심 피드백
* **색각 안전 팔레트**, **오프라인 모드**(세션 캐시)
* **QA 기준**: (1) 템플릿 유일해, (2) LRC 판정 일관성, (3) 음성→루브릭 오차±0.5 이내

---

## 14) KPI & 실험

* **학습 성과**: 전이 모의고사 +15%p(12주), LRC 통과 노드 수, 설명 루브릭 평균 ≥3.0
* **활성/유지**: D7 잔존 ≥35%, 주당 학습 ≥45분
* **A/B**: (a) 렌즈 토글 노출 vs 고정, (b) 설명 먼저 vs 나중, (c) 반례 카드 유무

---

## 15) 초기 콘텐츠 팩(제작 백로그)

1. **덧셈→등차**: S1 40, S2 40, S3 20 (동형 3맥락 포함)
2. **비율·비례**: S1 40, S2 40, S3 20
3. **좌표→직선/원**: S1 30, S2 40, S3 20
4. **닮음→삼각비**: S1 30, S2 40, S3 20
5. **경우의 수 씨앗**: S1 30, S2 30, S3 15
6. **누적→적분 직관**: S1 30, S2 30, S3 15

---

## 16) 12주 로드맵(제품·콘텐츠 동시 진행)

**W1–W2**

* PRD 동결, 데이터 스키마/템플릿 DSL 확정
* 온보딩 진단 v0.9, 세션 플레이어(렌즈 토글/설명칸) 기본

**W3–W4**

* 문제 생성기 v1(템플릿→3맥락 자동 파생)
* LRC 엔진 v0.9(정확/RT/설명 판정)
* 콘텐츠: 덧셈→등차 S1/S2/S3 1차 120문항

**W5–W6**

* 리포트 1.0(아이/부모) & 지식그래프 뷰
* 교사 콘솔 0.8(히트맵/과제)
* 파일럿 A(20~40명) 데이터 수집(정확/RT/설명)

**W7–W8**

* IRT/ELO 보정, 앵커 문항 탑재
* 반례 카드·1분 드릴 자동 추천
* 콘텐츠: 비율·비례/좌표→직선 1차 160문항

**W9–W10**

* Backwards Bridge 모드, 인터리빙 스케줄러
* 전이 모의고사(Structure-Only) 1.0
* 파일럿 B(교습소 1~2곳) + 코호트 히트맵 리뷰

**W11–W12**

* 품질/접근성 QA, 법무 점검(저작권 로그)
* v1.0 컷: 6스레드 최소 600~800문항, 리포트/콘솔 안정화
* 런칭 문서(교사 악보/부모 가이드) 배포

---

## 17) 리스크 & 대응

* **과속 요구(부모)** → LRC 근거 리포트 제공, 게이트 하향불가 원칙
* **설명형 입력 부담** → 음성→텍스트 옵션, 키워드 자동 제안
* **데이터 스파스** → 앵커 문항과 동형 3형제로 빠른 파라미터 추정
* **저작권 이슈** → “구조만 추출·재저작” 프로세스, `inspiration_only` 로그 필수

---

## 부록 A. 예시 아이템(요약)

**템플릿**: `ALG-AP-S2-015` (등차 S2)

* **자극**: 표 (n=1..6), 첫항 4, 공차 5(무작위)
* **질문**: “일반항을 **말로** 먼저 쓰고, 식으로 옮기세요.”
* **정답**: “시작 4에서 **같은 만큼** 5씩 늘어남 → (a_n=4+5(n-1))”
* **루브릭 키워드**: 시작값/차이/기울기(그래프 연계)

**템플릿**: `ALG-PR-S3-007` (비례 S3)

* **자극**: 거리–시간 표(거리×시간 일정)
* **질문**: “반비례인지 설명하고 식을 쓰세요.”
* **정답**: “곱이 일정 → (xy=c)” / 그래프는 하이퍼볼릭

**템플릿**: `CAL-ACC-S3-003` (누적 S3)

* **자극**: 곡선 데이터와 폭=1 막대
* **질문**: “사다리꼴 근사 vs 계단 합 비교, 면적 단위 포함 설명”
* **정답**: 단위/폭 언급 필수, 오개념(높이합=면적) 경고

---

## 부록 B. 수업 악보(교사 콘솔 자동 생성 예)

* **도입(1′)**: 오늘 렌즈 🔺, 생활 예(계단)
* **탐구(10′)**: C→P(표 채우기), P→A(말→식)
* **전이(7′)**: 동형 3형제(생활/데이터/도형)
* **메타(3′)**: “시작값/차이/기울기”로 한 문장
* **퀵체크(4′)**: 6문항 + LRC 즉시 피드백

---

*이 PRD를 기준으로 바로 **화면 설계서(와이어 상세)**, **콘텐츠 제작 브리프(각 스레드별 6p 유닛 사양)**, **데이터 사전(Analytics 이벤트 정의)**까지 확장 가능합니다.*
*원하시면 **우선 스레드 3개(덧셈→등차, 비율·비례, 좌표→직선/원)**로 **MVP 상세 화면/플로우**와 **첫 100문항 템플릿**을 즉시 작성해 드릴게요.*
