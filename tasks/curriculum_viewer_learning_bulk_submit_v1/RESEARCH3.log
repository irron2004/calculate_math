
============================================================
[2026-01-08 10:17:18] RESEARCH3 (req_id: af3c6e6c9c)
============================================================
  |10| COMB_AS_CHOOSE_R | STEP_COMB_DERIVE | “r개 선택” 인식이 유도 단계
  입력(중복 제거 대상)을 안정화 | 0.74 |
  |11| COMB_ORDER_IGNORED_REASON | STEP_COMB_DERIVE | r! 중복 제거 이유가
  유도 템플릿을 의미 기반으로 고정 | 0.80 |
  |12| COMB_FROM_PERM_DIVIDE | STEP_COMB_DERIVE | nPr/r! 절차가 조합 유도
  의 실행 골격으로 전이 | 0.74 |
  |13| FACTORIAL_CANCELLATION | STEP_COMB_DERIVE | 약분 정리가 조합 유도/
  계산의 마무리 실행으로 전이 | 0.74 |
  |14| CHOOSE_THEN_ARRANGE | STEP_COMB_DERIVE | 선택-배열 동치(nPr=nCr·r!)
  가 유도 확인/복합 분해로 전이(권장) | 0.68 |
  |15| STEP_COMB_DERIVE | COMB_BASIC | 의미→유도→정리 묶음이 조합 단원 대
  표 문항 구조로 전이 | 0.74 |
  |16| SYSTEMATIC_LISTING_BASIC | STEP_SAMPLE_SPACE_BUILD | 체계적 나열이
  표본공간 구성(빠짐/중복 점검) 템플릿으로 전이 | 0.76 |
  |17| SAMPLE_SPACE_AS_SET | STEP_SAMPLE_SPACE_BUILD | 분모(전체) 고정이
  구성 단계의 핵심 입력으로 전이 | 0.75 |
  |18| TREE_DIAGRAM_BASIC | STEP_SAMPLE_SPACE_BUILD | 분기 시각화가 표본공
  간 구성/검산 구조로 전이(권장) | 0.70 |
  |19| STEP_SAMPLE_SPACE_BUILD | STEP_PROB_SETUP | 전체(분모) 고정이 고전
  확률 설정(사건/전제/A/S) 단계로 전이 | 0.76 |
  |20| EVENT_AS_SUBSET | STEP_PROB_SETUP | 사건=부분집합 관점이 분자(유리
  한 경우) 정의 구조로 전이 | 0.78 |
  |21| CLASSICAL_PROB_EQUIPROBABLE_CHECK | STEP_PROB_SETUP | 등확률 전제
  확인이 A/S 적용 게이트로 전이 | 0.77 |
  |22| EQUIPROBABLE_DECISION | STEP_PROB_SETUP | Yes/No 분기가 계산 경로
  (A/S 적용 여부)를 고정 | 0.74 |
  |23| COUNT_FAVORABLE_TOTAL | STEP_PROB_SETUP | 유리/전체 분리 카운팅이
  A/S 설정 실행으로 전이 | 0.77 |
  |24| PROB_AS_RATIO | STEP_PROB_SETUP | 카운팅 결과를 A/S로 출력하는 표현
  이 설정 단계의 핵심으로 전이 | 0.76 |
  |25| STEP_PROB_SETUP | PROB_BASIC | 설정 템플릿(전체→사건→전제→A/S)이 확
  률 기초 대표 문항 구조로 전이 | 0.72 |
  |26| STEP_EVENT_OPS_INCL_EXCL | STEP_INCL_EXCL_2SET | 문장→집합식→판정→
  보정 구조가 2집합 포함배제 단계로 전이 | 0.73 |
  |27| INCL_EXCL_2SET_MEANING | STEP_INCL_EXCL_2SET | -교집합이 중복 보정
  이라는 의미가 식 적용을 안정화하며 전이 | 0.74 |
  |28| APPLY_INCL_EXCL_2SET | STEP_INCL_EXCL_2SET | 항 매핑→대입→계산 실행
  이 단계 완성을 보장 | 0.75 |
  |29| STEP_INCL_EXCL_2SET | PROB_BASIC | 합사건/포함배제 유형 대표 문항
  구조로 전이 | 0.69 |
  |30| COMPLEMENT_EVENT | COMPLEMENT_RULE | 여사건(보완) 개념이 1-p 규칙
  적용으로 전이 | 0.75 |
  |31| COMPLEMENT_RULE | PROB_BASIC | 1-p 절차가 여사건 유형 대표 문항 구
  조로 전이 | 0.74 |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | COMB_AS_SUBSET | EVENT_AS_SUBSET | 부분집합 선택 ↔ 사건(부분집합)
  고정으로 “대상 집합화” 구조가 동형 | 0.70 |
  | 2 | SLOT_DIAGRAM | TREE_DIAGRAM_BASIC | 단계 선택 구조를 슬롯/트리로
  외재화해 누락을 막는 표현 동형 | 0.63 |
  | 3 | CHECK_DOUBLE_COUNTING | INCL_EXCL_2SET_MEANING | 겹침 감지→중복 보
  정 필요(-교집합) 의미 구조 동형 | 0.74 |
  | 4 | COMB_ORDER_IGNORED_REASON | INCL_EXCL_2SET_MEANING | 중복 원인 설
  명 후 보정(÷r!/ -교집합)으로 연결하는 구조 동형 | 0.64 |
  | 5 | EQUIPROBABLE_DECISION | DISJOINT_OR_OVERLAP_DECISION | 조건 점검→
  규칙 선택 게이트 패턴만 유사(대상은 다름) | 0.58 |
  | 6 | COMPLEMENT_EVENT | FACTORIAL_ZERO_MEANING | 경계 케이스(없음/전부)
  에서 정의를 고정해 붕괴를 막는 메타 패턴 동형 | 0.52 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답 생성 규칙 |
  |---|---------|------------------|-----------|---------------|
  | 1 | 슬롯 기반 단계곱 | k∈[2,5], ai∈[2,10] | S=Π ai | Σ ai, 단계 누락,
  중복허용으로 착각 |
  | 2 | 서로소 합(덧셈원리) | m∈[2,6], mi∈[3,40], disjoint=true | total=Σ
  mi | Π mi, 겹침이 있는데도 단순합, Σ mi ± 1 |
  | 3 | 순열 nPr(감소곱) | n∈[4,12], r∈[0,n] | nPr=Π_{i=0}^{r-1}(n-i) |
  n^r, nCr, Π 범위 오류 |
  | 4 | 순열 nPr(팩토리얼) | n∈[4,12], r∈[0,n] | nPr=n!/(n-r)! | n!/r!,
  n!/(n-r), nCr |
  | 5 | 경계 0! 체크(nP0/nPn) | n∈[3,20], case∈{nP0,nPn} | ans=1 | 0, n,
  n! |
  | 6 | 조합 nCr(팩토리얼) | n∈[6,40], r∈[0,n] | nCr=n!/(r!(n-r)!) | nPr,
  r! 누락, (n-r)! 누락 |
  | 7 | 조합 유도(nPr/r!) | n∈[6,40], r∈[2,n-1] | nCr=nPr/r! | nPr,
  nCr·r!, nPr/(n-r)! |
  | 8 | 선택 후 배열(nCr·r!) | n∈[6,30], r∈[2,n] | nCr·r! (=nPr) | nCr만,
  nPr/r!, r!만, nPr |
  | 9 | 고전확률(A/S) | S∈[12,60], A∈[1,S], equiprobable=true | p=A/S | S/
  A, (A±1)/S, 등확률 미확인인데 A/S 적용 |
  |10| 여사건 확률(1-p) | p∈[0.05,0.95] | 1-p | p, 1/(1-p), 1-(p/2) |
  |11| 포함배제(2집합) 확률 | S∈[20,200], nA,nB∈[1,S], nAB∈[0,min] |
  p=(nA+nB-nAB)/S | (nA+nB+nAB)/S, (nA+nB)/S, nAB/S, -2nAB 보정 |
  |12| 정확히 하나(2집합) | nA,nB∈[3,80], nAB∈[0,min], S∈[20,200] |
  pXO=(nA+nB-2nAB)/S | (nA+nB-nAB)/S, (nA+nB)/S, 2nAB/S |

  ### 상세 템플릿 예시 (3개)

  Template 1: 선택 후 배열(nCr·r!)
  - Parameters: { n: [6,30], r: [2,n], roles_distinct: true }
  - Answer: f(n,r) = nCr * r!  (= nPr)
  - Distractors: [nCr (배열 단계 누락), nPr/r! (나누기 방향 착각), nPr (선
  택만인데 배열로 착각), r!만 사용]
  - Required Skills: [CHOOSE_THEN_ARRANGE, COMB_AS_CHOOSE_R,
  ORDER_SENSITIVE_CHECK, COMB_ORDER_IGNORED_REASON, COMB_FROM_PERM_DIVIDE]

  Template 2: 포함배제(2집합) 확률
  - Parameters: { S: [20,200], nA: [1,S], nB: [1,S], nAB: [0,min(nA,nB)],
  equiprobable: true }
  - Answer: f(S,nA,nB,nAB) = (nA + nB - nAB) / S
  - Distractors: [(nA+nB+nAB)/S, (nA+nB)/S, nAB/S, (nA+nB-2nAB)/S]
  - Required Skills: [EVENT_OPERATION_EXPRESSION,
  INTERSECTION_UNION_MEANING, DISJOINT_OR_OVERLAP_DECISION,
  CHECK_DOUBLE_COUNTING, INCL_EXCL_2SET_MEANING, APPLY_INCL_EXCL_2SET,
  PROB_AS_RATIO]

  Template 3: 경계 0! 체크(nP0/nPn)
  - Parameters: { n: [3,20], case: ["nP0","nPn"] }
  - Answer: f(n,case) = 1
  - Distractors: [0, n, n!]
  - Required Skills: [FACTORIAL_ZERO_MEANING, PERM_PRODUCT_FORM,
  FACTORIAL_EXPANSION]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 선택 후 배열(조합×순열) | r명을 뽑고 r개 역할에 배정 | r개 항목을
  뽑아 순서 있는 리스트 생성 | r개 점을 택해 순서대로 라벨링 |
  | 2 | 순열(자리 채우기) | 비밀번호/좌석 배치 경우의 수 | 길이 r의 순서
  튜플 생성 | 단계별 선택 곱으로 경로 수 |
  | 3 | 조합(부분집합 선택) | n명 중 r명 위원 선출 | n개 feature 중 r개 선
  택 | n점 중 r점 선택 |
  | 4 | 표본공간 구성(단계 곱) | 코스 메뉴 선택 경우의 수 | 속성 조합 가능
  한 경우의 수 | 격자 이동 경로를 단계별로 나열 |
  | 5 | 2집합 포함배제(겹침 보정) | 두 동아리 중 하나 이상 가입자 수 | 조
  건 A OR B 레코드 수(중복 제거) | 두 도형 합집합 넓이/점 개수 |
  | 6 | 여사건(보완) | “적어도 하나”를 “하나도 아님”으로 뒤집기 | OR의 반
  대(NOT A AND NOT B)로 계산 | 합집합 바깥을 먼저 구해 전체에서 빼기 |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 선택 후 배열(조합×순열)
  - 생활: n명 중 r명을 뽑아 서로 다른 역할 r개에 배정하는 경우의 수를 구한
  다.
  - 데이터: n개의 후보 중 r개를 선택해 순서 있는 추천 리스트(길이 r)를 만
  드는 경우의 수를 구한다.
  - 도형: n개의 점 중 r개를 선택해 라벨(1..r)을 부여하여 순서 있는 배치를
  만든다.
  - 공통 스킬: [CHOOSE_THEN_ARRANGE, COMB_AS_CHOOSE_R,
  ORDER_SENSITIVE_CHECK, PERM_AS_FILLING_SLOTS, PERM_PRODUCT_FORM]

  Triplet 2: 2집합 포함배제(겹침 보정)
  - 생활: A 조건 만족 nA, B 조건 만족 nB, 둘 다 만족 nAB가 주어질 때 “A 또
  는 B”의 인원/확률을 구한다.
  - 데이터: 조건 A, B를 만족하는 로그 수와 교집합이 주어질 때 OR 결과 수/
  비율을 구한다.
  - 도형: 영역 A, B의 넓이/점 개수와 교집합이 주어질 때 합집합 값을 구한
  다.
  - 공통 스킬: [EVENT_OPERATION_EXPRESSION, INTERSECTION_UNION_MEANING,
  DISJOINT_OR_OVERLAP_DECISION, CHECK_DOUBLE_COUNTING,
  INCL_EXCL_2SET_MEANING, APPLY_INCL_EXCL_2SET]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "TS_COMB_PROB",
    "add_nodes": [],
    "add_edges": [
      { "from": "COUNT_MUL_RULE_MEANING", "to": "STEP_PERM_DERIVE",
  "type": "enables", "reason": "단계 곱 의미가 순열 유도 템플릿으로 전이",
  "confidence": 0.76 },
      { "from": "SLOT_DIAGRAM", "to": "STEP_PERM_DERIVE", "type":
  "enables", "reason": "슬롯 도식이 단계/제약 외재화로 유도 전이를 강화",
  "confidence": 0.74 },
      { "from": "PERM_AS_FILLING_SLOTS", "to": "STEP_PERM_DERIVE", "type":
  "enables", "reason": "자리 채우기 의미가 곱/팩토리얼 전환을 안정화",
  "confidence": 0.74 },
      { "from": "PERM_PRODUCT_FORM", "to": "STEP_PERM_DERIVE", "type":
  "enables", "reason": "감소곱 표현이 nPr 유도/계산의 표준 형태로 전이",
  "confidence": 0.76 },
      { "from": "FACTORIAL_EXPANSION", "to": "STEP_PERM_DERIVE", "type":
  "enables", "reason": "전개/묶기로 연산 형태를 맞춰 유도 경로를 안정화",
  "confidence": 0.74 },
      { "from": "FACTORIAL_ZERO_MEANING", "to": "STEP_PERM_DERIVE",
  "type": "enables", "reason": "경계(r=0,r=n)에서 공식 붕괴를 막는 검산 포
  인트", "confidence": 0.66 },
      { "from": "STEP_PERM_DERIVE", "to": "PERM_BASIC", "type": "enables",
  "reason": "의미→표기→검산 템플릿이 순열 단원 대표 구조로 전이",
  "confidence": 0.74 },

      { "from": "ORDER_SENSITIVE_CHECK", "to": "STEP_COMB_DERIVE", "type":
  "enables", "reason": "순서 게이트가 조합 유도 경로 선택을 안정화",
  "confidence": 0.73 },
      { "from": "COMB_AS_SUBSET", "to": "STEP_COMB_DERIVE", "type":
  "enables", "reason": "선택=부분집합 관점이 조합 유도 구조를 정당화",
  "confidence": 0.73 },
      { "from": "COMB_AS_CHOOSE_R", "to": "STEP_COMB_DERIVE", "type":
  "enables", "reason": "r개 선택 인식이 유도 단계 입력을 안정화",
  "confidence": 0.74 },
      { "from": "COMB_ORDER_IGNORED_REASON", "to": "STEP_COMB_DERIVE",
  "type": "enables", "reason": "r! 중복 제거 이유가 유도 템플릿을 의미 기
  반으로 고정", "confidence": 0.80 },
      { "from": "COMB_FROM_PERM_DIVIDE", "to": "STEP_COMB_DERIVE", "type":
  "enables", "reason": "nPr/r! 절차가 조합 유도 실행 골격으로 전이",
  "confidence": 0.74 },
      { "from": "FACTORIAL_CANCELLATION", "to": "STEP_COMB_DERIVE",
  "type": "enables", "reason": "약분 정리가 조합 유도/계산의 마무리 실행",
  "confidence": 0.74 },
      { "from": "CHOOSE_THEN_ARRANGE", "to": "STEP_COMB_DERIVE", "type":
  "enables", "reason": "nPr=nCr·r! 동치가 유도 확인/복합 분해로 전이",
  "confidence": 0.68 },
      { "from": "STEP_COMB_DERIVE", "to": "COMB_BASIC", "type": "enables",
  "reason": "의미→유도→정리 묶음이 조합 단원 대표 구조로 전이",
  "confidence": 0.74 },

      { "from": "SYSTEMATIC_LISTING_BASIC", "to":
  "STEP_SAMPLE_SPACE_BUILD", "type": "enables", "reason": "체계적 나열이
  표본공간 구성(빠짐/중복 점검) 템플릿으로 전이", "confidence": 0.76 },
      { "from": "SAMPLE_SPACE_AS_SET", "to": "STEP_SAMPLE_SPACE_BUILD",
  "type": "enables", "reason": "분모(전체) 고정이 구성 단계의 핵심 입력으
  로 전이", "confidence": 0.75 },
      { "from": "TREE_DIAGRAM_BASIC", "to": "STEP_SAMPLE_SPACE_BUILD",
  "type": "enables", "reason": "분기 시각화가 표본공간 구성/검산을 돕는 전
  이(권장)", "confidence": 0.70 },
      { "from": "STEP_SAMPLE_SPACE_BUILD", "to": "STEP_PROB_SETUP",
  "type": "enables", "reason": "전체(분모) 고정이 고전확률 설정 단계로 전
  이", "confidence": 0.76 },
      { "from": "EVENT_AS_SUBSET", "to": "STEP_PROB_SETUP", "type":
  "enables", "reason": "사건=부분집합 관점이 분자 정의 구조로 전이",
  "confidence": 0.78 },
      { "from": "CLASSICAL_PROB_EQUIPROBABLE_CHECK", "to":
  "STEP_PROB_SETUP", "type": "enables", "reason": "등확률 전제 확인이 A/S
  적용 게이트로 전이", "confidence": 0.77 },
      { "from": "EQUIPROBABLE_DECISION", "to": "STEP_PROB_SETUP", "type":
  "enables", "reason": "Yes/No 분기가 계산 경로(A/S 적용 여부)를 고정",
  "confidence": 0.74 },
      { "from": "COUNT_FAVORABLE_TOTAL", "to": "STEP_PROB_SETUP", "type":
  "enables", "reason": "유리/전체 분리 카운팅이 A/S 설정 실행으로 전이",
  "confidence": 0.77 },
      { "from": "PROB_AS_RATIO", "to": "STEP_PROB_SETUP", "type":
  "enables", "reason": "카운팅 결과를 A/S로 출력하는 표현이 설정 단계의 핵
  심", "confidence": 0.76 },
      { "from": "STEP_PROB_SETUP", "to": "PROB_BASIC", "type": "enables",
  "reason": "설정 템플릿(전체→사건→전제→A/S)이 확률 기초 대표 구조로 전
  이", "confidence": 0.72 },

      { "from": "STEP_EVENT_OPS_INCL_EXCL", "to": "STEP_INCL_EXCL_2SET",
  "type": "enables", "reason": "문장→집합식→판정→보정 구조가 포함배제 단계
  로 전이", "confidence": 0.73 },
      { "from": "INCL_EXCL_2SET_MEANING", "to": "STEP_INCL_EXCL_2SET",
  "type": "enables", "reason": "-교집합이 중복 보정이라는 의미가 식 적용을
  안정화", "confidence": 0.74 },
      { "from": "APPLY_INCL_EXCL_2SET", "to": "STEP_INCL_EXCL_2SET",
  "type": "enables", "reason": "항 매핑→대입→계산 실행이 단계 완성을 보
  장", "confidence": 0.75 },
      { "from": "STEP_INCL_EXCL_2SET", "to": "PROB_BASIC", "type":
  "enables", "reason": "합사건/포함배제 유형 대표 문항 구조로 전이",
  "confidence": 0.69 },

      { "from": "COMPLEMENT_EVENT", "to": "COMPLEMENT_RULE", "type":
  "enables", "reason": "여사건(보완) 개념이 1-p 규칙 적용으로 전이",
  "confidence": 0.75 },
      { "from": "COMPLEMENT_RULE", "to": "PROB_BASIC", "type": "enables",
  "reason": "1-p 절차가 여사건 유형 대표 문항 구조로 전이", "confidence":
  0.74 },

      { "from": "COMB_AS_SUBSET", "to": "EVENT_AS_SUBSET", "type":
  "analog_of", "reason": "부분집합 선택과 사건(부분집합) 고정이 같은 구
  조", "confidence": 0.70 },
      { "from": "SLOT_DIAGRAM", "to": "TREE_DIAGRAM_BASIC", "type":
  "analog_of", "reason": "단계 선택 구조를 슬롯/트리로 외재화하는 표현 동
  형", "confidence": 0.63 },
      { "from": "CHECK_DOUBLE_COUNTING", "to": "INCL_EXCL_2SET_MEANING",
  "type": "analog_of", "reason": "겹침 감지→중복 보정 필요(-교집합) 의미
  구조 동형", "confidence": 0.74 },
      { "from": "COMB_ORDER_IGNORED_REASON", "to":
  "INCL_EXCL_2SET_MEANING", "type": "analog_of", "reason": "중복 원인 설명
  후 보정(÷r!/ -교집합)으로 연결하는 구조 동형", "confidence": 0.64 },
      { "from": "EQUIPROBABLE_DECISION", "to":
  "DISJOINT_OR_OVERLAP_DECISION", "type": "analog_of", "reason": "조건 점
  검→규칙 선택 게이트 패턴만 유사(대상은 다름)", "confidence": 0.58 },
      { "from": "COMPLEMENT_EVENT", "to": "FACTORIAL_ZERO_MEANING",
  "type": "analog_of", "reason": "경계 케이스(없음/전부)에서 정의를 고정해
  붕괴를 막는 메타 패턴", "confidence": 0.52 }
    ],
    "notes": [
      { "claim": "STEP_PERM_DERIVE를 거치면 nPr을 공식 암기 대신 자리-감소
  곱 구조로 풀게 된다.", "reason": "슬롯/자리 의미를 곱형태로 고정하고 팩
  토리얼 표기로 연결하면 해석-계산이 끊기지 않는다.", "confidence":
  0.74 },
      { "claim": "STEP_COMB_DERIVE에 CHOOSE_THEN_ARRANGE를 함께 두면
  nPr,nCr,nPr/r! 혼동이 줄어든다.", "reason": "선택-배열 동치 템플릿이 ‘중
  복 제거’ 의미를 강화해 공식 선택과 유도 검산이 안정화된다.",
  "confidence": 0.72 },
      { "claim": "STEP_PROB_SETUP(전체→사건→전제→A/S)을 고정하면 A/S 설정
  오류가 줄어든다.", "reason": "분모 변경, 유리/전체 혼합, 등확률 전제 누
  락은 설정 순서가 흔들릴 때 발생하므로 템플릿 고정이 효과적이다.",
  "confidence": 0.76 },
      { "claim": "STEP_EVENT_OPS_INCL_EXCL→STEP_INCL_EXCL_2SET 전이는 포함
  배제 부호/항 누락을 줄인다.", "reason": "집합식→겹침 판정→중복 보정 의미
  를 먼저 고정하면 -교집합이 공식 암기가 아니라 보정으로 연결된다.",
  "confidence": 0.75 },
      { "claim": "COMPLEMENT_EVENT ↔ FACTORIAL_ZERO_MEANING 동형은 경계 케
  이스 고정(메타)로만 제한해야 안전하다.", "reason": "내용 전이가 아니라
  ‘정의/규칙이 무너지는 경계’를 먼저 점검하는 패턴 유사성이므로 적용 범위
  를 좁혀야 혼동이 줄어든다.", "confidence": 0.66 }
    ]
  }

  [/R3 Transfer Report]

  ###DONE:abaa6f93fa###


› 터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_af3c6e6c9c.md


  44% context left



› Request af3c6e6c9c: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_af3c6e6c9c.md



  │ … +8 lines
                               
  CoSearch ## Output Format in research_af3c6e6c9c.md
                                      
                           
           curriculum_view                          
                                              
   4Search chars truncated in resear                


• Ran python - <<'PY'
  │ import re
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ … +8 lines
  └ [Previous Researcher Handoff (R2 Progression Report)]
    ## Micro Skill Decomposition
    … +707 lines

      [/R2 Progression Report]

  │ … +8 lines
•         
  └ Search ## Graph Patch JSON in research_af3c6e6c9c.m 
                               

› Summarize recent commits

  41% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +8 lines
  └ chars 25844
    lines 711

  │ … +9 lines

◦ Planning chunk output (5m 02s • esc to interrupt)


› Summarize recent commits

  38% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +9 lines
  └ [Previous Researcher Handoff (R2 Progression Report)]
    ## Micro Skill Decomposition
    … +200 lines
      그를 단일 진실 소스로 두고 표시를 전부 게이팅 | 0.78 |


  │ … +9 lines

◦ Planning chunk output (5m 16s • esc to interrupt)


› Summarize recent commits

  36% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +9 lines
  └ chars 7305

  │ … +10 lines

• Planning chunk output (5m 24s • esc to interrupt)


› Summarize recent commits

  36% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +10 lines
  └ 150 5439
    160 5846
    170 6230
    180 6510

  │ … +8 lines

• Planning chunk output (5m 30s • esc to interrupt)


› Summarize recent commits

  36% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +8 lines
  └ [Previous Researcher Handoff (R2 Progression Report)]
    ## Micro Skill Decomposition
    … +179 lines
    마/


  │ … +9 lines

• Planning chunk output (5m 36s • esc to interrupt)


› Summarize recent commits

  35% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +9 lines
  └ chars 7378

  │ … +9 lines

• Planning chunk output (5m 43s • esc to interrupt)


› Summarize recent commits

  35% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +9 lines
  └ 180 340 6567
    180 330 6087
    180 320 5612
    180 310 5134

  │ … +8 lines

◦ Planning chunk output (5m 49s • esc to interrupt)


› Summarize recent commits

  35% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +8 lines
  └   submitProblem 흐름을 모르고 수정해 회귀 발생 | 현재 상
    태
    … +161 lines
      트", "domain": "FE", "rep": "C", "confidence": 0.74 },


  │ … +9 lines

◦ Planning chunk output (5m 59s • esc to interrupt)


› Summarize recent commits

  33% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +9 lines
  └ 340 500 5679
    340 490 5442
    340 480 5164
    340 470 4828

  │ … +8 lines

• Planning chunk output (6m 04s • esc to interrupt)


› Summarize recent commits

  33% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +8 lines
  └       { "id": "STEP_PERSIST_RESTORE_WORKFLOW", "type":
      "step", "name_ko": "저장/복원/호환 처리", "domain":
    … +159 lines
      ### 2. 과잉 난이도/불필요 선행 (최소 5개)


  │ … +9 lines

• Planning chunk output (6m 14s • esc to interrupt)


› Summarize recent commits

  32% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +9 lines
  └ 500 650 5154
    500 640 4819
    500 630 4420
    500 620 4025

  │ … +8 lines

◦ Planning chunk output (6m 20s • esc to interrupt)


› Summarize recent commits

  32% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +8 lines
  └
      | # | 개념명 | 과잉 이유 | 조치 제안 |
    … +147 lines
      { "claim": "현재 LearnPage는 문제 카드별 제출


  │ … +9 lines

◦ Planning chunk output (6m 27s • esc to interrupt)


› Summarize recent commits

  31% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +9 lines
  └ lines total 711
    chars remaining 1934

  │ … +8 lines

◦ Planning chunk output (6m 33s • esc to interrupt)


› Summarize recent commits

  31% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_af3c6e6c9c.md'
  │ text = open(path,'r',encoding='utf-8').read()
  │ … +8 lines
  └   (submitProblem)로 단건 채점/단건 저장을 수행하며,
      StoredResult는 { nodeId, updatedAt, submissions:
    … +60 lines

      [/R2 Progression Report]

─ Worked for 7m 59s ────────────────────────────────────────

• ###BEGIN:af3c6e6c9c###

  ## Transfer Edge Analysis

  ### Enables Edges (스킬 → 상위 문항 구조)

  | # | From | To | transfer 이유 | confidence |
  |---|------|----|--------------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT |
  STEP_BULK_SUBMIT_UI_WORKFLOW | per-problem 제출 제거가
  bulk UX 재구성(단일 진입점+상태/조건)으로 전이 | 0.82 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON |
  STEP_BULK_SUBMIT_UI_WORKFLOW | 단일 버튼이 bulk UX의 유일
  한 진입점 구조를 고정 | 0.84 |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  STEP_BULK_SUBMIT_UI_WORKFLOW | “입력됨”의 기준을 grading과
  동일하게 맞추면 disabled UX가 안정화 | 0.82 |
  | 4 | LEARN_DISABLED_EDGECASES_12 |
  STEP_BULK_SUBMIT_UI_WORKFLOW | 엣지케이스 벡터를 기준으로
  disabled 회귀를 줄이는 템플릿으로 전이 | 0.76 |
  | 5 | LEARN_ALL_ANSWERED_NORMALIZED |
  STEP_BULK_SUBMIT_UI_WORKFLOW | allAnswered(정규화 기반)가
  버튼 활성화 규칙을 직접 완성 | 0.82 |
  | 6 | STEP_BULK_SUBMIT_UI_WORKFLOW |
  STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 진입점/disabled가
  고정되면 “채점 액션→표시 업데이트” 구조가 자연스럽게 활성
  화 | 0.72 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION |
  STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 전체 순회 채점이
  “결과 맵 생성→UI 반영” 핵심 동작으로 전이 | 0.84 |
  | 8 | LEARN_GRADED_STATE_FLAG |
  STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 채점 전/후 플래그가
  점수/정오/정답 표시의 기준(게이팅)을 고정 | 0.78 |
  | 9 | LEARN_SCORE_SUMMARY_CALC |
  STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 결과 맵 기반 X/N 요
  약이 bulk 채점 결과 표시 구조로 전이 | 0.74 |
  |10| LEARN_SCORE_AND_RESULT_GATING |
  STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | hasGraded 기반 게이
  팅이 채점 전 UI 혼란(0/N, 정답 노출)을 방지 | 0.76 |
  |11| LEARN_GRADE_BUTTON_LABEL_STATE |
  STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 라벨/상태 전환이
  “채점하기↔다시 채점” 후속 UX 구조로 전이 | 0.68 |
  |12| LEARN_AFTER_GRADE_EDIT_POLICY |
  STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 입력 변경 시 결과
  일관성 정책이 재채점/결과 초기화 UX로 전이 | 0.70 |
  |13| LEARN_STORE_RESULT_SCHEMA_BULK |
  STEP_PERSIST_RESTORE_WORKFLOW | 저장 계약(answers+results)
  이 있어야 저장/복원/마이그레이션 구조가 안정화 | 0.76 |
  |14| LEARN_LOCALSTORAGE_SAVE_BULK |
  STEP_PERSIST_RESTORE_WORKFLOW | “채점 후 한 번에 저장”이
  bulk 제출 요구를 직접 충족 | 0.80 |
  |15| LEARN_LOCALSTORAGE_RESTORE_BULK |
  STEP_PERSIST_RESTORE_WORKFLOW | 재진입 복원이 상태 재구성
  (answers/results/flags) 구조로 전이 | 0.78 |
  |16| LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  STEP_PERSIST_RESTORE_WORKFLOW | legacy partial 감지/정책이
  bulk 전환 시 호환 문제를 흡수 | 0.74 |
  |17| LEARN_RESET_CLEAR_STORAGE | STEP_RESET_WORKFLOW | 저
  장 키 삭제가 “다시 풀기”의 필수 동작으로 전이 | 0.82 |
  |18| LEARN_RESET_UI_STATE | STEP_RESET_WORKFLOW | 로컬 UI
  상태 리셋이 “다시 풀기” 체감(즉시 반영) 구조로 전이 | 0.78
  |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_GRADED_STATE_FLAG | 둘 다 파생 boolean state로 UI 분
  기/게이팅을 안정화하는 동형 구조 | 0.66 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  LEARN_SCORE_AND_RESULT_GATING | “표시/활성 조건이 계산 기
  준과 불일치하면 UX 붕괴”를 막는 게이팅 동형 | 0.68 |
  | 3 | LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_RESET_CLEAR_STORAGE | 동일 키에 대해 write/delete로
  상태 전이를 만드는 스토리지 트랜잭션 동형 | 0.62 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_RESET_UI_STATE | 외부 소스(스토리지/초기값)로부터 UI
  state를 재구성하는 초기화 동형 | 0.64 |
  | 5 | LEARN_DISABLED_EDGECASES_12 |
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 엣지 입력/
  legacy 데이터의 “예외 목록→정책 적용” 방어 설계 동형(메타)
  | 0.52 |
  | 6 | LEARN_GRADE_BUTTON_LABEL_STATE |
  LEARN_AFTER_GRADE_EDIT_POLICY | 상태 전이(채점/수정) 이후
  UI 의미(라벨/동작)를 재정렬하는 동형 | 0.58 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답
  생성 규칙 |
  |---|---------|------------------|-----------|------------
  ---|
  | 1 | 정규화 기반 allAnswered/disabled | n∈[1,30],
  answersRaw: string[], normalize: on | allAnswered = for
  all i: len(normalizeNumericInput(answersRaw[i]))>0;
  disabled = !allAnswered | raw 문자열 length로 판정, 공백만
  입력을 입력됨으로 판정, "0"을 미입력 처리 |
  | 2 | disabled 엣지케이스 벡터 12종 | cases: 12개 문자열,
  normalize 규칙 고정 | expectedFilledMap = {case:
  len(normalizeNumericInput(case))>0} | trim만 적용, 콤마 제
  거 누락, "+" "." 등 기호를 숫자로 오인 |
  | 3 | bulk gradeAll 결과 맵 생성 | n∈[1,50], answerById,
  correctById, grader=gradeNumericAnswer |
  results[id]=grader(answerById[id], correctById[id]) | 일부
  만 순회, key 누락, 문제 순서/ID mismatch, 이전 결과 merge
  로 스테일 유지 |
  | 4 | score X/N 요약 계산 | n∈[1,50], resultsMap 일부/전체
  | correct = count(results.isCorrect==true); total =
  problems.length; summary=${correct}/${total} | 분모를
  resultsMap 크기로 사용, correct 계산 기준 반전, 채점 전에
  도 0/N 노출 |
  | 5 | hasGraded 기반 결과 표시 게이팅 | hasGraded∈{T,F},
  resultsMap, answersMap | visible = hasGraded ?
  show(score+정오+정답) : hide(all) | resultsMap 존재 여부로
  표시, 부분 결과로 0/N 표기, 정답을 항상 노출 |
  | 6 | 버튼 라벨/상태 전환 | hasGraded∈{T,F},
  allAnswered∈{T,F},
  editPolicy∈{clearOnEdit,keepUntilRegrade} | label =
  hasGraded ? "다시 채점" : "채점하기"; disabled = !
  allAnswered; onClick=gradeAll | hasGraded와 무관하게 라벨
  고정, disabled 조건을 raw로 계산, 채점 후에도 disabled로
  막힘 |
  | 7 | 저장 스키마(answers+results) 계약 | nodeId,
  updatedAt, answersMap, resultsMap, flags | StoredResult =
  { nodeId, updatedAt, answers: answersMap, results:
  resultsMap, hasGraded } | results 미저장, answers만 저장,
  submissions(legacy)로 저장, updatedAt 누락 |
  | 8 | 저장→복원 상태 일치 | n∈[1,30], initialState,
  doGrade, doSave, doRestore | restoreState == savedState
  (answers/results/hasGraded) | hasGraded 복원 누락, answers
  만 복원, 결과만 복원, key 불일치로 초기화 |
  | 9 | legacy partial 마이그레이션 정책 |
  legacySubmissionsSize∈[0,n-1],
  policy∈{reset,migrate,notify} | reset: clear; migrate: map
  to new schema; notify: keep but gate UI | 부분 데이터를 전
  체로 오인, migrate 시 key 매핑 누락, notify 없이 UI 꼬임 |
  |10| 다시 풀기(스토리지+UI) | hasStored∈{T,F},
  hasGraded∈{T,F}, answers/results 존재 | clear storage key;
  set answersMap={}, resultsMap={}, hasGraded=false | 스토리
  지만 삭제, UI만 리셋, flags 미리셋, 일부 키만 삭제 |

  ### 상세 템플릿 예시 (3개)

  Template 1: 정규화 기반 allAnswered/disabled
  - Parameters: { n: [1,30], answersRaw: ["", "  ", "1,234",
  "0", "+", "."], normalize: true }
  - Answer: f(answersRaw) = allAnswered =
  all(len(normalizeNumericInput(a))>0), disabled = !
  allAnswered
  - Distractors: [raw length로 판정, trim만 적용, "0"을 미입
  력 처리, "+" "."를 입력됨으로 처리]
  - Required Skills:
  [LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED]

  Template 2: bulk gradeAll 결과 맵 생성
  - Parameters: { n: [1,50], problemIds: [...],
  answerByProblemId: {...}, correctByProblemId: {...} }
  - Answer:
  f(problemIds,answerByProblemId,correctByProblemId) =
  resultsByProblemId = map(id ->
  gradeNumericAnswer(answerByProblemId[id],
  correctByProblemId[id]))
  - Distractors: [일부만 순회, id 대신 index로 매핑, 이전 결
  과 merge로 스테일 유지, 문제 수 변화 시 누락]
  - Required Skills: [LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG]

  Template 3: legacy partial 마이그레이션 정책
  - Parameters: { n: [5,30], legacySubmissionsSize: [0,n-1],
  policy: ["reset","migrate","notify"] }
  - Answer: f(policy) = reset: clearStorage+clearState;
  migrate: convert legacy submissions -> new
  {answers,results,hasGraded}; notify: keep legacy but gate
  UI and prompt user
  - Distractors: [partial을 완전 데이터로 간주, migrate에서
  hasGraded/updatedAt 누락, notify 없이 UI 꼬임]
  - Required Skills:
  [LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_SCORE_AND_RESULT_GATING]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 조건 충족 전 버튼 비활성(게이트) | 모든 필수 서류가
  있어야 접수 버튼 가능 | 모든 입력 파일이 있어야 배치 잡 실
  행 | 필요한 길이/각이 모두 주어져야 도형 계산 시작 |
  | 2 | 전체 순회 처리→결과 맵 | 시험지 전 문항을 한 번에 채
  점해 오답표 생성 | 레코드 전건을 스캔해 상태 컬럼 생성 |
  여러 선분/점에 대해 한 번에 길이/각 결과 생성 |
  | 3 | 결과 표시 게이팅(hasGraded) | 채점 전에는 점수 공개
  금지 | 처리 완료 플래그 전에는 리포트 노출 금지 | 작도 완
  료 전에는 치수/면적 표시 금지 |
  | 4 | 저장/복원(상태 재구성) | 중간 저장 후 재개(답안+채점
  표) | 체크포인트 저장 후 재시작 | 측정값 저장 후 다시 도형
  을 재구성 |
  | 5 | legacy 데이터 호환/마이그레이션 | 예전 양식(부분 작
  성) 데이터를 새 양식으로 변환/초기화 | 구 스키마 일부 데이
  터 마이그레이션 정책 | 단위/좌표계 변경 시 변환 또는 초기
  화 정책 |
  | 6 | 초기화(다시 풀기) | 제출 철회 후 처음부터 다시 작성
  | 캐시/결과 삭제 후 재처리 | 원점으로 되돌리고 다시 작도 |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 조건 충족 전 버튼 비활성(게이트)
  - 생활: 모든 문제 답안을 다 쓰기 전에는 “채점하기”를 누를
  수 없게 하고, 공백/콤마 같은 입력을 정규화 기준으로 미입력
  처리한다.
  - 데이터: 모든 필수 필드가 채워지기 전에는 “배치 실행”을
  비활성화하고, 입력 정규화 규칙(공백 제거/형식화)을 단일 기
  준으로 둔다.
  - 도형: 필요한 요소(변 길이, 각도)가 모두 주어지기 전에는
  “계산”을 비활성화하고, 값의 유효성 판정을 단일 규칙으로 고
  정한다.
  - 공통 스킬: [LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Triplet 2: 저장/복원(상태 재구성)
  - 생활: 채점 결과와 답안을 함께 저장해 새로고침/재진입 시
  동일한 화면(점수/정오/정답)을 재구성한다.
  - 데이터: 결과 테이블과 입력 파라미터를 함께 저장해 재실행
  시 동일한 리포트를 재현한다.
  - 도형: 측정값과 계산 결과를 함께 저장해 다시 열었을 때 동
  일한 도형 상태와 수치를 복원한다.
  - 공통 스킬: [LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK, LEARN_GRADED_STATE_FLAG]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [],
    "add_edges": [
      { "from": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "to":
  "STEP_BULK_SUBMIT_UI_WORKFLOW", "type": "enables",
  "reason": "per-problem 제거가 bulk UI 재구성(단일 진입점
  +disabled 규칙)으로 전이", "confidence": 0.82 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "STEP_BULK_SUBMIT_UI_WORKFLOW", "type": "enables",
  "reason": "단일 버튼이 bulk UX의 유일한 진입점 구조를 고
  정", "confidence": 0.84 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "STEP_BULK_SUBMIT_UI_WORKFLOW", "type": "enables",
  "reason": "입력 판정 기준을 normalizeNumericInput과 일치시
  키면 disabled/채점 불일치가 줄어든다", "confidence":
  0.82 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "STEP_BULK_SUBMIT_UI_WORKFLOW", "type": "enables",
  "reason": "엣지케이스 테스트 벡터가 disabled 회귀를 줄이는
  템플릿으로 전이", "confidence": 0.76 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "STEP_BULK_SUBMIT_UI_WORKFLOW", "type": "enables",
  "reason": "allAnswered(정규화 기반)가 버튼 활성화 규칙을
  완성", "confidence": 0.82 },

      { "from": "STEP_BULK_SUBMIT_UI_WORKFLOW", "to":
  "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW", "type": "enables",
  "reason": "진입점/disabled가 고정되면 채점 액션→표시 업데
  이트 구조가 활성화", "confidence": 0.72 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW", "type": "enables",
  "reason": "전체 순회 채점이 결과 맵 생성→UI 반영의 핵심 동
  작", "confidence": 0.84 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW", "type": "enables",
  "reason": "채점 전/후 플래그가 점수/정오/정답 표시 게이팅
  의 기준을 고정", "confidence": 0.78 },
      { "from": "LEARN_SCORE_SUMMARY_CALC", "to":
  "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW", "type": "enables",
  "reason": "총점 X/N 요약이 bulk 채점 결과 표시 구조로 전
  이", "confidence": 0.74 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW", "type": "enables",
  "reason": "hasGraded 기반 게이팅이 채점 전 UI 혼란을 방
  지", "confidence": 0.76 },
      { "from": "LEARN_GRADE_BUTTON_LABEL_STATE", "to":
  "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW", "type": "enables",
  "reason": "라벨/상태 전환이 재채점 UX 구조를 고정",
  "confidence": 0.68 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW", "type": "enables",
  "reason": "입력 변경 시 결과 일관성 정책이 후속 UX(초기화/
  재채점)로 전이", "confidence": 0.70 },

      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "STEP_PERSIST_RESTORE_WORKFLOW", "type": "enables",
  "reason": "answers+results 저장 계약이 저장/복원/호환 설계
  를 안정화", "confidence": 0.76 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "STEP_PERSIST_RESTORE_WORKFLOW", "type": "enables",
  "reason": "일괄 채점 후 한 번에 저장이 bulk 저장 요구를 직
  접 충족", "confidence": 0.80 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "STEP_PERSIST_RESTORE_WORKFLOW", "type": "enables",
  "reason": "재진입/새로고침 복원이 상태 재구성 워크플로로
  전이", "confidence": 0.78 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "STEP_PERSIST_RESTORE_WORKFLOW", "type": "enables",
  "reason": "legacy partial 감지/정책이 bulk 전환 호환 문제
  를 흡수", "confidence": 0.74 },

      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "STEP_RESET_WORKFLOW", "type": "enables", "reason": "저장
  키 삭제가 다시 풀기 동작의 필수 부분", "confidence":
  0.82 },
      { "from": "LEARN_RESET_UI_STATE", "to":
  "STEP_RESET_WORKFLOW", "type": "enables", "reason": "UI 상
  태 리셋이 다시 풀기의 즉시 반영/체감을 보장",
  "confidence": 0.78 },

      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "analog_of", "reason":
  "둘 다 파생 boolean state로 UI 게이팅을 안정화하는 구조",
  "confidence": 0.66 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "analog_of",
  "reason": "UI 게이팅 조건이 계산 기준과 불일치할 때 생기는
  UX 붕괴를 막는 구조", "confidence": 0.68 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "analog_of",
  "reason": "동일 키에 대한 write/delete로 상태 전이를 만드
  는 스토리지 트랜잭션 구조", "confidence": 0.62 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_RESET_UI_STATE", "type": "analog_of", "reason": "외
  부 소스(스토리지/초기값)로부터 UI state를 재구성하는 초기
  화 구조", "confidence": 0.64 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "analog_of", "reason": "예외 목록을 먼저 정의하고 정책으로
  흡수하는 방어 설계 패턴(메타)", "confidence": 0.52 },
      { "from": "LEARN_GRADE_BUTTON_LABEL_STATE", "to":
  "LEARN_AFTER_GRADE_EDIT_POLICY", "type": "analog_of",
  "reason": "상태 전이 이후 UI 의미(라벨/동작)를 재정렬하는
  패턴", "confidence": 0.58 }
    ],
    "notes": [
      { "claim": "disabled/표시 게이팅은 반드시 grading의 정
  규화 기준과 같은 단일 진실 소스를 공유해야 한다.",
  "reason": "입력 판정(원문)과 채점 판정(정규화)이 다르면 사
  용자는 버튼/결과 표시를 신뢰할 수 없게 된다.",
  "confidence": 0.82 },
      { "claim": "hasGraded 같은 채점 전/후 플래그를 두고 점
  수/정오/정답/라벨을 전부 게이팅하면 UI 혼란(0/N 조기 노출)
  을 줄인다.", "reason": "결과 맵이 존재하더라도 채점 전 상
  태를 분리하지 않으면 화면이 조기 노출되거나 스테일 상태가
  된다.", "confidence": 0.76 },
      { "claim": "legacy partial 호환은 '조건부 정책'으로 두
  고 requires로 과잉 잠금하지 않는 편이 안전하다.",
  "reason": "legacy 데이터가 없는 경로가 존재할 수 있어, 항
  상 선행으로 강제하면 구현/테스트 경로가 경직된다.",
  "confidence": 0.74 },
      { "claim": "메타 analog_of(엣지케이스↔마이그레이션)는
  절차(예외 목록→정책) 전이에만 제한해야 한다.", "reason":
  "내용 전이가 아니라 방어 설계 패턴 유사성이므로 적용 범위
  를 좁혀야 오용을 줄일 수 있다.", "confidence": 0.66 }
    ]
  }

  ## APPENDIX: R2 Progression Report (verbatim)

  [Previous Researcher Handoff (R2 Progression Report)]

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 파악 | FE | C | 변경 전 상태/스키마를 기준점
  으로 고정해야 회귀를 줄일 수 있음 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1)의 핵심 변경(개별 제출 흐
  름 제거) |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 유일한 진입점
  UI를 구성 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | “입력됨/미입력” 판정이 grading과 불일치하면 UX가 붕괴
  |
  | 5 | LEARN_DISABLED_EDGECASES_12 | disabled 판정 입력 엣
  지케이스 12종 정의 | QA | C | 빈값/공백/콤마/0 등 예외를
  명시해 disabled/채점 불일치를 방지 |
  | 6 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | 버튼 활성화 조건(모든 문제 입력)을
  안정적으로 계산 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 순
  회 채점으로 전환하는 핵심 동작 |
  | 8 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | “채점 전/후”를 분리하지 않
  으면 점수/결과가 조기 노출됨 |
  | 9 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵 기
  반) | FE | P | 일괄 채점 결과로 상단 점수 요약을 계산/표
  시 |
  | 10 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 UI 혼란(0/N 노
  출 등)을 방지 |
  | 11 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 채점 후 재입력 정책에
  따라 버튼 의미를 일관되게 유지 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 정의 | FE | C | 저장/복원/마이그레이션의 계약
  (Contract)을 먼저 고정 |
  | 13 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(개
  별→일괄) 전환 |
  | 14 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 복원 동작을 충족
  (상태 재구성) |
  | 15 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  부분 제출 데이터 호환/마이그레이션 규칙 | FE | C | 기존
  submissions 일부 저장 데이터가 남아 있을 때 UX 꼬임 방지
  |
  | 16 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장된 결과/
  답안을 제거 |
  | 17 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answerByProblemId/results) | FE | P | 스토리지 삭제만으
  로는 화면이 갱신되지 않으므로 UI 리셋이 필요 |
  | 18 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 결과/점
  수의 일관성 정책을 명시해야 스테일 상태를 막음 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_WORKFLOW | bulk 제출 UI 구성
  (disabled까지) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출 제거 후
  단일 버튼을 추가하고, 정규화 기반 allAnswered로 disabled
  를 안정화 |
  | 2 | STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 일괄 채점→상
  태/표시 업데이트 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SCORE_AND_RESULT_GATING,
  LEARN_GRADE_BUTTON_LABEL_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | gradeAll 결과를 상태로 고
  정하고, hasGraded 기반으로 점수/결과 표시 및 후속 UX(재입
  력/다시채점)를 정합화 |
  | 3 | STEP_PERSIST_RESTORE_WORKFLOW | 저장/복원/호환 처리
  | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 스키마 계약
  을 고정한 뒤 bulk 저장/복원과 legacy partial 대응을 연결
  |
  | 4 | STEP_RESET_WORKFLOW | 다시 풀기(스토리지+UI) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered가 정규화 기반
  이면 먼저 “입력됨” 기준을 normalizeNumericInput으로 고정
  해야 함 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | 점수 X/N은 문제별 채점 결과가
  있어야 계산 가능 | 0.78 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 채점 이후 상태(hasGraded 등)를
  올려야 ‘채점 전/후’가 분리됨 | 0.74 |
  | 4 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 같은
  플래그 없이는 정의/구현이 불가 | 0.76 |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 스키마 계약이 먼저 필요 | 0.80 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 상태를 재구성하므로 선행 필요 | 0.80 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK | “일괄 채점 후 한 번에 저
  장”은 채점 결과 생성이 선행 | 0.80 |
  | 8 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_CLEAR_STORAGE | reset은 삭제 대상 키/데이터를
  알아야 하므로 저장 계약이 선행 | 0.74 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  스토리지 삭제만으로는 화면 상태가 남아 UI 리셋이 필요 |
  0.78 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 결과를 복원했다면 ‘채점됨’ 상태
  를 함께 복원해야 표시가 일관됨 | 0.72 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 최종 disabled 기준을 굳히
  기 전에 엣지케이스 목록이 있으면 불일치 회귀가 줄어듦 |
  0.76 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 설계가 액션 인터페이스를 구체화하는 데 도움 | 0.70 |
  | 3 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 submitProblem 흐름
  을 알면 제거 시 사이드이펙트(저장/상태) 회귀를 줄일 수 있
  음 | 0.65 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | UX 공백을 피하려면 제거/추
  가를 함께 설계하는 것이 안전(필수는 아님) | 0.68 |
  | 5 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial이 있을
  때만 필요하므로 requires로 잠그지 않고 조건부로 권장 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨은 ‘채점 전/후’
  화면 상태와 함께 설계하면 혼란이 줄어듦 | 0.66 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 정책(입력 변경 시 결과 유
  지/초기화)이 게이팅과 함께 맞물리므로 동시 설계를 권장 |
  0.70 |
  | 8 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_RESET_UI_STATE | ‘초기화’와 ‘입력 변경’이 상태를 어
  떻게 되돌리는지 일관되게 정의하는 데 도움 | 0.62 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | 복원 시에도 채점 결과가
  표시되도록 게이팅 조건을 함께 검토하는 것이 권장 | 0.70 |
  | 10 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼을 먼저 만들고 나중에
  disabled를 붙일 수 있으나, 함께 설계하면 UX 디테일이 빨리
  안정화 | 0.65 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 기존 저장 스키마/
  submitProblem 흐름을 모르고 수정해 회귀 발생 | 현재 상태
  흐름(단건 채점→merge 저장)을 1페이지로 먼저 고정 | 0.74 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI 입
  력 판정(원문)과 채점 판정(정규화)이 불일치 |
  normalizeNumericInput 기준으로 “입력됨”을 단일 정의로 통
  일 | 0.82 |
  | 3 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", "."
  같은 케이스에서 disabled/채점이 엇갈림 | 엣지케이스 목록
  을 테스트 벡터로 만들어 allAnswered/normalize에 대입 |
  0.76 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 흔들림 | problems 기준으
  로 계산(useMemo)하고 로딩/빈 배열 처리 규칙을 명시 | 0.72
  |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 상태 업
  데이트/결과 맵 생성에서 누락/순서 오류 | “문제 목록→정규
  화→grade→result map”을 순수 함수로 분리해 생성 | 0.75 |
  | 6 | LEARN_GRADED_STATE_FLAG | 결과가 하나라도 있으면 0/
  N이 노출되는 등 ‘채점 전/후’ 경계가 흐림 | hasGraded 플래
  그를 단일 진실 소스로 두고 표시를 전부 게이팅 | 0.78 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | 점수 계산이 부분 결과/문
  제 수와 어긋나 X/N이 틀림 | 결과 맵 기준으로 correct
  count를 계산하고 분모는 problems.length로 고정 | 0.72 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 복원 시/채점 전 표
  시 조건이 뒤섞여 UI가 어색해짐 | “복원됨=채점됨” 여부를
  명확히 결정(플래그와 함께 저장/복원) | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | 무엇을 저장해야 하
  는지(답만? 결과까지?)가 흔들려 스키마가 빈번히 바뀜 |
  StoredResult 계약을 먼저 문서화(answers + isCorrect +
  updatedAt) | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial이 남아 복원/disabled/표시가 꼬임 |
  “partial 감지→초기화 or 마이그레이션” 정책을 명시하고 구
  현 | 0.74 |
  | 11 | LEARN_RESET_CLEAR_STORAGE | 스토리지만 지우고 UI
  상태가 남아 ‘초기화’가 체감되지 않음 | 키 삭제 + 로컬 상
  태(answer/results/flags) 초기화를 한 액션으로 묶기 | 0.78
  |
  | 12 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과가 스테일(불일치) 상태로 남음 | 입력 변경 시 결과
  초기화(또는 버튼을 다시 채점으로 전환) 정책을 고정 | 0.72
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 즉시 새 진입점(UI)을 제공해 기능 공백을 막는다
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BULK_GRADE_ALL_ACTION | 저장은 ‘채점 결과 생성’이
  있어야 의미가 생긴다 |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 버튼 자체보다 먼저 “활성
  조건” 계산이 브릿지로 필요하다 |
  | 4 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴한다 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 저장/복원은 동일 스키마
  계약이 중간 다리다 |
  | 6 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy는 복원 시점에서
  감지/정책 적용이 자연스럽다 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_GRADE_BUTTON_LABEL_STATE |
  LEARN_SCORE_AND_RESULT_GATING | 표시/게이팅 상태를 고정하
  면 버튼 라벨 정책이 쉬워진다 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_AFTER_GRADE_EDIT_POLICY | LEARN_GRADED_STATE_FLAG |
  ‘채점됨’ 상태가 있어야 입력 변경 정책의 대상 상태가 명확
  해진다 |
  | 9 | LEARN_LOCALSTORAGE_SAVE_BULK → LEARN_RESET_UI_STATE
  | LEARN_RESET_CLEAR_STORAGE | reset은 먼저 저장 키 삭제를
  수행한 뒤 UI 초기화로 이어진다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_STORE_RESULT_SCHEMA_BULK |
  LEARN_LOCALSTORAGE_SAVE_BULK | 기존
  StoredResult(submissions) 기반을 이해해야 bulk 저장 계약
  을 무리 없이 정의한다 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 파
  악", "domain": "FE", "rep": "C", "confidence": 0.72 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기) 추
  가", "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "type":
  "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.80 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "micro", "name_ko": "기존 부분 제출 데이터 호환/마이그레
  이션 규칙", "domain": "FE", "rep": "C", "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화/다시
  채점)", "domain": "UX", "rep": "C", "confidence": 0.70 },
  { "id": "STEP_BULK_SUBMIT_UI_WORKFLOW", "type":
  "step", "name_ko": "bulk 제출 UI 구성(disabled까지)",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW",
  "type": "step", "name_ko": "일괄 채점→상태/표시 업데이
  트", "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_WORKFLOW", "type":
  "step", "name_ko": "저장/복원/호환 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_WORKFLOW", "type": "step",
  "name_ko": "다시 풀기(스토리지+UI)", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
  ],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 없이도 가능하며 비활성
  조건은 권장 설계로 두는 편이 안전", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "reset은 저장된 키/데이터를 전제로 하므로 방향
  이 반대이며 requires로도 부적절", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅과 재입력 정책은 상호 영향은 있으나 필수
  선후로 잠글 관계는 아님", "confidence": 0.70 },
  { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "엣지케이스 목록은 견고성을 높이는 권장 사항이
  며 기본 allAnswered 구현의 필수 선행은 아님",
  "confidence": 0.76 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가는 순서가 바뀌어도 구현 가능하므로
  requires로 잠그지 않는다", "confidence": 0.72 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "migration은 legacy 데이터가 있을 때만 필요하므
  로 requires가 아니라 조건부 권장", "confidence": 0.74 }
  ],
  "notes": [
  { "claim": "LEARN_ALL_ANSWERED_NORMALIZED는 버튼 존재
  와 무관하게 정의될 수 있으므로 requires로 잠그지 말고 UI
  에서 조건부로 사용한다.", "reason": "버튼을 먼저 렌더링하
  고 disabled만 나중에 붙이는 구현 경로가 자연스럽고 회귀
  위험이 낮다.", "confidence": 0.70 },
  { "claim": "LEARN_DISABLED_EDGECASES_12는 최종
  disabled 품질을 위한 권장 선행이다.", "reason":
  "normalizeNumericInput과의 일관성을 10+ 입력 벡터로 검증
  하면 빈값/0 처리 등에서 UX 불일치가 줄어든다.",
  "confidence": 0.76 },
  { "claim": "LEARN_STORE_RESULT_SCHEMA_BULK를 먼저 고
  정하면 저장/복원/마이그레이션 논의가 단순해진다.",
  "reason": "답안과 결과를 함께 저장한다는 계약이 흔들리면
  상태 플래그/게이팅/점수 계산까지 연쇄로 흔들린다.",
  "confidence": 0.78 },
  { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "일부 노드/사용자는 legacy 데이터가 없을 수 있
  어 requires 잠금은 과잉 선행이 된다.", "confidence":
  0.74 },
  { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 게이팅과
  함께 설계하되 requires로 강제하지 않는다.", "reason": "정
  책은 '입력 변경 시 결과 초기화' 또는 '다시 채점 버튼 제
  공' 등 대체 경로가 존재한다.", "confidence": 0.70 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 단일 버튼 UX(페이지 하단 채점하기/전체 제출) | 현재
  는 문제 카드별 제출만 존재해 “모든 문제 후 일괄 채점” 요
  구
  를 충족하지 못함 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 1)에서 제거가
  핵심인데 현재 UI는 per-problem 제출 흐름에 고정되어 있음
  |
  높음 |
  | 3 | 채점하기 disabled 조건 정의(정규화 일관성) | 버튼
  disabled 기준이 normalizeNumericInput()과 일관되게 정의되
  어야 하나 현재는 해당 UX 자체가 없음 | 높음 |
  | 4 | “모든 문제 미입력” 판정 로직(allAnswered) |
  problems[] 전체를 기준으로 answerByProblemId가 모두 채워
  졌
  는지 판단하는 상태/계산이 필요(문제 수 변화/로딩 타이밍
  포
  함) | 높음 |
  | 5 | 입력 엣지케이스(10개+) 목록/정의 | AC 요구(10개+)가
  문서/설계로 존재해야 하는데 현재 정의가 없음(예: "", "
  ", "\t\n", ",", " , , ", "1,234", " 1 234 ", "0",
  "-0", "+", ".", "Infinity" 등) | 중 |
  | 6 | 일괄 채점 동작(전체 순회→채점→결과 맵 생성) | 현재
  는
  submitProblem(problem)로 단건 채점만 가능하며, 전체 문제
  를
  한 번에 채점해 결과를 고정하는 액션이 없음 | 높음 |
  | 7 | 채점 이후 UI 상태 정의(채점 전/후) | 현재는 결과가
  하나라도 있으면 점수 0/N이 항상 표시될 수 있고, “채점 전/
  후” 상태(예: hasGraded/isSubmitted) 기준이 없음 | 중 |
  | 8 | “채점 후 재입력” UX 정책 | bulk 채점 후 입력을 수정
  할 때 결과/점수의 일관성(자동 결과 초기화 vs “다시 채점”
  버튼) 정책이 필요하나 정의 없음 | 중 |
  | 9 | localStorage 저장 시점 변경(개별→일괄) | 현재는 개
  별
  제출 시 submissions를 merge 저장; 요구는 일괄 채점 후 답
  안
  +결과를 한 번에 저장 | 높음 |
  |10| 저장/복원 스키마 호환/마이그레이션 | 기존 키
  (curriculum-viewer:learn:lastResult:${nodeId})에 부분 제
  출
  데이터가 남아있을 수 있어 bulk 전환 시 호환 규칙이 필요 |
  높음 |
  |11| 초기화/다시 풀기(키 삭제 + 상태 리셋) | 요구사항 4)
  다시 풀기 버튼 및 저장된 결과/답안 삭제가 필요하나 현재
  없
  음 | 높음 |
  |12| Out of Scope 가드레일 명시(무엇을 안 바꿀지) | 구현
  중 문제 타입 확장/서버 연동/커리큘럼 구조 변경으로 범위가
  새는 것을 막는 체크리스트가 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 기반 요구를 흐림 | 금지(요구 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 변경의 핵심
  은 “제출 UX/저장/복원”이며 타입 확장은 범위 밖 | 금지(향
  후
  별도 티켓) |
  | 3 | 문제은행 JSON 스키마 변경 | 현재는 problems_v1.json
  로딩으로 충분하며 스키마 변경은 회귀 위험만 큼 | 기존 스
  키
  마 유지 |
  | 4 | grading 로직 대개편(분수/근삿값/허용오차 등) | 요구
  는 제출 UX이며 채점 확장은 별도 사양 필요 |
  gradeNumericAnswer() 유지, 필요 시 후속 티켓 |
  | 5 | 대형 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 해결 가능, 도입은 과잉 | React state/
  useMemo로 해결 |
  | 6 | “입력 중 실시간 저장(autosave)” | 요구는 “채점 후
  한
  번에 저장”이며 autosave는 UX/스키마를 복잡하게 함 | 이번
  범위에서 제외(필요 시 옵션) |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk UX 미구현 | 제거만 하면 채
  점
  경로가 사라져 기능 공백 발생 | 단일 채점하기 버튼 +
  gradeAll 액션 먼저 추가 후 제거 |
  | 2 | disabled 판정(원문 입력 기준) → 실제 채점(정규화 기
  준) | " , " 같은 입력이 disabled 해제되거나 반대로 0이 미
  입력 처리되는 불일치 위험 | disabled는
  normalizeNumericInput(answer).length>0로 고정 |
  | 3 | 저장 시점 변경(개별→일괄) → 기존 localStorage 데이
  터
  무시 | 기존 submissions가 부분만 존재할 수 있어 복원/버튼
  상태가 꼬일 수 있음 | “legacy partial” 감지(개수/키) 후
  초
  기화 또는 안내/정책 적용 |
  | 4 | 점수 표시(항상 0/N) → 채점 UX | 채점 전부터 점수가
  보이면 사용자가 이미 채점된 것으로 오해 | hasGraded 도입
  후 채점 후에만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 생김 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(다시 풀기) 없음 → 상태 복원 유지 | 사용자가
  저장된 결과를 지울 방법이 없어 UX 막힘 | 다시 풀기(키 삭
  제
  +상태 리셋) 추가 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "모든 문제 미입력 판정(allAnswered,
  정
  규화 기반)", "domain": "FE", "rep": "P", "confidence":
  0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출(submissions
  일
  부) 데이터 호환/마이그레이션 규칙", "domain": "FE",
  "rep":
  "C", "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기(초기화): 저장 키 삭제 + 상태 리셋",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  (빈
  값/공백/콤마/0/부호/소수점 등)", "domain": "QA", "rep":
  "C", "confidence": 0.76 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점/단건 저장을 수행하며,
  StoredResult는 { nodeId, updatedAt, submissions:
  { [problemId]: { submitted, isCorrect } } } 형태이다.",
  "reason": "LearnPage.tsx에서 gradeNumericAnswer 호출 및
  localStorage merge 저장 로직과 StoredResult 타입 정의가
  확
  인된다.", "confidence": 0.86 },
  { "claim": "bulk UX의 disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 모든
  problems가 채워졌는지 검사해야 grading과 일관된다.",
  "reason": "grading.ts의 normalizeNumericInput은 공백/콤마
  제거를 수행하므로, 동일 기준을 쓰지 않으면 '미입력/입력
  됨'
  판단이 채점 결과와 어긋난다.", "confidence": 0.82 },
  { "claim": "점수/정오/정답 표시는 채점 전/후 상태
  (hasGraded 등)로 게이팅하지 않으면 채점 전에도 0/N이 노출
  되는 혼란이 발생할 수 있다.", "reason": "현재 score 계산
  은
  problems.length만으로 0/N을 만들 수 있어 bulk 전환 시 '채
  점 전' 상태를 별도로 분리하는 것이 안전하다.",
  "confidence": 0.74 },
  { "claim": "기존 localStorage에 부분 제출(submissions
  일부) 데이터가 남아 있을 수 있으므로 bulk 전환 시 호환 규
  칙(초기화/마이그레이션/안내)이 필요하다.", "reason": "기
  존
  구현은 문제별 제출 시마다 submissions를 merge 저장하므로,
  저장된 문제 수가 전체 problems 수보다 적은 legacy 데이터
  가
  자연스럽게 생성된다.", "confidence": 0.78 },
  { "claim": "Out of Scope(문제 타입 확장/서버 연동/커리
  큘럼 구조 변경)를 피하고 LearnPage.tsx 중심으로 제출 UX/
  저
  장 시점만 바꾸는 것이 회귀 위험이 낮다.", "reason":
  "task.md가 수정 중심 파일과 비범위를 명시하며, 현재 문제
  로딩/채점 로직은 요구 충족에 충분한 기반을 제공한다.",
  "confidence": 0.76 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그:
    LEARN_SINGLE_SUBMIT_FLOW(→LEARN_BULK_SUBMIT_FLOW),
    LEARN_STORAGE_UPDATE_PER_PROBLEM(→LEARN_STORAGE_SAVE_AF
    T
    ER_BULK_GRADE)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass (R3는
    requires 추가 없이 enables/analog_of만 제안)
  - Requires 사이클: Pass (새 requires를 추가하지 않았으므로
    사이클 위험 없음)
  - level 미제안: Pass
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 (R3 영역인 enables/analog_of
    만 제안)
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass (Transfer+APPENDIX(R2 원문)+QA 포함)

  [/R3 Transfer Report]

  ###DONE:af3c6e6c9c###


› Summarize recent commits

  22% context left · ? for shortcuts


============================================================
[2026-01-08 10:46:31] RESEARCH3 (req_id: f976572779)
============================================================
  | 18 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 결과/점
  수의 일관성 정책을 명시해야 스테일 상태를 막음 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_WORKFLOW | bulk 제출 UI 구성
  (disabled까지) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출 제거 후
  단일 버튼을 추가하고, 정규화 기반 allAnswered로 disabled
  를 안정화 |
  | 2 | STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 일괄 채점→상
  태/표시 업데이트 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SCORE_AND_RESULT_GATING,
  LEARN_GRADE_BUTTON_LABEL_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | gradeAll 결과를 상태로 고
  정하고, hasGraded 기반으로 점수/결과 표시 및 후속 UX(재입
  력/다시채점)를 정합화 |
  | 3 | STEP_PERSIST_RESTORE_WORKFLOW | 저장/복원/호환 처리
  | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 스키마 계약
  을 고정한 뒤 bulk 저장/복원과 legacy partial 대응을 연결
  |
  | 4 | STEP_RESET_WORKFLOW | 다시 풀기(스토리지+UI) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered가 정규화 기반
  이면 먼저 “입력됨” 기준을 normalizeNumericInput으로 고정
  해야 함 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | 점수 X/N은 문제별 채점 결과가
  있어야 계산 가능 | 0.78 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 채점 이후 상태(hasGraded 등)를
  올려야 ‘채점 전/후’가 분리됨 | 0.74 |
  | 4 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 같은
  플래그 없이는 정의/구현이 불가 | 0.76 |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 스키마 계약이 먼저 필요 | 0.80 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 상태를 재구성하므로 선행 필요 | 0.80 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK | “일괄 채점 후 한 번에 저
  장”은 채점 결과 생성이 선행 | 0.80 |
  | 8 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_CLEAR_STORAGE | reset은 삭제 대상 키/데이터를
  알아야 하므로 저장 계약이 선행 | 0.74 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  스토리지 삭제만으로는 화면 상태가 남아 UI 리셋이 필요 |
  0.78 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 결과를 복원했다면 ‘채점됨’ 상태
  를 함께 복원해야 표시가 일관됨 | 0.72 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 최종 disabled 기준을 굳히
  기 전에 엣지케이스 목록이 있으면 불일치 회귀가 줄어듦 |
  0.76 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 설계가 액션 인터페이스를 구체화하는 데 도움 | 0.70 |
  | 3 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 submitProblem 흐름
  을 알면 제거 시 사이드이펙트(저장/상태) 회귀를 줄일 수 있
  음 | 0.65 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | UX 공백을 피하려면 제거/추
  가를 함께 설계하는 것이 안전(필수는 아님) | 0.68 |
  | 5 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial이 있을
  때만 필요하므로 requires로 잠그지 않고 조건부로 권장 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨은 ‘채점 전/후’
  화면 상태와 함께 설계하면 혼란이 줄어듦 | 0.66 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 정책(입력 변경 시 결과 유
  지/초기화)이 게이팅과 함께 맞물리므로 동시 설계를 권장 |
  0.70 |
  | 8 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_RESET_UI_STATE | ‘초기화’와 ‘입력 변경’이 상태를 어
  떻게 되돌리는지 일관되게 정의하는 데 도움 | 0.62 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | 복원 시에도 채점 결과가
  표시되도록 게이팅 조건을 함께 검토하는 것이 권장 | 0.70 |
  | 10 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼을 먼저 만들고 나중에
  disabled를 붙일 수 있으나, 함께 설계하면 UX 디테일이 빨리
  안정화 | 0.65 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 기존 저장 스키마/
  submitProblem 흐름을 모르고 수정해 회귀 발생 | 현재 상태
  흐름(단건 채점→merge 저장)을 1페이지로 먼저 고정 | 0.74 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI 입
  력 판정(원문)과 채점 판정(정규화)이 불일치 |
  normalizeNumericInput 기준으로 “입력됨”을 단일 정의로 통
  일 | 0.82 |
  | 3 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", "."
  같은 케이스에서 disabled/채점이 엇갈림 | 엣지케이스 목록
  을 테스트 벡터로 만들어 allAnswered/normalize에 대입 |
  0.76 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 흔들림 | problems 기준으
  로 계산(useMemo)하고 로딩/빈 배열 처리 규칙을 명시 | 0.72
  |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 상태 업
  데이트/결과 맵 생성에서 누락/순서 오류 | “문제 목록→정규
  화→grade→result map”을 순수 함수로 분리해 생성 | 0.75 |
  | 6 | LEARN_GRADED_STATE_FLAG | 결과가 하나라도 있으면 0/
  N이 노출되는 등 ‘채점 전/후’ 경계가 흐림 | hasGraded 플래
  그를 단일 진실 소스로 두고 표시를 전부 게이팅 | 0.78 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | 점수 계산이 부분 결과/문
  제 수와 어긋나 X/N이 틀림 | 결과 맵 기준으로 correct
  count를 계산하고 분모는 problems.length로 고정 | 0.72 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 복원 시/채점 전 표
  시 조건이 뒤섞여 UI가 어색해짐 | “복원됨=채점됨” 여부를
  명확히 결정(플래그와 함께 저장/복원) | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | 무엇을 저장해야 하
  는지(답만? 결과까지?)가 흔들려 스키마가 빈번히 바뀜 |
  StoredResult 계약을 먼저 문서화(answers + isCorrect +
  updatedAt) | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial이 남아 복원/disabled/표시가 꼬임 |
  “partial 감지→초기화 or 마이그레이션” 정책을 명시하고 구
  현 | 0.74 |
  | 11 | LEARN_RESET_CLEAR_STORAGE | 스토리지만 지우고 UI
  상태가 남아 ‘초기화’가 체감되지 않음 | 키 삭제 + 로컬 상
  태(answer/results/flags) 초기화를 한 액션으로 묶기 | 0.78
  |
  | 12 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과가 스테일(불일치) 상태로 남음 | 입력 변경 시 결과
  초기화(또는 버튼을 다시 채점으로 전환) 정책을 고정 | 0.72
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 즉시 새 진입점(UI)을 제공해 기능 공백을 막는다
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BULK_GRADE_ALL_ACTION | 저장은 ‘채점 결과 생성’이
  있어야 의미가 생긴다 |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 버튼 자체보다 먼저 “활성
  조건” 계산이 브릿지로 필요하다 |
  | 4 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴한다 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 저장/복원은 동일 스키마
  계약이 중간 다리다 |
  | 6 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy는 복원 시점에서
  감지/정책 적용이 자연스럽다 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_GRADE_BUTTON_LABEL_STATE |
  LEARN_SCORE_AND_RESULT_GATING | 표시/게이팅 상태를 고정하
  면 버튼 라벨 정책이 쉬워진다 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_AFTER_GRADE_EDIT_POLICY | LEARN_GRADED_STATE_FLAG |
  ‘채점됨’ 상태가 있어야 입력 변경 정책의 대상 상태가 명확
  해진다 |
  | 9 | LEARN_LOCALSTORAGE_SAVE_BULK → LEARN_RESET_UI_STATE
  | LEARN_RESET_CLEAR_STORAGE | reset은 먼저 저장 키 삭제를
  수행한 뒤 UI 초기화로 이어진다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_STORE_RESULT_SCHEMA_BULK |
  LEARN_LOCALSTORAGE_SAVE_BULK | 기존
  StoredResult(submissions) 기반을 이해해야 bulk 저장 계약
  을 무리 없이 정의한다 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 파
  악", "domain": "FE", "rep": "C", "confidence": 0.72 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기) 추
  가", "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "type":
  "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.80 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "micro", "name_ko": "기존 부분 제출 데이터 호환/마이그레
  이션 규칙", "domain": "FE", "rep": "C", "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화/다시
  채점)", "domain": "UX", "rep": "C", "confidence": 0.70 },
  { "id": "STEP_BULK_SUBMIT_UI_WORKFLOW", "type":
  "step", "name_ko": "bulk 제출 UI 구성(disabled까지)",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW",
  "type": "step", "name_ko": "일괄 채점→상태/표시 업데이
  트", "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_WORKFLOW", "type":
  "step", "name_ko": "저장/복원/호환 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_WORKFLOW", "type": "step",
  "name_ko": "다시 풀기(스토리지+UI)", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
  ],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 없이도 가능하며 비활성
  조건은 권장 설계로 두는 편이 안전", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "reset은 저장된 키/데이터를 전제로 하므로 방향
  이 반대이며 requires로도 부적절", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅과 재입력 정책은 상호 영향은 있으나 필수
  선후로 잠글 관계는 아님", "confidence": 0.70 },
  { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "엣지케이스 목록은 견고성을 높이는 권장 사항이
  며 기본 allAnswered 구현의 필수 선행은 아님",
  "confidence": 0.76 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가는 순서가 바뀌어도 구현 가능하므로
  requires로 잠그지 않는다", "confidence": 0.72 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "migration은 legacy 데이터가 있을 때만 필요하므
  로 requires가 아니라 조건부 권장", "confidence": 0.74 }
  ],
  "notes": [
  { "claim": "LEARN_ALL_ANSWERED_NORMALIZED는 버튼 존재
  와 무관하게 정의될 수 있으므로 requires로 잠그지 말고 UI
  에서 조건부로 사용한다.", "reason": "버튼을 먼저 렌더링하
  고 disabled만 나중에 붙이는 구현 경로가 자연스럽고 회귀
  위험이 낮다.", "confidence": 0.70 },
  { "claim": "LEARN_DISABLED_EDGECASES_12는 최종
  disabled 품질을 위한 권장 선행이다.", "reason":
  "normalizeNumericInput과의 일관성을 10+ 입력 벡터로 검증
  하면 빈값/0 처리 등에서 UX 불일치가 줄어든다.",
  "confidence": 0.76 },
  { "claim": "LEARN_STORE_RESULT_SCHEMA_BULK를 먼저 고
  정하면 저장/복원/마이그레이션 논의가 단순해진다.",
  "reason": "답안과 결과를 함께 저장한다는 계약이 흔들리면
  상태 플래그/게이팅/점수 계산까지 연쇄로 흔들린다.",
  "confidence": 0.78 },
  { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "일부 노드/사용자는 legacy 데이터가 없을 수 있
  어 requires 잠금은 과잉 선행이 된다.", "confidence":
  0.74 },
  { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 게이팅과
  함께 설계하되 requires로 강제하지 않는다.", "reason": "정
  책은 '입력 변경 시 결과 초기화' 또는 '다시 채점 버튼 제
  공' 등 대체 경로가 존재한다.", "confidence": 0.70 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 단일 버튼 UX(페이지 하단 채점하기/전체 제출) | 현재
  는 문제 카드별 제출만 존재해 “모든 문제 후 일괄 채점” 요
  구
  를 충족하지 못함 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 1)에서 제거가
  핵심인데 현재 UI는 per-problem 제출 흐름에 고정되어 있음
  |
  높음 |
  | 3 | 채점하기 disabled 조건 정의(정규화 일관성) | 버튼
  disabled 기준이 normalizeNumericInput()과 일관되게 정의되
  어야 하나 현재는 해당 UX 자체가 없음 | 높음 |
  | 4 | “모든 문제 미입력” 판정 로직(allAnswered) |
  problems[] 전체를 기준으로 answerByProblemId가 모두 채워
  졌
  는지 판단하는 상태/계산이 필요(문제 수 변화/로딩 타이밍
  포
  함) | 높음 |
  | 5 | 입력 엣지케이스(10개+) 목록/정의 | AC 요구(10개+)가
  문서/설계로 존재해야 하는데 현재 정의가 없음(예: "", "
  ", "\t\n", ",", " , , ", "1,234", " 1 234 ", "0",
  "-0", "+", ".", "Infinity" 등) | 중 |
  | 6 | 일괄 채점 동작(전체 순회→채점→결과 맵 생성) | 현재
  는
  submitProblem(problem)로 단건 채점만 가능하며, 전체 문제
  를
  한 번에 채점해 결과를 고정하는 액션이 없음 | 높음 |
  | 7 | 채점 이후 UI 상태 정의(채점 전/후) | 현재는 결과가
  하나라도 있으면 점수 0/N이 항상 표시될 수 있고, “채점 전/
  후” 상태(예: hasGraded/isSubmitted) 기준이 없음 | 중 |
  | 8 | “채점 후 재입력” UX 정책 | bulk 채점 후 입력을 수정
  할 때 결과/점수의 일관성(자동 결과 초기화 vs “다시 채점”
  버튼) 정책이 필요하나 정의 없음 | 중 |
  | 9 | localStorage 저장 시점 변경(개별→일괄) | 현재는 개
  별
  제출 시 submissions를 merge 저장; 요구는 일괄 채점 후 답
  안
  +결과를 한 번에 저장 | 높음 |
  |10| 저장/복원 스키마 호환/마이그레이션 | 기존 키
  (curriculum-viewer:learn:lastResult:${nodeId})에 부분 제
  출
  데이터가 남아있을 수 있어 bulk 전환 시 호환 규칙이 필요 |
  높음 |
  |11| 초기화/다시 풀기(키 삭제 + 상태 리셋) | 요구사항 4)
  다시 풀기 버튼 및 저장된 결과/답안 삭제가 필요하나 현재
  없
  음 | 높음 |
  |12| Out of Scope 가드레일 명시(무엇을 안 바꿀지) | 구현
  중 문제 타입 확장/서버 연동/커리큘럼 구조 변경으로 범위가
  새는 것을 막는 체크리스트가 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 기반 요구를 흐림 | 금지(요구 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 변경의 핵심
  은 “제출 UX/저장/복원”이며 타입 확장은 범위 밖 | 금지(향
  후
  별도 티켓) |
  | 3 | 문제은행 JSON 스키마 변경 | 현재는 problems_v1.json
  로딩으로 충분하며 스키마 변경은 회귀 위험만 큼 | 기존 스
  키
  마 유지 |
  | 4 | grading 로직 대개편(분수/근삿값/허용오차 등) | 요구
  는 제출 UX이며 채점 확장은 별도 사양 필요 |
  gradeNumericAnswer() 유지, 필요 시 후속 티켓 |
  | 5 | 대형 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 해결 가능, 도입은 과잉 | React state/
  useMemo로 해결 |
  | 6 | “입력 중 실시간 저장(autosave)” | 요구는 “채점 후
  한
  번에 저장”이며 autosave는 UX/스키마를 복잡하게 함 | 이번
  범위에서 제외(필요 시 옵션) |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk UX 미구현 | 제거만 하면 채
  점
  경로가 사라져 기능 공백 발생 | 단일 채점하기 버튼 +
  gradeAll 액션 먼저 추가 후 제거 |
  | 2 | disabled 판정(원문 입력 기준) → 실제 채점(정규화 기
  준) | " , " 같은 입력이 disabled 해제되거나 반대로 0이 미
  입력 처리되는 불일치 위험 | disabled는
  normalizeNumericInput(answer).length>0로 고정 |
  | 3 | 저장 시점 변경(개별→일괄) → 기존 localStorage 데이
  터
  무시 | 기존 submissions가 부분만 존재할 수 있어 복원/버튼
  상태가 꼬일 수 있음 | “legacy partial” 감지(개수/키) 후
  초
  기화 또는 안내/정책 적용 |
  | 4 | 점수 표시(항상 0/N) → 채점 UX | 채점 전부터 점수가
  보이면 사용자가 이미 채점된 것으로 오해 | hasGraded 도입
  후 채점 후에만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 생김 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(다시 풀기) 없음 → 상태 복원 유지 | 사용자가
  저장된 결과를 지울 방법이 없어 UX 막힘 | 다시 풀기(키 삭
  제
  +상태 리셋) 추가 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "모든 문제 미입력 판정(allAnswered,
  정
  규화 기반)", "domain": "FE", "rep": "P", "confidence":
  0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출(submissions
  일
  부) 데이터 호환/마이그레이션 규칙", "domain": "FE",
  "rep":
  "C", "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기(초기화): 저장 키 삭제 + 상태 리셋",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  (빈
  값/공백/콤마/0/부호/소수점 등)", "domain": "QA", "rep":
  "C", "confidence": 0.76 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점/단건 저장을 수행하며,
  StoredResult는 { nodeId, updatedAt, submissions:
  { [problemId]: { submitted, isCorrect } } } 형태이다.",
  "reason": "LearnPage.tsx에서 gradeNumericAnswer 호출 및
  localStorage merge 저장 로직과 StoredResult 타입 정의가
  확
  인된다.", "confidence": 0.86 },
  { "claim": "bulk UX의 disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 모든
  problems가 채워졌는지 검사해야 grading과 일관된다.",
  "reason": "grading.ts의 normalizeNumericInput은 공백/콤마
  제거를 수행하므로, 동일 기준을 쓰지 않으면 '미입력/입력
  됨'
  판단이 채점 결과와 어긋난다.", "confidence": 0.82 },
  { "claim": "점수/정오/정답 표시는 채점 전/후 상태
  (hasGraded 등)로 게이팅하지 않으면 채점 전에도 0/N이 노출
  되는 혼란이 발생할 수 있다.", "reason": "현재 score 계산
  은
  problems.length만으로 0/N을 만들 수 있어 bulk 전환 시 '채
  점 전' 상태를 별도로 분리하는 것이 안전하다.",
  "confidence": 0.74 },
  { "claim": "기존 localStorage에 부분 제출(submissions
  일부) 데이터가 남아 있을 수 있으므로 bulk 전환 시 호환 규
  칙(초기화/마이그레이션/안내)이 필요하다.", "reason": "기
  존
  구현은 문제별 제출 시마다 submissions를 merge 저장하므로,
  저장된 문제 수가 전체 problems 수보다 적은 legacy 데이터
  가
  자연스럽게 생성된다.", "confidence": 0.78 },
  { "claim": "Out of Scope(문제 타입 확장/서버 연동/커리
  큘럼 구조 변경)를 피하고 LearnPage.tsx 중심으로 제출 UX/
  저
  장 시점만 바꾸는 것이 회귀 위험이 낮다.", "reason":
  "task.md가 수정 중심 파일과 비범위를 명시하며, 현재 문제
  로딩/채점 로직은 요구 충족에 충분한 기반을 제공한다.",
  "confidence": 0.76 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그:
    LEARN_SINGLE_SUBMIT_FLOW(→LEARN_BULK_SUBMIT_FLOW),
    LEARN_STORAGE_UPDATE_PER_PROBLEM(→LEARN_STORAGE_SAVE_AF
    T
    ER_BULK_GRADE)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass (R3는
    requires 추가 없이 enables/analog_of만 제안)
  - Requires 사이클: Pass (새 requires를 추가하지 않았으므로
    사이클 위험 없음)
  - level 미제안: Pass
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 (R3 영역인 enables/analog_of
    만 제안)
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass (Transfer+APPENDIX(R2 원문)+QA 포함)

  [/R3 Transfer Report]

  ###DONE:af3c6e6c9c###


› 터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_f976572779.md


  22% context left



› Request f976572779: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_f976572779.md


• Context compacted

• Running wc -l .agents/inbox/research_f976572779.md
•         
  Troubleshoearch_f976572779.md 6


› Summarize recent commits

  98% context left · ? for shortcuts 


• Ran wc -l .agents/inbox/research_f976572779.md
  └ 936 .agents/inbox/research_f976572779.md


• Explored
  └ Search Output Format in research_f976572779.md
                                      
  │ … +220 lines                        
                                        
    Read task.md
                                           
                                 
    Search \[/R2 Progressi              
r                     
   3Read research_f976572779.md


• Ran python - <<'PY'
  │ import json
  │ s = r'''{
  │ … +220 lines
  └ ok R3 curriculum_viewer_learning_bulk_submit_v1 15 24

─ Worked for 8m 11s ────────────────────────────────────────

• ###BEGIN:f976572779###

  ## Transfer Edge Analysis

  ### Enables Edges (스킬 → 상위 문항 구조)

  | # | From | To | transfer 이유 | confidence |
  |---|------|----|--------------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT |
  PATTERN_SINGLE_ACTION_ENTRYPOINT | 개별 제출 제거는 단일
  CTA 중심의 흐름(하단 1버튼)으로 구조 전이를 강제한다. |
  0.76 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON |
  PATTERN_SINGLE_ACTION_ENTRYPOINT | 단일 버튼이 bulk 제출/
  채점의 유일 진입점 구조를 만든다. | 0.82 |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 입력됨 판정을 정규
  화와 일치시키면 disabled와 채점 기준 불일치를 제거한다. |
  0.84 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | problems 기반으로
  allAnswered를 안정 계산하면 “모두 입력 전 비활성” 게이트가
  흔들리지 않는다. | 0.80 |
  | 5 | LEARN_DISABLED_EDGECASES_12 |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 엣지케이스 벡터가
  게이트 판정 회귀(공백/콤마/0)를 방지한다. | 0.74 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION |
  PATTERN_BATCH_GRADE_PIPELINE | 전체 순회 채점을 “수집→채점
  →결과맵” 파이프라인으로 만들면 렌더/저장까지 확장된다. |
  0.80 |
  | 7 | LEARN_BUILD_RESULT_MAP |
  PATTERN_CANONICAL_RESULT_MAP | resultByProblemId 중간표현
  이 표시/집계/직렬화를 단일 키 계약으로 고정한다. | 0.78 |
  | 8 | LEARN_GRADED_STATE_FLAG |
  PATTERN_POST_GRADE_VISIBILITY_GATING | 채점 전/후 플래그는
  점수·정오·정답 노출 조건을 분리하는 상위 구조를 가능하게
  한다. | 0.78 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING |
  PATTERN_POST_GRADE_VISIBILITY_GATING | 게이팅 규칙을 명시
  하면 채점 전 0/N, 정답 선노출 같은 UX 붕괴를 막는다. |
  0.76 |
  | 10 | LEARN_SCORE_SUMMARY_CALC |
  PATTERN_POST_GRADE_VISIBILITY_GATING | X/N 요약은
  hasGraded 기반으로 노출해야 “채점됨” 의미가 유지된다. |
  0.72 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 채점 후 수정 시 스
  테일 결과를 무효화하고 재채점 흐름으로 전이된다. | 0.74 |
  | 12 | LEARN_GRADE_BUTTON_LABEL_STATE |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 라벨 전환(채점하기
  ↔다시 채점)이 재채점 구조를 사용자에게 명확히 전달한다. |
  0.70 |
  | 13 | LEARN_STORE_RESULT_SCHEMA_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 스키마 계약이 있
  어야 “채점 후 1회 저장(답안+결과)” 스냅샷 구조가 안정화된
  다. | 0.78 |
  | 14 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  PATTERN_RESTORE_VALIDATE_MIGRATE | 복원은 parse/검증/예외
  처리(초기화 포함) 파이프라인으로 구조 전이된다. | 0.76 |
  | 15 | LEARN_RESET_UI_STATE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | 저장소만 지우는 초기
  화가 아니라 UI 상태까지 동기화하는 ‘완전 초기화’ 구조로 전
  이된다. | 0.80 |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | PATTERN_NORMALIZED_COMPLETENESS_GATE |
  STRUCT_PREDICATE_GATED_ACTION | 정규화된 상태에서
  predicate를 계산해 액션을 게이트하는 구조가 동일하다. |
  0.74 |
  | 2 | PATTERN_POST_GRADE_VISIBILITY_GATING |
  STRUCT_PREDICATE_GATED_ACTION | 불리언 플래그(hasGraded)로
  가시성/액션을 제어하는 게이트 구조가 동형이다. | 0.72 |
  | 3 | PATTERN_BATCH_GRADE_PIPELINE |
  STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP | 컬렉션을 순회하
  며 keyed 결과맵을 생성하는 map→index 구조가 동형이다. |
  0.76 |
  | 4 | PATTERN_CANONICAL_RESULT_MAP |
  STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP | keyed map을 중간
  표현으로 고정해 후속 연산을 단순화하는 구조가 같다. | 0.70
  |
  | 5 | PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | 스냅샷을 버전/스키마
  와 함께 저장해 호환을 보장하는 구조가 동형이다. | 0.68 |
  | 6 | PATTERN_RESTORE_VALIDATE_MIGRATE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | restore 시 validate
  후 migrate/reset 분기하는 복원 파이프라인 구조가 동일하다.
  | 0.72 |
  | 7 | PATTERN_EDIT_INVALIDATES_AND_REGRADES |
  STRUCT_CACHE_INVALIDATION_ON_MUTATION | 입력 변경을 트리거
  로 기존 결과를 무효화하고 재계산을 요구하는 구조가 같다. |
  0.74 |
  | 8 | PATTERN_RESET_CLEAR_STORAGE_AND_UI |
  STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE | persisted
  state 제거와 view state 재수화를 함께 수행해야 일관성이 유
  지되는 구조가 동형이다. | 0.72 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답
  생성 규칙 |
  |---|---------|------------------|-----------|------------
  ---|
  | 1 | 정규화 기반 Disabled Gate | N:1~50, answers:문자열
  (공백/콤마 포함) | disabled = not
  all_i(len(normalize(ans_i))>0) | raw input 기준 판정,
  "0"를 빈값 처리, trim만 적용 |
  | 2 | Bulk Grade 결과맵 생성 | N:1~50, answersMap,
  gradeNumericAnswer | resultById[id]=grade(ans[id]),
  score=sum(isCorrect) | 루프 중 setState, key mismatch, 순
  서 의존 로직 |
  | 3 | 채점 후 결과/점수 가시성 게이트 | hasGraded:bool,
  resultMap | show = hasGraded, hide otherwise | 0/N 선노출,
  정답 선노출, 복원 시 flag 누락 |
  | 4 | 채점 후 수정 무효화/재채점 유도 | hasGraded:true,
  edit 이벤트 | onChange→clear results, hasGraded=false,
  CTA="다시 채점" | 스테일 결과 유지, 라벨 미전환, 부분만 초
  기화 |
  | 5 | 채점 후 1회 저장 스냅샷 | nodeId,
  payload{answers,results,updatedAt,version} |
  setItem(key(nodeId), JSON.stringify(payload)) | 문제별 저
  장으로 partial 생성, version 누락, 저장 시점 조기 |
  | 6 | 복원 parse/validate/migrate | storedStr(valid/
  invalid/legacy), problemsLen | invalid→reset, legacy
  partial→policy, else restore+hasGraded | parse crash,
  partial을 graded로 오인, 문제 수 불일치 미처리 |
  | 7 | Reset(다시 풀기) 동기화 | stored 존재, UI에 answers/
  results | removeItem + clear answer/result/flags | storage
  만 삭제하고 UI 잔존, derived state 재계산 누락 |
  | 8 | nodeId 스코프 키 분리 | nodeIdA,nodeIdB, 동일 페이지
  | key = prefix + nodeId, cross contamination 없음 | 고정
  키 사용, nodeId 누락으로 노드 간 오염 |
  | 9 | 로딩/문제 수 변화 안정화 | problems undefined 또는
  변경, answers 잔존 | disable while loading, allAnswered
  derived from problems | stale problemsLen, memo 누락으로
  순간 활성/비활성 흔들림 |

  ### 상세 템플릿 예시 (3개)

  Template 1: 정규화 기반 Disabled Gate
  - Parameters: { N: [1,50], answers: ["", "   ", "1,234",
  "0", ".", "+", "Infinity"], normalize:
  normalizeNumericInput }
  - Answer: disabled = !all_i( normalize(answers[i]).length
  > 0 )
  - Distractors: [raw input length로 판정, trim만 적용,
  "0"를 빈값 처리]
  - Required Skills:
  [LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Template 2: 채점 후 1회 저장 스냅샷
  - Parameters: { nodeId: ["nA","nB"], payload:
  { answersMap, resultByProblemId, updatedAt: [unixMs],
  version: [1,2] } }
  - Answer: storageKey(nodeId) = "curriculum-
  viewer:learn:lastResult:" + nodeId,
  setItem(storageKey(nodeId), JSON.stringify(payload))
  - Distractors: [문제별 저장으로 partial 생성, 저장 시점이
  채점 전, version 누락, nodeId 누락으로 오염]
  - Required Skills: [LEARN_IDENTIFY_STORAGE_KEY,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK]

  Template 3: 복원 parse→validate→migrate/reset
  - Parameters: { storedStr: [validJSON, invalidJSON,
  legacyPartialJSON], problemsLen: [1,50], policy:
  ["reset","restoreAnswersOnly","forceRegrade"] }
  - Answer: parsed = safeParse(storedStr); if !
  validShape(parsed) -> reset; else if
  isLegacyPartial(parsed, problemsLen) -> policyBranch; else
  restore answers+results+hasGraded
  - Distractors: [JSON.parse 예외로 런타임 크래시, partial을
  graded로 오인, 문제 수 변경 미처리]
  - Required Skills: [LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 조건 충족 전 잠금 해제 | 필수 항목 입력 전 제출 버튼
  비활성 | 필수 필드 누락 시 commit 차단 | 모든 점 지정 전
  면적 계산 버튼 비활성 |
  | 2 | 배치 처리 파이프라인 | 영수증을 모아 한 번에 정산 |
  레코드 배치 잡으로 결과맵 생성 | 여러 도형 넓이를 일괄 계
  산해 요약 |
  | 3 | keyed 중간표현 고정 | 항목별 체크리스트를 ID로 관리
  | id→result 맵으로 집계/표시/저장 | 각 변/각도 값을 라벨로
  맵핑 후 계산 |
  | 4 | 완료 후 가시성 게이팅 | 채점 전 점수 공개 금지 |
  flag true일 때만 리포트 노출 | 구성 완료 후 보조선/측정값
  표시 |
  | 5 | 버전드 스냅샷 저장/복원 | 임시저장 후 이어하기 |
  versioned snapshot restore with migration | CAD 도면 저장/
  로드 시 버전 변환 |
  | 6 | 레거시 partial 마이그레이션 | 구서식 일부 제출 데이
  터 처리 | old schema partial record migrate or reset | 구
  버전 도면 일부 요소 누락 import 처리 |
  | 7 | 초기화 동기화(저장+화면) | 신청 취소 시 내역 삭제+화
  면 초기화 | clear cache + reset view state | 그리기 초기화
  시 파일/화면 모두 초기화 |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 조건 충족 전 잠금 해제
  - 생활: 온라인 신청서에서 필수 항목을 모두 입력하기 전까지
  "제출" 버튼이 비활성화된다.
  - 데이터: 파이프라인에서 required 필드가 모두 채워지기 전
  에는 commit 단계가 실행되지 않는다.
  - 도형: 좌표평면에서 다각형의 모든 꼭짓점을 지정하기 전에
  는 "면적 계산" 버튼이 비활성화된다.
  - 공통 스킬: [LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Triplet 2: 버전드 스냅샷 저장/복원
  - 생활: 장바구니/신청서를 임시저장했다가 재접속 시 동일 상
  태로 복원하되, 구버전 데이터는 변환 또는 초기화된다.
  - 데이터: versioned snapshot을 읽어 validate 후 migrate/
  reset 분기하여 안전하게 rehydrate 한다.
  - 도형: CAD 도면을 저장/로드할 때 버전 정보를 통해 포맷을
  변환하고, 깨진 파일은 복구 불가로 초기화한다.
  - 공통 스킬: [LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type":
  "micro", "name_ko": "단일 주요 액션 진입점(개별 제출 제거
  후)", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "type": "micro", "name_ko": "정규화 기반 완결성 게이트(모
  두 입력 전까지 비활성)", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_BATCH_GRADE_PIPELINE", "type":
  "micro", "name_ko": "배치 채점 파이프라인(수집→채점→결과
  맵)", "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_CANONICAL_RESULT_MAP", "type":
  "micro", "name_ko": "정규 키 기반 결과맵
  (resultByProblemId) 중간표현", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "type": "micro", "name_ko": "채점 후 가시성 게이팅(점수·정
  오·정답)", "domain": "UX", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "type": "micro", "name_ko": "채점 후 수정 시 결과 무효화
  및 재채점 유도", "domain": "UX", "rep": "C", "lens":
  ["difference", "transform"] },
      { "id": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "type": "micro", "name_ko": "버전드 스냅샷 저장(답안+결과,
  채점 후 1회)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_RESTORE_VALIDATE_MIGRATE", "type":
  "micro", "name_ko": "복원 파이프라인
  (parse→validate→migrate or reset)", "domain": "FE", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type":
  "micro", "name_ko": "초기화는 저장소 삭제와 UI 리셋을 함
  께", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_NODE_SCOPED_STORAGE_KEY", "type":
  "micro", "name_ko": "nodeId 스코프 로컬 저장 키(노드 간 오
  염 방지)", "domain": "FE", "rep": "C", "lens":
  ["difference"] },
      { "id": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "micro", "name_ko": "조건식 기반 액션/가시성 게이트",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP",
  "type": "micro", "name_ko": "컬렉션 순회로 키드 맵 생성
  (map→index)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "micro", "name_ko": "버전드 스냅샷의 검증·마이그레이션",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "STRUCT_CACHE_INVALIDATION_ON_MUTATION",
  "type": "micro", "name_ko": "입력 변경 시 캐시/결과 무효
  화", "domain": "FE", "rep": "C", "lens": ["difference",
  "transform"] },
      { "id": "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE",
  "type": "micro", "name_ko": "저장 상태 삭제 후 뷰 재수화",
  "domain": "FE", "rep": "C", "lens": ["transform"] }
    ],
    "merge_aliases": [],
    "add_edges": [
      { "from": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "to":
  "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type": "enables",
  "reason": "개별 제출을 제거하면 단일 CTA 중심의 흐름 설계
  로 전이된다.", "confidence": 0.76 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type": "enables",
  "reason": "단일 버튼(채점하기)이 bulk 제출/채점의 유일 진
  입점 구조를 만든다.", "confidence": 0.82 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "모든 문제의 정규화된 입력 존재 여부를 계산하면
  버튼 disabled 게이트가 안정화된다.", "confidence": 0.8 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "입력됨 판정을 normalizeNumericInput과 일치시키
  면 disabled와 채점 기준 불일치를 제거한다.", "confidence":
  0.84 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "엣지케이스 벡터를 고정하면 게이트 조건 회귀를
  빠르게 잡아낸다.", "confidence": 0.74 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "PATTERN_BATCH_GRADE_PIPELINE", "type": "enables",
  "reason": "전체 순회 채점을 순수 계산 파이프라인으로 만들
  면 결과/점수/저장까지 일괄 처리로 확장된다.",
  "confidence": 0.8 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "PATTERN_CANONICAL_RESULT_MAP", "type": "enables",
  "reason": "problemId 키 기반 결과맵을 두면 표시·집계·직렬
  화가 같은 키 계약으로 수렴한다.", "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "채점 전/후 플래그는 점수·정오·정답의 노출 조건
  을 명확히 분리한다.", "confidence": 0.78 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "게이팅 규칙을 명시하면 채점 전 0/N 또는 정답 노
  출 같은 UX 혼선을 방지한다.", "confidence": 0.76 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "채점 후 수정 정책을 정의하면 스테일
  결과를 무효화하고 재채점 흐름으로 전이된다.",
  "confidence": 0.74 },
      { "from": "LEARN_GRADE_BUTTON_LABEL_STATE", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "버튼 라벨 전환은 재채점 유도 구조를
  사용자에게 전달하는 핵심 UI 신호다.", "confidence": 0.7 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "답안+결과 스키마를 고정해야 채점 후
  1회 저장 스냅샷으로 안전하게 직렬화할 수 있다.",
  "confidence": 0.78 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "bulk 복원은 parse/검증/예외처리(초기화 포함) 파
  이프라인 구조로 확장된다.", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "legacy partial을 감지하면 마이그레이션 또는 재
  채점 유도 분기 구조가 필요해진다.", "confidence": 0.72 },
      { "from": "LEARN_RESET_UI_STATE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "UI 상태 리셋을 포함해야 초기화 UX가 즉시 체감되
  고 저장 데이터와 화면이 동기화된다.", "confidence": 0.8 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "PATTERN_NODE_SCOPED_STORAGE_KEY", "type": "enables",
  "reason": "nodeId를 포함한 키 계약을 이해해야 노드 간 결과
  오염을 방지하는 저장 구조로 전이된다.", "confidence":
  0.72 },
      { "from": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "정규화된 상태에서 predicate를 계산
  해 UI 액션을 게이트하는 구조가 동일하다.", "confidence":
  0.74 },
      { "from": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "hasGraded 같은 불리언으로 가시성/
  액션을 제어하는 게이트 구조가 동일하다.", "confidence":
  0.72 },
      { "from": "PATTERN_BATCH_GRADE_PIPELINE", "to":
  "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP", "type":
  "analog_of", "reason": "문제 컬렉션을 순회하며 keyed 결과
  맵을 생성하는 map→index 구조가 동형이다.", "confidence":
  0.76 },
      { "from": "PATTERN_CANONICAL_RESULT_MAP", "to":
  "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP", "type":
  "analog_of", "reason": "중간표현을 keyed map으로 고정해 후
  속 연산(표시/집계/저장)을 단순화하는 구조가 동일하다.",
  "confidence": 0.7 },
      { "from": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "스냅샷을 버전/스키마와 함께 저장해
  향후 호환을 보장하는 구조가 동형이다.", "confidence":
  0.68 },
      { "from": "PATTERN_RESTORE_VALIDATE_MIGRATE", "to":
  "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "restore 시 validate 후 migrate/
  reset 분기하는 복원 파이프라인 구조가 동일하다.",
  "confidence": 0.72 },
      { "from": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "to": "STRUCT_CACHE_INVALIDATION_ON_MUTATION", "type":
  "analog_of", "reason": "입력 변경을 트리거로 기존 결과를
  무효화하고 재계산을 요구하는 구조가 동형이다.",
  "confidence": 0.74 },
      { "from": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "to":
  "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE", "type":
  "analog_of", "reason": "persisted state 제거와 view state
  재수화를 함께 수행해야 일관성이 유지되는 구조가 동일하
  다.", "confidence": 0.72 }
    ],
    "remove_edges": [],
    "notes": [
      { "claim": "disabled 판정과 채점의 '입력됨' 기준은
  normalizeNumericInput으로 단일화되어야 한다.", "reason":
  "공백/콤마 제거 등 정규화 결과를 기준으로 해야 버튼 활성/
  비활성과 채점 결과가 엇갈리지 않는다.", "confidence":
  0.84 },
      { "claim": "bulk 채점은 입력 수집→순수 채점→결과맵 생
  성→단일 setState로 구현하는 편이 안전하다.", "reason": "순
  회 중 setState를 섞으면 순서/클로저 버그가 발생하기 쉬워
  결과/표시/저장이 흔들린다.", "confidence": 0.78 },
      { "claim": "resultByProblemId는 점수 집계와 문제별 표
  시의 공통 중간표현으로 두는 것이 전이 효율이 높다.",
  "reason": "동일 키 계약을 유지하면 X/N 집계, 정오/정답 렌
  더, 직렬화가 같은 데이터에서 파생된다.", "confidence":
  0.76 },
      { "claim": "채점 후에만 점수/정답을 노출하는 게이팅은
  저장/복원 시 UX 혼선을 줄인다.", "reason": "부분 저장이나
  legacy 데이터가 있을 때도 hasGraded 기준으로 노출을 통제할
  수 있다.", "confidence": 0.74 },
      { "claim": "legacy partial은 복원 단계에서 감지하고 정
  책(초기화 또는 재채점 유도)으로 처리해야 한다.", "reason":
  "기존 per-problem 저장은 전체 문제 수보다 적은 submissions
  를 남기므로 bulk 전환 후 충돌이 자연스럽다.",
  "confidence": 0.72 },
      { "claim": "초기화는 localStorage 삭제와 UI 상태 리셋
  을 함께 수행해야 한다.", "reason": "저장소만 지우면 화면에
  남은 answer/result/hasGraded가 그대로여서 사용자가 초기화
  를 체감하지 못한다.", "confidence": 0.8 }
    ]
  }

  ## APPENDIX: R2 Progression Report (verbatim)

  [Previous Researcher Handoff (R2 Progression Report)]

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 파악 | FE | C | 변경 전 기준점(상태/스키마)
  을 고정해야 회귀를 줄일 수 있음 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화는 동일 키 계약을 알아야
  수행 가능 |
  | 3 | LEARN_BUILD_ANSWER_STATE_MAP | answerByProblemId 상
  태 맵 유지 | FE | P | allAnswered/일괄 채점을 위해 “문제
  ID→답안” 표현이 필요 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | per-problem 제출 흐름을 제거해야 UX
  요구사항 1) 충족 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 단일 진입점을
  구성 |
  | 6 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | “입력됨/미입력” 기준이 grading과 불일치하면 UX가 붕괴
  |
  | 7 | LEARN_DISABLED_EDGECASES_12 | disabled/정규화 입력
  엣지케이스 12종 정의 | QA | C | 빈값/공백/콤마/0 등 예외
  에서 버튼 상태가 흔들리는 것을 방지 |
  | 8 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지
  disabled”를 안정적으로 계산 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 10 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장을 위해
  결과를 문제ID 기준으로 고정 |
  | 11 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전/후 표시, 복원 시
  상태 일관성을 위해 필요 |
  | 12 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 채점 후 상단 점수 요약(X/N)을 계산/표시
  |
  | 13 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 0/N 노출 등 혼
  란을 방지 |
  | 14 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 결과 표시를 충
  족 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 정책을 고정 |
  | 16 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 상태/정책에 맞게 버튼
  의미를 일관되게 전달 |
  | 17 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션의
  계약(Contract)을 먼저 고정 |
  | 18 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/검증 규칙 | FE | P | 잘못된/legacy 데이터로 인한 런타
  임 오류와 UX 꼬임 방지 |
  | 19 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(일
  괄 채점 후) 충족 |
  | 20 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 복원 동작 충족 |
  | 21 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 호환/마이그레이션 정책 | FE | C | 기존 부
  분 제출 데이터가 남아 있을 때 복원/disabled/표시 충돌 방
  지 |
  | 22 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장 데이터
  삭제 |
  | 23 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  갱신되지 않으므로 UI 리셋이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_UI_SETUP | bulk 제출 UI 구성(disabled까
  지) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_BUILD_ANSWER_STATE_MAP,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출 제거 후
  단일 버튼을 추가하고 정규화 기반 allAnswered로 disabled를
  안정화 |
  | 2 | STEP_BULK_GRADE_AND_RENDER | 일괄 채점→결과 표시/점
  수/버튼 상태 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT,
  LEARN_AFTER_GRADE_EDIT_POLICY,
  LEARN_GRADE_BUTTON_LABEL_STATE | gradeAll 결과를 상태로
  고정하고, 채점 후에만 결과/점수를 노출하며 재입력 시 정책
  에 따라 버튼/결과를 정합화 |
  | 3 | STEP_PERSIST_RESTORE | 저장/복원/호환 처리 |
  LEARN_IDENTIFY_STORAGE_KEY,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 키/스키마
  계약을 고정한 뒤 bulk 저장·복원과 legacy partial 대응을
  연결 |
  | 4 | STEP_RESET_WORKFLOW | 다시 풀기(키 삭제+UI 리셋) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장하려면 어떤 키에 쓰는
  지(계약)가 선행되어야 함 | 0.72 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원하려면 어떤 키에서
  읽는지(계약)가 선행되어야 함 | 0.72 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_RESET_CLEAR_STORAGE | 초기화는 삭제 대상 키를 알아
  야 수행 가능 | 0.72 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 ‘입력됨’ 기준을 먼저 고정해야 함 | 0.82 |
  | 5 | LEARN_BUILD_ANSWER_STATE_MAP →
  LEARN_ALL_ANSWERED_NORMALIZED | 모든 문제 답 입력 여부는
  answers 맵(표현)이 있어야 순회/판정 가능 | 0.75 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 전체 채점 결과를 생성
  한 뒤에야 구성 가능 | 0.78 |
  | 7 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점은 문제별 결과가 있어야 집계 가능 | 0.76 |
  | 8 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과 맵이 선행되어야 함 | 0.78 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 채점 전/후 상태는 bulk 채점 액
  션 이후에 정의/세팅 가능 | 0.74 |
  | 10 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 채점 전/후 플래
  그 없이는 구현 불가 | 0.76 |
  | 11 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 계약이 먼저 필요 | 0.80 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 상태를 재구성하므로 선행 필요 | 0.80 |
  | 13 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK | 요구사항은 “일괄 채점 후”
  저장이므로 채점 결과 생성이 선행 | 0.80 |
  | 14 | LEARN_GRADED_STATE_FLAG →
  LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨 전환은 채점 상
  태(hasGraded 등)에 의존 | 0.70 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 엣지케이스 테스트 벡터가
  있으면 disabled/정규화 불일치 회귀가 줄어듦 | 0.76 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 UI는 먼저 만들 수 있으
  나, disabled까지 함께 설계하면 UX가 빨리 안정화 | 0.65 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 실제 구현은 독립 가능하지
  만, UI 이벤트 연결을 고려하면 함께 설계하는 편이 안전 |
  0.70 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 게이팅을 같이 설계하면 채
  점 전 결과 노출을 예방 | 0.70 |
  | 5 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADE_BUTTON_LABEL_STATE | 재입력 정책에 따라 버튼
  이 “다시 채점/채점하기”로 일관되게 전환됨 | 0.70 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 입력 변경 시 결과를 유지/
  초기화할지에 따라 게이팅/표시 규칙이 달라짐 | 0.70 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 검증 규칙은 스키마 계
  약(필드/타입/버전)을 알아야 정의 가능 | 0.74 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 파싱/검증을 붙이면 잘못
  된 저장 데이터로 인한 런타임 오류를 줄임 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial은 조건부
  이므로, 발견 시 정책 적용(초기화/재채점 요구) 흐름을 권장
  | 0.74 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_BUILD_ANSWER_STATE_MAP | 복원된 답안을 answers 맵에
  채워야 allAnswered/입력 UI가 일관됨 | 0.72 |
  | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_BUILD_RESULT_MAP | 복원된 결과를 결과 맵으로 재구성
  하면 점수/표시가 재현됨 | 0.70 |
  | 12 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거만 먼저 하면 기능 공백
  이 생길 수 있어, 단일 버튼을 먼저 마련하는 순서를 권장 |
  0.68 |
  | 13 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  “완전 초기화” UX를 위해 키 삭제와 UI 리셋을 함께 수행하는
  것을 권장 | 0.78 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 기존 흐름(단건 채점
  →merge 저장) 이해 없이 수정해 저장/복원 회귀 발생 | 현재
  StoredResult{submissions} 계약과 submitProblem 저장 시점
  을 1페이지로 먼저 고정 | 0.74 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI
  “입력됨” 판정과 grading “입력됨” 판정이 다르면 disabled/
  채점이 엇갈림 | normalizeNumericInput(answer).length>0를
  단일 기준으로 고정하고 모든 판정에서 재사용 | 0.82 |
  | 3 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", ".",
  "Infinity" 등에서 빈값/유효값 기준이 흔들림 | 엣지케이스
  를 테스트 벡터로 문서화하고 normalize 결과 기준으로 기대
  값을 명시 | 0.76 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems 기준으로 계산(useMemo)하고 로딩 중/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 5 | LEARN_BUILD_ANSWER_STATE_MAP | 문제 ID와 답안 상태
  가 어긋나 특정 문제 답이 덮어써지거나 누락 |
  answerByProblemId를 problemId 키로만 갱신하고, problems
  변경 시 상태 정합성 점검 | 0.70 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 상태 업
  데이트를 섞어 부수효과/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 7 | LEARN_BUILD_RESULT_MAP | resultByProblemId 키 매칭
  이 틀리면 점수/표시가 전부 어긋남 | 문제 목록의 problemId
  를 단일 키로 사용하고 결과 생성 시 동일 키로만 맵을 구성
  | 0.74 |
  | 8 | LEARN_GRADED_STATE_FLAG | hasGraded 기준이 불명확해
  채점 전에도 0/N 또는 결과가 노출 | hasGraded를 “bulk 채점
  실행 완료(또는 복원된 결과 존재)”로 정의하고 게이팅에 사
  용 | 0.78 |
  | 9 | LEARN_SCORE_SUMMARY_CALC | 부분 결과/legacy 데이터
  로 분모/분자가 맞지 않아 X/N이 틀림 | 분모는
  problems.length로 고정하고 분자는 결과 맵의 isCorrect 집
  계로 계산 | 0.72 |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과
  만 저장 등 스키마가 흔들려 복원/게이팅이 꼬임 | “answers

  - submissions(or resultMap) + updatedAt(+version)” 최소
    계약을 먼저 고정 | 0.78 |
    | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON 파싱 실패/
    필드 누락/문제 수 변경으로 복원이 불안정 |
    parse→validate→(필요 시) 초기화/마이그레이션 분기로 복원
    파이프라인을 분리 | 0.76 |
    | 12 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
    legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충
    돌
    | partial 감지(저장된 문제 수 < problems.length) 후 정책
    (초기화/재채점 요구)을 명시 | 0.74 |
    | 13 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
    시 결과/점수가 스테일(불일치) 상태로 남음 | 입력 변경 시
    결과 초기화 또는 “다시 채점” 유도(버튼 라벨 전환) 정책을
    고정 | 0.72 |
    | 14 | LEARN_RESET_UI_STATE | 키 삭제만 하고 UI가 그대로
    라 “초기화”가 체감되지 않음 | removeItem + answer/
    result/
    hasGraded를 한 액션으로 리셋해 즉시 UI 반영 | 0.78 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새로운 제출 진입점(UI)을 먼저 확보해 기능 공백
  을 막음 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BULK_GRADE_ALL_ACTION | 저장은 “채점 결과 생성” 이
  후에 의미가 생김(요구사항도 채점 후 저장) |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_BULK_GRADE_ALL_ACTION |
  LEARN_ALL_ANSWERED_NORMALIZED | 입력 판정이 안정화되어야
  “모든 문제 입력 후 채점” UX가 일관됨 |
  | 4 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴하므로 기준 노드가 브릿
  지 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  UI 표시는 결과를 problemId로 고정한 맵이 중간 표현으로 필
  요 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계도 동일 결과 맵을 기반으로 해야 일관됨 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | ‘채점 후에만 표시’ 규칙을
  중간에 두면 조기 노출을 방지 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 스키마 계약을 검증 규
  칙으로 연결하면 복원 안정성이 증가 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원된 결과를 ‘채점됨’ 상태로 재구성해야 표시 게이팅이 자
  연스러움 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 초기화
  는 먼저 저장 키 삭제를 수행한 뒤 UI 리셋으로 이어지는 흐
  름이 안전 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type":
  "micro", "name_ko": "localStorage 키 포맷 식별",
  "domain": "FE", "rep": "C", "confidence": 0.72 },
  { "id": "LEARN_BUILD_ANSWER_STATE_MAP", "type":
  "micro", "name_ko": "answerByProblemId 상태 맵 유지",
  "domain": "FE", "rep": "P", "confidence": 0.72 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
  { "id": "STEP_BULK_UI_SETUP", "type": "step",
  "name_ko": "bulk 제출 UI 구성(disabled까지)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_AND_RENDER", "type": "step",
  "name_ko": "일괄 채점→결과 표시/점수/버튼 상태",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE", "type": "step",
  "name_ko": "저장/복원/호환 처리", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
  { "id": "STEP_RESET_WORKFLOW", "type": "step",
  "name_ko": "다시 풀기(키 삭제+UI 리셋)", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
  ],
  "add_edges": [
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_BUILD_ANSWER_STATE_MAP", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.75 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_GRADE_BUTTON_LABEL_STATE", "type": "requires",
  "confidence": 0.70 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 과잉 잠금", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부이므로 requires가 아니
  라 권장/노트로 두는 편이 안전", "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원된 결과로 hasGraded를 파생할 수도 있어 단일 선행 잠
  금은 과잉", "confidence": 0.70 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "UI
  리셋과 키 삭제는 함께 수행이 권장되지만 선후를 잠글 필수
  관계는 아님", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 정책
  은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires로 잠그지 않는다", "confidence": 0.72 }
  ],
  "notes": [
  { "claim": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE는 복원
  안정성을 위한 권장 노드다.", "reason": "parse 실패/필드
  누락/legacy 데이터로 인한 런타임 오류와 UX 꼬임을 줄이기
  위해 validate 단계를 두는 편이 안전하다.", "confidence":
  0.78 },
  { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "모든 사용자에게 legacy 데이터가 존재하는 것은
  아니므로 requires 잠금은 과잉 선행이 될 수 있다.",
  "confidence": 0.74 },
  { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 입력 변경
  시 결과 스테일 문제를 다루는 권장 정책 노드다.",
  "reason": "결과 초기화 또는 다시 채점 유도 등 대체 경로가
  있어 requires로 강제하지 않고 UX 결정으로 남기는 편이 안
  전하다.", "confidence": 0.70 },
  { "claim": "완전 초기화 UX는
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만으로는 화면
  상태가 즉시 초기화되지 않아 사용자 체감이 어긋날 수 있
  다.", "confidence": 0.78 },
  { "claim": "LEARN_BUILD_RESULT_MAP은 결과 표시/점수/
  저장의 공통 중간 표현이다.", "reason": "problemId 기반 결
  과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되어
  오류가 줄어든다.", "confidence": 0.74 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작 1페이지 요약(상태 흐름/데이터 스키마) |
  LearnPage는 문제별 제출→단건 채점→localStorage merge 저장
  흐름이며 StoredResult{submissions} 계약이 기준점인데, 이
  를
  명시 요약하지 않으면 변경 시 회귀가 발생 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 핵심(개별 제
  출
  제거)인데 현재 UI는 per-problem 제출에 고정 | 높음 |
  | 3 | 페이지 하단 단일 버튼 채점하기(전체 제출) | 일괄 채
  점 UX의 유일한 진입점이 필요하나 현재 없음 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 버튼 활성/비활성이 채점과 엇갈림 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | “모든 문제 답 입력
  전까지 disabled”를 problems[] 기준으로 안정적으로 계산하
  는
  로직이 필요(로딩/문제수 변화 포함) | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요: "", "   ", "\t\n", ",", " , , ",
  "1,234", " 1 234 ", "0", "-0", "+", ".", "Infinity" | 중
  |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem(problem)만 존재해 “한 번에 전체 채
  점” 동작이 없음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전에도 점수/정답이 노출되거나(0/N) 저장/복원 시 상태가 꼬
  이는 것을 막기 위한 상태 기준이 필요 | 중 |
  | 9 | 문제별 결과 표시(정오/정답) 정책(일괄 채점 후) | 요
  구는 채점 후 각 문제 카드에 정오/정답 표시인데, 현재는 단
  건 제출 시에만 결과가 생김 | 높음 |
  |10| 총점 X/N 표시 정책(채점 후에만) | 상단 점수는 채점
  후
  에만 의미가 있으나 현재 구조는 “결과 일부 존재”만으로 0/N
  노출 가능 | 중 |
  |11| 저장/복원 계약(답안+채점결과를 한 번에 저장/복원) |
  요구는 일괄 채점 후 저장/복원인데, 현재는 문제별 제출 시
  마
  다 submissions를 merge 저장 | 높음 |
  |12| legacy partial(기존 부분 제출 데이터) 호환/마이그레
  이
  션 | 기존 데이터가 일부 문제만 채점/저장된 형태로 남아 있
  을 수 있어 bulk 전환 시 복원/disabled/표시가 꼬임 | 높음
  |
  |13| 다시 풀기(초기화): 키 삭제 + UI 상태 리셋 | 요구사항
  4)인데 현재는 사용자가 저장된 결과/답안을 삭제할 UX가 없
  음
  | 높음 |
  |14| 채점 후 재입력 정책(스테일 결과 처리) | 채점 후 입력
  변경 시 결과/점수와 입력이 불일치하는 스테일 상태가 발생
  할
  수 있어 정책이 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope(서버 연동) 위반이
  며
  localStorage 요구를 흐림 | 금지(이번 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 티켓은 제출
  UX/저장/복원이며 타입 확장은 별도 사양 필요 | 금지(후속
  티
  켓) |
  | 3 | grading 대개편(허용오차/분수/근삿값) | 요구는 일괄
  제출 UX이며 채점 정책 변경은 회귀 위험만 증대 | 기존
  gradeNumericAnswer() 유지 |
  | 4 | 문제은행 JSON 스키마 변경 | 로딩/데이터 구조 변경은
  범위 밖이며 회귀 위험 큼 | 기존 problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 충분, 도입은 과잉 | React state/useMemo로
  해결 |
  | 6 | 입력 중 실시간 autosave | 요구는 “채점 후 한 번에
  저
  장”이며 autosave는 정책/호환을 복잡화 | 이번 범위에서 제
  외
  |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 제출 미구현 | 제거만 하면
  채
  점/저장 경로가 사라져 기능 공백 발생 | 단일 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 입력 기준) → 채점(정규화 기준) | " ,
  "
  같은 케이스에서 버튼 활성/비활성과 채점 결과가 불일치 |
  disabled 판정은 normalizeNumericInput(answer).length>0로
  고정 |
  | 3 | 일괄 저장(한 번에 저장) → 기존 partial 데이터 복원
  |
  legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충돌
  | partial 감지 후 정책(초기화/답안만 복원/재채점 요구) 정
  의 |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 0/N 노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 발생 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | localStorage만
  지
  우면 화면은 이전 결과/답안을 계속 표시 | 키 삭제 +
  answerByProblemId/resultByProblemId/hasGraded 리셋 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled/정규화 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출 데이터 호환/
  마
  이그레이션 규칙", "domain": "FE", "rep": "C",
  "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results/hasGraded)", "domain": "FE", "rep": "P",
  "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입과 submitProblem의
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason": "grading.ts의
  normalizeNumericInput은 공백/콤마 제거를 수행하므로,
  disabled가 원문 기준이면 '입력됨/미입력'이 채점과 불일치
  한
  다.", "confidence": 0.82 },
  { "claim": "bulk 전환 시 legacy partial(일부 문제만
  submissions에 존재) 데이터가 자연스럽게 존재하므로 호환/
  마
  이그레이션 정책이 필요하다.", "reason": "기존 구현은 문제
  별 제출 시마다 submissions를 누적 저장하므로 전체 문제 수
  보다 적은 저장 데이터가 생성된다.", "confidence": 0.78 },
  { "claim": "점수/정오/정답 표시는 hasGraded 같은 상태
  로 게이팅해야 한다.", "reason": "채점 전 0/N 노출 및 저
  장/
  복원 시 표시 기준 혼란을 막기 위해 채점 전/후를 분리해야
  한다.", "confidence": 0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI 상태
  리셋을 함께 수행해야 한다.", "reason": "키 삭제만으로는
  화
  면에 남아있는 answer/result 상태가 즉시 초기화되지 않아
  UX
  가 어긋난다.", "confidence": 0.78 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 패치에
    requires 엣지 추가 없음(enables/analog_of만 제안)
  - Requires 사이클: Pass — R3에서 requires 미추가,
    add_edges 타입 스캔으로 자체 점검
  - level 미제안: Pass — Graph Patch JSON에 level/min_level
    필드 없음
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — R3는 enables/analog_of만
    제안(잠금 충돌 없음)
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — transfer/templates/triplets + appendix(R2 원문) +
    QA 포함

  [/R3 Transfer Report]

  ###DONE:f976572779###


› Summarize recent commits

  74% context left · ? for shortcuts


============================================================
[2026-01-08 11:14:55] RESEARCH3 (req_id: 06c7d600de)
============================================================
  | 6 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 상태 업
  데이트를 섞어 부수효과/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 7 | LEARN_BUILD_RESULT_MAP | resultByProblemId 키 매칭
  이 틀리면 점수/표시가 전부 어긋남 | 문제 목록의 problemId
  를 단일 키로 사용하고 결과 생성 시 동일 키로만 맵을 구성
  | 0.74 |
  | 8 | LEARN_GRADED_STATE_FLAG | hasGraded 기준이 불명확해
  채점 전에도 0/N 또는 결과가 노출 | hasGraded를 “bulk 채점
  실행 완료(또는 복원된 결과 존재)”로 정의하고 게이팅에 사
  용 | 0.78 |
  | 9 | LEARN_SCORE_SUMMARY_CALC | 부분 결과/legacy 데이터
  로 분모/분자가 맞지 않아 X/N이 틀림 | 분모는
  problems.length로 고정하고 분자는 결과 맵의 isCorrect 집
  계로 계산 | 0.72 |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과
  만 저장 등 스키마가 흔들려 복원/게이팅이 꼬임 | “answers

  - submissions(or resultMap) + updatedAt(+version)” 최소
    계약을 먼저 고정 | 0.78 |
    | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON 파싱 실패/
    필드 누락/문제 수 변경으로 복원이 불안정 |
    parse→validate→(필요 시) 초기화/마이그레이션 분기로 복원
    파이프라인을 분리 | 0.76 |
    | 12 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
    legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충
    돌
    | partial 감지(저장된 문제 수 < problems.length) 후 정책
    (초기화/재채점 요구)을 명시 | 0.74 |
    | 13 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
    시 결과/점수가 스테일(불일치) 상태로 남음 | 입력 변경 시
    결과 초기화 또는 “다시 채점” 유도(버튼 라벨 전환) 정책을
    고정 | 0.72 |
    | 14 | LEARN_RESET_UI_STATE | 키 삭제만 하고 UI가 그대로
    라 “초기화”가 체감되지 않음 | removeItem + answer/
    result/
    hasGraded를 한 액션으로 리셋해 즉시 UI 반영 | 0.78 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새로운 제출 진입점(UI)을 먼저 확보해 기능 공백
  을 막음 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BULK_GRADE_ALL_ACTION | 저장은 “채점 결과 생성” 이
  후에 의미가 생김(요구사항도 채점 후 저장) |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_BULK_GRADE_ALL_ACTION |
  LEARN_ALL_ANSWERED_NORMALIZED | 입력 판정이 안정화되어야
  “모든 문제 입력 후 채점” UX가 일관됨 |
  | 4 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴하므로 기준 노드가 브릿
  지 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  UI 표시는 결과를 problemId로 고정한 맵이 중간 표현으로 필
  요 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계도 동일 결과 맵을 기반으로 해야 일관됨 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | ‘채점 후에만 표시’ 규칙을
  중간에 두면 조기 노출을 방지 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 스키마 계약을 검증 규
  칙으로 연결하면 복원 안정성이 증가 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원된 결과를 ‘채점됨’ 상태로 재구성해야 표시 게이팅이 자
  연스러움 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 초기화
  는 먼저 저장 키 삭제를 수행한 뒤 UI 리셋으로 이어지는 흐
  름이 안전 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type":
  "micro", "name_ko": "localStorage 키 포맷 식별",
  "domain": "FE", "rep": "C", "confidence": 0.72 },
  { "id": "LEARN_BUILD_ANSWER_STATE_MAP", "type":
  "micro", "name_ko": "answerByProblemId 상태 맵 유지",
  "domain": "FE", "rep": "P", "confidence": 0.72 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
  { "id": "STEP_BULK_UI_SETUP", "type": "step",
  "name_ko": "bulk 제출 UI 구성(disabled까지)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_AND_RENDER", "type": "step",
  "name_ko": "일괄 채점→결과 표시/점수/버튼 상태",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE", "type": "step",
  "name_ko": "저장/복원/호환 처리", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
  { "id": "STEP_RESET_WORKFLOW", "type": "step",
  "name_ko": "다시 풀기(키 삭제+UI 리셋)", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
  ],
  "add_edges": [
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_BUILD_ANSWER_STATE_MAP", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.75 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_GRADE_BUTTON_LABEL_STATE", "type": "requires",
  "confidence": 0.70 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 과잉 잠금", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부이므로 requires가 아니
  라 권장/노트로 두는 편이 안전", "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원된 결과로 hasGraded를 파생할 수도 있어 단일 선행 잠
  금은 과잉", "confidence": 0.70 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "UI
  리셋과 키 삭제는 함께 수행이 권장되지만 선후를 잠글 필수
  관계는 아님", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 정책
  은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires로 잠그지 않는다", "confidence": 0.72 }
  ],
  "notes": [
  { "claim": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE는 복원
  안정성을 위한 권장 노드다.", "reason": "parse 실패/필드
  누락/legacy 데이터로 인한 런타임 오류와 UX 꼬임을 줄이기
  위해 validate 단계를 두는 편이 안전하다.", "confidence":
  0.78 },
  { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "모든 사용자에게 legacy 데이터가 존재하는 것은
  아니므로 requires 잠금은 과잉 선행이 될 수 있다.",
  "confidence": 0.74 },
  { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 입력 변경
  시 결과 스테일 문제를 다루는 권장 정책 노드다.",
  "reason": "결과 초기화 또는 다시 채점 유도 등 대체 경로가
  있어 requires로 강제하지 않고 UX 결정으로 남기는 편이 안
  전하다.", "confidence": 0.70 },
  { "claim": "완전 초기화 UX는
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만으로는 화면
  상태가 즉시 초기화되지 않아 사용자 체감이 어긋날 수 있
  다.", "confidence": 0.78 },
  { "claim": "LEARN_BUILD_RESULT_MAP은 결과 표시/점수/
  저장의 공통 중간 표현이다.", "reason": "problemId 기반 결
  과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되어
  오류가 줄어든다.", "confidence": 0.74 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작 1페이지 요약(상태 흐름/데이터 스키마) |
  LearnPage는 문제별 제출→단건 채점→localStorage merge 저장
  흐름이며 StoredResult{submissions} 계약이 기준점인데, 이
  를
  명시 요약하지 않으면 변경 시 회귀가 발생 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 핵심(개별 제
  출
  제거)인데 현재 UI는 per-problem 제출에 고정 | 높음 |
  | 3 | 페이지 하단 단일 버튼 채점하기(전체 제출) | 일괄 채
  점 UX의 유일한 진입점이 필요하나 현재 없음 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 버튼 활성/비활성이 채점과 엇갈림 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | “모든 문제 답 입력
  전까지 disabled”를 problems[] 기준으로 안정적으로 계산하
  는
  로직이 필요(로딩/문제수 변화 포함) | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요: "", "   ", "\t\n", ",", " , , ",
  "1,234", " 1 234 ", "0", "-0", "+", ".", "Infinity" | 중
  |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem(problem)만 존재해 “한 번에 전체 채
  점” 동작이 없음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전에도 점수/정답이 노출되거나(0/N) 저장/복원 시 상태가 꼬
  이는 것을 막기 위한 상태 기준이 필요 | 중 |
  | 9 | 문제별 결과 표시(정오/정답) 정책(일괄 채점 후) | 요
  구는 채점 후 각 문제 카드에 정오/정답 표시인데, 현재는 단
  건 제출 시에만 결과가 생김 | 높음 |
  |10| 총점 X/N 표시 정책(채점 후에만) | 상단 점수는 채점
  후
  에만 의미가 있으나 현재 구조는 “결과 일부 존재”만으로 0/N
  노출 가능 | 중 |
  |11| 저장/복원 계약(답안+채점결과를 한 번에 저장/복원) |
  요구는 일괄 채점 후 저장/복원인데, 현재는 문제별 제출 시
  마
  다 submissions를 merge 저장 | 높음 |
  |12| legacy partial(기존 부분 제출 데이터) 호환/마이그레
  이
  션 | 기존 데이터가 일부 문제만 채점/저장된 형태로 남아 있
  을 수 있어 bulk 전환 시 복원/disabled/표시가 꼬임 | 높음
  |
  |13| 다시 풀기(초기화): 키 삭제 + UI 상태 리셋 | 요구사항
  4)인데 현재는 사용자가 저장된 결과/답안을 삭제할 UX가 없
  음
  | 높음 |
  |14| 채점 후 재입력 정책(스테일 결과 처리) | 채점 후 입력
  변경 시 결과/점수와 입력이 불일치하는 스테일 상태가 발생
  할
  수 있어 정책이 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope(서버 연동) 위반이
  며
  localStorage 요구를 흐림 | 금지(이번 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 티켓은 제출
  UX/저장/복원이며 타입 확장은 별도 사양 필요 | 금지(후속
  티
  켓) |
  | 3 | grading 대개편(허용오차/분수/근삿값) | 요구는 일괄
  제출 UX이며 채점 정책 변경은 회귀 위험만 증대 | 기존
  gradeNumericAnswer() 유지 |
  | 4 | 문제은행 JSON 스키마 변경 | 로딩/데이터 구조 변경은
  범위 밖이며 회귀 위험 큼 | 기존 problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 충분, 도입은 과잉 | React state/useMemo로
  해결 |
  | 6 | 입력 중 실시간 autosave | 요구는 “채점 후 한 번에
  저
  장”이며 autosave는 정책/호환을 복잡화 | 이번 범위에서 제
  외
  |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 제출 미구현 | 제거만 하면
  채
  점/저장 경로가 사라져 기능 공백 발생 | 단일 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 입력 기준) → 채점(정규화 기준) | " ,
  "
  같은 케이스에서 버튼 활성/비활성과 채점 결과가 불일치 |
  disabled 판정은 normalizeNumericInput(answer).length>0로
  고정 |
  | 3 | 일괄 저장(한 번에 저장) → 기존 partial 데이터 복원
  |
  legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충돌
  | partial 감지 후 정책(초기화/답안만 복원/재채점 요구) 정
  의 |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 0/N 노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 발생 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | localStorage만
  지
  우면 화면은 이전 결과/답안을 계속 표시 | 키 삭제 +
  answerByProblemId/resultByProblemId/hasGraded 리셋 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled/정규화 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출 데이터 호환/
  마
  이그레이션 규칙", "domain": "FE", "rep": "C",
  "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results/hasGraded)", "domain": "FE", "rep": "P",
  "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입과 submitProblem의
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason": "grading.ts의
  normalizeNumericInput은 공백/콤마 제거를 수행하므로,
  disabled가 원문 기준이면 '입력됨/미입력'이 채점과 불일치
  한
  다.", "confidence": 0.82 },
  { "claim": "bulk 전환 시 legacy partial(일부 문제만
  submissions에 존재) 데이터가 자연스럽게 존재하므로 호환/
  마
  이그레이션 정책이 필요하다.", "reason": "기존 구현은 문제
  별 제출 시마다 submissions를 누적 저장하므로 전체 문제 수
  보다 적은 저장 데이터가 생성된다.", "confidence": 0.78 },
  { "claim": "점수/정오/정답 표시는 hasGraded 같은 상태
  로 게이팅해야 한다.", "reason": "채점 전 0/N 노출 및 저
  장/
  복원 시 표시 기준 혼란을 막기 위해 채점 전/후를 분리해야
  한다.", "confidence": 0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI 상태
  리셋을 함께 수행해야 한다.", "reason": "키 삭제만으로는
  화
  면에 남아있는 answer/result 상태가 즉시 초기화되지 않아
  UX
  가 어긋난다.", "confidence": 0.78 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 패치에
    requires 엣지 추가 없음(enables/analog_of만 제안)
  - Requires 사이클: Pass — R3에서 requires 미추가,
    add_edges 타입 스캔으로 자체 점검
  - level 미제안: Pass — Graph Patch JSON에 level/min_level
    필드 없음
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — R3는 enables/analog_of만
    제안(잠금 충돌 없음)
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — transfer/templates/triplets + appendix(R2 원문) +
    QA 포함

  [/R3 Transfer Report]

  ###DONE:f976572779###


› 터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_06c7d600de.md


  74% context left


› Summarize recent commits

  74% context left · ? for shortcuts



› Request 06c7d600de: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_06c7d600de.md



• Explored
  └ Read research_06c7d600de.md
                                                     
  │ … +1 lines                 
                                        
reDeterminingd600de.md         8
                                           
                                 
    Search LEARN_IDENTIFY_              
r                     
   6Read research_06c7d600de.md


• Ran for r in "86 205" "206 325" "326 445" "446 565" "566
  │ 685" "686 805" "806 875"; do set -- $r; echo "---CHUNK
  │ $1-$2---"; sed -n "$1,${2}p" .agents/inbox/
  │ … +1 lines
  └ ---CHUNK 86-205---
    [Previous Researcher Handoff (R2 Progression Report)]
    … +793 lines

      [/R2 Progression Report]

  │ … +268 lines
•         
  └alida ing Jrch_06c7d600de.m6


› Summarize recent commits

  67% context left · ? for shortcuts


• Ran python - <<'PY'
  │ import json
  │ obj = {
  │ … +268 lines
  └ ok 21 26

─ Worked for 6m 42s ────────────────────────────────────────

• ###BEGIN:06c7d600de###

  ## Transfer Edge Analysis

  ### Enables Edges (스킬 → 상위 문항 구조)

  | # | From | To | transfer 이유 | confidence |
  |---|------|----|--------------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT |
  PATTERN_SINGLE_CTA_BULK_GRADE | 개별 제출 경로 제거는 단일
  CTA 중심의 bulk 채점 플로우로 전이된다. | 0.78 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON |
  PATTERN_SINGLE_CTA_BULK_GRADE | 하단 1버튼은 bulk 채점 흐
  름의 유일 진입점 구조를 만든다. | 0.84 |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 입력됨 판정을 정규
  화와 일치시키면 disabled와 채점 기준 불일치를 제거한다. |
  0.84 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | problems[] 전체를
  순회해 allAnswered를 계산하면 완결성 게이트가 안정화된다.
  | 0.78 |
  | 5 | LEARN_DISABLED_EDGECASES_12 |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 엣지케이스 벡터를
  고정하면 게이트 조건 회귀를 빠르게 검출한다. | 0.74 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION |
  PATTERN_BATCH_GRADE_PIPELINE | 전체 순회 채점을 순수 파이
  프라인으로 만들면 결과/표시/저장까지 일괄 처리로 확장된다.
  | 0.80 |
  | 7 | LEARN_BUILD_RESULT_MAP |
  PATTERN_CANONICAL_RESULT_MAP | problemId 키 결과맵을 중간
  표현으로 고정하면 집계/표시/직렬화가 같은 계약으로 수렴한
  다. | 0.78 |
  | 8 | LEARN_SCORE_SUMMARY_CALC |
  PATTERN_SCORE_SUMMARY_AGGREGATION | 결과맵 기반 X/N 집계는
  상단 요약 UI를 위한 상위 구조로 전이된다. | 0.74 |
  | 9 | LEARN_GRADED_STATE_FLAG |
  PATTERN_POST_GRADE_VISIBILITY_GATING | hasGraded 같은 플래
  그는 채점 후에만 결과를 노출하는 가시성 게이트 구조를 가능
  하게 한다. | 0.78 |
  | 10 | LEARN_SHOW_PER_PROBLEM_RESULT |
  PATTERN_PER_ITEM_FEEDBACK_DISPLAY | 문제별 정오/정답 표시
  를 일괄 채점 이후로 이동시키는 표시 구조로 전이된다. |
  0.76 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 채점 후 수정 정책
  을 정의하면 스테일 결과를 무효화하고 재채점 흐름을 설계할
  수 있다. | 0.74 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 답안+결과 스키마
  계약이 있어야 채점 후 1회 저장 스냅샷을 안전하게 직렬화할
  수 있다. | 0.78 |
  | 13 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  PATTERN_RESTORE_VALIDATE_MIGRATE | 재진입 복원은 parse/검
  증/예외처리(초기화 포함) 파이프라인 구조로 전이된다. |
  0.76 |
  | 14 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  PATTERN_LEGACY_PARTIAL_POLICY_BRANCH | 부분 제출 데이터는
  bulk UX와 충돌하므로 감지 후 정책 분기 구조가 필요하다. |
  0.74 |
  | 15 | LEARN_RESET_UI_STATE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | UI 상태까지 함께 리셋
  해야 초기화가 즉시 체감되고 저장 데이터와 화면이 동기화된
  다. | 0.80 |
  | 16 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA |
  PATTERN_SCHEMA_AS_MIGRATION_SEED | 기존 저장 계약
  (submissions)을 문서화하면 bulk 스냅샷으로의 호환/마이그레
  이션 설계가 안정화된다. | 0.72 |
  | 17 | LEARN_STRICT_JSON_OUTPUT_GUARD |
  PATTERN_STRICT_JSON_HANDOFF_CONTRACT | 머신 파싱 가능한
  strict JSON 산출물 계약이 있어야 결합 패치 검증/병합이 가
  능하다. | 0.84 |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | PATTERN_NORMALIZED_COMPLETENESS_GATE |
  STRUCT_PREDICATE_GATED_ACTION | derived
  predicate(allAnswered)로 CTA를 게이트하는 구조가 동일하다.
  | 0.74 |
  | 2 | PATTERN_POST_GRADE_VISIBILITY_GATING |
  STRUCT_PREDICATE_GATED_ACTION | 플래그(hasGraded)로 가시
  성/행동을 제어하는 게이트 구조가 동형이다. | 0.72 |
  | 3 | PATTERN_BATCH_GRADE_PIPELINE |
  STRUCT_REDUCE_TO_KEYED_MAP | 문제 컬렉션을 순회/reduce하여
  keyed 결과맵을 만드는 구조가 동형이다. | 0.76 |
  | 4 | PATTERN_CANONICAL_RESULT_MAP |
  STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION | 중간표현을
  canonical map으로 고정해 후속 연산을 단순화하는 구조가 같
  다. | 0.72 |
  | 5 | PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | 버전/스키마를 포함한
  스냅샷 저장은 향후 검증·마이그레이션 구조로 전이된다. |
  0.68 |
  | 6 | PATTERN_RESTORE_VALIDATE_MIGRATE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | restore 시 validate
  후 migrate/reset 분기하는 구조가 동일하다. | 0.72 |
  | 7 | PATTERN_EDIT_INVALIDATES_AND_REGRADES |
  STRUCT_CACHE_INVALIDATION_ON_MUTATION | 입력 변경 이벤트가
  기존 결과를 무효화하고 재계산을 요구하는 구조가 동형이다.
  | 0.74 |
  | 8 | PATTERN_RESET_CLEAR_STORAGE_AND_UI |
  STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE | persisted
  state 삭제와 view state 재수화를 함께 수행해야 일관성이 유
  지된다. | 0.72 |
  | 9 | PATTERN_STRICT_JSON_HANDOFF_CONTRACT |
  STRUCT_MACHINE_READABLE_HANDOFF_CONTRACT | 산출물을 머신리
  더블 계약으로 고정해 자동 검증/병합을 가능하게 하는 구조가
  같다. | 0.76 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답
  생성 규칙 |
  |---|---------|------------------|-----------|------------
  ---|
  | 1 | 정규화 기반 allAnswered/disabled 게이트 | N:1~60,
  answers:문자열(공백/콤마/부호 포함) | disabled = not
  all_i(len(normalize(ans_i))>0) | raw 기준 판정, trim만 적
  용, "0"를 빈값 처리, 문제 로딩 중 활성화 |
  | 2 | bulk 채점 파이프라인(순수 계산) | problems:1~60,
  answersMap, gradeFn | resultMap = {id:
  gradeFn(norm(ans[id]))}, score=sum(isCorrect) | 순회 중
  setState 혼합, 키 mismatch, 결과 누락/덮어쓰기 |
  | 3 | 채점 후 가시성 게이팅(hasGraded) | hasGraded:bool,
  resultMap, score | showResults = hasGraded, hide otherwise
  | 채점 전 0/N 노출, 정답 선노출, 복원 후 flag 누락 |
  | 4 | 문제별 피드백 렌더(결과맵 기반) | problems:1~60,
  resultMap | render(problemId) uses resultMap[problemId] |
  index 기반 접근, problemId 변경 시 오표시, partial 결과 섞
  임 |
  | 5 | 채점 후 수정 시 무효화/재채점 유도 | hasGraded:true,
  onChange 이벤트 | onChange→clear results, hasGraded=false,
  CTA="다시 채점" | 스테일 결과 유지, 라벨 미전환, 일부만 초
  기화 |
  | 6 | 버전드 스냅샷 저장(채점 후 1회) | nodeId,
  payload{answers,results,updatedAt,version} |
  setItem(key(nodeId), JSON.stringify(payload)) | per-
  problem 저장으로 partial 생성, version 누락, 저장 시점 조
  기 |
  | 7 | 복원 parse→validate→migrate/reset | storedStr(valid/
  invalid/legacy), problemsLen | invalid→reset; legacy
  partial→policy; else restore+hasGraded | parse 크래시,
  partial을 graded로 오인, 문제 수 변경 미처리 |
  | 8 | strict JSON 산출물 계약 | patch JSON 문자열 |
  JSON.parse(patch) 성공 + 문자열 내부 줄바꿈 없음 | 문자열
  줄바꿈 포함, trailing comma, 키 누락으로 파서 실패 |

  ### 상세 템플릿 예시 (3개)

  Template 1: 정규화 기반 allAnswered/disabled 게이트
  - Parameters: { N: [1,60], answers: ["", "   ", ",",
  "1,234", "0", "+", ".", "Infinity"], normalize:
  normalizeNumericInput }
  - Answer: disabled = !all_i( normalize(answers[i]).length
  > 0 )
  - Distractors: [raw input length로 판정, trim만 적용,
  "0"를 빈값 처리, problems 로딩 중에도 enabled]
  - Required Skills:
  [LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Template 2: 복원 parse→validate→migrate/reset
  - Parameters: { storedStr: [validJSON, invalidJSON,
  legacyPartialJSON], problemsLen: [1,60], policy:
  ["reset","restoreAnswersOnly","forceRegrade"] }
  - Answer: parsed = safeParse(storedStr); if !
  validShape(parsed) -> reset; else if
  isLegacyPartial(parsed, problemsLen) -> policyBranch; else
  restore answers+results+hasGraded
  - Distractors: [JSON.parse 예외로 런타임 크래시, partial을
  graded로 오인, 문제 수 변경 미처리]
  - Required Skills: [LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  Template 3: strict JSON 산출물 계약
  - Parameters: { patchJsonText: [\"{...}\"] }
  - Answer: JSON.parse(patchJsonText) succeeds AND no
  unescaped newline exists inside any string value
  - Distractors: [문자열 내부 줄바꿈 포함, trailing comma,
  미닫힌 따옴표]
  - Required Skills: [LEARN_STRICT_JSON_OUTPUT_GUARD]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 조건 충족 전 잠금 해제 | 필수 항목 입력 전 제출 버튼
  비활성 | required 필드 누락 시 commit/submit 차단 | 모든
  점 지정 전 계산 버튼 비활성 |
  | 2 | 배치 처리 파이프라인 | 서류를 모아 한 번에 심사 | 레
  코드 배치 잡으로 결과맵 생성 | 여러 도형 값을 일괄 계산해
  요약 |
  | 3 | keyed 중간표현 고정 | 항목별 체크리스트를 ID로 관리
  | id→result 맵으로 집계/표시/저장 | 변/각도 값을 라벨로 맵
  핑 후 계산 |
  | 4 | 완료 후 가시성 게이팅 | 완료 후에만 합격/점수 공개 |
  flag true일 때만 리포트 노출 | 구성 완료 후 보조선/측정값
  표시 |
  | 5 | 버전드 스냅샷 저장/복원 | 임시저장 후 이어하기(구버
  전 변환) | versioned snapshot validate+migrate | 도면 저
  장/로드 시 버전 변환 |
  | 6 | 초기화 동기화(저장+화면) | 신청 취소 시 내역 삭제+화
  면 초기화 | clear cache + reset view state | 초기화 시 파
  일/화면 모두 초기화 |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 조건 충족 전 잠금 해제
  - 생활: 온라인 신청서에서 필수 항목을 모두 입력하기 전까지
  "제출" 버튼이 비활성화된다.
  - 데이터: 파이프라인에서 required 필드가 모두 채워지기 전
  에는 commit 단계가 실행되지 않는다.
  - 도형: 좌표평면에서 다각형의 모든 꼭짓점을 지정하기 전에
  는 "면적 계산" 버튼이 비활성화된다.
  - 공통 스킬: [LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Triplet 2: 버전드 스냅샷 저장/복원
  - 생활: 장바구니/신청서를 임시저장했다가 재접속 시 동일 상
  태로 복원하되, 구버전 데이터는 변환 또는 초기화된다.
  - 데이터: versioned snapshot을 읽어 validate 후 migrate/
  reset 분기하여 안전하게 rehydrate 한다.
  - 도형: CAD 도면을 저장/로드할 때 버전 정보를 통해 포맷을
  변환하고, 깨진 파일은 복구 불가로 초기화한다.
  - 공통 스킬: [LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "PATTERN_SINGLE_CTA_BULK_GRADE", "type":
  "micro", "name_ko": "단일 CTA 기반 bulk 채점 진입점",
  "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "type": "micro", "name_ko": "정규화 기반 완결성 게이트
  (allAnswered→disabled)", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_BATCH_GRADE_PIPELINE", "type":
  "micro", "name_ko": "배치 채점 파이프라인(수집→채점→결과
  맵)", "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_CANONICAL_RESULT_MAP", "type":
  "micro", "name_ko": "problemId 키 기반 결과맵 중간표현",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_SCORE_SUMMARY_AGGREGATION", "type":
  "micro", "name_ko": "총점 X/N 집계(결과맵 기반)",
  "domain": "FE", "rep": "C", "lens": ["accumulation"] },
      { "id": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "type": "micro", "name_ko": "채점 후 가시성 게이팅(점수·정
  오·정답)", "domain": "UX", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_PER_ITEM_FEEDBACK_DISPLAY", "type":
  "micro", "name_ko": "문제별 피드백 표시(일괄 채점 후)",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "type": "micro", "name_ko": "채점 후 수정 시 결과 무효화
  및 재채점 유도", "domain": "UX", "rep": "C", "lens":
  ["difference", "transform"] },
      { "id": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "type": "micro", "name_ko": "버전드 스냅샷 저장(답안+결과,
  채점 후 1회)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_RESTORE_VALIDATE_MIGRATE", "type":
  "micro", "name_ko": "복원 파이프라인
  (parse→validate→migrate or reset)", "domain": "FE", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "type": "micro", "name_ko": "legacy partial 감지 후 정책
  분기(초기화/재채점 유도)", "domain": "FE", "rep": "C",
  "lens": ["difference", "transform"] },
      { "id": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type":
  "micro", "name_ko": "초기화는 저장소 삭제와 UI 리셋을 함
  께", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_SCHEMA_AS_MIGRATION_SEED", "type":
  "micro", "name_ko": "기존 StoredResult schema 문서화를 마
  이그레이션 시드로 사용", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_STRICT_JSON_HANDOFF_CONTRACT",
  "type": "micro", "name_ko": "strict JSON 산출물 계약(파싱/
  병합 가능)", "domain": "QA", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "micro", "name_ko": "조건식 기반 액션/가시성 게이트",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "STRUCT_REDUCE_TO_KEYED_MAP", "type": "micro",
  "name_ko": "컬렉션을 reduce하여 keyed map 생성", "domain":
  "FE", "rep": "C", "lens": ["transform"] },
      { "id":
  "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION", "type":
  "micro", "name_ko": "정규 중간표현을 고정해 후속 연산을 단
  순화", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "micro", "name_ko": "버전드 스냅샷 검증·마이그레이션",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "STRUCT_CACHE_INVALIDATION_ON_MUTATION",
  "type": "micro", "name_ko": "변경 이벤트로 캐시/결과 무효
  화", "domain": "FE", "rep": "C", "lens": ["difference",
  "transform"] },
      { "id": "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE",
  "type": "micro", "name_ko": "persisted state 삭제 후 view
  state 재수화", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_MACHINE_READABLE_HANDOFF_CONTRACT",
  "type": "micro", "name_ko": "머신리더블 핸드오프 계약
  (strict JSON)", "domain": "QA", "rep": "C", "lens":
  ["transform"] }
    ],
    "merge_aliases": [],
    "add_edges": [
      { "from": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "to":
  "PATTERN_SINGLE_CTA_BULK_GRADE", "type": "enables",
  "reason": "개별 제출 경로 제거는 단일 CTA 중심의 제출/채점
  구조로 전이된다.", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "PATTERN_SINGLE_CTA_BULK_GRADE", "type": "enables",
  "reason": "하단 1버튼은 bulk 채점 흐름의 유일 진입점 구조
  를 만든다.", "confidence": 0.84 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "입력됨 판정을 정규화와 일치시키면 disabled와 채
  점 기준 불일치를 제거한다.", "confidence": 0.84 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "problems[] 전체를 순회해 allAnswered를 계산하면
  완결성 게이트가 안정화된다.", "confidence": 0.78 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "엣지케이스 벡터를 고정하면 게이트 조건 회귀를
  빠르게 검출한다.", "confidence": 0.74 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "PATTERN_BATCH_GRADE_PIPELINE", "type": "enables",
  "reason": "전체 순회 채점을 순수 파이프라인으로 만들면 결
  과/표시/저장까지 일괄 처리로 확장된다.", "confidence":
  0.8 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "PATTERN_CANONICAL_RESULT_MAP", "type": "enables",
  "reason": "problemId 키 결과맵을 중간표현으로 고정하면 집
  계/표시/직렬화가 같은 계약으로 수렴한다.", "confidence":
  0.78 },
      { "from": "LEARN_SCORE_SUMMARY_CALC", "to":
  "PATTERN_SCORE_SUMMARY_AGGREGATION", "type": "enables",
  "reason": "결과맵 기반 X/N 집계는 상단 요약 UI를 위한 상위
  구조로 전이된다.", "confidence": 0.74 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "hasGraded 같은 플래그는 채점 후에만 결과를 노출
  하는 가시성 게이트 구조를 가능하게 한다.", "confidence":
  0.78 },
      { "from": "LEARN_SHOW_PER_PROBLEM_RESULT", "to":
  "PATTERN_PER_ITEM_FEEDBACK_DISPLAY", "type": "enables",
  "reason": "문제별 정오/정답 표시를 일괄 채점 이후로 이동시
  키는 표시 구조로 전이된다.", "confidence": 0.76 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "채점 후 수정 정책을 정의하면 스테일
  결과를 무효화하고 재채점 흐름을 설계할 수 있다.",
  "confidence": 0.74 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "답안+결과 스키마 계약이 있어야 채점
  후 1회 저장 스냅샷을 안전하게 직렬화할 수 있다.",
  "confidence": 0.78 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "재진입 복원은 parse/검증/예외처리(초기화 포함)
  파이프라인 구조로 전이된다.", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH", "type": "enables",
  "reason": "부분 제출 데이터는 bulk UX와 충돌하므로 감지 후
  정책 분기 구조가 필요하다.", "confidence": 0.74 },
      { "from": "LEARN_RESET_UI_STATE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "UI 상태까지 함께 리셋해야 초기화가 즉시 체감되
  고 저장 데이터와 화면이 동기화된다.", "confidence": 0.8 },
      { "from": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "to":
  "PATTERN_SCHEMA_AS_MIGRATION_SEED", "type": "enables",
  "reason": "기존 저장 계약(submissions)을 문서화하면 bulk
  스냅샷으로의 호환/마이그레이션 설계가 안정화된다.",
  "confidence": 0.72 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "PATTERN_STRICT_JSON_HANDOFF_CONTRACT", "type": "enables",
  "reason": "머신 파싱 가능한 strict JSON 산출물 계약이 있어
  야 결합 패치 검증/병합이 가능하다.", "confidence": 0.84 },
      { "from": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "derived predicate(allAnswered)로
  CTA를 게이트하는 구조가 동일하다.", "confidence": 0.74 },
      { "from": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "플래그(hasGraded)로 가시성/행동을
  제어하는 게이트 구조가 동형이다.", "confidence": 0.72 },
      { "from": "PATTERN_BATCH_GRADE_PIPELINE", "to":
  "STRUCT_REDUCE_TO_KEYED_MAP", "type": "analog_of",
  "reason": "문제 컬렉션을 순회/reduce하여 keyed 결과맵을 만
  드는 구조가 동형이다.", "confidence": 0.76 },
      { "from": "PATTERN_CANONICAL_RESULT_MAP", "to":
  "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION", "type":
  "analog_of", "reason": "중간표현을 canonical map으로 고정
  해 후속 연산을 단순화하는 구조가 같다.", "confidence":
  0.72 },
      { "from": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "버전/스키마를 포함한 스냅샷 저장은
  향후 검증·마이그레이션 구조로 전이된다.", "confidence":
  0.68 },
      { "from": "PATTERN_RESTORE_VALIDATE_MIGRATE", "to":
  "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "restore 시 validate 후 migrate/
  reset 분기하는 구조가 동일하다.", "confidence": 0.72 },
      { "from": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "to": "STRUCT_CACHE_INVALIDATION_ON_MUTATION", "type":
  "analog_of", "reason": "입력 변경 이벤트가 기존 결과를 무
  효화하고 재계산을 요구하는 구조가 동형이다.",
  "confidence": 0.74 },
      { "from": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "to":
  "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE", "type":
  "analog_of", "reason": "persisted state 삭제와 view state
  재수화를 함께 수행해야 일관성이 유지된다.", "confidence":
  0.72 },
      { "from": "PATTERN_STRICT_JSON_HANDOFF_CONTRACT",
  "to": "STRUCT_MACHINE_READABLE_HANDOFF_CONTRACT", "type":
  "analog_of", "reason": "산출물을 머신리더블 계약으로 고정
  해 자동 검증/병합을 가능하게 하는 구조가 같다.",
  "confidence": 0.76 }
    ],
    "remove_edges": [],
    "notes": [
      { "claim": "disabled 판정과 채점의 '입력됨' 기준은
  normalizeNumericInput으로 단일화되어야 한다.", "reason":
  "공백/콤마 제거 등 정규화 결과를 기준으로 해야 버튼 활성/
  비활성과 채점 결과가 엇갈리지 않는다.", "confidence":
  0.84 },
      { "claim": "bulk 채점은 입력 수집→순수 채점→결과맵 생
  성→단일 state update로 구성하는 편이 안전하다.", "reason":
  "순회 중 상태 업데이트를 섞으면 순서/클로저 버그로 결과/표
  시/저장이 흔들리기 쉽다.", "confidence": 0.78 },
      { "claim": "resultByProblemId는 점수 집계와 문제별 표
  시의 공통 중간표현으로 두는 것이 전이 효율이 높다.",
  "reason": "동일 키 계약을 유지하면 X/N 집계, 정오/정답 렌
  더, 직렬화가 같은 데이터에서 파생된다.", "confidence":
  0.76 },
      { "claim": "legacy partial은 복원 단계에서 감지하고 정
  책(초기화 또는 재채점 유도)으로 처리해야 한다.", "reason":
  "기존 per-problem 저장은 submissions 일부만 남기는 것이 정
  상 동작이었고, bulk 전환 후 충돌이 자연스럽다.",
  "confidence": 0.74 },
      { "claim": "초기화는 localStorage 삭제와 UI 상태 리셋
  을 함께 수행해야 한다.", "reason": "저장소만 지우면 화면에
  남은 answer/results/flags가 그대로여서 사용자가 초기화를
  체감하지 못한다.", "confidence": 0.8 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 없
  는 strict JSON이어야 한다.", "reason": "파싱 실패는 결합
  패치 검증/병합(DAG/충돌 포함)을 중단시키므로 산출물 계약을
  강화해야 한다.", "confidence": 0.84 }
    ]
  }

  ## APPENDIX: R2 Progression Report (verbatim)

  [Previous Researcher Handoff (R2 Progression Report)]

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 1페이지 요약 | FE | C | 변경 전 기준선(상태/
  저장 시점)을 고정해 회귀를 줄이기 위해 |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA | StoredResult/
  submissions 스키마 문서화 | FE | C | bulk 저장/복원/호환
  을 설계하려면 기존 저장 계약을 먼저 명시해야 함 |
  | 3 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1)의 핵심(개별 제출 경로 제
  거)을 독립 작업으로 분리 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 단일 진입점을
  구현하기 위해 |
  | 5 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | UI 입력 판정과 grading 판정이 어긋나면 기능/UX가 붕괴
  하기 때문 |
  | 6 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  정의(빈값/공백/콤마/0/부호/소수점 등) | QA | C |
  disabled/정규화 일관성을 케이스 기반으로 고정해 회귀를 줄
  이기 위해 |
  | 7 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지
  disabled”를 problems[] 기준으로 안정화 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 9 | LEARN_BUILD_RESULT_MAP | problemId→채점결과
  (resultByProblemId) 맵 생성 | FE | P | 점수/표시/저장을
  같은 키로 정렬하는 중간 표현이 필요 |
  | 10 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전 점수 노출, 복원 후
  표시 기준 혼선을 막는 기준점 |
  | 11 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 요구사항 2) 점수 요약 표시를 별도 계산
  단위로 분리 |
  | 12 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 결과 노출 및
  legacy partial 노출 혼란을 차단 |
  | 13 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 문제 카드별 결
  과 표시를 독립 작업으로 분리 |
  | 14 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션/
  초기화의 공통 계약을 고정 |
  | 15 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 저장 시점(개별→일괄) 전환
  을 독립 작업으로 분리 |
  | 16 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 저장된 상태를 UI 상태
  (answer/results/flags)로 재구성하기 위해 |
  | 17 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 스
  키마 검증(파싱 실패/필드 누락 방지) | QA | P | 잘못된
  JSON/legacy 데이터로 인한 런타임 오류/UX 꼬임을 방지 |
  | 18 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 데이터 감지/정책 정의 | FE | C | 기존
  submissions 일부 저장 데이터가 bulk UX와 충돌하는 문제를
  분리 |
  | 19 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장 데이터
  삭제 동작을 독립 작업으로 분리 |
  | 20 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  남아있을 수 있어 즉시 상태 초기화 필요 |
  | 21 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 상태를 방지하는 규칙을 고정 |
  | 22 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장(문자열 줄바꿈 금지) | QA | C | reviewer
  요구: 결합 패치 파싱/병합을 위해 strict JSON이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출을 제거하
  고 단일 채점 버튼을 추가한 뒤, 정규화 기반 allAnswered로
  disabled를 안정화 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT | gradeAll 결과를 result 맵
  으로 고정하고 hasGraded 게이팅 하에 점수/정답을 표시 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 기반을 이해한 뒤 bulk 스키마로 저장/복원하고
  legacy partial을 감지/정책화 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 다시 풀기 시 저장/화면 상
  태를 함께 리셋하고, 채점 후 재입력 시 결과 처리 규칙을 정
  함 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 최종 결합 패치 검증/병
  합 파이프라인을 위해 문자열 내부 줄바꿈 없이 JSON을 출력
  |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 “입력됨/미입력” 기준을 먼저
  normalizeNumericInput으로 고정해야 함 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | result 맵은 전체 채점 결과(문제
  별 결과)가 있어야 생성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  점수 X/N은 problemId별 isCorrect 집계가 선행되어야 계산
  가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  problemId별 결과가 선행되어야 함 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 “채점됨” 상태
  (hasGraded 등) 없이 구현할 수 없음 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장은 스키마 계약(저장 필
  드/형태)을 먼저 정의해야 함 | 0.80 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 UI 상태를 재구성하므로 선행 필요 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 구현은 선후가 바뀔 수
  있으나, disabled까지 함께 설계하면 UX가 빨리 안정화 |
  0.65 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 UI와 액션을 함께 설계하는 것이 안전 | 0.70 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 보통 gradeAll 완료 시 hasGraded
  를 세팅하는 흐름이 자연 | 0.74 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능하지만, 표시
  시점은 게이팅과 함께 설계하는 것이 혼란을 줄임 | 0.70 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 결과 표시도 채점
  후에만 노출되도록 게이팅과 함께 설계 권장 | 0.70 |
  | 6 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 submissions 계약을
  이해해야 bulk 저장 계약/호환 정책이 안정화 | 0.74 |
  | 7 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | validate를 복원 파이프
  라인에 넣으면 parse/legacy 오류로 인한 회귀가 감소 | 0.78
  |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial이 있을
  때만 필요하므로 조건부(권장)로 배치 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원된 결과가 있다면 “채점됨”
  상태를 함께 재구성하는 것이 자연 | 0.70 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 화면이 남아 UX가 어긋나므로 함께 수행을
  권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 재입력 시 결과를 초기화할
  지 여부가 게이팅/표시 규칙에 영향을 줌 | 0.70 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 결합 검증 파이프라인이 JSON 파
  싱에 의존하므로 strict JSON 가드가 선행됨 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI는
  원문 입력, grading은 정규화 입력을 기준으로 삼아 “입력됨/
  미입력” 판정이 어긋남 |
  normalizeNumericInput(answer).length>0를 단일 기준으로 고
  정하고 disabled/채점에서 재사용 | 0.82 |
  | 2 | LEARN_DISABLED_EDGECASES_12 | "", " ", ",", "0",
  "+", "." 같은 케이스에서 기대 동작이 불명확해 로직이 흔들
  림 | 엣지케이스 벡터를 문서화하고 normalize 결과 기반으로
  기대값을 명시 | 0.76 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems[] 기준으로 계산(useMemo)하고 로딩/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 state 업
  데이트를 섞어 사이드이펙트/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 5 | LEARN_BUILD_RESULT_MAP | 결과를 problemId로 정렬하
  지 못해 점수/표시/저장 키가 어긋남 | problemId를 단일 키
  로 고정하고 resultByProblemId를 중간 표현으로 둠 | 0.74 |
  | 6 | LEARN_GRADED_STATE_FLAG | hasGraded의 의미(gradeAll
  완료 vs 복원됨)가 불명확해 게이팅/표시가 꼬임 | “gradeAll
  수행 또는 복원된 결과 존재”를 hasGraded 정의로 명시하고
  동일 기준을 사용 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 노
  출 가능, legacy partial 결과 노출 등 표시 기준 혼란 | 점
  수/정오/정답 표시는 hasGraded일 때만 노출하도록 단일 게이
  팅 규칙 적용 | 0.74 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과만
  저장 등 스키마가 흔들리면 복원/게이팅이 연쇄로 흔들림 |
  answers+results(또는 submissions)+updatedAt(+version) 최
  소 계약을 먼저 고정 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 일부 저장 데이터가 bulk UX에서 “채점됨”처럼
  보이거나 allAnswered와 충돌 | partial 감지(저장된 문제 수
  < problems.length) 후 정책(초기화/재채점 유도)을 명시 |
  0.74 |
  | 10 | LEARN_RESET_UI_STATE | 키 삭제만 수행해 화면에 이
  전 answer/result/flags가 남아 “초기화”가 체감되지 않음 |
  reset 액션에서 localStorage 삭제와 UI 상태 리셋을 함께 수
  행 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과/점수가 스테일(불일치) 상태로 남음 | 입력 변경 시
  결과 초기화 또는 버튼을 “다시 채점”으로 전환하는 정책을
  고정 | 0.72 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 내부 줄바
  꿈 때문에 JSON 파싱이 실패해 결합 패치 검증/병합이 중단됨
  | JSON 문자열은 한 줄로 유지(또는 \n 이스케이프)하고
  strict JSON으로 출력 | 0.84 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새 제출 진입점(UI)을 먼저 제공해 기능 공백을 방
  지 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 기준 정의에서 바로 UI로
  점프하지 않고 “활성 조건 계산”을 중간에 둠 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계의 공통 입력을 result 맵으로 정규화 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  문제별 표시도 동일한 result 맵을 중간 입력으로 사용 |
  | 5 | LEARN_GRADED_STATE_FLAG → LEARN_SCORE_SUMMARY_CALC
  | LEARN_SCORE_AND_RESULT_GATING | 계산과 표시 시점을 분리
  해 채점 전 노출을 차단 |
  | 6 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 결과 표시는 게이팅을 중간
  에 두어 조기 노출을 방지 |
  | 7 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 schema 이해→새
  schema 계약→legacy 정책으로 연결하면 충돌이 줄어듦 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 전에 validate를
  두면 파싱 실패/누락 필드로 인한 회귀가 감소 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원된 결과를 “채점됨” 상태로 재구성하면 게이팅 기준이 단
  순해짐 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 저장된
  키 삭제 후 UI 리셋으로 이어지는 초기화 흐름이 자연 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_SUMMARY_CALC | LEARN_GRADED_STATE_FLAG | 편집
  정책은 “채점된 상태”를 기준으로 점수/표시 갱신 규칙을 정
  의할 수 있음 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_PERSIST_RESTORE_MIGRATION_FLOW |
  STEP_STRICT_JSON_HANDOFF | 기능 구현과 별개로 산출물
  (strict JSON) 보장이 결합 검증 파이프라인을 가능하게 함 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이지 요약", "domain": "FE", "rep": "C", "confidence":
  0.72 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA",
  "type": "micro", "name_ko": "StoredResult/submissions 스
  키마 문서화", "domain": "FE", "rep": "C", "confidence":
  0.74 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기) 추
  가", "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "type":
  "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "problemId→채점결과(resultByProblemId) 맵 생
  성", "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)", "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.80 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 스키마 검증(파싱 실패/필
  드 누락 방지)", "domain": "QA", "rep": "P", "confidence":
  0.74 },
  { "id":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "micro", "name_ko": "legacy partial 데이터 감지/정책 정
  의", "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화/다시
  채점)", "domain": "UX", "rep": "C", "confidence": 0.70 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
  { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
  ],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires", "reason": "스키마 문서화는 흐름 요약과 독립적
  으로도 가능해 requires 잠금은 과잉", "confidence":
  0.72 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 과잉 잠금", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부로만 필요하므로
  requires가 아니라 권장/노트가 적절", "confidence":
  0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
  ],
  "notes": [
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "정규화(공백/콤마 제거)
  기준과 UI 기준이 다르면 " , " 같은 입력에서 버튼 상태와
  채점 결과가 불일치한다.", "confidence": 0.82 },
  { "claim": "legacy partial은 조건부로 감지해 초기화/
  재채점 유도 등 정책을 적용하는 편이 안전하다.", "reason":
  "기존 per-problem 저장은 submissions 일부만 남는 것이 정
  상 동작이었고, 이를 bulk UX에 그대로 노출하면 혼란이 생긴
  다.", "confidence": 0.74 },
  { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, 점수/정답 표시는 hasGraded일 때만 노
  출한다.", "reason": "채점 전 0/N 노출 및 부분 저장 데이터
  노출을 통제하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
  { "claim": "LEARN_BUILD_RESULT_MAP은 점수/표시/저장의
  공통 중간 표현으로 유용하다.", "reason": "problemId 기반
  결과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되
  어 오류가 줄어든다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력해야 결합 패치 검증/병합이 가능하
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 DAG/
  충돌 포함 자동 검증 파이프라인을 중단시킨다.",
  "confidence": 0.84 },
  { "claim": "allAnswered와 버튼 추가는 requires로 잠그
  지 않고 병렬 구현 가능하며, disabled 로직만 연결하면 된
  다.", "reason": "UI를 먼저 만들고 disabled 조건을 나중에
  붙이는 구현 경로가 자연스럽고 회귀 위험이 낮다.",
  "confidence": 0.70 },
  { "claim": "reset은 localStorage 키 삭제와 UI 상태 리
  셋을 함께 수행하는 것이 UX 상 권장이다.", "reason": "키
  삭제만 수행하면 화면에 남아있는 answer/result/flags가 그
  대로여서 사용자가 초기화를 체감하지 못한다.",
  "confidence": 0.78 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작/상태 흐름 1페이지 요약 | LearnPage는 “문
  제
  별 제출→단건 채점→localStorage merge 저장” 구조인데, 이를
  기준선으로 요약하지 않으면 bulk 전환 시 회귀 원인을 추적
  하
  기 어려움 | 높음 |
  | 2 | StoredResult 스키마 명시(현재: submissions) | 저장/
  복원 계약이 { nodeId, updatedAt, submissions }인데 bulk
  저
  장으로 바뀔 때 호환/마이그레이션 규칙이 필요 | 높음 |
  | 3 | 단일 버튼 채점하기 UX(하단 고정) | 요구사항은 “모든
  문제 입력 후 한 번에 제출”인데 현재 UI는 문제 카드별 제출
  만 존재 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일치) | disabled 판정
  이 normalizeNumericInput()과 일관되지 않으면 " , " 같은
  입
  력에서 활성/비활성이 채점과 불일치 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | problems[] 전체에
  대
  해 정규화 후 빈 값 여부를 확인해야 “모든 문제 입력 전까지
  disabled”를 구현 가능 | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요(빈값/공백/콤마/0/부호/소수점/Infinity
  등) | 중 |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem만 있어 “한 번에 전체 채점” 동작이
  없
  음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 0/N 노출, 복원 후 표시 기준 혼란을 막기 위해 채점 전/
  후
  상태를 분리해야 함 | 중 |
  | 9 | 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노
  출
  해야 사용자 혼란(채점 전 점수 노출/legacy partial) 최소화
  | 중 |
  |10| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 “개별 제출”이 아니라 “일괄 채점 후”로 바뀌어야
  함 | 높음 |
  |11| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 한
  번
  에 복원해 UI 상태를 재구성해야 함 | 높음 |
  |12| legacy partial 호환/마이그레이션 정책 | 기존 per-
  problem 저장은 submissions 일부만 남기는 데이터가 자연스
  럽
  게 생성되므로 bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |13| 초기화(다시 풀기): localStorage 삭제 + UI 리셋 | 요
  구
  사항 4)인데 현재 사용자가 저장된 결과/답안을 지울 방법이
  없음 | 높음 |
  |14| strict JSON 출력 가드(줄바꿈 금지) | reviewer 지적처
  럼 문자열 내부 줄바꿈이 있으면 자동 파싱/병합이 실패하므
  로
  산출물 JSON은 strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 요구를 흐림 | 금지 |
  | 2 | 문제 타입 확장(서술형/객관식) | 이번 티켓은 제출
  UX/
  저장/복원이며 타입 확장은 별도 설계 필요 | 금지(후속 티
  켓)
  |
  | 3 | 채점 정책 확장(허용오차/분수/근사) | bulk 제출 UX와
  무관하며 회귀 위험만 증가 | gradeNumericAnswer() 유지 |
  | 4 | 문제은행 스키마 변경 | 데이터 구조 변경은 범위 밖이
  며 회귀 위험 큼 | problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | autosave(입력 즉시 저장) | 요구는 “채점 후 한 번에
  저장”이며 호환/정책을 복잡화 | 제외 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 액션/버튼 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 상태/표시와 충돌
  |
  legacy partial 감지 후 정책(초기화/답안만 복원/재채점 유
  도) |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 점수
  노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남아있는 answer/result/flags가 그대로 | 키 삭제 +
  UI 상태 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/ submisions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 데
  이터 호환/정책", "domain": "FE", "rep": "C",
  "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload))가 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "legacy partial 데이터는 bulk 전환 시 필연
  적으로 존재할 수 있어 복원 단계에서 감지/정책화가 필요하
  다.", "reason": "기존 per-problem 저장은 전체 문제 수보다
  적은 submissions를 남기는 것이 정상 동작이었다.",
  "confidence": 0.74 },
  { "claim": "채점 전/후 게이팅(hasGraded)은 점수/정답
  조기 노출과 저장/복원 혼선을 줄인다.", "reason": "채점 전
  0/N 노출, 부분 저장 데이터 노출을 통제하려면 표시 기준이
  필요하다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch JSON에 requires 엣지 제안 없음(enables/analog_of만
    포함)
  - Requires 사이클: Pass — R3에서 requires 미추가(타입 스캔
    으로 자체 점검)
  - level 미제안: Pass — level/min_level 필드 미포함
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — R3는 enables/analog_of만
    제안하여 잠금 충돌 없음
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — transfer/templates/triplets + appendix(R2 원문) +
    QA 포함

  [/R3 Transfer Report]

  ###DONE:06c7d600de###


› Summarize recent commits

  58% context left · ? for shortcuts


============================================================
[2026-01-08 11:39:05] RESEARCH3 (req_id: 16e1580719)
============================================================
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "problemId→채점결과(resultByProblemId) 맵 생
  성", "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)", "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.80 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 스키마 검증(파싱 실패/필
  드 누락 방지)", "domain": "QA", "rep": "P", "confidence":
  0.74 },
  { "id":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "micro", "name_ko": "legacy partial 데이터 감지/정책 정
  의", "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화/다시
  채점)", "domain": "UX", "rep": "C", "confidence": 0.70 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
  { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
  ],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires", "reason": "스키마 문서화는 흐름 요약과 독립적
  으로도 가능해 requires 잠금은 과잉", "confidence":
  0.72 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 과잉 잠금", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부로만 필요하므로
  requires가 아니라 권장/노트가 적절", "confidence":
  0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
  ],
  "notes": [
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "정규화(공백/콤마 제거)
  기준과 UI 기준이 다르면 " , " 같은 입력에서 버튼 상태와
  채점 결과가 불일치한다.", "confidence": 0.82 },
  { "claim": "legacy partial은 조건부로 감지해 초기화/
  재채점 유도 등 정책을 적용하는 편이 안전하다.", "reason":
  "기존 per-problem 저장은 submissions 일부만 남는 것이 정
  상 동작이었고, 이를 bulk UX에 그대로 노출하면 혼란이 생긴
  다.", "confidence": 0.74 },
  { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, 점수/정답 표시는 hasGraded일 때만 노
  출한다.", "reason": "채점 전 0/N 노출 및 부분 저장 데이터
  노출을 통제하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
  { "claim": "LEARN_BUILD_RESULT_MAP은 점수/표시/저장의
  공통 중간 표현으로 유용하다.", "reason": "problemId 기반
  결과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되
  어 오류가 줄어든다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력해야 결합 패치 검증/병합이 가능하
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 DAG/
  충돌 포함 자동 검증 파이프라인을 중단시킨다.",
  "confidence": 0.84 },
  { "claim": "allAnswered와 버튼 추가는 requires로 잠그
  지 않고 병렬 구현 가능하며, disabled 로직만 연결하면 된
  다.", "reason": "UI를 먼저 만들고 disabled 조건을 나중에
  붙이는 구현 경로가 자연스럽고 회귀 위험이 낮다.",
  "confidence": 0.70 },
  { "claim": "reset은 localStorage 키 삭제와 UI 상태 리
  셋을 함께 수행하는 것이 UX 상 권장이다.", "reason": "키
  삭제만 수행하면 화면에 남아있는 answer/result/flags가 그
  대로여서 사용자가 초기화를 체감하지 못한다.",
  "confidence": 0.78 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작/상태 흐름 1페이지 요약 | LearnPage는 “문
  제
  별 제출→단건 채점→localStorage merge 저장” 구조인데, 이를
  기준선으로 요약하지 않으면 bulk 전환 시 회귀 원인을 추적
  하
  기 어려움 | 높음 |
  | 2 | StoredResult 스키마 명시(현재: submissions) | 저장/
  복원 계약이 { nodeId, updatedAt, submissions }인데 bulk
  저
  장으로 바뀔 때 호환/마이그레이션 규칙이 필요 | 높음 |
  | 3 | 단일 버튼 채점하기 UX(하단 고정) | 요구사항은 “모든
  문제 입력 후 한 번에 제출”인데 현재 UI는 문제 카드별 제출
  만 존재 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일치) | disabled 판정
  이 normalizeNumericInput()과 일관되지 않으면 " , " 같은
  입
  력에서 활성/비활성이 채점과 불일치 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | problems[] 전체에
  대
  해 정규화 후 빈 값 여부를 확인해야 “모든 문제 입력 전까지
  disabled”를 구현 가능 | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요(빈값/공백/콤마/0/부호/소수점/Infinity
  등) | 중 |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem만 있어 “한 번에 전체 채점” 동작이
  없
  음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 0/N 노출, 복원 후 표시 기준 혼란을 막기 위해 채점 전/
  후
  상태를 분리해야 함 | 중 |
  | 9 | 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노
  출
  해야 사용자 혼란(채점 전 점수 노출/legacy partial) 최소화
  | 중 |
  |10| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 “개별 제출”이 아니라 “일괄 채점 후”로 바뀌어야
  함 | 높음 |
  |11| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 한
  번
  에 복원해 UI 상태를 재구성해야 함 | 높음 |
  |12| legacy partial 호환/마이그레이션 정책 | 기존 per-
  problem 저장은 submissions 일부만 남기는 데이터가 자연스
  럽
  게 생성되므로 bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |13| 초기화(다시 풀기): localStorage 삭제 + UI 리셋 | 요
  구
  사항 4)인데 현재 사용자가 저장된 결과/답안을 지울 방법이
  없음 | 높음 |
  |14| strict JSON 출력 가드(줄바꿈 금지) | reviewer 지적처
  럼 문자열 내부 줄바꿈이 있으면 자동 파싱/병합이 실패하므
  로
  산출물 JSON은 strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 요구를 흐림 | 금지 |
  | 2 | 문제 타입 확장(서술형/객관식) | 이번 티켓은 제출
  UX/
  저장/복원이며 타입 확장은 별도 설계 필요 | 금지(후속 티
  켓)
  |
  | 3 | 채점 정책 확장(허용오차/분수/근사) | bulk 제출 UX와
  무관하며 회귀 위험만 증가 | gradeNumericAnswer() 유지 |
  | 4 | 문제은행 스키마 변경 | 데이터 구조 변경은 범위 밖이
  며 회귀 위험 큼 | problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | autosave(입력 즉시 저장) | 요구는 “채점 후 한 번에
  저장”이며 호환/정책을 복잡화 | 제외 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 액션/버튼 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 상태/표시와 충돌
  |
  legacy partial 감지 후 정책(초기화/답안만 복원/재채점 유
  도) |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 점수
  노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남아있는 answer/result/flags가 그대로 | 키 삭제 +
  UI 상태 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/ submisions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 데
  이터 호환/정책", "domain": "FE", "rep": "C",
  "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload))가 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "legacy partial 데이터는 bulk 전환 시 필연
  적으로 존재할 수 있어 복원 단계에서 감지/정책화가 필요하
  다.", "reason": "기존 per-problem 저장은 전체 문제 수보다
  적은 submissions를 남기는 것이 정상 동작이었다.",
  "confidence": 0.74 },
  { "claim": "채점 전/후 게이팅(hasGraded)은 점수/정답
  조기 노출과 저장/복원 혼선을 줄인다.", "reason": "채점 전
  0/N 노출, 부분 저장 데이터 노출을 통제하려면 표시 기준이
  필요하다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch JSON에 requires 엣지 제안 없음(enables/analog_of만
    포함)
  - Requires 사이클: Pass — R3에서 requires 미추가(타입 스캔
    으로 자체 점검)
  - level 미제안: Pass — level/min_level 필드 미포함
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — R3는 enables/analog_of만
    제안하여 잠금 충돌 없음
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — transfer/templates/triplets + appendix(R2 원문) +
    QA 포함

  [/R3 Transfer Report]

  ###DONE:06c7d600de###


› 터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_16e1580719.md


  58% context left



› Request 16e1580719: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_16e1580719.md


• Running wc -l .agents/inbox/research_16e1580719.md
•         
• └ Read research_16e15807194md
                                                     
                               
    Search \[/R2 Progressi              
r                     
  61% context left · ? for shortcuts


• Ran wc -l .agents/inbox/research_16e1580719.md
  └ 971 .agents/inbox/research_16e1580719.md

  │ … +296 lines
•         
◦ └ nsidching revious Researcher H3ndoff in
                                 
                               
› Summarize recent commits

  50% context left · ? for shortcuts


• Ran python - <<'PY'
  │ import json
  │ s = r'''{
  │ … +296 lines
  └ ok R3 curriculum_viewer_learning_bulk_submit_v1 23 35

─ Worked for 6m 38s ────────────────────────────────────────

• ###BEGIN:16e1580719###

  ## Transfer Edge Analysis

  ### Enables Edges (스킬 → 상위 문항 구조)

  | # | From | To | transfer 이유 | confidence |
  |---|------|----|--------------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT |
  PATTERN_SINGLE_CTA_BULK_GRADE | 개별 제출 제거는 단일 CTA
  중심의 bulk 채점 플로우로 전이된다. | 0.78 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON |
  PATTERN_SINGLE_CTA_BULK_GRADE | 하단 1버튼은 bulk 채점 흐
  름의 유일 진입점 구조를 만든다. | 0.84 |
  | 3 | LEARN_BUILD_ANSWER_STATE_MAP |
  PATTERN_CANONICAL_ANSWER_MAP | problemId 키 답안맵을 고정
  하면 allAnswered/저장/복원 로직이 단일 계약으로 수렴한다.
  | 0.74 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 정규화된
  allAnswered 계산은 “모두 입력 전 비활성” 게이트를 안정화한
  다. | 0.78 |
  | 5 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 입력됨 판정을 정규
  화와 일치시키면 disabled와 채점 기준 불일치를 제거한다. |
  0.84 |
  | 6 | LEARN_DISABLED_EDGECASES_12 |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 엣지케이스 벡터를
  고정하면 게이트 조건 회귀를 빠르게 검출한다. | 0.74 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION |
  PATTERN_BATCH_GRADE_PIPELINE | 전체 순회 채점을 순수 파이
  프라인으로 만들면 결과/표시/저장까지 일괄 처리로 확장된다.
  | 0.80 |
  | 8 | LEARN_BUILD_RESULT_MAP |
  PATTERN_CANONICAL_RESULT_MAP | problemId 키 결과맵을 중간
  표현으로 고정하면 집계/표시/직렬화가 같은 계약으로 수렴한
  다. | 0.78 |
  | 9 | LEARN_SCORE_SUMMARY_CALC |
  PATTERN_SCORE_SUMMARY_AGGREGATION | 결과맵 기반 X/N 집계는
  상단 요약 UI를 위한 상위 구조로 전이된다. | 0.74 |
  | 10 | LEARN_GRADED_STATE_FLAG |
  PATTERN_POST_GRADE_VISIBILITY_GATING | hasGraded 플래그는
  채점 후에만 점수·정답을 노출하는 가시성 게이트 구조를 가능
  하게 한다. | 0.78 |
  | 11 | LEARN_SCORE_AND_RESULT_GATING |
  PATTERN_POST_GRADE_VISIBILITY_GATING | 게이팅 규칙을 명시
  하면 채점 전 0/N 및 정답 선노출 같은 혼선을 줄인다. | 0.76
  |
  | 12 | LEARN_SHOW_PER_PROBLEM_RESULT |
  PATTERN_PER_ITEM_FEEDBACK_DISPLAY | 문제별 정오/정답 표시
  를 일괄 채점 이후로 이동시키는 표시 구조로 전이된다. |
  0.76 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 채점 후 수정 정책
  은 스테일 결과를 무효화하고 재채점을 유도하는 흐름 설계를
  가능하게 한다. | 0.74 |
  | 14 | LEARN_GRADE_BUTTON_LABEL_STATE |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 버튼 라벨 전환은
  재채점 필요를 사용자에게 전달하는 핵심 UI 신호다. | 0.70 |
  | 15 | LEARN_IDENTIFY_STORAGE_KEY |
  PATTERN_NODE_SCOPED_STORAGE_KEY | nodeId를 포함한 키 계약
  을 이해해야 노드 간 결과 오염을 방지하는 저장 구조로 전이
  된다. | 0.72 |
  | 16 | LEARN_STORE_RESULT_SCHEMA_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 답안+결과 스키마
  계약이 있어야 채점 후 1회 저장 스냅샷을 안전하게 직렬화할
  수 있다. | 0.78 |
  | 17 | LEARN_LOCALSTORAGE_SAVE_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 저장 시점을 “채점
  후 1회”로 고정하면 partial 데이터를 줄이고 복원 일관성이
  높아진다. | 0.72 |
  | 18 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE |
  PATTERN_RESTORE_VALIDATE_MIGRATE | 복원 단계에 validate를
  포함하면 parse 실패/필드 누락으로 인한 런타임 오류를 줄인
  다. | 0.78 |
  | 19 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  PATTERN_RESTORE_VALIDATE_MIGRATE | 재진입 복원은 parse/검
  증/예외처리(초기화 포함) 파이프라인 구조로 전이된다. |
  0.76 |
  | 20 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  PATTERN_LEGACY_PARTIAL_POLICY_BRANCH | 부분 제출 데이터는
  bulk UX와 충돌하므로 감지 후 정책 분기 구조가 필요하다. |
  0.74 |
  | 21 | LEARN_RESET_CLEAR_STORAGE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | 저장된 결과 삭제는 UI
  리셋과 함께 설계되어야 완전 초기화 UX가 된다. | 0.76 |
  | 22 | LEARN_RESET_UI_STATE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | UI 상태 리셋을 포함해
  야 초기화가 즉시 체감되고 저장 데이터와 화면이 동기화된다.
  | 0.80 |
  | 23 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA |
  PATTERN_SCHEMA_AS_MIGRATION_SEED | 기존 submissions 기반
  저장 계약을 문서화하면 bulk 스냅샷으로의 호환 설계가 안정
  화된다. | 0.72 |
  | 24 | LEARN_STRICT_JSON_OUTPUT_GUARD |
  PATTERN_STRICT_JSON_HANDOFF_CONTRACT | strict JSON 규칙을
  명시하면 결합 패치 파싱/병합 가능한 산출물 계약으로 전이된
  다. | 0.84 |
  | 25 | LEARN_JSON_VALIDATE_PARSE |
  PATTERN_STRICT_JSON_HANDOFF_CONTRACT | JSON.parse 통과 검
  증을 포함하면 “실제 strict”를 자동으로 보장할 수 있다. |
  0.84 |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | PATTERN_NORMALIZED_COMPLETENESS_GATE |
  STRUCT_PREDICATE_GATED_ACTION | derived
  predicate(allAnswered)로 CTA를 게이트하는 구조가 동일하다.
  | 0.74 |
  | 2 | PATTERN_POST_GRADE_VISIBILITY_GATING |
  STRUCT_PREDICATE_GATED_ACTION | 플래그(hasGraded)로 가시
  성/행동을 제어하는 게이트 구조가 동형이다. | 0.72 |
  | 3 | PATTERN_BATCH_GRADE_PIPELINE |
  STRUCT_REDUCE_TO_KEYED_MAP | 문제 컬렉션을 순회/reduce하여
  keyed 결과맵을 만드는 구조가 동형이다. | 0.76 |
  | 4 | PATTERN_CANONICAL_RESULT_MAP |
  STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION | 중간표현을
  canonical map으로 고정해 후속 연산을 단순화하는 구조가 같
  다. | 0.72 |
  | 5 | PATTERN_CANONICAL_ANSWER_MAP |
  STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION |
  answerByProblemId 같은 keyed map을 중간표현으로 두는 구조
  가 동일하다. | 0.70 |
  | 6 | PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | 버전/스키마를 포함한
  스냅샷 저장은 향후 검증·마이그레이션 구조로 전이된다. |
  0.68 |
  | 7 | PATTERN_RESTORE_VALIDATE_MIGRATE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | restore 시 validate
  후 migrate/reset 분기하는 구조가 동일하다. | 0.72 |
  | 8 | PATTERN_EDIT_INVALIDATES_AND_REGRADES |
  STRUCT_CACHE_INVALIDATION_ON_MUTATION | 입력 변경 이벤트가
  기존 결과를 무효화하고 재계산을 요구하는 구조가 동형이다.
  | 0.74 |
  | 9 | PATTERN_RESET_CLEAR_STORAGE_AND_UI |
  STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE | persisted
  state 삭제와 view state 재수화를 함께 수행해야 일관성이 유
  지된다. | 0.72 |
  | 10 | PATTERN_STRICT_JSON_HANDOFF_CONTRACT |
  STRUCT_MACHINE_READABLE_HANDOFF_CONTRACT | 산출물을 머신리
  더블 계약으로 고정해 자동 검증/병합을 가능하게 하는 구조가
  같다. | 0.76 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답
  생성 규칙 |
  |---|---------|------------------|-----------|------------
  ---|
  | 1 | 정규화 기반 완결성 게이트 | N:1~60, answers:문자열
  (공백/콤마/부호 포함) | disabled = not
  all_i(len(normalize(ans_i))>0) | raw 기준 판정, trim만 적
  용, "0"를 빈값 처리, 로딩 중 활성화 |
  | 2 | problemId 키 답안맵(answerByProblemId) 유지 |
  problems:1~60, onChange events | answerById[id]=newValue,
  keys = problemIds | index 기반 저장, 다른 id 덮어쓰기,
  problems 변경 시 stale 유지 |
  | 3 | bulk 채점 파이프라인(순수 계산) | problems:1~60,
  answersMap, gradeFn |
  resultById[id]=gradeFn(norm(ans[id])) | 순회 중 setState
  혼합, 키 mismatch, result 일부 누락 |
  | 4 | 결과맵 기반 총점 X/N 집계 | resultMap,
  N=problems.length | score = sum(isCorrect), denom=N |
  denom을 resultMap 길이로 사용, partial에 끌려감 |
  | 5 | 채점 후 가시성 게이팅(hasGraded) | hasGraded:bool,
  resultMap/score | show = hasGraded, hide otherwise | 채점
  전 0/N 노출, 정답 선노출, 복원 flag 누락 |
  | 6 | 채점 후 수정 무효화 + 라벨 전환 | hasGraded:true,
  onChange | onChange→clear resultMap, hasGraded=false,
  CTA="다시 채점" | 스테일 결과 유지, 라벨 미전환, 일부만 초
  기화 |
  | 7 | 버전드 스냅샷 저장(채점 후 1회) | nodeId,
  payload{answers,results,updatedAt,version} |
  setItem(key(nodeId), JSON.stringify(payload)) | per-
  problem 저장으로 partial 생성, version 누락, nodeId 누락 |
  | 8 | 복원 parse→validate→legacy policy→rehydrate |
  storedStr(valid/invalid/legacy), problemsLen |
  invalid→reset; legacy partial→policy; else
  restore+hasGraded | parse 크래시, partial을 graded로 오인,
  문제 수 변경 미처리 |
  | 9 | strict JSON 산출물 파싱 검증 | patchJsonText:JSON 문
  자열 | JSON.parse(patchJsonText) 성공 + 문자열 내부 줄바꿈
  없음 | 문자열 내부 줄바꿈 포함, trailing comma, 미닫힌 따
  옴표 |

  ### 상세 템플릿 예시 (3개)

  Template 1: 정규화 기반 완결성 게이트
  - Parameters: { N: [1,60], answers: ["", "   ", ",",
  "1,234", "0", "+", ".", "Infinity"], normalize:
  normalizeNumericInput }
  - Answer: disabled = !all_i( normalize(answers[i]).length
  > 0 )
  - Distractors: [raw input length로 판정, trim만 적용,
  "0"를 빈값 처리, problems 로딩 중 enabled]
  - Required Skills:
  [LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12, LEARN_BUILD_ANSWER_STATE_MAP]

  Template 2: 복원 parse→validate→legacy policy→rehydrate
  - Parameters: { storedStr: [validJSON, invalidJSON,
  legacyPartialJSON], problemsLen: [1,60], policy:
  ["reset","restoreAnswersOnly","forceRegrade"] }
  - Answer: parsed = safeParse(storedStr); if !
  validShape(parsed) -> reset; else if
  isLegacyPartial(parsed, problemsLen) -> policyBranch; else
  restore answers+results+hasGraded
  - Distractors: [JSON.parse 예외로 런타임 크래시, legacy
  partial을 graded로 오인, 문제 수 변경 미처리]
  - Required Skills: [LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  Template 3: strict JSON 산출물 파싱 검증
  - Parameters: { patchJsonText: ["{...}"], parse:
  JSON.parse }
  - Answer: parse(patchJsonText) succeeds AND no unescaped
  newline exists inside any string value
  - Distractors: [문자열 내부 줄바꿈 포함, trailing comma,
  미닫힌 따옴표]
  - Required Skills: [LEARN_STRICT_JSON_OUTPUT_GUARD,
  LEARN_JSON_VALIDATE_PARSE]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 조건 충족 전 잠금 해제 | 필수 항목 입력 전 제출 버튼
  비활성 | required 필드 누락 시 commit/submit 차단 | 모든
  점 지정 전 계산 버튼 비활성 |
  | 2 | keyed 상태맵을 중간표현으로 고정 | 체크리스트를 항목
  ID로 관리 | id→value/result 맵으로 처리 | 변/각도 라벨로
  값을 맵핑 후 계산 |
  | 3 | 배치 처리 파이프라인 | 서류를 모아 한 번에 심사 | 레
  코드 배치 잡으로 결과맵 생성 | 여러 도형 값을 일괄 계산해
  요약 |
  | 4 | 완료 후 가시성 게이팅 | 완료 후에만 점수/피드백 공개
  | job 완료 플래그 true일 때만 리포트 노출 | 구성 완료 후
  보조선/측정값 표시 |
  | 5 | 버전드 스냅샷 저장/복원 | 임시저장 후 이어하기(구버
  전 변환) | versioned snapshot validate+migrate | 도면 저
  장/로드 시 버전 변환 |
  | 6 | 초기화 동기화(저장+화면) | 신청 취소 시 내역 삭제+화
  면 초기화 | clear cache + reset view state | 초기화 시 파
  일/화면 모두 초기화 |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 조건 충족 전 잠금 해제
  - 생활: 온라인 신청서에서 필수 항목을 모두 입력하기 전까지
  "제출" 버튼이 비활성화된다.
  - 데이터: 파이프라인에서 required 필드가 모두 채워지기 전
  에는 commit 단계가 실행되지 않는다.
  - 도형: 좌표평면에서 다각형의 모든 꼭짓점을 지정하기 전에
  는 "면적 계산" 버튼이 비활성화된다.
  - 공통 스킬: [LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Triplet 2: 버전드 스냅샷 저장/복원
  - 생활: 작성 중인 답안을 임시저장했다가 재접속 시 동일 상
  태로 복원하되, 구버전 데이터는 변환 또는 초기화된다.
  - 데이터: versioned snapshot을 읽어 validate 후 migrate/
  reset 분기하여 안전하게 rehydrate 한다.
  - 도형: CAD 도면을 저장/로드할 때 버전 정보를 통해 포맷을
  변환하고, 깨진 파일은 복구 불가로 초기화한다.
  - 공통 스킬: [LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "PATTERN_SINGLE_CTA_BULK_GRADE", "type":
  "micro", "name_ko": "단일 CTA 기반 bulk 채점 진입점",
  "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "type": "micro", "name_ko": "정규화 기반 완결성 게이트
  (allAnswered→disabled)", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_CANONICAL_ANSWER_MAP", "type":
  "micro", "name_ko": "problemId 키 답안맵
  (answerByProblemId) 중간표현", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_BATCH_GRADE_PIPELINE", "type":
  "micro", "name_ko": "배치 채점 파이프라인(수집→채점→결과
  맵)", "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_CANONICAL_RESULT_MAP", "type":
  "micro", "name_ko": "problemId 키 결과맵
  (resultByProblemId) 중간표현", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_SCORE_SUMMARY_AGGREGATION", "type":
  "micro", "name_ko": "총점 X/N 집계(결과맵 기반)",
  "domain": "FE", "rep": "C", "lens": ["accumulation"] },
      { "id": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "type": "micro", "name_ko": "채점 후 가시성 게이팅(점수·정
  오·정답)", "domain": "UX", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_PER_ITEM_FEEDBACK_DISPLAY", "type":
  "micro", "name_ko": "문제별 피드백 표시(일괄 채점 후)",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "type": "micro", "name_ko": "채점 후 수정 시 결과 무효화
  및 재채점 유도", "domain": "UX", "rep": "C", "lens":
  ["difference", "transform"] },
      { "id": "PATTERN_NODE_SCOPED_STORAGE_KEY", "type":
  "micro", "name_ko": "nodeId 스코프 저장 키 계약(노드 간 오
  염 방지)", "domain": "FE", "rep": "C", "lens":
  ["difference"] },
      { "id": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "type": "micro", "name_ko": "버전드 스냅샷 저장(답안+결과,
  채점 후 1회)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_RESTORE_VALIDATE_MIGRATE", "type":
  "micro", "name_ko": "복원 파이프라인
  (parse→validate→migrate or reset)", "domain": "FE", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "type": "micro", "name_ko": "legacy partial 감지 후 정책
  분기(초기화/재채점 유도)", "domain": "FE", "rep": "C",
  "lens": ["difference", "transform"] },
      { "id": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type":
  "micro", "name_ko": "초기화는 저장소 삭제와 UI 리셋을 함
  께", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_SCHEMA_AS_MIGRATION_SEED", "type":
  "micro", "name_ko": "기존 StoredResult schema 문서화를 마
  이그레이션 시드로 사용", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_STRICT_JSON_HANDOFF_CONTRACT",
  "type": "micro", "name_ko": "strict JSON 산출물 계약(파싱/
  병합 가능)", "domain": "QA", "rep": "C", "lens":
  ["transform"] },

      { "id": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "micro", "name_ko": "조건식 기반 액션/가시성 게이트",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "STRUCT_REDUCE_TO_KEYED_MAP", "type": "micro",
  "name_ko": "컬렉션을 reduce하여 keyed map 생성", "domain":
  "FE", "rep": "C", "lens": ["transform"] },
      { "id":
  "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION", "type":
  "micro", "name_ko": "정규 중간표현을 고정해 후속 연산을 단
  순화", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "micro", "name_ko": "버전드 스냅샷 검증·마이그레이션",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "STRUCT_CACHE_INVALIDATION_ON_MUTATION",
  "type": "micro", "name_ko": "변경 이벤트로 캐시/결과 무효
  화", "domain": "FE", "rep": "C", "lens": ["difference",
  "transform"] },
      { "id": "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE",
  "type": "micro", "name_ko": "persisted state 삭제 후 view
  state 재수화", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_MACHINE_READABLE_HANDOFF_CONTRACT",
  "type": "micro", "name_ko": "머신리더블 핸드오프 계약
  (strict JSON)", "domain": "QA", "rep": "C", "lens":
  ["transform"] }
    ],
    "merge_aliases": [],
    "add_edges": [
      { "from": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "to":
  "PATTERN_SINGLE_CTA_BULK_GRADE", "type": "enables",
  "reason": "개별 제출 제거는 단일 CTA 중심의 bulk 채점 플로
  우로 전이된다.", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "PATTERN_SINGLE_CTA_BULK_GRADE", "type": "enables",
  "reason": "하단 1버튼은 bulk 채점 흐름의 유일 진입점 구조
  를 만든다.", "confidence": 0.84 },
      { "from": "LEARN_BUILD_ANSWER_STATE_MAP", "to":
  "PATTERN_CANONICAL_ANSWER_MAP", "type": "enables",
  "reason": "problemId 키 답안맵을 고정하면 allAnswered/저
  장/복원 로직이 단일 계약으로 수렴한다.", "confidence":
  0.74 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "정규화된 allAnswered 계산은 '모두 입력 전 비활
  성' 게이트를 안정화한다.", "confidence": 0.78 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "입력됨 판정을 정규화와 일치시키면 disabled와 채
  점 기준 불일치를 제거한다.", "confidence": 0.84 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "엣지케이스 벡터를 고정하면 게이트 조건 회귀를
  빠르게 검출한다.", "confidence": 0.74 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "PATTERN_BATCH_GRADE_PIPELINE", "type": "enables",
  "reason": "전체 순회 채점을 순수 파이프라인으로 만들면 결
  과/표시/저장까지 일괄 처리로 확장된다.", "confidence":
  0.8 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "PATTERN_CANONICAL_RESULT_MAP", "type": "enables",
  "reason": "problemId 키 결과맵을 중간표현으로 고정하면 집
  계/표시/직렬화가 같은 계약으로 수렴한다.", "confidence":
  0.78 },
      { "from": "LEARN_SCORE_SUMMARY_CALC", "to":
  "PATTERN_SCORE_SUMMARY_AGGREGATION", "type": "enables",
  "reason": "결과맵 기반 X/N 집계는 상단 요약 UI를 위한 상위
  구조로 전이된다.", "confidence": 0.74 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "hasGraded 플래그는 채점 후에만 점수·정답을 노출
  하는 가시성 게이트 구조를 가능하게 한다.", "confidence":
  0.78 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "게이팅 규칙을 명시하면 채점 전 0/N 및 정답 선노
  출 같은 혼선을 줄인다.", "confidence": 0.76 },
      { "from": "LEARN_SHOW_PER_PROBLEM_RESULT", "to":
  "PATTERN_PER_ITEM_FEEDBACK_DISPLAY", "type": "enables",
  "reason": "문제별 정오/정답 표시를 일괄 채점 이후로 이동시
  키는 표시 구조로 전이된다.", "confidence": 0.76 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "채점 후 수정 정책은 스테일 결과를 무
  효화하고 재채점을 유도하는 흐름 설계를 가능하게 한다.",
  "confidence": 0.74 },
      { "from": "LEARN_GRADE_BUTTON_LABEL_STATE", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "버튼 라벨 전환은 재채점 필요를 사용
  자에게 전달하는 핵심 UI 신호다.", "confidence": 0.7 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "PATTERN_NODE_SCOPED_STORAGE_KEY", "type": "enables",
  "reason": "nodeId를 포함한 키 계약을 이해해야 노드 간 결과
  오염을 방지하는 저장 구조로 전이된다.", "confidence":
  0.72 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "답안+결과 스키마 계약이 있어야 채점
  후 1회 저장 스냅샷을 안전하게 직렬화할 수 있다.",
  "confidence": 0.78 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "저장 시점을 '채점 후 1회'로 고정하면
  partial 데이터를 줄이고 복원 일관성이 높아진다.",
  "confidence": 0.72 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "복원 단계에 validate를 포함하면 parse 실패/필드
  누락으로 인한 런타임 오류를 줄인다.", "confidence":
  0.78 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "재진입 복원은 parse/검증/예외처리(초기화 포함)
  파이프라인 구조로 전이된다.", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH", "type": "enables",
  "reason": "부분 제출 데이터는 bulk UX와 충돌하므로 감지 후
  정책 분기 구조가 필요하다.", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "저장된 결과 삭제는 UI 리셋과 함께 설계되어야 완
  전 초기화 UX가 된다.", "confidence": 0.76 },
      { "from": "LEARN_RESET_UI_STATE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "UI 상태 리셋을 포함해야 초기화가 즉시 체감되고
  저장 데이터와 화면이 동기화된다.", "confidence": 0.8 },
      { "from": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "to":
  "PATTERN_SCHEMA_AS_MIGRATION_SEED", "type": "enables",
  "reason": "기존 submissions 기반 저장 계약을 문서화하면
  bulk 스냅샷으로의 호환 설계가 안정화된다.", "confidence":
  0.72 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "PATTERN_STRICT_JSON_HANDOFF_CONTRACT", "type": "enables",
  "reason": "strict JSON 규칙을 명시하면 결합 패치 파싱/병합
  가능한 산출물 계약으로 전이된다.", "confidence": 0.84 },
      { "from": "LEARN_JSON_VALIDATE_PARSE", "to":
  "PATTERN_STRICT_JSON_HANDOFF_CONTRACT", "type": "enables",
  "reason": "JSON.parse 통과 검증을 포함하면 '실제 strict'를
  자동으로 보장할 수 있다.", "confidence": 0.84 },

      { "from": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "derived predicate(allAnswered)로
  CTA를 게이트하는 구조가 동일하다.", "confidence": 0.74 },
      { "from": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "플래그(hasGraded)로 가시성/행동을
  제어하는 게이트 구조가 동형이다.", "confidence": 0.72 },
      { "from": "PATTERN_BATCH_GRADE_PIPELINE", "to":
  "STRUCT_REDUCE_TO_KEYED_MAP", "type": "analog_of",
  "reason": "문제 컬렉션을 순회/reduce하여 keyed 결과맵을 만
  드는 구조가 동형이다.", "confidence": 0.76 },
      { "from": "PATTERN_CANONICAL_RESULT_MAP", "to":
  "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION", "type":
  "analog_of", "reason": "중간표현을 canonical map으로 고정
  해 후속 연산을 단순화하는 구조가 같다.", "confidence":
  0.72 },
      { "from": "PATTERN_CANONICAL_ANSWER_MAP", "to":
  "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION", "type":
  "analog_of", "reason": "answerByProblemId 같은 keyed map을
  중간표현으로 두는 구조가 동일하다.", "confidence": 0.7 },
      { "from": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "버전/스키마를 포함한 스냅샷 저장은
  향후 검증·마이그레이션 구조로 전이된다.", "confidence":
  0.68 },
      { "from": "PATTERN_RESTORE_VALIDATE_MIGRATE", "to":
  "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "restore 시 validate 후 migrate/
  reset 분기하는 구조가 동일하다.", "confidence": 0.72 },
      { "from": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "to": "STRUCT_CACHE_INVALIDATION_ON_MUTATION", "type":
  "analog_of", "reason": "입력 변경 이벤트가 기존 결과를 무
  효화하고 재계산을 요구하는 구조가 동형이다.",
  "confidence": 0.74 },
      { "from": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "to":
  "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE", "type":
  "analog_of", "reason": "persisted state 삭제와 view state
  재수화를 함께 수행해야 일관성이 유지된다.", "confidence":
  0.72 },
      { "from": "PATTERN_STRICT_JSON_HANDOFF_CONTRACT",
  "to": "STRUCT_MACHINE_READABLE_HANDOFF_CONTRACT", "type":
  "analog_of", "reason": "산출물을 머신리더블 계약으로 고정
  해 자동 검증/병합을 가능하게 하는 구조가 같다.",
  "confidence": 0.76 }
    ],
    "remove_edges": [],
    "notes": [
      { "claim": "disabled 판정과 채점의 '입력됨' 기준은
  normalizeNumericInput으로 단일화되어야 한다.", "reason":
  "정규화 결과를 기준으로 해야 버튼 활성/비활성과 채점 결과
  가 엇갈리지 않는다.", "confidence": 0.84 },
      { "claim": "bulk 채점은 입력 수집→순수 채점→결과맵 생
  성→단일 state update로 구성하는 편이 안전하다.", "reason":
  "순회 중 상태 업데이트를 섞으면 순서/클로저 버그로 결과/표
  시/저장이 흔들리기 쉽다.", "confidence": 0.78 },
      { "claim": "legacy partial은 복원 단계에서 감지하고 정
  책(초기화 또는 재채점 유도)으로 처리해야 한다.", "reason":
  "기존 per-problem 저장은 submissions 일부만 남기는 것이 정
  상 동작이었고 bulk 전환 후 충돌이 자연스럽다.",
  "confidence": 0.74 },
      { "claim": "초기화는 localStorage 삭제와 UI 상태 리셋
  을 함께 수행해야 한다.", "reason": "저장소만 지우면 화면에
  남은 answer/results/flags가 그대로여서 사용자가 초기화를
  체감하지 못한다.", "confidence": 0.8 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 없
  는 strict JSON이어야 한다.", "reason": "파싱 실패는 결합
  패치 검증/병합(DAG/충돌 포함)을 중단시키므로 산출물 계약을
  강화해야 한다.", "confidence": 0.84 }
    ]
  }

  ## APPENDIX: R2 Progression Report (verbatim)

  [Previous Researcher Handoff (R2 Progression Report)]

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 기준선 요약 | FE | C | 변경 전 상태(단건 채
  점/merge 저장)를 기준점으로 고정해야 회귀를 줄일 수 있음
  |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA |
  StoredResult(submissions) 스키마 명시 | FE | C | 저장/복
  원 계약이 흔들리면 bulk 전환 시 호환/마이그레이션 논의가
  붕괴 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화가 모두 동일 키 계약에 의
  존 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1) 핵심 변경(개별 제출 경로
  제거)을 독립 작업으로 분리 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기(전
  체 제출) 버튼 추가 | FE | P | bulk UX의 단일 진입점을 구
  현하기 위해 |
  | 6 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 기준을 normalizeNumericInput과 일치 | FE | C |
  입력 판정이 grading과 불일치하면 disabled/채점 결과가 엇
  갈려 UX가 붕괴 |
  | 7 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  정의(빈값/공백/콤마/0/부호/소수점 등) | QA | C |
  disabled/정규화 일관성을 케이스 기반으로 고정해 회귀를 줄
  이기 위해 |
  | 8 | LEARN_BUILD_ANSWER_STATE_MAP | answerByProblemId 상
  태 맵 유지 | FE | P | allAnswered/저장/복원을 위해 “문제
  ID→답” 표현을 안정화 |
  | 9 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지 disabled”
  조건을 problems[] 기준으로 안정화 |
  | 10 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 11 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장을 동일
  키(problemId)로 정렬하는 중간 표현이 필요 |
  | 12 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전 0/N 노출, 복원 후
  표시 기준 혼란을 막는 기준점 |
  | 13 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 요구사항 2) 상단 점수 요약을 안정적으로
  집계/표시 |
  | 14 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 결과 노출 및
  legacy partial 노출 혼란을 차단 |
  | 15 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 문제 카드별 결
  과 표시를 독립 작업으로 분리 |
  | 16 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 채점 후 재입력 정책과
  결합해 사용자가 다음 행동을 오해하지 않게 하기 위해 |
  | 17 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 상태를 방지하는 규칙을 고정 |
  | 18 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션/
  초기화의 공통 계약을 고정 |
  | 19 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(일
  괄 채점 후) 전환을 구현 |
  | 20 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/검증 규칙(JSON shape validate) | FE | C | 잘못된/
  legacy 데이터로 인한 런타임 오류와 UX 꼬임을 방지 |
  | 21 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 저장된 상태를 UI
  상태로 재구성 |
  | 22 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial(부분 제출) 호환/정책 | FE | C | 기존
  submissions 일부 저장 데이터가 bulk UX와 충돌하는 문제를
  분리 |
  | 23 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장된 결과/
  답안을 삭제 |
  | 24 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  즉시 초기화되지 않아 UI 리셋이 필요 |
  | 25 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장(문자열 줄바꿈 금지) | QA | C | 자동 파
  싱/병합 파이프라인을 위해 산출물 JSON 형식을 실제로 보장
  |
  | 26 | LEARN_JSON_VALIDATE_PARSE | Graph Patch JSON 파싱
  검증(파서 통과 확인) | QA | P | “strict JSON” 준수 여부를
  자동으로 확인할 단일 체크 동작이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_UI_DISABLED_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_BUILD_ANSWER_STATE_MAP,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출을 제거하
  고 단일 채점 버튼을 추가한 뒤, 정규화 기반 allAnswered로
  disabled를 안정화 |
  | 2 | STEP_BULK_GRADE_DISPLAY_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT,
  LEARN_AFTER_GRADE_EDIT_POLICY,
  LEARN_GRADE_BUTTON_LABEL_STATE | gradeAll 결과를 result
  맵으로 고정하고 hasGraded 게이팅 하에 점수/정답을 표시,
  채점 후 편집 정책에 따라 버튼 상태를 정합화 |
  | 3 | STEP_STORAGE_FLOW | 저장/복원/legacy 처리 |
  LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
  LEARN_IDENTIFY_STORAGE_KEY,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존 저장
  계약을 이해한 뒤 bulk 스키마로 저장/복원하고 legacy
  partial을 감지/정책화 |
  | 4 | STEP_RESET_FLOW | 다시 풀기(키 삭제+UI 리셋) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |
  | 5 | STEP_OUTPUT_STRICT_JSON_FLOW | 산출물 strict JSON
  보장 | LEARN_STRICT_JSON_OUTPUT_GUARD,
  LEARN_JSON_VALIDATE_PARSE | 결합 패치 검증/병합이 가능하
  도록 JSON 문자열 줄바꿈 금지 및 파싱 검증을 수행 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장 대상 키를 모르면 저장
  위치가 달라져 저장/복원/초기화가 불일치함 | 0.72 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 특정 키에서 읽어
  야 하므로 키 계약이 선행되어야 함 | 0.72 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_RESET_CLEAR_STORAGE | 초기화는 삭제 대상 키를 알아
  야 수행 가능 | 0.72 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 “입력됨/미입력” 기준을 먼저 고정해야 함 |
  0.82 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | result 맵은 문제별 채점 결과가
  있어야 생성 가능 | 0.78 |
  | 6 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 X/N은 problemId별 결과 집계가 선행되어야 계산 가능 |
  0.76 |
  | 7 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  problemId별 결과가 선행되어야 함 | 0.78 |
  | 8 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 “채점됨” 상태
  (hasGraded 등) 없이 구현할 수 없음 | 0.76 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 계약이 먼저 필요 | 0.80 |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 UI 상태를 재구성하므로 선행 필요 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 submitProblem/저장
  흐름을 알면 제거 시 사이드이펙트 회귀를 줄일 수 있음 |
  0.65 |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 submissions 계약을
  이해해야 bulk 저장 계약/호환 정책이 안정화 | 0.74 |
  | 3 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 엣지케이스 벡터가 있으면
  disabled/정규화 불일치 회귀가 감소 | 0.76 |
  | 4 | LEARN_BUILD_ANSWER_STATE_MAP →
  LEARN_ALL_ANSWERED_NORMALIZED | 답안 상태 표현을 안정화하
  면 allAnswered 계산이 단순/견고해짐 | 0.72 |
  | 5 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 UI는 독립 구현 가능하
  지만, disabled까지 함께 설계하면 UX가 빨리 안정화 | 0.65
  |
  | 6 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 UI와 액션을 함께 설계하는 것이 안전 | 0.70 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 보통 gradeAll 완료 시 hasGraded
  를 세팅하는 흐름이 자연 | 0.74 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능하지만, 표시
  시점은 게이팅과 함께 설계하는 것이 혼란을 줄임 | 0.70 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과 표시는 채점 후에만
  노출되도록 게이팅과 함께 설계 권장 | 0.70 |
  | 10 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | validate를 복원 파이프
  라인에 넣으면 parse/legacy 오류로 인한 회귀가 감소 | 0.78
  |
  | 11 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial은 조건부
  이므로 발견 시 정책 적용 흐름을 권장 | 0.74 |
  | 12 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 화면이 남아 UX가 어긋나므로 함께 수행을
  권장 | 0.78 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADE_BUTTON_LABEL_STATE | 편집 정책에 따라 버튼이
  “다시 채점/채점하기”로 일관되게 전환됨 | 0.70 |
  | 14 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  LEARN_JSON_VALIDATE_PARSE | 가드(규칙)만 두지 말고 실제
  파싱 검증으로 준수 여부를 확인하는 것이 안전 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI는
  원문 입력을 보고, grading은 정규화 입력을 보는 불일치로
  disabled/채점이 엇갈림 |
  normalizeNumericInput(answer).length>0를 단일 기준으로 고
  정하고 모든 판정에서 재사용 | 0.82 |
  | 2 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", ".",
  "Infinity" 등에서 “미입력/입력” 기대가 모호해 구현이 흔들
  림 | 엣지케이스를 테스트 벡터로 문서화하고 normalize 결과
  기반 기대값을 명시 | 0.76 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems[] 기준으로 계산(useMemo)하고 로딩/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 4 | LEARN_BUILD_ANSWER_STATE_MAP | 문제 ID 매칭/상태 업
  데이트가 꼬여 특정 문제 답이 누락/덮어씀 |
  answerByProblemId는 problemId 키로만 갱신하고 problems 변
  경 시 정합성 점검 | 0.70 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 state 업
  데이트를 섞어 사이드이펙트/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 6 | LEARN_BUILD_RESULT_MAP | 결과를 problemId로 정렬하
  지 못해 점수/표시/저장 키가 어긋남 | resultByProblemId를
  단일 중간 표현으로 두고 모든 집계/표시에 동일 키를 사용 |
  0.74 |
  | 7 | LEARN_GRADED_STATE_FLAG | hasGraded의 의미(gradeAll
  완료 vs 복원됨 vs partial)가 불명확해 게이팅이 꼬임 |
  “bulk 결과 존재 시 graded” 등 단일 정의를 정하고 저장/복
  원 시 동일 기준 적용 | 0.74 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 노
  출, legacy partial 노출 등 표시 기준 혼란 | 점수/정오/정
  답 표시는 hasGraded일 때만 노출하도록 단일 게이팅 규칙 적
  용 | 0.74 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과만
  저장 등 스키마가 흔들리면 복원/게이팅이 연쇄로 흔들림 |
  answers+results(+updatedAt/+version) 최소 계약을 먼저 고
  정하고 이를 기준으로 구현 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 일부 저장 데이터가 bulk UX에서 “채점됨”처럼
  보이거나 allAnswered와 충돌 | partial 감지(저장된 문제 수
  < problems.length) 후 정책(초기화/재채점 유도)을 명시 |
  0.74 |
  | 11 | LEARN_RESET_UI_STATE | 키 삭제만 수행해 화면에 이
  전 answer/result/flags가 남아 “초기화”가 체감되지 않음 |
  reset 액션에서 localStorage 삭제와 UI 상태 리셋을 함께 수
  행 | 0.78 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 내부 줄바
  꿈 때문에 JSON 파싱이 실패해 결합 패치 검증/병합이 중단됨
  | 모든 문자열을 한 줄로 유지(또는 \n 이스케이프)하고
  LEARN_JSON_VALIDATE_PARSE로 파싱 통과를 확인 | 0.84 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새 제출 진입점(UI)을 먼저 제공해 기능 공백을 방
  지 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 기준 정의에서 UI로 점프하
  지 않고 “활성 조건 계산”을 중간에 둠 |
  | 3 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴하므로 기준 노드가 브릿
  지 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계의 공통 입력을 result 맵으로 정규화 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  문제별 표시도 동일한 result 맵을 중간 입력으로 사용 |
  | 6 | LEARN_GRADED_STATE_FLAG → LEARN_SCORE_SUMMARY_CALC
  | LEARN_SCORE_AND_RESULT_GATING | 계산과 표시 시점을 분리
  해 채점 전 노출을 차단 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 결과 표시는 게이팅을 중간
  에 두어 조기 노출을 방지 |
  | 8 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 schema 이해→새
  schema 계약→legacy 정책으로 연결하면 충돌이 줄어듦 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 전에 validate를
  두면 파싱 실패/누락 필드로 인한 회귀가 감소 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 저장된
  키 삭제 후 UI 리셋으로 이어지는 초기화 흐름이 자연 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_SUMMARY_CALC | LEARN_GRADE_BUTTON_LABEL_STATE
  | 정책을 버튼 상태 전환으로 연결하면 사용자가 “다시 채점”
  필요를 이해하기 쉬움 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD → Graph Patch JSON
  출력 | LEARN_JSON_VALIDATE_PARSE | 가드만 두지 말고 파서
  통과 검증을 중간에 둬서 “실제 strict”를 보장 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type":
  "micro", "name_ko": "localStorage 키 포맷 식별",
  "domain": "FE", "rep": "C", "confidence": 0.72 },
  { "id": "LEARN_BUILD_ANSWER_STATE_MAP", "type":
  "micro", "name_ko": "answerByProblemId 상태 맵 유지",
  "domain": "FE", "rep": "P", "confidence": 0.72 },
  { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
  { "id": "LEARN_JSON_VALIDATE_PARSE", "type": "micro",
  "name_ko": "Graph Patch JSON 파싱 검증(파서 통과 확인)",
  "domain": "QA", "rep": "P", "confidence": 0.84 },
  { "id": "STEP_BULK_UI_DISABLED_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_DISPLAY_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_STORAGE_FLOW", "type": "step",
  "name_ko": "저장/복원/legacy 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_FLOW", "type": "step", "name_ko":
  "다시 풀기(키 삭제+UI 리셋)", "domain": "FE", "rep": "C",
  "confidence": 0.72 },
  { "id": "STEP_OUTPUT_STRICT_JSON_FLOW", "type":
  "step", "name_ko": "산출물 strict JSON 보장", "domain":
  "QA", "rep": "C", "confidence": 0.84 }
  ],
  "add_edges": [
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.72 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires", "reason": "흐름 요약과 스키마 문서화는 병렬로
  도 가능해 requires 잠금은 과잉", "confidence": 0.72 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 UI는 allAnswered 구현과 독립적으로 가능하
  므로 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "validate는 안정성을 높이는 권장 선행이며 복원
  의 필수 잠금은 아님", "confidence": 0.78 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부이므로 requires가 아니
  라 권장/노트가 적절", "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원된 결과 존재로 hasGraded를 파생할 수 있어 단일 잠금
  은 과잉", "confidence": 0.70 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
  ],
  "notes": [
  { "claim": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE는 복원
  안정성을 높이는 권장 선행이며 requires로 잠그지 않는다.",
  "reason": "parse/shape validation이 없어도 복원은 가능하
  지만, 잘못된 데이터로 인한 런타임 오류를 줄이려면
  validate 단계가 유용하다.", "confidence": 0.78 },
  { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "모든 사용자에게 legacy 데이터가 존재하는 것은
  아니므로 requires 잠금은 과잉 선행이 될 수 있다.",
  "confidence": 0.74 },
  { "claim": "완전 초기화 UX는
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만 수행하면
  화면에 남아있는 answer/result/flags가 그대로여서 사용자가
  초기화를 체감하지 못한다.", "confidence": 0.78 },
  { "claim": "LEARN_GRADE_BUTTON_LABEL_STATE는 채점 후
  편집 정책을 사용자가 이해하는 데 도움이 된다.", "reason":
  "입력 변경 시 결과를 초기화하는 경우 버튼을 "다시 채점
  "으로 전환하면 스테일 결과를 줄이고 다음 행동을 안내한
  다.", "confidence": 0.70 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력하고, LEARN_JSON_VALIDATE_PARSE로
  파싱 통과를 확인한다.", "reason": "reviewer 지적처럼 JSON
  파싱 실패는 결합 패치 검증/병합 파이프라인을 중단시킨
  다.", "confidence": 0.84 },
  { "claim": "R3 Transfer 산출물은 FE/UX 티켓에서는 상
  태 전이(입력→활성화→채점→저장→복원→초기화) 예시로 대체하
  거나 N/A를 명시하는 방식이 적합하다.", "reason": "problem
  templates/triplets은 도메인 부적합일 수 있어 reviewer 권
  고대로 도메인 맞춤 전이 근거로 전환하는 편이 안전하다.",
  "confidence": 0.74 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 제출/저장 흐름 기준선 요약 | 현재는
  문제별 제출→단건 채점→submissions merge 저장 구조라, bulk
  전환 시 무엇이 바뀌는지 기준선이 필요 | 높음 |
  | 2 | StoredResult(submissions) 스키마 명시 |
  localStorage
  저장/복원 계약이 명시되지 않으면 bulk 저장으로 전환 시 호
  환/마이그레이션 규칙이 흔들림 | 높음 |
  | 3 | 문제 카드별 제출 버튼 제거 | 요구사항 1) 핵심인데
  현
  재 UI는 per-problem 제출에 고정 | 높음 |
  | 4 | 하단 단일 채점하기(전체 제출) 버튼 | 요구 UX의 유일
  한 진입점이 필요하나 현재 없음 | 높음 |
  | 5 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 활성/비활성이 채점과 엇갈림 | 높음 |
  | 6 | allAnswered 계산(정규화 기반) | problems[] 전체를
  기
  준으로 “모두 입력됨”을 안정적으로 계산해야 함(로딩 타이
  밍/
  문제 수 변화 포함) | 높음 |
  | 7 | 입력 엣지케이스 10+ 정의 | AC 요구 충족을 위해 최소
  벡터가 필요(예: "", " ", ",", " , ", "0", "-0", "1,234",
  "
  1 234 ", "+", ".", "Infinity" 등) | 중 |
  | 8 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 submitProblem(problem)로 단건 채점만 가능해 bulk 채점
  동작이 없음 | 높음 |
  | 9 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 점수/정답 노출(0/N) 및 복원 후 표시 기준 혼란을 막기
  위
  해 필요 | 중 |
  |10| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노출
  해야 UX가 일관되고 legacy partial 데이터 혼선을 줄임 | 중
  |
  |11| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 개별 제출이 아니라 일괄 채점 후로 바뀌어야 함 |
  높음 |
  |12| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 복원
  해 상태를 재구성해야 함 | 높음 |
  |13| legacy partial 호환/정책 | 기존 per-problem 저장은
  submissions 일부만 남기는 데이터가 정상으로 생성되므로,
  bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |14| 다시 풀기(초기화): 키 삭제 + UI 리셋 | 요구사항 4)이
  며 키 삭제만으로는 화면이 즉시 초기화되지 않음 | 높음 |
  |15| strict JSON 산출 가드 | reviewer 지적처럼 문자열 내
  부
  줄바꿈이 있으면 파싱/병합이 실패하므로 산출물 JSON은
  strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | R3 Transfer 템플릿/트리플릿 강제 | 본 티켓은 FE/UX
  개선이며 problem templates/triplets은 도메인 부적합(또는
  N/A 처리 필요) | N/A 명시 또는 최소 전이(상태 전이) 예시
  로
  대체 |
  | 2 | 서버 연동/DB 저장 | Out of Scope 위반, localStorage
  요구를 흐림 | 금지 |
  | 3 | 문제 타입 확장(서술형/객관식) | 이번 티켓 범위를 벗
  어남 | 금지(후속 티켓) |
  | 4 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하며 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 5 | 문제은행 JSON 스키마 변경 | 데이터 구조 변경은 범위
  밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 6 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 버튼/액션 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 표시/disabled와
  충
  돌 | partial 감지 후 정책(초기화/답안만 복원/재채점 유도)
  |
  | 4 | 점수 표시 → 채점 UX | 채점 전 0/N 노출은 “이미 채점
  됨” 오해 유발 | hasGraded 도입 후 채점 후에만 점수/정답
  표
  시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남은 answer/result/flags가 그대로 | 키 삭제 + UI
  리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙(JSON
  shape
  validate)", "domain": "FE", "rep": "C", "confidence":
  0.78 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 호
  환/정책", "domain": "FE", "rep": "C", "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "R3 Transfer 산출물은 본 티켓(UX/FE)에서는
  problem templates/triplets 대신 상태 전이(입력→활성화→채
  점
  →저장→복원→초기화) 전이 예시로 대체하거나 N/A를 명시하는
  방식이 적합하다.", "reason": "reviewer도 FE/UX 티켓에서
  Transfer 항목을 N/A 처리 또는 도메인 맞춤 예시로 대체하라
  고 권고했다.", "confidence": 0.74 },
  { "claim": "legacy partial(부분 제출) 데이터는 bulk 전
  환 시 필연적으로 존재할 수 있어 복원 단계에서 감지/정책화
  가 필요하다.", "reason": "기존 per-problem 저장은 전체 문
  제 수보다 적은 submissions를 남기는 것이 정상 동작이었
  다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch는 enables/analog_of만 포함
  - Requires 사이클: Pass — R3 requires 미추가(타입 스캔으로
    자체 점검)
  - level 미제안: Pass — level/min_level 필드 미포함
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — R3는 enables/analog_of만
    제안하여 잠금 충돌 없음
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — transfer/templates/triplets + appendix(R2 원문) +
    QA 포함

  [/R3 Transfer Report]

  ###DONE:16e1580719###


› Summarize recent commits

  41% context left · ? for shortcuts


============================================================
[2026-01-08 12:23:23] RESEARCH3 (req_id: 147ec46891)
============================================================
  기
  준으로 “모두 입력됨”을 안정적으로 계산해야 함(로딩 타이
  밍/
  문제 수 변화 포함) | 높음 |
  | 7 | 입력 엣지케이스 10+ 정의 | AC 요구 충족을 위해 최소
  벡터가 필요(예: "", " ", ",", " , ", "0", "-0", "1,234",
  "
  1 234 ", "+", ".", "Infinity" 등) | 중 |
  | 8 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 submitProblem(problem)로 단건 채점만 가능해 bulk 채점
  동작이 없음 | 높음 |
  | 9 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 점수/정답 노출(0/N) 및 복원 후 표시 기준 혼란을 막기
  위
  해 필요 | 중 |
  |10| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노출
  해야 UX가 일관되고 legacy partial 데이터 혼선을 줄임 | 중
  |
  |11| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 개별 제출이 아니라 일괄 채점 후로 바뀌어야 함 |
  높음 |
  |12| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 복원
  해 상태를 재구성해야 함 | 높음 |
  |13| legacy partial 호환/정책 | 기존 per-problem 저장은
  submissions 일부만 남기는 데이터가 정상으로 생성되므로,
  bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |14| 다시 풀기(초기화): 키 삭제 + UI 리셋 | 요구사항 4)이
  며 키 삭제만으로는 화면이 즉시 초기화되지 않음 | 높음 |
  |15| strict JSON 산출 가드 | reviewer 지적처럼 문자열 내
  부
  줄바꿈이 있으면 파싱/병합이 실패하므로 산출물 JSON은
  strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | R3 Transfer 템플릿/트리플릿 강제 | 본 티켓은 FE/UX
  개선이며 problem templates/triplets은 도메인 부적합(또는
  N/A 처리 필요) | N/A 명시 또는 최소 전이(상태 전이) 예시
  로
  대체 |
  | 2 | 서버 연동/DB 저장 | Out of Scope 위반, localStorage
  요구를 흐림 | 금지 |
  | 3 | 문제 타입 확장(서술형/객관식) | 이번 티켓 범위를 벗
  어남 | 금지(후속 티켓) |
  | 4 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하며 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 5 | 문제은행 JSON 스키마 변경 | 데이터 구조 변경은 범위
  밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 6 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 버튼/액션 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 표시/disabled와
  충
  돌 | partial 감지 후 정책(초기화/답안만 복원/재채점 유도)
  |
  | 4 | 점수 표시 → 채점 UX | 채점 전 0/N 노출은 “이미 채점
  됨” 오해 유발 | hasGraded 도입 후 채점 후에만 점수/정답
  표
  시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남은 answer/result/flags가 그대로 | 키 삭제 + UI
  리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙(JSON
  shape
  validate)", "domain": "FE", "rep": "C", "confidence":
  0.78 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 호
  환/정책", "domain": "FE", "rep": "C", "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "R3 Transfer 산출물은 본 티켓(UX/FE)에서는
  problem templates/triplets 대신 상태 전이(입력→활성화→채
  점
  →저장→복원→초기화) 전이 예시로 대체하거나 N/A를 명시하는
  방식이 적합하다.", "reason": "reviewer도 FE/UX 티켓에서
  Transfer 항목을 N/A 처리 또는 도메인 맞춤 예시로 대체하라
  고 권고했다.", "confidence": 0.74 },
  { "claim": "legacy partial(부분 제출) 데이터는 bulk 전
  환 시 필연적으로 존재할 수 있어 복원 단계에서 감지/정책화
  가 필요하다.", "reason": "기존 per-problem 저장은 전체 문
  제 수보다 적은 submissions를 남기는 것이 정상 동작이었
  다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch는 enables/analog_of만 포함
  - Requires 사이클: Pass — R3 requires 미추가(타입 스캔으로
    자체 점검)
  - level 미제안: Pass — level/min_level 필드 미포함
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — R3는 enables/analog_of만
    제안하여 잠금 충돌 없음
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — transfer/templates/triplets + appendix(R2 원문) +
    QA 포함

  [/R3 Transfer Report]

  ###DONE:16e1580719###


› 터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_147ec46891.md


  41% context left



› Request 147ec46891: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_147ec46891.md



• Explored
                               
• Running wc -l .agents/inbox/ esearch_147ec46891.md 
                               
    Search ## Graph Patch JSON in research_147ec46891.m 
                                           
                                 
    Search \[/R2 Progressi              
r                     
    Search \[/R1 Coverage Report\] i                        


• Ran wc -l .agents/inbox/research_147ec46891.md
  └ 863 .agents/inbox/research_147ec46891.md

  │ … +8 lines

◦ Extracting segments with Python (2m 59s • esc to interrupt


› Summarize recent commits

  41% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 84, 150
  │ … +8 lines
  └ [Previous Researcher Handoff (R2 Progression Report)]
    ## Micro Skill Decomposition
    … +66 lines
    |
      LEARN_STORE_RESULT_SCHEMA_BULK,

  │ … +8 lines

◦ Extracting segments with Python (3m 06s • esc to interrupt


› Summarize recent commits

  41% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 151, 217
  │ … +8 lines
  └   LEARN_BUILD_SUBMISSIONS_PAYLOAD,
      LEARN_LOCALSTORAGE_SAVE_BULK,
    … +67 lines
    판
      정에 반영되어야 함 | 0.72 |

  │ … +8 lines

◦ Extracting segments with Python (3m 11s • esc to interrupt


› Summarize recent commits

  40% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 218, 284
  │ … +8 lines
  └   | 10 | LEARN_RESET_UI_STATE →
      LEARN_ALL_ANSWERED_NORMALIZED | reset 후 allAnswered가
    … +65 lines

      | # | Long Edge | 제안 Bridge Node | 이유 |

  │ … +8 lines

◦ Extracting segments with Python (3m 16s • esc to interrupt


› Summarize recent commits

  40% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 285, 351
  │ … +8 lines
  └   |---|-----------|-----------------|------|
      | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
    … +65 lines
      "rep": "C", "confidence": 0.72 }
        ],

  │ … +8 lines

• Extracting segments with Python (3m 23s • esc to interrupt


› Summarize recent commits

  40% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 352, 418
  │ … +8 lines
  └     "add_edges": [
          { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE",
    … +67 lines
      "LEARN_RESET_UI_STATE", "type": "requires", "reason":
    "키

  │ … +8 lines

• Extracting segments with Python (3m 27s • esc to interrupt


› Summarize recent commits

  39% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 419, 485
  │ … +8 lines
  └   삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은
    과
    … +68 lines
      변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음
    |

  │ … +8 lines

◦ Extracting segments with Python (3m 33s • esc to interrupt


› Summarize recent commits

  38% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 486, 552
  │ … +8 lines
  └   | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX
    의
    … +67 lines
      가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 구
    현

  │ … +8 lines

• Extracting segments with Python (3m 42s • esc to interrupt


› Summarize recent commits

  38% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 553, 619
  │ … +8 lines
  └   후
      제거 |
    … +65 lines
      "domain": "FE", "rep": "P" },
      { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",

  │ … +8 lines

• Extracting segments with Python (3m 48s • esc to interrupt


› Summarize recent commits

  38% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 620, 686
  │ … +8 lines
  └   "name_ko": "총점 X/N 집계 로직", "domain": "FE",
    "rep":
    … +64 lines
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
      "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },

  │ … +8 lines

• Extracting segments with Python (3m 53s • esc to interrupt


› Summarize recent commits

  37% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 687, 753
  │ … +8 lines
  └   { "from": "LEARN_BUILD_RESULT_MAP", "to":
      "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
    … +63 lines
      - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
        LEARN_DOCUMENT_STORED_RESULT_SCHEMA,

  │ … +8 lines

• Extracting segments with Python (3m 58s • esc to interrupt


› Summarize recent commits

  37% context left · ? for shortcuts


• Ran python - <<'PY'
  │ path = '.agents/inbox/research_147ec46891.md'
  │ start, end = 754, 776
  │ … +8 lines
  └     LEARN_IDENTIFY_STORAGE_KEY,
        LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    … +19 lines

      [/R2 Progression Report]

  │ … +274 lines

◦ Assembling output and ensuring accuracy (6m 17s • esc to i


› Summarize recent commits

  33% context left · ? for shortcuts


• Ran python - <<'PY'
  │ import json
  │ obj = {
  │ … +274 lines
  └ ok 21 28

  │ … +284 lines

◦ Assembling output and ensuring accuracy (7m 30s • esc to i


› Summarize recent commits

  31% context left · ? for shortcuts


• Ran python - <<'PY'
  │ import json
  │ obj = {
  │ … +284 lines
  └ ok 21 30

─ Worked for 8m 14s ────────────────────────────────────────

• ###BEGIN:147ec46891###

  ## Transfer Edge Analysis

  ### Enables Edges (스킬 → 상위 문항 구조)

  | # | From | To | transfer 이유 | confidence |
  |---|------|----|--------------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT |
  PATTERN_SINGLE_CTA_BULK_GRADE | 개별 제출 제거는 단일 CTA
  기반 제출/채점 구조로 전이된다. | 0.78 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON |
  PATTERN_SINGLE_CTA_BULK_GRADE | 하단 1버튼은 bulk 채점의
  유일 진입점 구조를 만든다. | 0.84 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE |
  PATTERN_IS_ANSWERED_PREDICATE_CONTRACT | 정규화 기반 입력
  됨 predicate를 명시하면 disabled/채점 기준 불일치를 제거한
  다. | 0.82 |
  | 4 | LEARN_DEFINE_IS_ANSWERED_PREDICATE |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 입력됨 기준을 고정
  하면 allAnswered/disabled 게이트가 일관되게 동작한다. |
  0.84 |
  | 5 | LEARN_ALL_ANSWERED_NORMALIZED |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 정규화된
  allAnswered 계산은 “모두 입력 전 비활성” 게이트를 안정화한
  다. | 0.78 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION |
  PATTERN_BATCH_GRADE_PIPELINE | 문제 컬렉션을 순회해 일괄
  채점하면 submissions를 생성하는 배치 파이프라인으로 전이된
  다. | 0.80 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION |
  PATTERN_CANONICAL_RESULT_MAP | 일괄 채점 결과를 problemId
  키로 정렬하면 결과맵 중간표현으로 확장된다. | 0.74 |
  | 8 | LEARN_SCORE_SUMMARY_CALC |
  PATTERN_SCORE_SUMMARY_AGGREGATION | X/N 집계를 결과맵 기반
  으로 고정하면 상단 요약 구조가 안정화된다. | 0.74 |
  | 9 | LEARN_GRADED_STATE_FLAG |
  PATTERN_POST_GRADE_VISIBILITY_GATING | hasGraded는 채점 후
  에만 결과를 노출하는 가시성 게이트 구조를 가능하게 한다. |
  0.78 |
  | 10 | LEARN_SCORE_AND_RESULT_GATING |
  PATTERN_POST_GRADE_VISIBILITY_GATING | 게이팅 규칙을 명시
  하면 채점 전 0/N 또는 정답 선노출 혼선을 줄인다. | 0.76 |
  | 11 | LEARN_SHOW_PER_PROBLEM_RESULT |
  PATTERN_PER_PROBLEM_FEEDBACK_RENDER | 문제별 정오/정답 표
  시를 채점 후에만 렌더하는 구조로 전이된다. | 0.76 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 저장 계약이 있어
  야 채점 후 1회 저장 스냅샷을 안정적으로 직렬화할 수 있다.
  | 0.78 |
  | 13 | LEARN_BUILD_SUBMISSIONS_PAYLOAD |
  PATTERN_CANONICAL_SUBMISSIONS_PAYLOAD | UI 상태를 저장 스
  키마에 맞는 submissions payload로 변환하는 중간표현이 생긴
  다. | 0.80 |
  | 14 | LEARN_BUILD_SUBMISSIONS_PAYLOAD |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | payload 생성은 저
  장 단계(setItem)로 전이되는 핵심 브릿지다. | 0.74 |
  | 15 | LEARN_LOCALSTORAGE_SAVE_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 채점 직후 1회 저
  장을 고정하면 partial/merge 충돌이 줄고 복원 일관성이 높아
  진다. | 0.72 |
  | 16 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  PATTERN_RESTORE_VALIDATE_REHYDRATE | 복원은 parse/검증/
  rehydrate 파이프라인으로 구조화해야 런타임 오류를 줄일 수
  있다. | 0.76 |
  | 17 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  PATTERN_LEGACY_PARTIAL_POLICY_BRANCH | 기존 partial
  submissions가 있을 수 있으므로 복원 단계에서 감지 후 정책
  분기가 필요하다. | 0.74 |
  | 18 | LEARN_RESET_UI_STATE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | 저장소 삭제와 UI 상태
  리셋을 결합해야 초기화 UX가 즉시 반영된다. | 0.80 |
  | 19 | LEARN_AFTER_GRADE_EDIT_POLICY |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 채점 후 수정 정책
  은 결과를 무효화하고 재채점을 유도하는 흐름 설계를 가능하
  게 한다. | 0.76 |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | PATTERN_NORMALIZED_COMPLETENESS_GATE |
  STRUCT_PREDICATE_GATED_ACTION | derived
  predicate(allAnswered)로 CTA를 게이트하는 구조가 동일하다.
  | 0.74 |
  | 2 | PATTERN_POST_GRADE_VISIBILITY_GATING |
  STRUCT_PREDICATE_GATED_ACTION | 플래그(hasGraded)로 가시
  성/행동을 제어하는 게이트 구조가 동형이다. | 0.72 |
  | 3 | PATTERN_BATCH_GRADE_PIPELINE |
  STRUCT_REDUCE_TO_KEYED_MAP | 문제 컬렉션을 순회/reduce하여
  keyed 결과(submissions)로 변환하는 구조가 동형이다. | 0.76
  |
  | 4 | PATTERN_CANONICAL_RESULT_MAP |
  STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION | 중간표현을
  canonical map으로 고정해 집계/표시/저장을 단순화하는 구조
  가 같다. | 0.72 |
  | 5 | PATTERN_ID_KEYED_STATE_MAP |
  STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION | answer/
  result를 problemId 키 map으로 고정하는 중간표현 구조가 동
  일하다. | 0.70 |
  | 6 | PATTERN_CANONICAL_SUBMISSIONS_PAYLOAD |
  STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION | 저장용
  payload를 표준 형태로 고정해 후속 처리를 단순화하는 구조가
  같다. | 0.70 |
  | 7 | PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | 버전/스키마를 포함한
  스냅샷 저장은 향후 검증·마이그레이션 구조로 전이된다. |
  0.68 |
  | 8 | PATTERN_RESTORE_VALIDATE_REHYDRATE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | restore 시 validate
  후 rehydrate/reset 분기하는 구조가 동일하다. | 0.72 |
  | 9 | PATTERN_LEGACY_PARTIAL_POLICY_BRANCH |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | legacy/partial 데이
  터를 감지해 정책 분기하는 구조는 마이그레이션 패턴과 동형
  이다. | 0.68 |
  | 10 | PATTERN_EDIT_INVALIDATES_AND_REGRADES |
  STRUCT_CACHE_INVALIDATION_ON_MUTATION | 입력 변경 이벤트가
  기존 결과를 무효화하고 재계산을 요구하는 구조가 동형이다.
  | 0.74 |
  | 11 | PATTERN_RESET_CLEAR_STORAGE_AND_UI |
  STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE | persisted
  state 제거와 view state 재수화를 함께 수행해야 일관성이 유
  지된다. | 0.72 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답
  생성 규칙 |
  |---|---------|------------------|-----------|------------
  ---|
  | 1 | 정규화 기반 입력됨 predicate | answer:문자열(공백/콤
  마/부호 포함) | isAnswered = len(normalize(answer))>0 |
  raw 길이로 판정, trim만 적용, "0"를 미입력 처리 |
  | 2 | allAnswered 기반 disabled 게이트 | N:1~60, answers[]
  | disabled = not all_i(isAnswered(ans_i)) | problems 로딩
  중 enabled, 빈 배열에서 true 처리 |
  | 3 | 단일 CTA bulk 채점 진입 | hasGraded:bool,
  disabled:bool | CTA 클릭→gradeAll 실행(only if !disabled)
  | per-problem submit 잔존, 조건 없이 gradeAll 호출 |
  | 4 | gradeAll 배치 파이프라인 | problems[], answersMap,
  gradeFn | submissions = map(problemId→grade(norm(answer)))
  | 순회 중 setState 혼합, key mismatch, 빈값도 채점 |
  | 5 | 결과맵 기반 점수 집계 X/N | submissions or
  resultMap, N | X=sum(isCorrect), N=problems.length | N을
  제출 개수로 계산, partial에 끌려감 |
  | 6 | 채점 후 가시성 게이팅 | hasGraded, submissions |
  showScore/results = hasGraded | 채점 전 0/N 노출, 정답 선
  노출, 복원 flag 누락 |
  | 7 | 문제별 피드백 렌더 | problems[], submissions |
  render(problemId) from submissions[problemId] | index 기반
  접근, 정렬 변경 시 오표시 |
  | 8 | 저장용 submissions payload 생성 | answersMap,
  submissions, schema | payload = {version, updatedAt,
  submissions} | merge 저장, schema 누락, nodeId 미포함 |
  | 9 | 채점 후 1회 저장 스냅샷 | nodeId, payload |
  setItem(key(nodeId), JSON.stringify(payload)) | per-
  problem 저장, 저장 시점 분산, overwrite 미사용 |
  | 10 | 복원 parse→validate→rehydrate | storedStr,
  problemsLen | invalid→reset; legacy partial→policy; else
  restore state | parse 크래시, partial을 graded로 오인, 길
  이 불일치 무시 |
  | 11 | 초기화(저장+UI 동기화) | stored 존재, UI state |
  removeItem + clear answers/submissions/hasGraded | storage
  만 삭제하고 화면 잔상 유지 |

  ### 상세 템플릿 예시 (3개)

  Template 1: 정규화 기반 입력됨 predicate + allAnswered
  disabled 게이트
  - Parameters: { N: [1,60], answers: ["", "   ", ",",
  "1,234", "0", "+", ".", "Infinity"], normalize:
  normalizeNumericInput }
  - Answer: isAnswered(a)=normalize(a).length>0; disabled
  = !all_i(isAnswered(answers[i]))
  - Distractors: [raw input length로 판정, trim만 적용,
  "0"를 미입력 처리, problems 로딩 중 enabled]
  - Required Skills: [LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_ADD_BULK_GRADE_BUTTON]

  Template 2: gradeAll 배치 파이프라인 → submissions payload
  → 1회 저장
  - Parameters: { problems: [1..60], answersMap, gradeFn,
  schemaVersion: [1,2], nodeId: ["nA","nB"] }
  - Answer: submissions = reduce(problems,
  (acc,p)=>acc[p.id]=gradeFn(normalize(answersMap[p.id])));
  payload={version,updatedAt,submissions};
  setItem(key(nodeId), JSON.stringify(payload))
  - Distractors: [순회 중 setState 혼합, key mismatch, per-
  problem merge 저장으로 partial 생성, version 누락]
  - Required Skills: [LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK]

  Template 3: 복원 parse→validate→legacy partial 정책
  →rehydrate
  - Parameters: { storedStr: [validJSON, invalidJSON,
  legacyPartialJSON], problemsLen: [1,60], policy:
  ["reset","restoreAnswersOnly","forceRegrade"] }
  - Answer: parsed=safeParse(storedStr); if !
  validShape(parsed) -> reset; else if
  isLegacyPartial(parsed, problemsLen) -> policyBranch; else
  restore submissions+hasGraded
  - Distractors: [JSON.parse 예외로 런타임 크래시, partial을
  graded로 오인, 문제 수 변경 미처리]
  - Required Skills: [LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_GRADED_STATE_FLAG]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 조건 충족 전 잠금 해제 | 필수 항목 입력 전 제출 버튼
  비활성 | required 필드 누락 시 commit 차단 | 모든 점 지정
  전 계산 버튼 비활성 |
  | 2 | 배치 처리 파이프라인 | 서류를 모아 한 번에 심사 | 레
  코드 배치 잡으로 keyed 결과 생성 | 여러 도형 값을 일괄 계
  산해 요약 |
  | 3 | keyed 중간표현 고정 | 체크리스트를 항목 ID로 관리 |
  id→result 맵으로 집계/표시/저장 | 변/각도 라벨로 값을 맵핑
  후 계산 |
  | 4 | 완료 후 가시성 게이팅 | 완료 후에만 점수/피드백 공개
  | job 완료 플래그 true일 때만 리포트 노출 | 구성 완료 후
  측정값/보조선 표시 |
  | 5 | 버전드 스냅샷 저장/복원 | 임시저장 후 이어하기(구버
  전 변환) | versioned snapshot validate+migrate | 도면 저
  장/로드 시 버전 변환 |
  | 6 | 초기화 동기화(저장+화면) | 취소 시 내역 삭제+화면 초
  기화 | clear cache + reset view state | 초기화 시 파일/화
  면 모두 초기화 |
  | 7 | 편집 시 무효화/재계산 | 주문 수정 시 합계 재계산 필
  요 | mutation 시 캐시 무효화 | 점 이동 시 넓이/둘레 재계산
  |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 조건 충족 전 잠금 해제
  - 생활: 온라인 신청서에서 필수 항목을 모두 입력하기 전까지
  "제출" 버튼이 비활성화된다.
  - 데이터: 파이프라인에서 required 필드가 모두 채워지기 전
  에는 commit 단계가 실행되지 않는다.
  - 도형: 좌표평면에서 다각형의 모든 꼭짓점을 지정하기 전에
  는 "면적 계산" 버튼이 비활성화된다.
  - 공통 스킬: [LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_ADD_BULK_GRADE_BUTTON]

  Triplet 2: 편집 시 무효화/재계산
  - 생활: 채점 후 답을 수정하면 기존 점수는 무효가 되며 다시
  채점을 해야 한다.
  - 데이터: 입력 데이터가 변경되면 캐시된 결과를 무효화하고
  재계산을 수행한다.
  - 도형: 점을 이동하면 이전에 계산한 넓이/둘레는 무효가 되
  어 다시 계산해야 한다.
  - 공통 스킬: [LEARN_AFTER_GRADE_EDIT_POLICY,
  LEARN_GRADED_STATE_FLAG, LEARN_SCORE_AND_RESULT_GATING]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "PATTERN_SINGLE_CTA_BULK_GRADE", "type":
  "micro", "name_ko": "단일 CTA 기반 bulk 채점 진입점",
  "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_IS_ANSWERED_PREDICATE_CONTRACT",
  "type": "micro", "name_ko": "정규화 기반 입력됨 판정
  (predicate) 계약", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "type": "micro", "name_ko": "정규화 기반 완결성 게이트
  (allAnswered→disabled)", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_ID_KEYED_STATE_MAP", "type": "micro",
  "name_ko": "problemId 키 기반 상태맵(answers/results)",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_BATCH_GRADE_PIPELINE", "type":
  "micro", "name_ko": "배치 채점 파이프라인(수집→채점
  →submissions)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_CANONICAL_RESULT_MAP", "type":
  "micro", "name_ko": "problemId 키 결과맵
  (resultByProblemId) 중간표현", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_SCORE_SUMMARY_AGGREGATION", "type":
  "micro", "name_ko": "총점 X/N 집계(문제 수 기준)",
  "domain": "FE", "rep": "C", "lens": ["accumulation"] },
      { "id": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "type": "micro", "name_ko": "채점 후 가시성 게이팅(점수·정
  오·정답)", "domain": "UX", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_PER_PROBLEM_FEEDBACK_RENDER", "type":
  "micro", "name_ko": "문제별 피드백 렌더(정오/정답, 채점
  후)", "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_CANONICAL_SUBMISSIONS_PAYLOAD",
  "type": "micro", "name_ko": "canonical submissions payload
  생성(저장용)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "type": "micro", "name_ko": "버전드 스냅샷 저장(답안+결과,
  채점 후 1회)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_RESTORE_VALIDATE_REHYDRATE", "type":
  "micro", "name_ko": "복원 파이프라인
  (parse→validate→rehydrate)", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "type": "micro", "name_ko": "legacy partial 감지 후 정책
  분기", "domain": "FE", "rep": "C", "lens": ["difference",
  "transform"] },
      { "id": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type":
  "micro", "name_ko": "초기화는 저장소 삭제와 UI 리셋을 함
  께", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "type": "micro", "name_ko": "채점 후 수정 시 결과 무효화
  및 재채점 유도", "domain": "UX", "rep": "C", "lens":
  ["difference", "transform"] },
      { "id": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "micro", "name_ko": "조건식 기반 액션/가시성 게이트",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "STRUCT_REDUCE_TO_KEYED_MAP", "type": "micro",
  "name_ko": "컬렉션을 reduce하여 keyed map 생성", "domain":
  "FE", "rep": "C", "lens": ["transform"] },
      { "id":
  "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION", "type":
  "micro", "name_ko": "정규 중간표현을 고정해 후속 연산을 단
  순화", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "micro", "name_ko": "버전드 스냅샷 검증·마이그레이션",
  "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "STRUCT_CACHE_INVALIDATION_ON_MUTATION",
  "type": "micro", "name_ko": "변경 이벤트로 캐시/결과 무효
  화", "domain": "FE", "rep": "C", "lens": ["difference",
  "transform"] },
      { "id": "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE",
  "type": "micro", "name_ko": "persisted state 삭제 후 view
  state 재수화", "domain": "FE", "rep": "C", "lens":
  ["transform"] }
    ],
    "merge_aliases": [],
    "add_edges": [
      { "from": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "to":
  "PATTERN_SINGLE_CTA_BULK_GRADE", "type": "enables",
  "reason": "개별 제출 제거는 단일 CTA 기반의 제출/채점 구조
  로 전이된다.", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "PATTERN_SINGLE_CTA_BULK_GRADE", "type": "enables",
  "reason": "하단 1버튼은 bulk 채점의 유일 진입점 구조를 만
  든다.", "confidence": 0.84 },
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "PATTERN_IS_ANSWERED_PREDICATE_CONTRACT", "type":
  "enables", "reason": "정규화 기반 입력됨 predicate를 명시
  하면 disabled/채점 기준 불일치를 제거할 수 있다.",
  "confidence": 0.82 },
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "입력됨 기준을 고정하면 allAnswered/disabled 게
  이트가 일관되게 동작한다.", "confidence": 0.84 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "정규화된 allAnswered 계산은 '모두 입력 전 비활
  성' 게이트를 안정화한다.", "confidence": 0.78 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "PATTERN_BATCH_GRADE_PIPELINE", "type": "enables",
  "reason": "문제 컬렉션을 순회해 일괄 채점하면 submissions
  를 생성하는 배치 파이프라인으로 전이된다.", "confidence":
  0.8 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "PATTERN_CANONICAL_RESULT_MAP", "type": "enables",
  "reason": "일괄 채점 결과를 problemId 키로 정렬하면 결과맵
  중간표현으로 확장된다.", "confidence": 0.74 },
      { "from": "LEARN_SCORE_SUMMARY_CALC", "to":
  "PATTERN_SCORE_SUMMARY_AGGREGATION", "type": "enables",
  "reason": "X/N 집계를 결과맵 기반으로 고정하면 상단 요약
  구조가 안정화된다.", "confidence": 0.74 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "hasGraded는 채점 후에만 결과를 노출하는 가시성
  게이트 구조를 가능하게 한다.", "confidence": 0.78 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "게이팅 규칙을 명시하면 채점 전 0/N 또는 정답 선
  노출 같은 혼선을 줄인다.", "confidence": 0.76 },
      { "from": "LEARN_SHOW_PER_PROBLEM_RESULT", "to":
  "PATTERN_PER_PROBLEM_FEEDBACK_RENDER", "type": "enables",
  "reason": "문제별 정오/정답 표시를 채점 후에만 렌더하는 구
  조로 전이된다.", "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "저장 계약이 있어야 채점 후 1회 저장
  스냅샷을 안정적으로 직렬화할 수 있다.", "confidence":
  0.78 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "PATTERN_CANONICAL_SUBMISSIONS_PAYLOAD", "type":
  "enables", "reason": "UI 상태를 저장 스키마에 맞는
  submissions payload로 변환하는 중간표현이 생긴다.",
  "confidence": 0.8 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "payload 생성은 저장 단계(setItem)로
  전이되는 핵심 브릿지다.", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "채점 직후 1회 저장을 고정하면
  partial/merge 충돌이 줄고 복원 일관성이 높아진다.",
  "confidence": 0.72 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "PATTERN_RESTORE_VALIDATE_REHYDRATE", "type": "enables",
  "reason": "복원은 parse/검증/rehydrate 파이프라인으로 구조
  화해야 런타임 오류를 줄일 수 있다.", "confidence": 0.76 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH", "type": "enables",
  "reason": "기존 partial submissions가 있을 수 있으므로 복
  원 단계에서 감지 후 정책 분기가 필요하다.", "confidence":
  0.74 },
      { "from": "LEARN_RESET_UI_STATE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "저장소 삭제와 UI 상태 리셋을 결합해야 초기화 UX
  가 즉시 반영된다.", "confidence": 0.8 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "채점 후 수정 정책은 결과를 무효화하
  고 재채점을 유도하는 흐름 설계를 가능하게 한다.",
  "confidence": 0.76 },
      { "from": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "derived predicate(allAnswered)로
  CTA를 게이트하는 구조가 동일하다.", "confidence": 0.74 },
      { "from": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "플래그(hasGraded)로 가시성/행동을
  제어하는 게이트 구조가 동형이다.", "confidence": 0.72 },
      { "from": "PATTERN_BATCH_GRADE_PIPELINE", "to":
  "STRUCT_REDUCE_TO_KEYED_MAP", "type": "analog_of",
  "reason": "문제 컬렉션을 순회/reduce하여 keyed 결과
  (submissions)로 변환하는 구조가 동형이다.", "confidence":
  0.76 },
      { "from": "PATTERN_CANONICAL_RESULT_MAP", "to":
  "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION", "type":
  "analog_of", "reason": "중간표현을 canonical map으로 고정
  해 집계/표시/저장을 단순화하는 구조가 같다.",
  "confidence": 0.72 },
      { "from": "PATTERN_ID_KEYED_STATE_MAP", "to":
  "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION", "type":
  "analog_of", "reason": "answer/result를 problemId 키 map으
  로 고정하는 중간표현 구조가 동일하다.", "confidence":
  0.7 },
      { "from": "PATTERN_CANONICAL_SUBMISSIONS_PAYLOAD",
  "to": "STRUCT_CANONICAL_INTERMEDIATE_REPRESENTATION",
  "type": "analog_of", "reason": "저장용 payload를 표준 형태
  로 고정해 후속 처리를 단순화하는 구조가 같다.",
  "confidence": 0.7 },
      { "from": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "버전/스키마를 포함한 스냅샷 저장은
  향후 검증·마이그레이션 구조로 전이된다.", "confidence":
  0.68 },
      { "from": "PATTERN_RESTORE_VALIDATE_REHYDRATE", "to":
  "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "restore 시 validate 후 rehydrate/
  reset 분기하는 구조가 동일하다.", "confidence": 0.72 },
      { "from": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "legacy/partial 데이터를 감지해 정
  책 분기하는 구조는 마이그레이션 패턴과 동형이다.",
  "confidence": 0.68 },
      { "from": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "to": "STRUCT_CACHE_INVALIDATION_ON_MUTATION", "type":
  "analog_of", "reason": "입력 변경 이벤트가 기존 결과를 무
  효화하고 재계산을 요구하는 구조가 동형이다.",
  "confidence": 0.74 },
      { "from": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "to":
  "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE", "type":
  "analog_of", "reason": "persisted state 제거와 view state
  재수화를 함께 수행해야 일관성이 유지된다.", "confidence":
  0.72 }
    ],
    "notes": [
      { "claim": "'입력됨' 기준(predicate)은
  normalizeNumericInput 기반으로 단일화되어야 한다.",
  "reason": "공백/콤마 제거 등 정규화 결과를 기준으로 해야
  disabled와 채점 기준 불일치를 제거할 수 있다.",
  "confidence": 0.84 },
      { "claim": "bulk 채점은 순수 파이프라인(수집→채점
  →payload)으로 만들고 마지막에 상태를 반영하는 편이 안전하
  다.", "reason": "순회 중 state 업데이트를 섞으면 순서/클로
  저 버그로 결과/표시/저장이 흔들리기 쉽다.", "confidence":
  0.78 },
      { "claim": "점수/정답 노출은 hasGraded로 게이트해야 채
  점 전 0/N 또는 부분 데이터 노출 혼선을 줄인다.", "reason":
  "채점 전에도 분모 N은 계산 가능하므로 hasGraded 기준을 두
  지 않으면 사용자 오해가 발생한다.", "confidence": 0.74 },
      { "claim": "저장은 채점 후 1회 스냅샷으로 하고, 복원은
  parse/검증/rehydrate 파이프라인과 partial 정책으로 처리하
  는 것이 안정적이다.", "reason": "per-problem merge 저장은
  legacy partial을 만들고 bulk UX에서 복원/표시 충돌을 유발
  한다.", "confidence": 0.74 },
      { "claim": "초기화는 localStorage 삭제와 UI 상태 리셋
  을 함께 수행해야 한다.", "reason": "저장소만 지우면 화면에
  남은 answer/result/hasGraded 잔상 때문에 초기화를 체감하기
  어렵다.", "confidence": 0.8 }
    ]
  }

  ## APPENDIX: R2 Progression Report (verbatim)

  [Previous Researcher Handoff (R2 Progression Report)]

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항 1의 단일 진입점 제공 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 입력됨 판정 기
  준(predicate) 정의(정규화 기반) | FE | C | disabled/채점
  기준 불일치로 인한 UX 붕괴 방지 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled” 구
  현 핵심 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 단일 클릭으로 문제 전체 채점 수행 |
  | 6 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 채점 전 0/N 및 결과 노출을 제
  어하기 위한 기준 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/결
  과 표시(게이팅) | FE | P | 채점 전 표시 혼선(0/N,
  partial) 차단 |
  | 8 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | 상단 점수 표시 계산을 분리해 회귀 방지 |
  | 9 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표
  시(일괄 채점 후) | FE | P | 문제 카드별 피드백 제공(정답/
  오답/정답값) |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | 저장/복원/legacy 처리의 기준 스
  키마 확정 |
  | 11 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | UI 상태에서
  submissions payload 생성 | FE | P | gradeAll 출력과
  StoredResult{submissions} 저장을 연결 |
  | 12 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | “채점 후 한 번에 저장”
  요구사항 3 충족 |
  | 13 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 학습 연속성 확보 및 새로고침
  회귀 방지 |
  | 14 | LEARN_RESET_UI_STATE | 다시 풀기: 저장 삭제 + UI
  state 리셋 | FE | P | 초기화가 화면에 즉시 반영되도록 보
  장 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  를 방지하고 재채점 유도 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 제출 UI를 단일 버튼으로
  바꾸고 disabled 규칙을 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_GRADED_STATE_FLAG, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SHOW_PER_PROBLEM_RESULT |
  gradeAll 이후 표시/게이팅/점수 집계를 일관되게 렌더 |
  | 3 | STEP_PERSIST_RESTORE_FLOW | 저장/복원 계약 구현 |
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회로 단순화 |
  | 4 | STEP_RESET_EDIT_FLOW | 초기화 + 채점 후 편집 정책 |
  LEARN_RESET_UI_STATE, LEARN_AFTER_GRADE_EDIT_POLICY |
  reset과 편집 정책으로 스테일/잔상 상태를 제거 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이는 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | 총점은 문제별 채점 결과가 있어
  야 집계 가능 | 0.78 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | 정오/정답 표시는 채점 결
  과 생성이 선행 | 0.78 |
  | 4 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 정의에
  의존 | 0.76 |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 6 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거 전에 대체 진입점을 마
  련하면 기능 공백을 방지 | 0.80 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 정의가 유용 | 0.70 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트를 gradeAll로 연결
  해야 UX 완성 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅이 표
  시 기준을 단순화 | 0.74 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능해도 노출은
  hasGraded일 때 권장 | 0.70 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 정오/정답도 hasGraded일
  때만 노출하는 편이 안정 | 0.72 |
  | 7 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정 권장 | 0.70 |
  | 8 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADED_STATE_FLAG | 답 변경 시 hasGraded 초기화/재
  채점 유도 규칙이 필요 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_ALL_ANSWERED_NORMALIZED | 복원된 답안도 disabled 판
  정에 반영되어야 함 | 0.72 |
  | 10 | LEARN_RESET_UI_STATE →
  LEARN_ALL_ANSWERED_NORMALIZED | reset 후 allAnswered가 다
  시 false가 되도록 초기화 | 0.72 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 공백/콤마/0 입
  력에서 “입력됨” 직관과 채점 기준이 어긋남 |
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩/0개
  상태에서 allAnswered가 흔들려 버튼 상태가 불안정 |
  problems 길이 0이면 disabled 또는 버튼 숨김 규칙을 먼저
  고정 | 0.75 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 버튼의 위
  치/disabled/라벨이 산재하면 UX 일관성이 깨짐 | 단일 버튼
  을 페이지 하단에 고정하고 상태를 derived로 계산 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 answer
  map 조회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → submissions 맵을 반환하는
  순수 함수로 분리 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG | 복원/부분 데이터에서
  hasGraded의 의미가 모호해 결과 노출이 흔들림 | hasGraded
  를 “유효한 제출 결과 존재”로 정의하고 일관되게 세팅 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | UI 렌더를
  hasGraded로 게이트하고 채점 전에는 score/result를 숨김 |
  0.74 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | problems 변경/정렬과 결
  과 맵 키가 불일치하면 점수 집계가 틀어짐 | score는
  problems 배열을 기준으로 problem.id 키로 집계하도록 고정
  | 0.70 |
  | 8 | LEARN_SHOW_PER_PROBLEM_RESULT | 결과를 문제 카드에
  매핑할 때 key/순서 혼동으로 오표시 가능 | 항상 problem.id
  로 result를 조회해 동일 카드에 렌더 | 0.76 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | UI state(answers/
  results)와 StoredResult{submissions} 표현 전환이 어려움 |
  저장 계약을 answers+isCorrect 중심으로 명시하고 단일
  payload로 합침 | 0.80 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | 기존 merge 저장
  습관으로 partial/legacy 데이터가 섞여 UX 충돌 | gradeAll
  출력으로 submissions를 새로 구성해 overwrite 저장 | 0.78
  |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성/회귀 추적이 어려움 | 채점 버튼 클릭 시점
  에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_RESET_UI_STATE | storage만 삭제하면 화면의
  answer/result/flags 잔상이 남아 초기화가 체감되지 않음 |
  storage 삭제와 함께 state(answer/result/hasGraded)를 초기
  값으로 리셋 | 0.78 |
  | 14 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태가 발생 | 입력 변경 시
  결과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 기준을 명시
  해 disabled/allAnswered/테스트에서 재사용 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서 유연화
  |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류 감소 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터로 hasGraded를 결정한 뒤 노출을 게이트하도록
  중간 기준 제공 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제 차단 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후에는 결과를 숨기거
  나 재채점을 유도하는 게이트를 중간에 둠 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 추가 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | legacy/partial 처리도 최
  종 스키마 기준으로 판정하도록 기준점을 둠 |
  | 9 | LEARN_SCORE_SUMMARY_CALC →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_BULK_GRADE_ALL_ACTION | 점수/표시 둘 다 동일한
  gradeAll 결과를 단일 소스로 삼아 불일치 방지 |
  | 10 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 전에 새 진입점(단일 버튼)을 확보해 기능 공백을 방
  지 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "입력됨 판정 기준(predicate) 정의(정
  규화 기반)", "domain": "FE", "rep": "C", "confidence":
  0.82 },
  { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원 계약 구현", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
  { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
  ],
  "add_edges": [
  { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "0개/로딩 처리는 권장이지만 allAnswered 구현의
  필수 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires", "reason":
  "result 맵 설계/구현은 액션과 동시 설계가 가능해 단일 선
  행 잠금은 과잉", "confidence": 0.72 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 액션에서 세팅하길 권장하지만 정의/도입은 독
  립적으로 가능", "confidence": 0.74 },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부 케이스로서 requires보
  다 권장/노트가 적절", "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 }
  ],
  "notes": [
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "UI 기준과 채점 기준이 다
  르면 " , " 같은 입력에서 버튼 상태와 채점 결과가 불일치
  한다.", "confidence": 0.82 },
  { "claim": "hasGraded를 도입하고 score/result는
  hasGraded일 때만 노출하는 것이 UX 혼선을 줄인다.",
  "reason": "채점 전 0/N 노출 및 부분 저장 데이터 노출을 통
  제하려면 표시 기준을 단일 플래그로 고정해야 한다.",
  "confidence": 0.74 },
  { "claim": "일괄 제출은 submissions를 merge하지 말고
  gradeAll 결과로 overwrite 저장하는 편이 안전하다.",
  "reason": "merge 저장은 legacy partial을 필연적으로 만들
  고 bulk UX에서 복원/표시 충돌을 유발한다.", "confidence":
  0.78 },
  { "claim": "복원은 try/catch + nodeId 검증 +
  submissions 최소 shape 검증으로 런타임 오류를 방어하는 것
  이 권장이다.", "reason": "잘못된/legacy 데이터는
  JSON.parse 실패나 필드 누락으로 즉시 크래시/UX 꼬임을 만
  든다.", "confidence": 0.74 },
  { "claim": "채점 후 답 변경 시 결과를 초기화하거나 재
  채점 플로우를 고정해야 스테일 상태를 피할 수 있다.",
  "reason": "입력과 결과가 불일치하면 학습자가 상태를 해석
  하기 어렵고 신뢰도가 급락한다.", "confidence": 0.76 },
  { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/hasGraded) 리셋을 함께 수행하는 것이
  권장이다.", "reason": "키 삭제만 수행하면 화면에 남아있는
  상태 때문에 초기화를 체감하지 못한다.", "confidence":
  0.78 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 로직을 알아야 bulk 전환 시 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마/partial 의미 | 기
  존
  은 submissions merge로 부분 데이터가 정상 생성되어 bulk
  UX
  와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점이 필요(라벨/disabled/재채점 포함) | 높음 |
  | 6 | 미입력 판정 기준 정합화 | disabled 판정이
  normalizeNumericInput()과 불일치하면 채점과 UX가 엇갈림 |
  높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/빈 배열 포함 안정적으
  로
  계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 테스트 벡터(12종+) | 공백/콤마/0/부
  호/소수점/Infinity 등에서 기대값이 흔들려 회귀가 잦음 |
  중
  |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 문제 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성 및 결과 표시 규칙 | 문제별 정
  오/정답 표시와 점수 집계를 problemId 기준으로 정렬해야 함
  | 중 |
  |11| hasGraded 게이팅(채점 후 표시) | 채점 전 0/N 및
  partial 결과 노출 혼선을 막기 위한 표시 시점 규칙 필요 |
  중 |
  |12| 일괄 저장(전체 submissions 1회 저장) | 요구사항 3)
  저
  장 시점을 “일괄 채점 후 setItem 1회”로 전환해야 함 | 높음
  |
  |13| 복원 파이프라인(파싱/검증/legacy 정책) | 잘못된/
  legacy 데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함
  | 중 |
  |14| 다시 풀기: storage 삭제 + UI state 리셋 | 키 삭제만
  으
  로는 화면이 즉시 초기화되지 않아 state(answer/result/
  flags) 리셋이 필요 | 높음 |
  |15| 채점 후 답 변경 처리 정책 | 입력 변경 시 결과가 스테
  일해지므로 결과 초기화 또는 재채점 플로우를 고정해야 함 |
  중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓 분리) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 로직 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | gradeNumericAnswer 유지 |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 구현
  후
  제거 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 없으면 버
  튼 활성/비활성 기준이 흔들림 | normalize 기반 allAnswered
  를 먼저 고정 |
  | 3 | 원문 disabled 판정 → gradeNumericAnswer(정규화) |
  " , " 같은 입력에서 활성/채점 결과가 불일치해 UX 붕괴 |
  normalizeNumericInput(answer).length>0로 통일 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마/검증 없이 복원하
  면 파싱 실패·필드 누락이 런타임 문제로 이어짐 | schema 정
  의 + shape validate + 예외 처리 |
  | 5 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | restored partial에서 점
  수/
  결과 노출 기준이 불명확 | hasGraded 세팅 규칙(완전 제출만
  true 등) 정의 |
  | 6 | LEARN_RESET_CLEAR_STORAGE → (UI state 유지) |
  storage만 지우면 화면에 남은 answer/result/flags가 그대로
  | 키 삭제 + state 리셋 동시 수행 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY 미정 → 결과 표시 유지
  | 답 변경 후 스테일 결과(입력≠결과) 상태가 발생 | 입력 변
  경 시 결과 초기화 또는 “다시 채점” 플로우 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_HANDLE_EMPTY_PROBLEMS", "type":
  "micro", "name_ko": "문제 0개/로딩 상태 UI 규칙",
  "domain": "UX", "rep": "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" },
  { "from": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx의 submitProblem과
  StoredResult{submissions} setItem 흐름을 확인.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로만 '입력
  됨'을 판정해야 한다.", "reason": "grading이
  normalizeNumericInput을 사용하므로 원문 기준 disabled는
  활
  성/채점 불일치를 만든다.", "confidence": 0.82 },
  { "claim": "현재 score는 problems가 있으면 채점 전에도
  0/N이 노출될 수 있어 hasGraded 게이팅이 필요하다.",
  "reason": "score 계산은 resultByProblemId가 비어도
  {correct:0,total:N}을 반환한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 데이터는
  bulk UX에서 복원/점수/표시와 충돌하므로 정책이 필요하
  다.",
  "reason": "기존 per-problem 저장은 submissions를 merge하
  여
  부분 데이터가 정상적으로 생성된다.", "confidence":
  0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제만으로는
  충분하지 않고 UI state(answer/result/flags) 리셋이 필요하
  다.", "reason": "LearnPage는 answerByProblemId/
  resultByProblemId를 state로 유지하므로 화면이 남을 수 있
  다.", "confidence": 0.78 },
  { "claim": "일괄 제출은 setItem 1회로 전체 submissions
  를 저장해야 저장/복원/초기화 계약이 단순해진다.",
  "reason": "요구사항은 일괄 채점 후 한 번에 저장이며,
  merge
  저장은 partial을 필연적으로 만든다.", "confidence": 0.8 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_HANDLE_EMPTY_PROBLEMS,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch JSON은 enables/analog_of만 포함(requires 미추가)
  - Requires 사이클: Pass — R3 requires 미추가(타입 스캔으로
    자체 점검)
  - level 미제안: Pass — level/min_level 필드 미포함
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — R3는 enables/analog_of만
    제안하여 잠금 충돌 없음
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — transfer/templates/triplets + appendix(R2 원문) +
    QA 포함

  [/R3 Transfer Report]

  ###DONE:147ec46891###


› Summarize recent commits

  23% context left · ? for shortcuts


============================================================
[2026-01-08 12:49:13] RESEARCH3 (req_id: 849ee3283b)
============================================================
  LEARN_SCORE_SUMMARY_CALC | 총점은 문제별 채점 결과가 있어
  야 집계 가능 | 0.78 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | 정오/정답 표시는 채점 결
  과 생성이 선행 | 0.78 |
  | 4 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 정의에
  의존 | 0.76 |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 6 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거 전에 대체 진입점을 마
  련하면 기능 공백을 방지 | 0.80 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 정의가 유용 | 0.70 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트를 gradeAll로 연결
  해야 UX 완성 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅이 표
  시 기준을 단순화 | 0.74 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능해도 노출은
  hasGraded일 때 권장 | 0.70 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 정오/정답도 hasGraded일
  때만 노출하는 편이 안정 | 0.72 |
  | 7 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정 권장 | 0.70 |
  | 8 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADED_STATE_FLAG | 답 변경 시 hasGraded 초기화/재
  채점 유도 규칙이 필요 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_ALL_ANSWERED_NORMALIZED | 복원된 답안도 disabled 판
  정에 반영되어야 함 | 0.72 |
  | 10 | LEARN_RESET_UI_STATE →
  LEARN_ALL_ANSWERED_NORMALIZED | reset 후 allAnswered가 다
  시 false가 되도록 초기화 | 0.72 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 공백/콤마/0 입
  력에서 “입력됨” 직관과 채점 기준이 어긋남 |
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩/0개
  상태에서 allAnswered가 흔들려 버튼 상태가 불안정 |
  problems 길이 0이면 disabled 또는 버튼 숨김 규칙을 먼저
  고정 | 0.75 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 버튼의 위
  치/disabled/라벨이 산재하면 UX 일관성이 깨짐 | 단일 버튼
  을 페이지 하단에 고정하고 상태를 derived로 계산 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 answer
  map 조회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → submissions 맵을 반환하는
  순수 함수로 분리 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG | 복원/부분 데이터에서
  hasGraded의 의미가 모호해 결과 노출이 흔들림 | hasGraded
  를 “유효한 제출 결과 존재”로 정의하고 일관되게 세팅 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | UI 렌더를
  hasGraded로 게이트하고 채점 전에는 score/result를 숨김 |
  0.74 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | problems 변경/정렬과 결
  과 맵 키가 불일치하면 점수 집계가 틀어짐 | score는
  problems 배열을 기준으로 problem.id 키로 집계하도록 고정
  | 0.70 |
  | 8 | LEARN_SHOW_PER_PROBLEM_RESULT | 결과를 문제 카드에
  매핑할 때 key/순서 혼동으로 오표시 가능 | 항상 problem.id
  로 result를 조회해 동일 카드에 렌더 | 0.76 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | UI state(answers/
  results)와 StoredResult{submissions} 표현 전환이 어려움 |
  저장 계약을 answers+isCorrect 중심으로 명시하고 단일
  payload로 합침 | 0.80 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | 기존 merge 저장
  습관으로 partial/legacy 데이터가 섞여 UX 충돌 | gradeAll
  출력으로 submissions를 새로 구성해 overwrite 저장 | 0.78
  |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성/회귀 추적이 어려움 | 채점 버튼 클릭 시점
  에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_RESET_UI_STATE | storage만 삭제하면 화면의
  answer/result/flags 잔상이 남아 초기화가 체감되지 않음 |
  storage 삭제와 함께 state(answer/result/hasGraded)를 초기
  값으로 리셋 | 0.78 |
  | 14 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태가 발생 | 입력 변경 시
  결과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 기준을 명시
  해 disabled/allAnswered/테스트에서 재사용 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서 유연화
  |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류 감소 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터로 hasGraded를 결정한 뒤 노출을 게이트하도록
  중간 기준 제공 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제 차단 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후에는 결과를 숨기거
  나 재채점을 유도하는 게이트를 중간에 둠 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 추가 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | legacy/partial 처리도 최
  종 스키마 기준으로 판정하도록 기준점을 둠 |
  | 9 | LEARN_SCORE_SUMMARY_CALC →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_BULK_GRADE_ALL_ACTION | 점수/표시 둘 다 동일한
  gradeAll 결과를 단일 소스로 삼아 불일치 방지 |
  | 10 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 전에 새 진입점(단일 버튼)을 확보해 기능 공백을 방
  지 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "입력됨 판정 기준(predicate) 정의(정
  규화 기반)", "domain": "FE", "rep": "C", "confidence":
  0.82 },
  { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원 계약 구현", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
  { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
  ],
  "add_edges": [
  { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "0개/로딩 처리는 권장이지만 allAnswered 구현의
  필수 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires", "reason":
  "result 맵 설계/구현은 액션과 동시 설계가 가능해 단일 선
  행 잠금은 과잉", "confidence": 0.72 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 액션에서 세팅하길 권장하지만 정의/도입은 독
  립적으로 가능", "confidence": 0.74 },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부 케이스로서 requires보
  다 권장/노트가 적절", "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 }
  ],
  "notes": [
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "UI 기준과 채점 기준이 다
  르면 " , " 같은 입력에서 버튼 상태와 채점 결과가 불일치
  한다.", "confidence": 0.82 },
  { "claim": "hasGraded를 도입하고 score/result는
  hasGraded일 때만 노출하는 것이 UX 혼선을 줄인다.",
  "reason": "채점 전 0/N 노출 및 부분 저장 데이터 노출을 통
  제하려면 표시 기준을 단일 플래그로 고정해야 한다.",
  "confidence": 0.74 },
  { "claim": "일괄 제출은 submissions를 merge하지 말고
  gradeAll 결과로 overwrite 저장하는 편이 안전하다.",
  "reason": "merge 저장은 legacy partial을 필연적으로 만들
  고 bulk UX에서 복원/표시 충돌을 유발한다.", "confidence":
  0.78 },
  { "claim": "복원은 try/catch + nodeId 검증 +
  submissions 최소 shape 검증으로 런타임 오류를 방어하는 것
  이 권장이다.", "reason": "잘못된/legacy 데이터는
  JSON.parse 실패나 필드 누락으로 즉시 크래시/UX 꼬임을 만
  든다.", "confidence": 0.74 },
  { "claim": "채점 후 답 변경 시 결과를 초기화하거나 재
  채점 플로우를 고정해야 스테일 상태를 피할 수 있다.",
  "reason": "입력과 결과가 불일치하면 학습자가 상태를 해석
  하기 어렵고 신뢰도가 급락한다.", "confidence": 0.76 },
  { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/hasGraded) 리셋을 함께 수행하는 것이
  권장이다.", "reason": "키 삭제만 수행하면 화면에 남아있는
  상태 때문에 초기화를 체감하지 못한다.", "confidence":
  0.78 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 로직을 알아야 bulk 전환 시 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마/partial 의미 | 기
  존
  은 submissions merge로 부분 데이터가 정상 생성되어 bulk
  UX
  와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점이 필요(라벨/disabled/재채점 포함) | 높음 |
  | 6 | 미입력 판정 기준 정합화 | disabled 판정이
  normalizeNumericInput()과 불일치하면 채점과 UX가 엇갈림 |
  높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/빈 배열 포함 안정적으
  로
  계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 테스트 벡터(12종+) | 공백/콤마/0/부
  호/소수점/Infinity 등에서 기대값이 흔들려 회귀가 잦음 |
  중
  |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 문제 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성 및 결과 표시 규칙 | 문제별 정
  오/정답 표시와 점수 집계를 problemId 기준으로 정렬해야 함
  | 중 |
  |11| hasGraded 게이팅(채점 후 표시) | 채점 전 0/N 및
  partial 결과 노출 혼선을 막기 위한 표시 시점 규칙 필요 |
  중 |
  |12| 일괄 저장(전체 submissions 1회 저장) | 요구사항 3)
  저
  장 시점을 “일괄 채점 후 setItem 1회”로 전환해야 함 | 높음
  |
  |13| 복원 파이프라인(파싱/검증/legacy 정책) | 잘못된/
  legacy 데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함
  | 중 |
  |14| 다시 풀기: storage 삭제 + UI state 리셋 | 키 삭제만
  으
  로는 화면이 즉시 초기화되지 않아 state(answer/result/
  flags) 리셋이 필요 | 높음 |
  |15| 채점 후 답 변경 처리 정책 | 입력 변경 시 결과가 스테
  일해지므로 결과 초기화 또는 재채점 플로우를 고정해야 함 |
  중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓 분리) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 로직 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | gradeNumericAnswer 유지 |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 구현
  후
  제거 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 없으면 버
  튼 활성/비활성 기준이 흔들림 | normalize 기반 allAnswered
  를 먼저 고정 |
  | 3 | 원문 disabled 판정 → gradeNumericAnswer(정규화) |
  " , " 같은 입력에서 활성/채점 결과가 불일치해 UX 붕괴 |
  normalizeNumericInput(answer).length>0로 통일 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마/검증 없이 복원하
  면 파싱 실패·필드 누락이 런타임 문제로 이어짐 | schema 정
  의 + shape validate + 예외 처리 |
  | 5 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | restored partial에서 점
  수/
  결과 노출 기준이 불명확 | hasGraded 세팅 규칙(완전 제출만
  true 등) 정의 |
  | 6 | LEARN_RESET_CLEAR_STORAGE → (UI state 유지) |
  storage만 지우면 화면에 남은 answer/result/flags가 그대로
  | 키 삭제 + state 리셋 동시 수행 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY 미정 → 결과 표시 유지
  | 답 변경 후 스테일 결과(입력≠결과) 상태가 발생 | 입력 변
  경 시 결과 초기화 또는 “다시 채점” 플로우 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_HANDLE_EMPTY_PROBLEMS", "type":
  "micro", "name_ko": "문제 0개/로딩 상태 UI 규칙",
  "domain": "UX", "rep": "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" },
  { "from": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx의 submitProblem과
  StoredResult{submissions} setItem 흐름을 확인.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로만 '입력
  됨'을 판정해야 한다.", "reason": "grading이
  normalizeNumericInput을 사용하므로 원문 기준 disabled는
  활
  성/채점 불일치를 만든다.", "confidence": 0.82 },
  { "claim": "현재 score는 problems가 있으면 채점 전에도
  0/N이 노출될 수 있어 hasGraded 게이팅이 필요하다.",
  "reason": "score 계산은 resultByProblemId가 비어도
  {correct:0,total:N}을 반환한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 데이터는
  bulk UX에서 복원/점수/표시와 충돌하므로 정책이 필요하
  다.",
  "reason": "기존 per-problem 저장은 submissions를 merge하
  여
  부분 데이터가 정상적으로 생성된다.", "confidence":
  0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제만으로는
  충분하지 않고 UI state(answer/result/flags) 리셋이 필요하
  다.", "reason": "LearnPage는 answerByProblemId/
  resultByProblemId를 state로 유지하므로 화면이 남을 수 있
  다.", "confidence": 0.78 },
  { "claim": "일괄 제출은 setItem 1회로 전체 submissions
  를 저장해야 저장/복원/초기화 계약이 단순해진다.",
  "reason": "요구사항은 일괄 채점 후 한 번에 저장이며,
  merge
  저장은 partial을 필연적으로 만든다.", "confidence": 0.8 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_HANDLE_EMPTY_PROBLEMS,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch JSON은 enables/analog_of만 포함(requires 미추가)
  - Requires 사이클: Pass — R3 requires 미추가(타입 스캔으로
    자체 점검)
  - level 미제안: Pass — level/min_level 필드 미포함
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — R3는 enables/analog_of만
    제안하여 잠금 충돌 없음
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — transfer/templates/triplets + appendix(R2 원문) +
    QA 포함

  [/R3 Transfer Report]

  ###DONE:147ec46891###


› Request 849ee3283b: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_849ee3283b.md

  23% context left



› Request 849ee3283b: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_849ee3283b.md


• Context compacted

• Running wc -l .agents/inbox/research_849ee3283b.md
•         
  └ Read research_849ee3283b.md
                        
                      
› Summarize recent commits

  92% context left · ? for shortcuts 


• Ran wc -l .agents/inbox/research_849ee3283b.md
  └ 865 .agents/inbox/research_849ee3283b.md

  │ … +256 lines
•         
  └unnirc PytPrevious Researcher Handoff in
                                 
                                        
research_849ee3283b.md
                                 
   5Read task.md, T1.md


• Ran python - <<'PY'
  │ import json
  │ s = r'''{
  │ … +256 lines
  └ ok R3 curriculum_viewer_learning_bulk_submit_v1 16 30 7

  └ Read research_849ee3283b.md

• Preparing final answer (8m 36s • esc to interrupt)        


› Summarize recent commits

  79% context left · ? for shortcuts


• Explored
  └ Read research_849ee3283b.md

─ Worked for 8m 36s ────────────────────────────────────────

• ###BEGIN:849ee3283b###

  ## Transfer Edge Analysis

  ### Enables Edges (스킬 → 상위 문항 구조)

  | # | From | To | transfer 이유 | confidence |
  |---|------|----|--------------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT |
  PATTERN_SINGLE_ACTION_ENTRYPOINT | 개별 제출 제거로 단일
  CTA 중심 bulk 플로우로 구조 전이된다. | 0.76 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON |
  PATTERN_SINGLE_ACTION_ENTRYPOINT | 하단 단일 버튼이 bulk
  제출/채점의 유일 진입점 구조를 만든다. | 0.82 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | '입력됨' 기준을 정
  규화로 통일해 disabled/채점 불일치를 제거한다. | 0.82 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | allAnswered 안정 계
  산이 “모두 입력 전 비활성” 게이트를 고정한다. | 0.80 |
  | 5 | LEARN_DISABLED_EDGECASES_12 |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 공백/콤마/부호 입력
  벡터가 게이트 판정 회귀를 방지한다. | 0.74 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION |
  PATTERN_BATCH_GRADE_PIPELINE | 전체 순회 채점을 파이프라인
  화하면 표시/저장까지 일관되게 확장된다. | 0.80 |
  | 7 | LEARN_BUILD_RESULT_MAP |
  PATTERN_CANONICAL_RESULT_MAP | resultByProblemId keyed map
  이 표시/집계/직렬화의 단일 계약이 된다. | 0.78 |
  | 8 | LEARN_GRADED_STATE_FLAG |
  PATTERN_POST_GRADE_VISIBILITY_GATING | hasGraded가 점수·정
  오·정답 노출의 단일 기준을 만든다. | 0.78 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING |
  PATTERN_POST_GRADE_VISIBILITY_GATING | 채점 후에만 노출하
  는 게이팅이 채점 전 0/N·정답 선노출을 차단한다. | 0.76 |
  | 10 | LEARN_SCORE_SUMMARY_CALC |
  PATTERN_POST_GRADE_VISIBILITY_GATING | X/N 요약은
  hasGraded 기반 노출로 “채점됨” 의미를 유지한다. | 0.72 |
  | 11 | LEARN_SHOW_PER_PROBLEM_RESULT |
  PATTERN_POST_GRADE_VISIBILITY_GATING | 문제별 결과도
  hasGraded로 게이트해 UX 일관성을 보장한다. | 0.72 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 스키마 계약이 있
  어야 “채점 후 1회 overwrite” 스냅샷 구조가 성립한다. |
  0.78 |
  | 13 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  PATTERN_RESTORE_VALIDATE_MIGRATE | 복원은
  parse→validate→migrate/reset 분기 구조로 전이된다. | 0.76
  |
  | 14 | LEARN_RESET_UI_STATE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | UI 리셋까지 포함해야
  “저장+화면 동기화” 완전 초기화 구조가 된다. | 0.80 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 채점 후 답 변경 시
  결과 무효화·재채점 유도 구조가 필요하다. | 0.74 |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | PATTERN_NORMALIZED_COMPLETENESS_GATE |
  STRUCT_PREDICATE_GATED_ACTION | predicate 계산으로 액션을
  게이트하는 구조가 동형이다. | 0.74 |
  | 2 | PATTERN_POST_GRADE_VISIBILITY_GATING |
  STRUCT_PREDICATE_GATED_ACTION | hasGraded 같은 불리언으로
  가시성/액션을 제어하는 구조가 동형이다. | 0.72 |
  | 3 | PATTERN_BATCH_GRADE_PIPELINE |
  STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP | 컬렉션을 순회해
  keyed 결과맵을 생성하는 구조가 동일하다. | 0.76 |
  | 4 | PATTERN_CANONICAL_RESULT_MAP |
  STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP | keyed map을 중간
  표현으로 고정해 후속 연산을 단순화한다. | 0.70 |
  | 5 | PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | 버전/스키마를 포함한
  스냅샷 저장 구조가 동형이다. | 0.68 |
  | 6 | PATTERN_RESTORE_VALIDATE_MIGRATE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | validate 후 migrate/
  reset 분기하는 복원 파이프라인이 동일하다. | 0.72 |
  | 7 | PATTERN_EDIT_INVALIDATES_AND_REGRADES |
  STRUCT_CACHE_INVALIDATION_ON_MUTATION | mutation 시 결과
  무효화 후 재계산을 요구하는 구조가 동형이다. | 0.74 |
  | 8 | PATTERN_RESET_CLEAR_STORAGE_AND_UI |
  STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE | persisted
  state 제거와 UI 재수화를 동기화해야 일관성이 유지된다. |
  0.72 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답
  생성 규칙 |
  |---|---------|------------------|-----------|------------
  ---|
  | 1 | 정규화 기반 Disabled Gate | N:1~50,
  answers:string[], normalizeNumericInput | disabled = !
  all_i(len(norm(ans_i))>0) | raw input 기준, trim만 적용,
  "0"를 빈값 처리 |
  | 2 | 로딩/0문제 상태 allAnswered 안정화 | loading:bool,
  problemsLen:0~50, answersMap | allAnswered=false if
  loading or problemsLen==0 else predicateOverProblems |
  problems undefined에서 true, stale memo로 순간 토글 |
  | 3 | Bulk Grade 파이프라인 | problems[{id}], answersMap,
  gradeOne | resultById[id]=gradeOne(id,answers[id]) | index
  기반 키, loop 중 setState, side-effect 혼합 |
  | 4 | 결과맵 기반 총점 집계 | resultById, hasGraded |
  score = hasGraded ? sum(isCorrect) : hidden | 채점 전 0/N
  노출, partial 결과 집계 |
  | 5 | 채점 후 결과/정답 가시성 게이트 | hasGraded,
  resultById | showResult = hasGraded | 정답 선노출, flag 누
  락 시 노출 |
  | 6 | 채점 후 수정 무효화/재채점 CTA | hasGraded:true,
  change(problemId) | onChange→invalidateResult +
  hasGraded=false + CTA="다시 채점" | 스테일 결과 유지, 일부
  만 초기화, CTA 미전환 |
  | 7 | 채점 후 1회 저장 스냅샷 | nodeId,
  payload{answers,results,version,updatedAt} |
  setItem(key(nodeId), JSON.stringify(payload))
  onceAfterGrade | 문제별 merge 저장, nodeId 누락, version
  누락 |
  | 8 | 복원 parse→validate→policy 분기 | storedStr(valid/
  invalid/legacyPartial), problemsLen, policy | if !
  safeParse or !validShape -> reset; else if legacyPartial
  -> policyBranch; else restore | JSON.parse 크래시, partial
  을 graded로 오인 |
  | 9 | Reset 동기화(저장+UI) | stored exists, uiState |
  removeItem + reset answers/results/hasGraded | storage만
  삭제, UI 잔상 유지 |

  ### 상세 템플릿 예시 (3개)

  Template 1: 정규화 기반 Disabled Gate
  - Parameters: { N: [1,50], answers: ["", "   ", "1,234",
  "0", ".", "+", "-0", "Infinity"], normalize:
  normalizeNumericInput }
  - Answer: disabled = !all_i( normalize(answers[i]).length
  > 0 )
  - Distractors: [raw input length로 판정, trim만 적용,
  "0"를 빈값 처리, parseFloat 기반 판정]
  - Required Skills: [LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Template 2: 채점 후 1회 저장 스냅샷
  - Parameters: { nodeId: ["nA","nB"], payload:
  { answersMap, resultByProblemId, updatedAt: [unixMs],
  version: [1,2] } }
  - Answer: key(nodeId) = "curriculum-
  viewer:learn:lastResult:" + nodeId; setItem(key(nodeId),
  JSON.stringify(payload)) (after grade, once)
  - Distractors: [문제별 merge 저장으로 partial 생성, 저장
  시점이 채점 전, version 누락, nodeId 누락으로 노드 간 오
  염]
  - Required Skills: [LEARN_IDENTIFY_STORAGE_KEY,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK]

  Template 3: 복원 parse→validate→policy 분기
  - Parameters: { storedStr: [validJSON, invalidJSON,
  legacyPartialJSON], problemsLen: [1,50], policy:
  ["reset","restoreAnswersOnly","forceRegrade"] }
  - Answer: parsed = safeParse(storedStr); if !
  validShape(parsed) -> reset; else if
  isLegacyPartial(parsed, problemsLen) -> policyBranch; else
  restore(answers+results) and set hasGraded
  - Distractors: [JSON.parse 예외로 런타임 크래시, partial을
  graded로 오인, 문제 수 변경/불일치 미처리]
  - Required Skills: [LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_GRADED_STATE_FLAG]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 조건 충족 전 잠금 해제 | 필수 항목 입력 전 제출 버튼
  비활성 | required 필드 누락 시 commit 차단 | 모든 점 지정
  전 면적 계산 버튼 비활성 |
  | 2 | 배치 처리 파이프라인 | 영수증을 모아 한 번에 정산 |
  배치 잡으로 레코드 처리 결과맵 생성 | 여러 도형 넓이를 일
  괄 계산해 요약 |
  | 3 | keyed 중간표현 고정 | 항목별 체크리스트를 ID로 관리
  | id→result 맵으로 집계/표시/저장 | 각 변/각도 라벨로 맵핑
  후 계산 |
  | 4 | 완료 후 가시성 게이팅 | 완료 전 점수/결과 공개 금지
  | flag true일 때만 리포트 노출 | 구성 완료 후 보조선/측정
  값 표시 |
  | 5 | 버전드 스냅샷 저장/복원 | 임시저장 후 이어하기(구버
  전 변환) | versioned snapshot validate→migrate/reset | CAD
  도면 저장/로드 시 버전 변환 |
  | 6 | 레거시 partial 마이그레이션 | 구서식 일부 제출 데이
  터 처리 | old schema partial migrate or reset | 구버전 도
  면 일부 요소 누락 import 처리 |
  | 7 | 초기화 동기화(저장+화면) | 신청 취소 시 내역 삭제+화
  면 초기화 | clear cache + reset view state | 그리기 초기화
  시 파일/화면 모두 초기화 |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 조건 충족 전 잠금 해제
  - 생활: 온라인 신청서에서 필수 항목을 모두 입력하기 전까지
  "제출" 버튼이 비활성화된다.
  - 데이터: 파이프라인에서 required 필드가 모두 채워지기 전
  에는 commit 단계가 실행되지 않는다.
  - 도형: 좌표평면에서 다각형의 모든 꼭짓점을 지정하기 전에
  는 "면적 계산" 버튼이 비활성화된다.
  - 공통 스킬: [LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Triplet 2: 버전드 스냅샷 저장/복원
  - 생활: 장바구니/신청서를 임시저장했다가 재접속 시 동일 상
  태로 복원하되, 구버전 데이터는 변환 또는 초기화된다.
  - 데이터: versioned snapshot을 읽어 validate 후 migrate/
  reset 분기하여 안전하게 rehydrate 한다.
  - 도형: CAD 도면을 저장/로드할 때 버전 정보를 통해 포맷을
  변환하고, 깨진 파일은 복구 불가로 초기화한다.
  - 공통 스킬: [LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type":
  "micro", "name_ko": "단일 주요 액션 진입점(개별 제출 제거
  후)", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "type": "micro", "name_ko": "정규화 기반 완결성 게이트(모
  두 입력 전까지 비활성)", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_BATCH_GRADE_PIPELINE", "type":
  "micro", "name_ko": "배치 채점 파이프라인(수집→채점→결과
  맵)", "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_CANONICAL_RESULT_MAP", "type":
  "micro", "name_ko": "정규 키 기반 결과맵
  (resultByProblemId) 중간표현", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "type": "micro", "name_ko": "채점 후 가시성 게이팅
  (hasGraded로 score/result 노출)", "domain": "UX", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "type": "micro", "name_ko": "채점 후 수정 시 결과 무효화
  및 재채점 유도", "domain": "UX", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "type": "micro", "name_ko": "버전드 스냅샷 저장(채점 후 1
  회 overwrite)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_RESTORE_VALIDATE_MIGRATE", "type":
  "micro", "name_ko": "복원 파이프라인
  (parse→validate→migrate/reset 분기)", "domain": "FE",
  "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "type": "micro", "name_ko": "legacy partial 감지 시 정책
  분기(초기화/재채점 유도 등)", "domain": "ARCH", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type":
  "micro", "name_ko": "완전 초기화(저장소 삭제+UI 상태 리
  셋)", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_NODE_SCOPED_STORAGE_KEY", "type":
  "micro", "name_ko": "노드 스코프 저장 키(nodeId 포함으로
  오염 방지)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "micro", "name_ko": "predicate로 액션/가시성을 게이트하는
  구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP",
  "type": "micro", "name_ko": "컬렉션을 순회해 keyed map을
  만드는 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "micro", "name_ko": "버전드 스냅샷 저장/복원 및 마이그레이
  션 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_CACHE_INVALIDATION_ON_MUTATION",
  "type": "micro", "name_ko": "mutation 시 캐시/결과 무효화
  후 재계산 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE",
  "type": "micro", "name_ko": "persisted state 제거와 UI
  rehydrate를 동기화하는 구조", "domain": "STRUCT", "rep":
  "C", "lens": ["transform"] }
    ],
    "merge_aliases": [],
    "add_edges": [
      { "from": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "to":
  "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type": "enables",
  "reason": "개별 제출 제거는 단일 CTA 중심 흐름으로 전환을
  강제한다.", "confidence": 0.76 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type": "enables",
  "reason": "하단 단일 버튼이 bulk 제출/채점의 유일 진입점
  구조를 만든다.", "confidence": 0.82 },
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "입력됨 predicate를 정규화 기준으로 고정하면
  disabled/채점 기준 불일치를 제거한다.", "confidence":
  0.82 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "allAnswered를 안정적으로 계산하면 '모두 입력 전
  비활성' 게이트가 흔들리지 않는다.", "confidence": 0.8 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "엣지케이스 벡터가 공백/콤마/부호 입력에서 게이
  트 회귀를 방지한다.", "confidence": 0.74 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "PATTERN_BATCH_GRADE_PIPELINE", "type": "enables",
  "reason": "전체 순회 채점을 수집→채점→결과맵 파이프라인으
  로 만들면 표시/저장까지 확장된다.", "confidence": 0.8 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "PATTERN_CANONICAL_RESULT_MAP", "type": "enables",
  "reason": "problem.id 키로 결과를 고정하면 표시/집계/직렬
  화가 동일 keyed 계약에 기반한다.", "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "hasGraded 플래그가 점수·정오·정답 노출 조건을
  단일 기준으로 만든다.", "confidence": 0.78 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "게이팅 규칙을 명시하면 채점 전 0/N, 정답 선노출
  같은 UX 붕괴를 막는다.", "confidence": 0.76 },
      { "from": "LEARN_SCORE_SUMMARY_CALC", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "X/N 요약은 hasGraded 기반으로만 노출해야 '채점
  됨' 의미가 유지된다.", "confidence": 0.72 },
      { "from": "LEARN_SHOW_PER_PROBLEM_RESULT", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "문제별 정오/정답 표시는 채점 완료 이후에만 노출
  되는 구조로 고정되어야 한다.", "confidence": 0.72 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "채점 후 수정 시 스테일 결과를 무효화
  하고 재채점 흐름으로 전이된다.", "confidence": 0.74 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "스키마 계약이 있어야 '채점 후 1회 저
  장(답안+결과)' 스냅샷 구조가 안정화된다.", "confidence":
  0.78 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "answers/results를 payload로 직렬화하
  는 경로를 고정해야 overwrite 스냅샷 저장이 가능하다.",
  "confidence": 0.78 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "채점 직후 1회 setItem으로 저장 시점
  을 단순화하면 partial/merge 회귀를 줄인다.", "confidence":
  0.78 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "복원 시 shape 검증을 넣으면 invalid/타 노드 데
  이터로 인한 런타임 꼬임을 차단한다.", "confidence":
  0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "재진입/새로고침 복원은 parse→검증→복원 분기 파
  이프라인 구조로 정리된다.", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH", "type": "enables",
  "reason": "legacy partial을 감지하면 초기화/재채점 유도 등
  정책 분기 구조가 필요해진다.", "confidence": 0.72 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "저장 데이터 삭제는 초기화의 근거이며 UI 리셋과
  함께 완전 초기화로 전이된다.", "confidence": 0.78 },
      { "from": "LEARN_RESET_UI_STATE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "UI 상태 리셋을 포함해야 초기화 UX가 즉시 체감되
  고 저장 데이터와 화면이 동기화된다.", "confidence": 0.8 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "PATTERN_NODE_SCOPED_STORAGE_KEY", "type": "enables",
  "reason": "키 계약(nodeId 포함)을 이해해야 노드 간 결과 오
  염을 방지하는 저장 구조로 전이된다.", "confidence":
  0.72 },
      { "from": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "정규화된 상태에서 predicate를 계산
  해 UI 액션을 게이트하는 구조가 동일하다.", "confidence":
  0.74 },
      { "from": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "hasGraded 같은 불리언으로 가시성/
  액션을 제어하는 게이트 구조가 동형이다.", "confidence":
  0.72 },
      { "from": "PATTERN_BATCH_GRADE_PIPELINE", "to":
  "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP", "type":
  "analog_of", "reason": "문제 컬렉션을 순회하며 keyed 결과
  맵을 생성하는 map→index 구조가 동형이다.", "confidence":
  0.76 },
      { "from": "PATTERN_CANONICAL_RESULT_MAP", "to":
  "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP", "type":
  "analog_of", "reason": "중간표현을 keyed map으로 고정해 후
  속 연산(표시/집계/저장)을 단순화하는 구조가 동일하다.",
  "confidence": 0.7 },
      { "from": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "스냅샷을 버전/스키마와 함께 저장해
  향후 호환을 보장하는 구조가 동형이다.", "confidence":
  0.68 },
      { "from": "PATTERN_RESTORE_VALIDATE_MIGRATE", "to":
  "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "restore 시 validate 후 migrate/
  reset 분기하는 복원 파이프라인 구조가 동일하다.",
  "confidence": 0.72 },
      { "from": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "legacy/partial 감지 후 정책 분기
  (복원/초기화/재계산) 구조가 버전드 마이그레이션 구조와 동
  형이다.", "confidence": 0.7 },
      { "from": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "to": "STRUCT_CACHE_INVALIDATION_ON_MUTATION", "type":
  "analog_of", "reason": "입력 변경을 트리거로 기존 결과를
  무효화하고 재계산을 요구하는 구조가 동형이다.",
  "confidence": 0.74 },
      { "from": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "to":
  "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE", "type":
  "analog_of", "reason": "persisted state 제거와 view state
  재수화를 함께 수행해야 일관성이 유지되는 구조가 동형이
  다.", "confidence": 0.72 }
    ],
    "remove_edges": [],
    "notes": [
      { "claim": "disabled/채점의 '입력됨' 기준은
  normalizeNumericInput(answer).length>0로 단일화하는 편이
  안전하다.", "reason": "정규화 결과를 기준으로 해야 버튼 활
  성/비활성, allAnswered, 채점 결과가 엇갈리지 않는다.",
  "confidence": 0.82 },
      { "claim": "bulk 채점은 입력 수집→순수 채점→결과맵 생
  성→단일 setState로 구성하는 편이 회귀가 적다.", "reason":
  "순회 중 setState를 섞으면 순서/클로저 버그로 결과/표시/저
  장이 흔들리기 쉽다.", "confidence": 0.78 },
      { "claim": "resultByProblemId keyed map을 단일 소스로
  두면 점수 집계와 문제별 표시/저장이 일관된다.", "reason":
  "동일 키 계약을 유지하면 X/N 집계, 정오/정답 렌더, 직렬화
  가 같은 데이터에서 파생된다.", "confidence": 0.76 },
      { "claim": "채점 후 1회 overwrite 스냅샷 저장은 legacy
  partial 생성 원인을 차단한다.", "reason": "문제별 merge 저
  장은 partial을 자연스럽게 만들고 bulk UX와 충돌한다.",
  "confidence": 0.78 },
      { "claim": "복원은 safeParse+validate 후 legacy
  partial을 정책 분기로 처리해야 한다.", "reason": "parse 실
  패/타 노드 데이터/부분 submissions를 graded로 오인하는 UX
  혼선을 줄인다.", "confidence": 0.74 },
      { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태 때문에 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
      { "claim": "채점 후 답 변경은 결과/hasGraded를 무효화
  하고 재채점 CTA로 유도해야 한다.", "reason": "입력≠결과
  (stale) 상태를 남기면 사용자가 결과를 신뢰하지 못한다.",
  "confidence": 0.74 }
    ]
  }

  ## APPENDIX: R2 Progression Report (verbatim)

  [Previous Researcher Handoff (R2 Progression Report)]

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 요약 | FE | C | bulk 전환 시 회귀/기능공백을
  추적할 기준선을 만든다 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화가 같은 키 계약에 의존하
  므로 전제 확인이 필요하다 |
  | 3 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA | StoredResult/
  submissions 스키마 확인 | FE | C | bulk 저장으로 바꿔도
  호환되는 데이터 계약을 명시해야 한다 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  한다 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항의 단일 진입점(채점하기/전체
  제출)을 제공한다 |
  | 6 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 미입력 판정
  predicate 정의(정규화 기반) | FE | C | disabled/채점 기준
  불일치로 인한 UX 붕괴를 방지한다 |
  | 7 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled”를
  안정적으로 계산한다 |
  | 8 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  테스트 벡터 | QA | C | 공백/콤마/부호 등에서 판정 흔들림
  을 사전에 고정한다 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 한 번의 클릭으로 모든 문제를 채점하는 동
  작을 만든다 |
  | 10 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장에 공통
  으로 쓰는 중간 표현을 만든다 |
  | 11 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 채점 전 0/N 노출 및 partial
  결과 노출 혼선을 제어한다 |
  | 12 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  결과 표시(게이팅) | FE | P | 결과 노출 시점을 고정해 UX를
  일관되게 만든다 |
  | 13 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | 상단 점수 표시를 문제별 결과에서 안정적으로 계산한
  다 |
  | 14 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 문제 카드에 정오/정답값
  을 일관되게 렌더한다 |
  | 15 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | “채점 후 1회 저장” 스냅샷 구조를
  스키마로 고정한다 |
  | 16 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | UI 상태에서
  submissions payload 생성 | FE | P | answers/results를
  StoredResult{submissions}로 직렬화한다 |
  | 17 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고 1
  회 setItem으로 저장 시점을 단순화한다 |
  | 18 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터
  shape validate | FE | C | 잘못된/누락 필드로 인한 런타임
  오류와 UX 꼬임을 방지한다 |
  | 19 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial(submissions 일부) 처리 정책 | FE | C | 기
  존 merge 저장이 만든 partial을 bulk UX에 맞게 처리한다 |
  | 20 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태를 복원한다 |
  | 21 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화의 근거를 만든다 |
  | 22 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면에 남는 answer/result/flags 잔상을 제거한다
  |
  | 23 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과)를 방지한다 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼과 disabled 규칙
  을 묶어 UX 기준을 고정한다 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | gradeAll 결과를 중간 표현
  으로 만들고 게이팅/표시를 일관화한다 |
  | 3 | STEP_PERSIST_RESTORE_FLOW | 저장/복원/legacy 처리 |
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 저장 계약을 먼저 고정하
  고 복원/legacy 정책을 조건부로 적용한다 |
  | 4 | STEP_RESET_EDIT_FLOW | 초기화 + 채점 후 편집 정책 |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | reset과 편집 정책으로 잔
  상/스테일 상태를 제거한다 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이는 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 일괄 채점은 문제별 결과 맵 생성
  (또는 동등 표현)을 포함해야 완성 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점은 문제별 채점 결과가 있어야 집계 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 제출/저장 경로를
  알아야 제거 후 회귀를 줄일 수 있음 | 0.76 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거 전에 대체 진입점을 마
  련하면 기능 공백을 방지 | 0.80 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 정의가 유용 | 0.70 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트를 gradeAll로 연결
  해야 UX 완성 | 0.72 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능해도 노출은
  hasGraded일 때 권장 | 0.70 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy가 있을 때만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADED_STATE_FLAG | 답 변경 시 hasGraded 초기화/재
  채점 유도 규칙이 필요 | 0.74 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정하는 편이 안정 | 0.70 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | UI의 “입력됨”
  직관과 정규화 기준이 어긋나 disabled/채점이 불일치 |
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개 상태
  에서 allAnswered가 흔들려 버튼 상태가 불안정 | problems
  길이 0/로딩 상태의 disabled 규칙을 명시하고 안정적으로 계
  산 | 0.74 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 버튼 라벨/disabled/재
  채점 상태가 분산되면 UX가 일관되지 않음 | 단일 버튼을 하
  단 고정 + derived state로 label/disabled를 결정 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점 중 입력 조
  회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → resultByProblemId 반환으로
  순수 함수화 | 0.78 |
  | 5 | LEARN_BUILD_RESULT_MAP | 결과를 index 기반으로 다루
  면 문제 순서 변경 시 오표시 위험 | 항상 problem.id 키로
  resultByProblemId를 구성/조회하도록 고정 | 0.76 |
  | 6 | LEARN_GRADED_STATE_FLAG | 복원/partial 데이터에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효한 채점 결과 존재”로 정의하고 일관되게 세팅 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | score/result
  렌더를 hasGraded로 게이트하고 채점 전에는 숨김 | 0.74 |
  | 8 | LEARN_SCORE_SUMMARY_CALC | results가 비어도 0/N이
  계산되어 채점 전 표시 혼선이 생김 | 계산은 하되 UI 노출은
  hasGraded일 때만 하도록 분리 | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | merge 저장 습관이
  남으면 partial/legacy가 계속 생겨 UX가 꼬임 | bulk는
  overwrite 스냅샷 저장으로 고정하고 schema로 명시 | 0.78 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 StoredResult{submissions}로 변환할 때 필드/형식 누락이
  발생 | gradeAll 결과를 단일 소스로 payload를 구성하고 직
  렬화 경로를 단순화 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성 및 회귀 추적이 어려움 | 채점 버튼 클릭 시
  점에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도(또는 초기
  화) | 0.74 |
  | 14 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result/flags 잔상이 남아 초기화가 체감되지 않음 | storage
  삭제와 함께 state(answer/result/hasGraded)를 초기값으로
  리셋 | 0.78 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태 발생 | 입력 변경 시 결
  과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 동시에 정
  합화한다 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서를 유연
  하게 만든다 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류를 줄인다 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터에서 hasGraded를 결정한 뒤 노출을 게이트하면
  표시 규칙이 단순해진다 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제를 차단한다 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 이후 결과 노출 여부
  를 게이트로 통제하면 스테일 상태를 예방한다 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 둔다 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | legacy/partial 판정과
  복원을 검증 단계로 매개해 런타임 꼬임을 줄인다 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 불일치를 줄
  인다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 흐름에서 bulk 저장
  으로 전환할 때 스키마를 중간 기준점으로 두면 회귀 추적이
  쉬워진다 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원/legacy 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
  ],
  "add_edges": [
  { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "정규화 기준 자체보다 '입력됨 predicate'를 중간
  노드로 두면 disabled/allAnswered를 한 번에 정합화할 수 있
  어 기존 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded 정의/도입은 gradeAll과 병렬로 가능해 단일 선행
  잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 구현 중 즉시 확인 가능해 필수
  선행 잠금보다 노트가 적절", "confidence": 0.70 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 restore 구현의 필수 개념이지만
  requires 잠금으로 강제할 필요는 낮음", "confidence":
  0.68 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 단일 선행 잠금은 과
  잉", "confidence": 0.78 }
  ],
  "notes": [
  { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  " , " 같은 입력에서 버튼 상태와 채점 결과가 불일치한
  다.", "confidence": 0.82 },
  { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, score/result 노출은 hasGraded일 때만
  하는 것이 권장이다.", "reason": "채점 전 0/N 및 legacy
  partial 노출을 통제하려면 표시 기준을 단일 플래그로 고정
  해야 한다.", "confidence": 0.74 },
  { "claim": "per-problem 제출 제거는 bulk 경로(버튼/
  gradeAll/저장)가 준비된 뒤 진행하는 것이 권장이다.",
  "reason": "제거가 먼저면 채점/저장 경로가 사라져 기능 공
  백이 발생한다.", "confidence": 0.72 },
  { "claim": "legacy partial(submissions 일부) 데이터는
  조건부로 감지해 초기화 또는 재채점 유도 등 정책을 적용하
  는 것이 권장이다.", "reason": "기존 merge 저장으로 부분
  데이터가 정상 생성되었고, 이를 그대로 노출하면 "채점됨"
  오해가 생긴다.", "confidence": 0.74 },
  { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행하는 것이 권장
  이다.", "reason": "키 삭제만 수행하면 화면에 남은 상태 때
  문에 초기화가 즉시 반영되지 않는다.", "confidence":
  0.78 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)로 문자열 내부 줄바꿈 없이 출력해야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검증/병합 파이프라인을 중단시킨다.", "confidence": 0.90 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | 기존
  submitProblem/저장 merge 동작을 알아야 bulk 전환 시 기능
  공백/회귀를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 partial 의미 |
  기존 per-problem 저장은 submissions 일부만 남기는 데이터
  가
  정상 생성되어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 동작/표시가 일
  관됨 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 " , " 등에서 UX가 붕괴
  | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정
  적으로 계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", " , ",
  "0", "-0", "1,234", "+", ".", "Infinity" 등에서 기대값이
  흔들림 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/집계 기준 | 점수/결과 표시/저
  장을 problemId로 정렬하는 중간 표현이 필요 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  legacy partial 결과 노출 혼선을 막을 표시 기준이 필요 |
  중
  |
  |12| 결과/점수 표시 게이팅 규칙 | 채점 후에만 점수/정오/
  정
  답을 표시해야 UX가 일관되고 partial 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “일괄
  채점 후 한 번에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함 | 중 |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 answer/result/flags 리셋이
  필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | per-problem 제출 제거 → bulk 채점 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 구현 후 제거 |
  | 2 | 원문 disabled → 정규화 채점 | " , " 등에서 활성/비
  활
  성과 채점 기준이 엇갈려 UX 붕괴 | normalizeNumericInput
  기
  반으로 미입력 판정 통일 |
  | 3 | bulk 버튼 추가 → allAnswered 부재 | disabled 조건이
  불명확해 조기 활성/비활성이 흔들림 | problems[] 기반
  allAnswered(정규화) 먼저 고정 |
  | 4 | 저장 구현 → 복원/검증 미정 | 파싱 실패/필드 누락 시
  런타임 오류 및 상태 꼬임 | schema+shape validate+예외 처
  리
  추가 |
  | 5 | legacy partial 복원 → 결과 노출 | 부분 submissions
  가
  “채점됨”처럼 보이면 오해/혼선 발생 | partial 감지 시
  hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | 초기화(키 삭제만) → UI 잔상 | storage만 지우면
  answer/result/flags가 화면에 남음 | 키 삭제 + UI state 리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submitProblem과
  StoredResult{submissions} setItem 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled의 '입력됨' 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading이 normalizeNumericInput을 사용
  하므로 원문 기준 disabled는 채점과 불일치해 UX를 망친
  다.",
  "confidence": 0.84 },
  { "claim": "점수/정오/정답 표시는 hasGraded로 게이트해
  야 채점 전 0/N 및 partial 노출 혼선을 줄인다.", "reason":
  "현재 score는 problems가 있으면 result가 비어도 0/N을 표
  시
  할 수 있어 오해를 유발한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 처리는 조
  건부 정책이며 restore를 migration에 과잉 잠금(requires)하
  지 않는 편이 안전하다.", "reason": "migration은 legacy가
  존재할 때만 필요하고 reviewer도 requires 과잉 잠금을 지적
  했다.", "confidence": 0.72 },
  { "claim": "per-problem 제출 제거는 권장 순서이며,
  bulk 경로(버튼/gradeAll/저장)가 준비된 뒤 제거해야 기능
  공
  백을 피한다.", "reason": "제거가 먼저면 채점/저장 경로가
  사라져 사용자가 진행 불가 상태가 된다.", "confidence":
  0.72 },
  { "claim": "다시 풀기는 localStorage 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태 때문에 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검
  증/병합 파이프라인을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch는 requires 엣지를 추가하지 않았다(json.loads 통
    과).
  - Requires 사이클: Pass — requires 추가 없음(새 requires
    사이클 생성 불가)로 자체 점검.
  - level 미제안: Pass — level/min_level을 표/JSON/notes 어
    디에도 제안하지 않았다.
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — 본 출력은 enables/
    analog_of만 제안했다.
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — Transfer 포함, Progression을 Appendix로 포함,
    Coverage는 Appendix 내 R1 Coverage Report로 포함.

  [/R3 Transfer Report]

  ###DONE:849ee3283b###


› Summarize recent commits

  71% context left · ? for shortcuts


============================================================
[2026-01-08 13:21:47] RESEARCH3 (req_id: f3b3ecfcc0)
============================================================
  | 13 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | 상단 점수 표시를 문제별 결과에서 안정적으로 계산한
  다 |
  | 14 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 문제 카드에 정오/정답값
  을 일관되게 렌더한다 |
  | 15 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | “채점 후 1회 저장” 스냅샷 구조를
  스키마로 고정한다 |
  | 16 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | UI 상태에서
  submissions payload 생성 | FE | P | answers/results를
  StoredResult{submissions}로 직렬화한다 |
  | 17 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고 1
  회 setItem으로 저장 시점을 단순화한다 |
  | 18 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터
  shape validate | FE | C | 잘못된/누락 필드로 인한 런타임
  오류와 UX 꼬임을 방지한다 |
  | 19 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial(submissions 일부) 처리 정책 | FE | C | 기
  존 merge 저장이 만든 partial을 bulk UX에 맞게 처리한다 |
  | 20 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태를 복원한다 |
  | 21 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화의 근거를 만든다 |
  | 22 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면에 남는 answer/result/flags 잔상을 제거한다
  |
  | 23 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과)를 방지한다 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼과 disabled 규칙
  을 묶어 UX 기준을 고정한다 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | gradeAll 결과를 중간 표현
  으로 만들고 게이팅/표시를 일관화한다 |
  | 3 | STEP_PERSIST_RESTORE_FLOW | 저장/복원/legacy 처리 |
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 저장 계약을 먼저 고정하
  고 복원/legacy 정책을 조건부로 적용한다 |
  | 4 | STEP_RESET_EDIT_FLOW | 초기화 + 채점 후 편집 정책 |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | reset과 편집 정책으로 잔
  상/스테일 상태를 제거한다 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이는 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 일괄 채점은 문제별 결과 맵 생성
  (또는 동등 표현)을 포함해야 완성 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점은 문제별 채점 결과가 있어야 집계 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 제출/저장 경로를
  알아야 제거 후 회귀를 줄일 수 있음 | 0.76 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거 전에 대체 진입점을 마
  련하면 기능 공백을 방지 | 0.80 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 정의가 유용 | 0.70 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트를 gradeAll로 연결
  해야 UX 완성 | 0.72 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능해도 노출은
  hasGraded일 때 권장 | 0.70 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy가 있을 때만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADED_STATE_FLAG | 답 변경 시 hasGraded 초기화/재
  채점 유도 규칙이 필요 | 0.74 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정하는 편이 안정 | 0.70 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | UI의 “입력됨”
  직관과 정규화 기준이 어긋나 disabled/채점이 불일치 |
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개 상태
  에서 allAnswered가 흔들려 버튼 상태가 불안정 | problems
  길이 0/로딩 상태의 disabled 규칙을 명시하고 안정적으로 계
  산 | 0.74 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 버튼 라벨/disabled/재
  채점 상태가 분산되면 UX가 일관되지 않음 | 단일 버튼을 하
  단 고정 + derived state로 label/disabled를 결정 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점 중 입력 조
  회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → resultByProblemId 반환으로
  순수 함수화 | 0.78 |
  | 5 | LEARN_BUILD_RESULT_MAP | 결과를 index 기반으로 다루
  면 문제 순서 변경 시 오표시 위험 | 항상 problem.id 키로
  resultByProblemId를 구성/조회하도록 고정 | 0.76 |
  | 6 | LEARN_GRADED_STATE_FLAG | 복원/partial 데이터에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효한 채점 결과 존재”로 정의하고 일관되게 세팅 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | score/result
  렌더를 hasGraded로 게이트하고 채점 전에는 숨김 | 0.74 |
  | 8 | LEARN_SCORE_SUMMARY_CALC | results가 비어도 0/N이
  계산되어 채점 전 표시 혼선이 생김 | 계산은 하되 UI 노출은
  hasGraded일 때만 하도록 분리 | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | merge 저장 습관이
  남으면 partial/legacy가 계속 생겨 UX가 꼬임 | bulk는
  overwrite 스냅샷 저장으로 고정하고 schema로 명시 | 0.78 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 StoredResult{submissions}로 변환할 때 필드/형식 누락이
  발생 | gradeAll 결과를 단일 소스로 payload를 구성하고 직
  렬화 경로를 단순화 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성 및 회귀 추적이 어려움 | 채점 버튼 클릭 시
  점에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도(또는 초기
  화) | 0.74 |
  | 14 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result/flags 잔상이 남아 초기화가 체감되지 않음 | storage
  삭제와 함께 state(answer/result/hasGraded)를 초기값으로
  리셋 | 0.78 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태 발생 | 입력 변경 시 결
  과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 동시에 정
  합화한다 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서를 유연
  하게 만든다 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류를 줄인다 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터에서 hasGraded를 결정한 뒤 노출을 게이트하면
  표시 규칙이 단순해진다 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제를 차단한다 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 이후 결과 노출 여부
  를 게이트로 통제하면 스테일 상태를 예방한다 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 둔다 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | legacy/partial 판정과
  복원을 검증 단계로 매개해 런타임 꼬임을 줄인다 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 불일치를 줄
  인다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 흐름에서 bulk 저장
  으로 전환할 때 스키마를 중간 기준점으로 두면 회귀 추적이
  쉬워진다 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원/legacy 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
  ],
  "add_edges": [
  { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "정규화 기준 자체보다 '입력됨 predicate'를 중간
  노드로 두면 disabled/allAnswered를 한 번에 정합화할 수 있
  어 기존 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded 정의/도입은 gradeAll과 병렬로 가능해 단일 선행
  잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 구현 중 즉시 확인 가능해 필수
  선행 잠금보다 노트가 적절", "confidence": 0.70 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 restore 구현의 필수 개념이지만
  requires 잠금으로 강제할 필요는 낮음", "confidence":
  0.68 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 단일 선행 잠금은 과
  잉", "confidence": 0.78 }
  ],
  "notes": [
  { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  " , " 같은 입력에서 버튼 상태와 채점 결과가 불일치한
  다.", "confidence": 0.82 },
  { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, score/result 노출은 hasGraded일 때만
  하는 것이 권장이다.", "reason": "채점 전 0/N 및 legacy
  partial 노출을 통제하려면 표시 기준을 단일 플래그로 고정
  해야 한다.", "confidence": 0.74 },
  { "claim": "per-problem 제출 제거는 bulk 경로(버튼/
  gradeAll/저장)가 준비된 뒤 진행하는 것이 권장이다.",
  "reason": "제거가 먼저면 채점/저장 경로가 사라져 기능 공
  백이 발생한다.", "confidence": 0.72 },
  { "claim": "legacy partial(submissions 일부) 데이터는
  조건부로 감지해 초기화 또는 재채점 유도 등 정책을 적용하
  는 것이 권장이다.", "reason": "기존 merge 저장으로 부분
  데이터가 정상 생성되었고, 이를 그대로 노출하면 "채점됨"
  오해가 생긴다.", "confidence": 0.74 },
  { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행하는 것이 권장
  이다.", "reason": "키 삭제만 수행하면 화면에 남은 상태 때
  문에 초기화가 즉시 반영되지 않는다.", "confidence":
  0.78 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)로 문자열 내부 줄바꿈 없이 출력해야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검증/병합 파이프라인을 중단시킨다.", "confidence": 0.90 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | 기존
  submitProblem/저장 merge 동작을 알아야 bulk 전환 시 기능
  공백/회귀를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 partial 의미 |
  기존 per-problem 저장은 submissions 일부만 남기는 데이터
  가
  정상 생성되어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 동작/표시가 일
  관됨 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 " , " 등에서 UX가 붕괴
  | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정
  적으로 계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", " , ",
  "0", "-0", "1,234", "+", ".", "Infinity" 등에서 기대값이
  흔들림 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/집계 기준 | 점수/결과 표시/저
  장을 problemId로 정렬하는 중간 표현이 필요 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  legacy partial 결과 노출 혼선을 막을 표시 기준이 필요 |
  중
  |
  |12| 결과/점수 표시 게이팅 규칙 | 채점 후에만 점수/정오/
  정
  답을 표시해야 UX가 일관되고 partial 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “일괄
  채점 후 한 번에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함 | 중 |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 answer/result/flags 리셋이
  필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | per-problem 제출 제거 → bulk 채점 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 구현 후 제거 |
  | 2 | 원문 disabled → 정규화 채점 | " , " 등에서 활성/비
  활
  성과 채점 기준이 엇갈려 UX 붕괴 | normalizeNumericInput
  기
  반으로 미입력 판정 통일 |
  | 3 | bulk 버튼 추가 → allAnswered 부재 | disabled 조건이
  불명확해 조기 활성/비활성이 흔들림 | problems[] 기반
  allAnswered(정규화) 먼저 고정 |
  | 4 | 저장 구현 → 복원/검증 미정 | 파싱 실패/필드 누락 시
  런타임 오류 및 상태 꼬임 | schema+shape validate+예외 처
  리
  추가 |
  | 5 | legacy partial 복원 → 결과 노출 | 부분 submissions
  가
  “채점됨”처럼 보이면 오해/혼선 발생 | partial 감지 시
  hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | 초기화(키 삭제만) → UI 잔상 | storage만 지우면
  answer/result/flags가 화면에 남음 | 키 삭제 + UI state 리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submitProblem과
  StoredResult{submissions} setItem 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled의 '입력됨' 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading이 normalizeNumericInput을 사용
  하므로 원문 기준 disabled는 채점과 불일치해 UX를 망친
  다.",
  "confidence": 0.84 },
  { "claim": "점수/정오/정답 표시는 hasGraded로 게이트해
  야 채점 전 0/N 및 partial 노출 혼선을 줄인다.", "reason":
  "현재 score는 problems가 있으면 result가 비어도 0/N을 표
  시
  할 수 있어 오해를 유발한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 처리는 조
  건부 정책이며 restore를 migration에 과잉 잠금(requires)하
  지 않는 편이 안전하다.", "reason": "migration은 legacy가
  존재할 때만 필요하고 reviewer도 requires 과잉 잠금을 지적
  했다.", "confidence": 0.72 },
  { "claim": "per-problem 제출 제거는 권장 순서이며,
  bulk 경로(버튼/gradeAll/저장)가 준비된 뒤 제거해야 기능
  공
  백을 피한다.", "reason": "제거가 먼저면 채점/저장 경로가
  사라져 사용자가 진행 불가 상태가 된다.", "confidence":
  0.72 },
  { "claim": "다시 풀기는 localStorage 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태 때문에 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검
  증/병합 파이프라인을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch는 requires 엣지를 추가하지 않았다(json.loads 통
    과).
  - Requires 사이클: Pass — requires 추가 없음(새 requires
    사이클 생성 불가)로 자체 점검.
  - level 미제안: Pass — level/min_level을 표/JSON/notes 어
    디에도 제안하지 않았다.
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — 본 출력은 enables/
    analog_of만 제안했다.
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — Transfer 포함, Progression을 Appendix로 포함,
    Coverage는 Appendix 내 R1 Coverage Report로 포함.

  [/R3 Transfer Report]

  ###DONE:849ee3283b###


› 터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_f3b3ecfcc0.md


  71% context left



› Request f3b3ecfcc0: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_f3b3ecfcc0.md



•         
• Running wc -l .agents/inbox/research_f3b3ecfc 0.md
                                                    
       ng  research_f3b3ecfcc0.md
                               
                                           
           research_f3b3ec       
                                        
research_f3b3ecfcc0.md


• Ran wc -l .agents/inbox/research_f3b3ecfcc0.md
  └ 828 .agents/inbox/research_f3b3ecfcc0.md

  │ … +218 lines
•         
• └ Readting aSON f3b3ecfcc0.md


› Summarize recent commits

  66% context left · ? for shortcuts


• Ran python - <<'PY'
  │ import json
  │ s = r'''{
  │ … +218 lines
  └ ok R3 curriculum_viewer_learning_bulk_submit_v1 17 29 3

─ Worked for 6m 03s ────────────────────────────────────────

• ###BEGIN:f3b3ecfcc0###

  ## Transfer Edge Analysis

  ### Enables Edges (스킬 → 상위 문항 구조)

  | # | From | To | transfer 이유 | confidence |
  |---|------|----|--------------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT |
  PATTERN_SINGLE_ACTION_ENTRYPOINT | per-problem 제출 제거로
  단일 CTA 중심 구조로 전이된다. | 0.76 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON |
  PATTERN_SINGLE_ACTION_ENTRYPOINT | 하단 1버튼이 bulk 제출/
  채점의 유일 진입점이 된다. | 0.82 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | “입력됨” 기준을 정
  규화로 고정해 disabled/채점 불일치를 제거한다. | 0.82 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | allAnswered 파생값
  으로 “모두 입력 전 비활성” 게이트를 안정화한다. | 0.80 |
  | 5 | LEARN_DISABLED_EDGECASES_12 |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 엣지케이스 벡터로
  공백/콤마/부호 입력에서 게이트 회귀를 방지한다. | 0.74 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION |
  PATTERN_BATCH_GRADE_PIPELINE | 전체 문제 순회 채점을 배치
  파이프라인 구조로 정리한다. | 0.80 |
  | 7 | LEARN_BUILD_RESULT_MAP |
  PATTERN_CANONICAL_RESULT_MAP | problemId keyed 결과맵이 표
  시/집계/저장의 공통 중간표현이 된다. | 0.78 |
  | 8 | LEARN_GRADED_STATE_FLAG |
  PATTERN_POST_GRADE_VISIBILITY_GATING | hasGraded 플래그로
  결과 노출 시점을 단일 기준으로 만든다. | 0.78 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING |
  PATTERN_POST_GRADE_VISIBILITY_GATING | 채점 전 0/N·정답 선
  노출 같은 UX 붕괴를 게이팅으로 차단한다. | 0.76 |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 스키마 계약이 있
  어야 “채점 후 1회 overwrite” 스냅샷 구조가 성립한다. |
  0.78 |
  | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  PATTERN_RESTORE_VALIDATE_MIGRATE | 복원을
  parse→validate→migrate/reset 파이프라인 구조로 전이한다. |
  0.76 |
  | 12 | LEARN_RESET_UI_STATE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | UI 잔상 제거까지 포함
  한 “완전 초기화” 구조로 전이된다. | 0.80 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 채점 후 답 변경 시
  결과 무효화 및 재채점 유도 구조가 필요하다. | 0.74 |
  | 14 | LEARN_STRICT_JSON_OUTPUT_GUARD |
  PATTERN_STRICT_JSON_OUTPUT_VALIDATION | 파싱 실패를 사전에
  차단하는 strict JSON 검증 게이트로 전이된다. | 0.86 |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | PATTERN_NORMALIZED_COMPLETENESS_GATE |
  STRUCT_PREDICATE_GATED_ACTION | predicate로 액션을 게이트
  하는 구조가 동형이다. | 0.74 |
  | 2 | PATTERN_POST_GRADE_VISIBILITY_GATING |
  STRUCT_PREDICATE_GATED_ACTION | 불리언 플래그로 가시성/액
  션을 제어하는 게이트 구조가 동형이다. | 0.72 |
  | 3 | PATTERN_BATCH_GRADE_PIPELINE |
  STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP | 컬렉션 순회
  →keyed 결과 생성 구조가 동형이다. | 0.76 |
  | 4 | PATTERN_CANONICAL_RESULT_MAP |
  STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP | keyed map을 중간
  표현으로 고정해 후속 연산을 단순화한다. | 0.70 |
  | 5 | PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | 버전/스키마를 포함한
  스냅샷 저장 구조가 동형이다. | 0.68 |
  | 6 | PATTERN_RESTORE_VALIDATE_MIGRATE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | validate 후 migrate/
  reset 분기하는 복원 구조가 동형이다. | 0.72 |
  | 7 | PATTERN_EDIT_INVALIDATES_AND_REGRADES |
  STRUCT_CACHE_INVALIDATION_ON_MUTATION | mutation이 기존 결
  과를 무효화하고 재계산을 요구하는 구조가 동형이다. | 0.74
  |
  | 8 | PATTERN_RESET_CLEAR_STORAGE_AND_UI |
  STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE | persisted
  state 제거와 UI rehydrate를 동기화하는 구조가 동형이다. |
  0.72 |
  | 9 | PATTERN_STRICT_JSON_OUTPUT_VALIDATION |
  STRUCT_OUTPUT_VALIDATION_PIPELINE | 출력 형식/파싱을 게이
  트로 두어 실패를 조기에 차단하는 구조다. | 0.78 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답
  생성 규칙 |
  |---|---------|------------------|-----------|------------
  ---|
  | 1 | 정규화 기반 완결성 게이트 | N:1~50,
  answers:string[], normalizeNumericInput | disabled = !
  all_i(len(norm(ans_i))>0) | raw input 기준 판정, trim만 적
  용, "0"를 빈값 처리 |
  | 2 | 배치 채점→결과맵 생성 | problems[{id}] (1~50),
  answersMap, gradeOne |
  resultById[id]=gradeOne(id,answers[id]) | index 기반 키,
  순회 중 setState 혼합, 키 불일치 |
  | 3 | 채점 후 가시성 게이팅 | hasGraded:bool, resultById |
  show = hasGraded ? result/score : hidden | 채점 전 0/N 노
  출, 정답 선노출, flag 누락 |
  | 4 | 버전드 스냅샷 1회 저장 | nodeId,
  payload{answers,results,version,updatedAt} |
  setItem(key(nodeId), JSON.stringify(payload))
  onceAfterGrade | merge 저장으로 partial 생성, version 누
  락, nodeId 누락 |
  | 5 | 복원 parse→validate→정책 분기 | storedStr(valid/
  invalid/legacyPartial), problemsLen, policy |
  invalid→reset; legacyPartial→policyBranch; else restore |
  JSON.parse 크래시, partial을 graded로 오인, 불일치 미처리
  |
  | 6 | strict JSON 출력 검증 게이트 | jsonText 후보(줄바꿈
  포함/미포함), parser(json.loads) | parse ok && no literal
  newline-in-string | 문자열 내부 줄바꿈 허용, 주석/트레일링
  콤마 허용 |

  ### 상세 템플릿 예시 (3개)

  Template 1: 정규화 기반 완결성 게이트
  - Parameters: { N: [1,50], answers: ["", "   ", "1,234",
  "0", ".", "+", "-0", "Infinity"], normalize:
  normalizeNumericInput }
  - Answer: disabled = !all_i( normalize(answers[i]).length
  > 0 )
  - Distractors: [raw input length로 판정, trim만 적용,
  "0"를 빈값 처리, parseFloat 기반 판정]
  - Required Skills: [LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Template 2: 버전드 스냅샷 1회 저장
  - Parameters: { nodeId: ["nA","nB"], payload:
  { answersMap, resultByProblemId, updatedAt: [unixMs],
  version: [1,2] } }
  - Answer: key(nodeId) = "curriculum-
  viewer:learn:lastResult:" + nodeId; setItem(key(nodeId),
  JSON.stringify(payload)) (after grade, once)
  - Distractors: [merge 저장으로 partial 생성, 저장 시점이
  채점 전, version 누락, nodeId 누락으로 노드 간 오염]
  - Required Skills: [LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK]

  Template 3: strict JSON 출력 검증 게이트
  - Parameters: { jsonText: [validStrictJSON,
  jsonWithNewlineInString, jsonWithTrailingComma],
  validator: json.loads }
  - Answer: accept iff json.loads(jsonText) succeeds and no
  literal newline exists inside any string value
  - Distractors: [실제 줄바꿈을 문자열 값에 포함, 주석 허용,
  trailing comma 허용]
  - Required Skills: [LEARN_STRICT_JSON_OUTPUT_GUARD]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 조건 충족 전 잠금 해제 | 필수 항목 입력 전 “제출” 버
  튼 비활성 | required 필드 누락 시 commit 차단 | 모든 점 지
  정 전 “면적 계산” 버튼 비활성 |
  | 2 | 배치 처리 파이프라인 | 영수증을 모아 한 번에 정산 |
  배치 잡으로 레코드 처리 결과맵 생성 | 여러 도형 값을 일괄
  계산해 요약 |
  | 3 | 버전드 스냅샷 저장/복원 | 임시저장 후 이어하기(구버
  전 변환) | versioned snapshot validate→migrate/reset | CAD
  도면 저장/로드 시 버전 변환 |
  | 4 | 수정 시 결과 무효화/재계산 | 주문 변경 시 영수증/총
  액 재계산 | 입력 변경 시 캐시 무효화 후 재집계 | 점 이동
  시 길이/넓이 재계산 |
  | 5 | 출력 검증 게이트 | 제출 서식 검증 실패 시 반려 |
  strict JSON 파싱 실패 시 병합 중단 | 파일 포맷 검증 실패
  시 로드 거부 |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 조건 충족 전 잠금 해제
  - 생활: 온라인 신청서에서 필수 항목을 모두 입력하기 전까지
  "제출" 버튼이 비활성화된다.
  - 데이터: 파이프라인에서 required 필드가 모두 채워지기 전
  에는 commit 단계가 실행되지 않는다.
  - 도형: 좌표평면에서 다각형의 모든 꼭짓점을 지정하기 전에
  는 "면적 계산" 버튼이 비활성화된다.
  - 공통 스킬: [LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED,
  LEARN_DISABLED_EDGECASES_12]

  Triplet 2: 버전드 스냅샷 저장/복원
  - 생활: 장바구니/신청서를 임시저장했다가 재접속 시 동일 상
  태로 복원하되, 구버전 데이터는 변환 또는 초기화된다.
  - 데이터: versioned snapshot을 읽어 validate 후 migrate/
  reset 분기하여 안전하게 rehydrate 한다.
  - 도형: CAD 도면을 저장/로드할 때 버전 정보를 통해 포맷을
  변환하고, 깨진 파일은 복구 불가로 초기화한다.
  - 공통 스킬: [LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type":
  "micro", "name_ko": "단일 주요 액션 진입점(하단 1버튼)",
  "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "type": "micro", "name_ko": "정규화 기반 완결성 게이트
  (allAnswered로 비활성)", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_BATCH_GRADE_PIPELINE", "type":
  "micro", "name_ko": "배치 채점 파이프라인(수집→채점→결과
  맵)", "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_CANONICAL_RESULT_MAP", "type":
  "micro", "name_ko": "정규 키 기반 결과맵
  (resultByProblemId) 중간표현", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "type": "micro", "name_ko": "채점 후 가시성 게이팅
  (hasGraded로 score/result 노출)", "domain": "UX", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "type": "micro", "name_ko": "버전드 스냅샷 저장(채점 후 1
  회 overwrite)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_RESTORE_VALIDATE_MIGRATE", "type":
  "micro", "name_ko": "복원 파이프라인
  (parse→validate→migrate/reset)", "domain": "FE", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "type": "micro", "name_ko": "legacy partial 감지 후 정책
  분기(초기화/재채점 유도)", "domain": "ARCH", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type":
  "micro", "name_ko": "완전 초기화(저장소 삭제+UI 상태 리
  셋)", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "type": "micro", "name_ko": "채점 후 수정 시 결과 무효화
  및 재채점 유도", "domain": "UX", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_STRICT_JSON_OUTPUT_VALIDATION",
  "type": "micro", "name_ko": "산출물 strict JSON 검증 게이
  트(json.loads 통과)", "domain": "QA", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "micro", "name_ko": "predicate로 액션/가시성을 게이트하는
  구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP",
  "type": "micro", "name_ko": "컬렉션을 순회해 keyed map을
  만드는 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "micro", "name_ko": "버전드 스냅샷 저장/복원 및 마이그레이
  션 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_CACHE_INVALIDATION_ON_MUTATION",
  "type": "micro", "name_ko": "mutation 시 결과/캐시 무효화
  후 재계산 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE",
  "type": "micro", "name_ko": "persisted state 제거와 UI
  rehydrate를 동기화하는 구조", "domain": "STRUCT", "rep":
  "C", "lens": ["transform"] },
      { "id": "STRUCT_OUTPUT_VALIDATION_PIPELINE", "type":
  "micro", "name_ko": "출력 검증 파이프라인(형식/파싱/정
  책)", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] }
    ],
    "add_edges": [
      { "from": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "to":
  "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type": "enables",
  "reason": "개별 제출 경로 제거로 단일 CTA 중심 구조를 강제
  한다.", "confidence": 0.76 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type": "enables",
  "reason": "하단 1버튼이 bulk 제출/채점의 유일 진입점이 된
  다.", "confidence": 0.82 },
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "입력됨 기준을 정규화로 고정하면 게이트 판정이
  안정된다.", "confidence": 0.82 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "allAnswered가 단일 버튼 disabled 게이트의 핵심
  파생값이다.", "confidence": 0.8 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "엣지 입력을 고정해 게이트 회귀를 줄인다.",
  "confidence": 0.74 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "PATTERN_BATCH_GRADE_PIPELINE", "type": "enables",
  "reason": "전체 문제를 순회하는 배치 처리 구조로 전이된
  다.", "confidence": 0.8 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "PATTERN_CANONICAL_RESULT_MAP", "type": "enables",
  "reason": "problemId keyed 결과맵이 표시/집계/저장의 공통
  중간표현이 된다.", "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "hasGraded로 결과 노출 시점을 단일 기준으로 만든
  다.", "confidence": 0.78 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "채점 전 0/N·정답 선노출을 게이팅으로 차단하는
  구조다.", "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "스키마가 고정되어야 '채점 후 1회 저
  장' 스냅샷이 성립한다.", "confidence": 0.78 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "UI 상태를 payload로 직렬화하는 표현
  전환이 필요하다.", "confidence": 0.78 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "merge 대신 overwrite 저장으로
  partial 생성 원인을 줄인다.", "confidence": 0.78 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "복원 전 검증 단계가 invalid/타 노드 데이터에 대
  한 방어가 된다.", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "restore를 파이프라인으로 정리하면 예외/정책 분
  기가 명확해진다.", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH", "type": "enables",
  "reason": "legacy partial 감지 후 초기화/재채점 유도 정책
  분기가 필요하다.", "confidence": 0.72 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "저장소 삭제는 초기화의 근거이며 UI 리셋과 결합
  되어야 한다.", "confidence": 0.78 },
      { "from": "LEARN_RESET_UI_STATE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "화면 잔상을 제거해야 초기화 UX가 즉시 체감된
  다.", "confidence": 0.8 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "답 변경 시 결과 무효화 후 재채점으로
  전이되어 stale 상태를 막는다.", "confidence": 0.74 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "PATTERN_STRICT_JSON_OUTPUT_VALIDATION", "type":
  "enables", "reason": "출력 파싱 실패를 사전에 차단하는 검
  증 게이트가 된다.", "confidence": 0.86 },
      { "from": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "정규화된 상태에서 predicate로 액션
  을 게이트하는 구조가 동일하다.", "confidence": 0.74 },
      { "from": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "불리언 플래그로 가시성/액션을 제어
  하는 게이트 구조가 동일하다.", "confidence": 0.72 },
      { "from": "PATTERN_BATCH_GRADE_PIPELINE", "to":
  "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP", "type":
  "analog_of", "reason": "컬렉션을 순회해 keyed 결과를 만드
  는 구조가 동형이다.", "confidence": 0.76 },
      { "from": "PATTERN_CANONICAL_RESULT_MAP", "to":
  "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP", "type":
  "analog_of", "reason": "keyed map을 중간표현으로 고정해 후
  속 연산을 단순화한다.", "confidence": 0.7 },
      { "from": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "버전/스키마를 포함한 스냅샷 저장
  구조가 동일하다.", "confidence": 0.68 },
      { "from": "PATTERN_RESTORE_VALIDATE_MIGRATE", "to":
  "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "validate 후 migrate/reset 분기하는
  복원 구조가 동일하다.", "confidence": 0.72 },
      { "from": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "partial/legacy 감지 후 정책 분기
  구조가 마이그레이션 구조와 동형이다.", "confidence":
  0.7 },
      { "from": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "to": "STRUCT_CACHE_INVALIDATION_ON_MUTATION", "type":
  "analog_of", "reason": "mutation이 기존 결과를 무효화하고
  재계산을 요구하는 구조가 동형이다.", "confidence": 0.74 },
      { "from": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "to":
  "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE", "type":
  "analog_of", "reason": "persisted state 제거와 UI 재수화를
  함께 해야 일관성이 유지된다.", "confidence": 0.72 },
      { "from": "PATTERN_STRICT_JSON_OUTPUT_VALIDATION",
  "to": "STRUCT_OUTPUT_VALIDATION_PIPELINE", "type":
  "analog_of", "reason": "출력 형식/파싱을 게이트로 두어 실
  패를 조기에 차단하는 구조다.", "confidence": 0.78 }
    ],
    "notes": [
      { "claim": "FE/UX 스펙에서도 Transfer는 상태 전이 구조
  (게이트·파이프라인·스냅샷)로 재해석해 enables/analog_of로
  모델링할 수 있다.", "reason": "단일 버튼/disabled/저장·복
  원 요구는 모두 추상 구조로 전이 가능하다.", "confidence":
  0.74 },
      { "claim": "strict JSON 출력 검증은 기능 구현과 별개로
  병합 파이프라인을 살리는 품질 게이트로 분리하는 편이 좋
  다.", "reason": "문자열 내부 줄바꿈 등은 내용이 맞아도 파
  싱 실패로 전체 결합 검증이 중단된다.", "confidence":
  0.86 },
      { "claim": "R3 패치는 requires를 추가하지 않고
  enables/analog_of만 제안한다.", "reason": "필수 선행 잠금
  (requires)은 R2 소관이며 R3는 전이/동형 구조 연결에 집중한
  다.", "confidence": 0.9 }
    ]
  }

  ## APPENDIX: R2 Progression Report (verbatim)

  [Previous Researcher Handoff (R2 Progression Report)]

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항의 단일 진입점 제공 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 미입력 판정
  predicate 정의(정규화 기반) | FE | C | disabled/채점 기준
  불일치로 인한 UX 붕괴 방지 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled”를
  안정적으로 계산 |
  | 5 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  테스트 벡터 | QA | C | 공백/콤마/부호 등 판정 흔들림을 사
  전에 고정 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 한 번의 클릭으로 모든 문제 채점 수행 |
  | 7 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장의 공통
  중간 표현 마련 |
  | 8 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 결과 노출 시점 기준을 단일 플
  래그로 고정 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/결
  과 표시(게이팅) | FE | P | 채점 전 0/N 및 partial 노출 혼
  선 차단 |
  | 10 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | resultByProblemId 기반으로 점수 집계를 안정화 |
  | 11 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 카드에 정오/정답값을 일
  관되게 렌더 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | 저장/복원/legacy 정책의 기준 스
  키마 확정 |
  | 13 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 submissions payload로 변환 | FE | P | UI 상태를
  StoredResult{submissions}로 표현전환 |
  | 14 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고
  스냅샷 저장으로 단순화 |
  | 15 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/shape validate | FE | C | JSON 파싱 실패/필드 누락으로
  인한 런타임 오류 방지 |
  | 16 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 감지/정책 적용 | FE | C | 기존 merge 저장
  이 만든 partial을 bulk UX에 맞게 처리 |
  | 17 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태 복원 |
  | 18 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화 기반 마련 |
  | 19 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면 잔상(answer/result/flags)을 즉시 제거 |
  | 20 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과) 방지 |
  | 21 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장 | QA | C | 파싱 실패(문자열 줄바꿈 등)로
  병합 불가 문제 차단 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼 UX와 disabled
  기준을 함께 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | 채점→중간표현→게이팅→표시
  를 일관된 흐름으로 구성 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회 + legacy 조건부 처리 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 초기화 잔상 제거와 스테일
  결과 방지 정책을 묶어 적용 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 줄바꿈 없는 strict
  JSON으로 결합 검증/병합 가능 상태 보장 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 문제 전체 채점 결과가
  있어야 구성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 집계는 문제별 결과가 있어야 계산 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 기준을 먼저 고정하면 안전 | 0.70 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 클릭 이벤트를 gradeAll로 연
  결해야 UX가 완성됨 | 0.72 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 계산은 가능해도 노출은
  hasGraded일 때만 권장 | 0.70 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 6 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 7 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy 존재 시에만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 8 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정하는 편이 안정 | 0.70 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 10 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 답 변경 시 결과 초기화/재
  채점 유도에 게이팅 기준이 필요 | 0.74 |
  | 11 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | bulk 경로 준비 후 제거
  하면 기능 공백을 방지 | 0.80 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 출력 품질 검증을 단계로 분리하
  면 병합 실패를 예방 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 직관
  과 정규화 기준이 어긋나 disabled/채점 불일치 |
  normalizeNumericInput 기반 predicate로 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개에서
  allAnswered가 흔들려 버튼 상태 불안정 | problems 길이 0/
  로딩 상태 규칙을 명시 | 0.74 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 라벨/disabled/재채점
  상태가 분산되면 UX 해석이 어려움 | derived state로 label/
  disabled를 결정 | 0.70 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 입력 조
  회/빈값 처리/채점 호출이 섞여 인지부하 증가 | gradeAll을
  순수 함수로 분리해 map 반환 | 0.78 |
  | 5 | LEARN_BUILD_RESULT_MAP | index 기반 처리로 문제 순
  서/ID 불일치 시 오표시 위험 | 항상 problemId 키로
  resultByProblemId 구성 | 0.76 |
  | 6 | LEARN_GRADED_STATE_FLAG | 복원/partial에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효 결과 존재”로 정의 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전 0/N 노출로
  “이미 채점됨” 오해 발생 | score/result 렌더를 hasGraded로
  게이트 | 0.74 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK | answers/results를
  submissions 스키마로 전환할 때 누락/불일치 발생 | 스키마
  를 답안+정오 중심으로 단일화 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_SAVE_BULK | merge 저장 습관으로
  partial이 계속 생겨 UX 충돌 | gradeAll 결과로 overwrite
  스냅샷 저장 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨짐 | try/catch +
  nodeId 검증 + shape validate | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도 | 0.74 |
  | 12 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result 잔상이 남아 초기화가 체감되지 않음 | storage 삭제
  와 state 리셋을 함께 수행 | 0.78 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해 “입력≠결과” 상태 발생 | 입력 변경 시 결과
  초기화 또는 재채점 고정 | 0.76 |
  | 14 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 줄바꿈 등
  으로 patch JSON 파싱 실패가 반복됨 | 문자열 줄바꿈 금지 +
  json.loads 동등 검증 | 0.90 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 함께 정합
  화 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | STEP_BULK_SUBMIT_UI_FLOW |
  UI 추가를 allAnswered 구현과 분리해 병렬 작업이 가능 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  버튼 배치와 클릭 핸들러 연결을 단계로 묶어 점프를 완화 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 일관성 강화
  |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  표시 로직을 중간 표현에만 의존하도록 분리해 오표시를 줄임
  |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 변환 단계 추가 |
  | 7 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 저장된 데이터의 파싱/
  검증 단계를 매개로 복원 실패를 완화 |
  | 8 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 시 hasGraded 기준을 먼저 확정해 노출 규칙을 단순화 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_AND_EDIT_FLOW | reset을 하나의 플로우로 묶어
  잔상/부분 초기화를 방지 |
  | 10 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후 결과 노출을 게이
  트로 통제하면 스테일 상태를 예방 |
  | 11 | (비-strict JSON) → (병합/검증 실패) |
  LEARN_STRICT_JSON_OUTPUT_GUARD | 산출물 품질을 별도 노드
  로 두면 파싱 실패를 조기에 차단 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "answers/results를 submissions
  payload로 변환", "domain": "FE", "rep": "P",
  "confidence": 0.80 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장",
  "domain": "QA", "rep": "C", "confidence": 0.90 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
  { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
  ],
  "add_edges": [
  { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 결과 존재로 파생하거나 액션에서 세팅하는 등
  대체 경로가 있어 필수 선행 잠금은 과잉", "confidence":
  0.72 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 }
  ],
  "notes": [
  { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  공백/콤마 입력에서 버튼 상태와 채점 결과가 불일치한다.",
  "confidence": 0.82 },
  { "claim": "버튼 추가와 allAnswered 구현은 병렬로 가
  능하고, 최종적으로 disabled 조건만 연결하면 된다.",
  "reason": "UI를 먼저 만들고 이후에 allAnswered 로직을 붙
  이는 경로가 자연스럽고 회귀 위험이 낮다.", "confidence":
  0.70 },
  { "claim": "legacy partial은 조건부로만 필요하므로
  requires보다 노트/권장 선행으로 관리하는 것이 적절하다.",
  "reason": "partial은 기존 merge 저장 데이터가 존재할 때만
  발생하고, 항상 필요한 선행 관계가 아니다.", "confidence":
  0.74 },
  { "claim": "score/result 노출은 hasGraded로 게이트하
  는 것이 권장이다.", "reason": "채점 전 0/N 및 부분 데이터
  노출을 방지하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
  { "claim": "reset은 localStorage 키 삭제와 UI state
  리셋을 함께 수행하는 것이 권장이다.", "reason": "키 삭제
  만 수행하면 화면에 남은 answer/result 잔상으로 인해 초기
  화가 체감되지 않는다.", "confidence": 0.78 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력되어야 한다.", "reason": "문자열
  줄바꿈은 파싱 실패를 유발해 결합 검증/병합 파이프라인을
  중단시킨다.", "confidence": 0.90 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 merge를 이해해야 bulk 전환 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 legacy partial
  의미 | 기존 merge 저장으로 부분 submissions가 정상 생성되
  어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 함 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 UX가 붕괴 | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정화
  필요 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", "0",
  "-0", "1,234", "+", ".", "Infinity" 등 기대값을 고정해야
  함 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재 단건 채점만 가
  능
  하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/단일 소스화 | 점수 집계/문제
  별
  결과 표시/저장을 동일 키(problemId)로 정렬해야 함 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  partial 결과 노출 혼선을 막을 표시 기준이 필요 | 중 |
  |12| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 표시
  해야 UX가 일관되고 legacy 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “한 번
  에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 상태 꼬임을 방지해야 함 | 중
  |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 state 리셋이 필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/근사/분수) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 준비
  후
  제거 |
  | 2 | 원문 disabled 판정 → 정규화 채점 | " , " 등에서 활
  성/비활성과 채점 기준이 엇갈려 UX 붕괴 |
  normalizeNumericInput 기반으로 미입력 판정 통일 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 불명확하
  면
  조기 활성/비활성이 흔들림 | problems[] 기준
  allAnswered(정
  규화) 먼저 고정 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증 없이 복원하면 파싱
  실패/필드 누락으로 런타임 오류 | schema+shape validate+예
  외 처리 추가 |
  | 5 | legacy partial 복원 → 결과/점수 노출 | 부분
  submissions가 “채점됨”처럼 보이면 오해/혼선 발생 |
  partial
  감지 시 hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | LEARN_RESET_CLEAR_STORAGE → UI 잔상 유지 | storage
  만
  지우면 answer/result/flags가 화면에 남음 | 키 삭제 + UI
  state 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C", "confidence": 0.8 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.84 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P", "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P", "confidence": 0.75 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체 저
  장)",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C", "confidence":
  0.72 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C", "confidence": 0.74 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.84 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.75 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submissions를 기존 값과 병합
  해 setItem하는 흐름이 확인된다.", "confidence": 0.86 },
  { "claim": "미입력 판정(disabled)은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading.ts가 normalizeNumericInput을
  사
  용하므로 원문 기준 판정은 활성/채점 불일치를 만든다.",
  "confidence": 0.84 },
  { "claim": "현재 점수 표시는 채점 전에도 0/N이 노출될
  수 있어 hasGraded 게이팅이 필요하다.", "reason": "score는
  problems가 있으면 result가 비어도 correct=0,total=N을 표
  시
  할 수 있다.", "confidence": 0.74 },
  { "claim": "legacy partial 처리는 조건부 정책이며
  restore에 과잉 잠금(requires)으로 고정하지 않는 편이 안전
  하다.", "reason": "partial은 legacy 데이터가 존재할 때만
  발생하고 reviewer도 requires 과잉 잠금을 지적했다.",
  "confidence": 0.72 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태로 인해 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 검증/
  병
  합을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - R3 Graph Patch JSON 파싱(json.loads): Pass (strict JSON,
    문자열 값 내부 실제 줄바꿈 없음)
  - Requires-only 잠금(새 requires 제안): Pass (R3는
    enables/analog_of만 제안)
  - Requires 사이클: Pass (새 requires 엣지 추가 없음으로 자
    체 점검)
  - level 미제안: Pass (level/min_level 미포함)
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 (R3는 전이/동형만 제안)
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass (Transfer 포함, Appendix에 R2+R1 포함)

  [/R3 Transfer Report]

  ###DONE:f3b3ecfcc0###


› Summarize recent commits

  58% context left · ? for shortcuts


============================================================
[2026-01-08 13:41:48] RESEARCH3 (req_id: 28f5d43214)
============================================================
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼 UX와 disabled
  기준을 함께 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | 채점→중간표현→게이팅→표시
  를 일관된 흐름으로 구성 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회 + legacy 조건부 처리 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 초기화 잔상 제거와 스테일
  결과 방지 정책을 묶어 적용 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 줄바꿈 없는 strict
  JSON으로 결합 검증/병합 가능 상태 보장 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 문제 전체 채점 결과가
  있어야 구성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 집계는 문제별 결과가 있어야 계산 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 기준을 먼저 고정하면 안전 | 0.70 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 클릭 이벤트를 gradeAll로 연
  결해야 UX가 완성됨 | 0.72 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 계산은 가능해도 노출은
  hasGraded일 때만 권장 | 0.70 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 6 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 7 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy 존재 시에만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 8 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정하는 편이 안정 | 0.70 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 10 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 답 변경 시 결과 초기화/재
  채점 유도에 게이팅 기준이 필요 | 0.74 |
  | 11 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | bulk 경로 준비 후 제거
  하면 기능 공백을 방지 | 0.80 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 출력 품질 검증을 단계로 분리하
  면 병합 실패를 예방 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 직관
  과 정규화 기준이 어긋나 disabled/채점 불일치 |
  normalizeNumericInput 기반 predicate로 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개에서
  allAnswered가 흔들려 버튼 상태 불안정 | problems 길이 0/
  로딩 상태 규칙을 명시 | 0.74 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 라벨/disabled/재채점
  상태가 분산되면 UX 해석이 어려움 | derived state로 label/
  disabled를 결정 | 0.70 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 입력 조
  회/빈값 처리/채점 호출이 섞여 인지부하 증가 | gradeAll을
  순수 함수로 분리해 map 반환 | 0.78 |
  | 5 | LEARN_BUILD_RESULT_MAP | index 기반 처리로 문제 순
  서/ID 불일치 시 오표시 위험 | 항상 problemId 키로
  resultByProblemId 구성 | 0.76 |
  | 6 | LEARN_GRADED_STATE_FLAG | 복원/partial에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효 결과 존재”로 정의 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전 0/N 노출로
  “이미 채점됨” 오해 발생 | score/result 렌더를 hasGraded로
  게이트 | 0.74 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK | answers/results를
  submissions 스키마로 전환할 때 누락/불일치 발생 | 스키마
  를 답안+정오 중심으로 단일화 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_SAVE_BULK | merge 저장 습관으로
  partial이 계속 생겨 UX 충돌 | gradeAll 결과로 overwrite
  스냅샷 저장 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨짐 | try/catch +
  nodeId 검증 + shape validate | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도 | 0.74 |
  | 12 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result 잔상이 남아 초기화가 체감되지 않음 | storage 삭제
  와 state 리셋을 함께 수행 | 0.78 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해 “입력≠결과” 상태 발생 | 입력 변경 시 결과
  초기화 또는 재채점 고정 | 0.76 |
  | 14 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 줄바꿈 등
  으로 patch JSON 파싱 실패가 반복됨 | 문자열 줄바꿈 금지 +
  json.loads 동등 검증 | 0.90 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 함께 정합
  화 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | STEP_BULK_SUBMIT_UI_FLOW |
  UI 추가를 allAnswered 구현과 분리해 병렬 작업이 가능 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  버튼 배치와 클릭 핸들러 연결을 단계로 묶어 점프를 완화 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 일관성 강화
  |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  표시 로직을 중간 표현에만 의존하도록 분리해 오표시를 줄임
  |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 변환 단계 추가 |
  | 7 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 저장된 데이터의 파싱/
  검증 단계를 매개로 복원 실패를 완화 |
  | 8 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 시 hasGraded 기준을 먼저 확정해 노출 규칙을 단순화 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_AND_EDIT_FLOW | reset을 하나의 플로우로 묶어
  잔상/부분 초기화를 방지 |
  | 10 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후 결과 노출을 게이
  트로 통제하면 스테일 상태를 예방 |
  | 11 | (비-strict JSON) → (병합/검증 실패) |
  LEARN_STRICT_JSON_OUTPUT_GUARD | 산출물 품질을 별도 노드
  로 두면 파싱 실패를 조기에 차단 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "answers/results를 submissions
  payload로 변환", "domain": "FE", "rep": "P",
  "confidence": 0.80 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장",
  "domain": "QA", "rep": "C", "confidence": 0.90 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
  { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
  ],
  "add_edges": [
  { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 결과 존재로 파생하거나 액션에서 세팅하는 등
  대체 경로가 있어 필수 선행 잠금은 과잉", "confidence":
  0.72 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 }
  ],
  "notes": [
  { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  공백/콤마 입력에서 버튼 상태와 채점 결과가 불일치한다.",
  "confidence": 0.82 },
  { "claim": "버튼 추가와 allAnswered 구현은 병렬로 가
  능하고, 최종적으로 disabled 조건만 연결하면 된다.",
  "reason": "UI를 먼저 만들고 이후에 allAnswered 로직을 붙
  이는 경로가 자연스럽고 회귀 위험이 낮다.", "confidence":
  0.70 },
  { "claim": "legacy partial은 조건부로만 필요하므로
  requires보다 노트/권장 선행으로 관리하는 것이 적절하다.",
  "reason": "partial은 기존 merge 저장 데이터가 존재할 때만
  발생하고, 항상 필요한 선행 관계가 아니다.", "confidence":
  0.74 },
  { "claim": "score/result 노출은 hasGraded로 게이트하
  는 것이 권장이다.", "reason": "채점 전 0/N 및 부분 데이터
  노출을 방지하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
  { "claim": "reset은 localStorage 키 삭제와 UI state
  리셋을 함께 수행하는 것이 권장이다.", "reason": "키 삭제
  만 수행하면 화면에 남은 answer/result 잔상으로 인해 초기
  화가 체감되지 않는다.", "confidence": 0.78 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력되어야 한다.", "reason": "문자열
  줄바꿈은 파싱 실패를 유발해 결합 검증/병합 파이프라인을
  중단시킨다.", "confidence": 0.90 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 merge를 이해해야 bulk 전환 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 legacy partial
  의미 | 기존 merge 저장으로 부분 submissions가 정상 생성되
  어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 함 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 UX가 붕괴 | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정화
  필요 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", "0",
  "-0", "1,234", "+", ".", "Infinity" 등 기대값을 고정해야
  함 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재 단건 채점만 가
  능
  하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/단일 소스화 | 점수 집계/문제
  별
  결과 표시/저장을 동일 키(problemId)로 정렬해야 함 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  partial 결과 노출 혼선을 막을 표시 기준이 필요 | 중 |
  |12| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 표시
  해야 UX가 일관되고 legacy 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “한 번
  에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 상태 꼬임을 방지해야 함 | 중
  |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 state 리셋이 필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/근사/분수) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 준비
  후
  제거 |
  | 2 | 원문 disabled 판정 → 정규화 채점 | " , " 등에서 활
  성/비활성과 채점 기준이 엇갈려 UX 붕괴 |
  normalizeNumericInput 기반으로 미입력 판정 통일 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 불명확하
  면
  조기 활성/비활성이 흔들림 | problems[] 기준
  allAnswered(정
  규화) 먼저 고정 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증 없이 복원하면 파싱
  실패/필드 누락으로 런타임 오류 | schema+shape validate+예
  외 처리 추가 |
  | 5 | legacy partial 복원 → 결과/점수 노출 | 부분
  submissions가 “채점됨”처럼 보이면 오해/혼선 발생 |
  partial
  감지 시 hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | LEARN_RESET_CLEAR_STORAGE → UI 잔상 유지 | storage
  만
  지우면 answer/result/flags가 화면에 남음 | 키 삭제 + UI
  state 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C", "confidence": 0.8 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.84 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P", "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P", "confidence": 0.75 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체 저
  장)",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C", "confidence":
  0.72 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C", "confidence": 0.74 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.84 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.75 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submissions를 기존 값과 병합
  해 setItem하는 흐름이 확인된다.", "confidence": 0.86 },
  { "claim": "미입력 판정(disabled)은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading.ts가 normalizeNumericInput을
  사
  용하므로 원문 기준 판정은 활성/채점 불일치를 만든다.",
  "confidence": 0.84 },
  { "claim": "현재 점수 표시는 채점 전에도 0/N이 노출될
  수 있어 hasGraded 게이팅이 필요하다.", "reason": "score는
  problems가 있으면 result가 비어도 correct=0,total=N을 표
  시
  할 수 있다.", "confidence": 0.74 },
  { "claim": "legacy partial 처리는 조건부 정책이며
  restore에 과잉 잠금(requires)으로 고정하지 않는 편이 안전
  하다.", "reason": "partial은 legacy 데이터가 존재할 때만
  발생하고 reviewer도 requires 과잉 잠금을 지적했다.",
  "confidence": 0.72 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태로 인해 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 검증/
  병
  합을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - R3 Graph Patch JSON 파싱(json.loads): Pass (strict JSON,
    문자열 값 내부 실제 줄바꿈 없음)
  - Requires-only 잠금(새 requires 제안): Pass (R3는
    enables/analog_of만 제안)
  - Requires 사이클: Pass (새 requires 엣지 추가 없음으로 자
    체 점검)
  - level 미제안: Pass (level/min_level 미포함)
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 (R3는 전이/동형만 제안)
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass (Transfer 포함, Appendix에 R2+R1 포함)

  [/R3 Transfer Report]

  ###DONE:f3b3ecfcc0###


› 터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_28f5d43214.md


  58% context left



› Request 28f5d43214: 아래 파일(티켓 지시)을 읽고 결과를 이
  터미널에 Output Format대로 그대로 출력해줘. 가능하면 repo
  파일을 생성/수정하지 말고, 마지막에 마커를 그대로 출력해.
  -> /mnt/c/Users/irron/Desktop/my/web_service_new/
  calculate_math/.agents/inbox/research_28f5d43214.md



•         
• Running wc -l .agents/inbox/research_28f5d43214.md
                                                    
   in      research_28f5d43214.md
                               
                                           
           research_28f5d4       
                                        
research_28f5d43214.md


• Ran wc -l .agents/inbox/research_28f5d43214.md
  └ 857 .agents/inbox/research_28f5d43214.md

  │ … +279 lines
•         
• Structch LEARN_IDENTIFY_S5OR00E_KEY in
r                     
                               
› Summarize recent commits

  50% context left · ? for shortcuts


• Ran python - <<'PY'
  │ import json
  │ s = r'''{
  │ … +279 lines
  └ ok R3 curriculum_viewer_learning_bulk_submit_v1 19 34 5

─ Worked for 5m 51s ────────────────────────────────────────

• ###BEGIN:28f5d43214###

  ## Transfer Edge Analysis

  ### Enables Edges (스킬 → 상위 문항 구조)

  | # | From | To | transfer 이유 | confidence |
  |---|------|----|--------------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT |
  PATTERN_SINGLE_ACTION_ENTRYPOINT | 개별 제출 경로 제거로
  단일 CTA 중심 흐름으로 전환을 강제한다. | 0.76 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON |
  PATTERN_SINGLE_ACTION_ENTRYPOINT | 하단 단일 버튼이 bulk
  제출/채점의 유일 진입점 구조를 만든다. | 0.82 |
  | 3 | LEARN_HANDLE_EMPTY_PROBLEMS |
  PATTERN_EMPTY_PROBLEMS_LOADING_GUARD | 0문제/로딩에서
  vacuous truth로 버튼이 활성화되는 흔들림을 막는다. | 0.78
  |
  | 4 | LEARN_DEFINE_IS_ANSWERED_PREDICATE |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 입력됨 predicate를
  정규화 기준으로 고정하면 disabled 판정과 채점 기준이 일치
  한다. | 0.82 |
  | 5 | LEARN_ALL_ANSWERED_NORMALIZED |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | allAnswered 파생값
  으로 단일 버튼 disabled 게이트를 안정 계산한다. | 0.80 |
  | 6 | LEARN_DISABLED_EDGECASES_12 |
  PATTERN_NORMALIZED_COMPLETENESS_GATE | 엣지 입력 테스트 벡
  터가 공백/콤마/부호 입력에서 게이트 회귀를 방지한다. |
  0.74 |
  | 7 | LEARN_ALL_ANSWERED_NORMALIZED |
  PATTERN_EMPTY_PROBLEMS_LOADING_GUARD | 공집합/로딩 기본값
  규칙을 포함해야 allAnswered가 안정적으로 UI에 반영된다. |
  0.72 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION |
  PATTERN_BATCH_GRADE_PIPELINE | 전체 문제 순회 채점을 수집→
  채점→결과맵 파이프라인으로 정리할 수 있다. | 0.80 |
  | 9 | LEARN_BUILD_RESULT_MAP |
  PATTERN_CANONICAL_RESULT_MAP | problemId keyed 결과맵이 표
  시/집계/저장의 공통 중간표현이 된다. | 0.78 |
  | 10 | LEARN_GRADED_STATE_FLAG |
  PATTERN_POST_GRADE_VISIBILITY_GATING | hasGraded 플래그가
  점수·정오·정답 노출 조건을 단일 기준으로 만든다. | 0.78 |
  | 11 | LEARN_SCORE_AND_RESULT_GATING |
  PATTERN_POST_GRADE_VISIBILITY_GATING | 채점 전 0/N 및 정답
  선노출 같은 UX 오해를 게이팅으로 차단한다. | 0.76 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK |
  PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE | 스키마 계약이 있
  어야 “채점 후 1회 저장(답안+결과)” 스냅샷 구조가 성립한다.
  | 0.78 |
  | 13 | LEARN_LOCALSTORAGE_RESTORE_BULK |
  PATTERN_RESTORE_VALIDATE_MIGRATE | 복원을
  parse→validate→migrate/reset 파이프라인 구조로 정리한다. |
  0.76 |
  | 14 | LEARN_RESET_CLEAR_STORAGE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | 저장 데이터 삭제는 초
  기화의 근거이며 UI 리셋과 결합되어야 한다. | 0.78 |
  | 15 | LEARN_RESET_UI_STATE |
  PATTERN_RESET_CLEAR_STORAGE_AND_UI | 화면 잔상을 제거해야
  초기화 UX가 즉시 체감된다. | 0.80 |
  | 16 | LEARN_AFTER_GRADE_EDIT_POLICY |
  PATTERN_EDIT_INVALIDATES_AND_REGRADES | 답 변경 시 결과/
  hasGraded 무효화 후 재채점 흐름으로 전이되어 stale 상태를
  막는다. | 0.74 |
  | 17 | LEARN_STRICT_JSON_OUTPUT_GUARD |
  PATTERN_STRICT_JSON_OUTPUT_VALIDATION | 문자열 줄바꿈 등
  포맷 오류를 파싱 단계에서 차단하는 품질 게이트로 전이된다.
  | 0.86 |

  ### Analog_of Edges (동형 구조 연결)

  | # | Node A | Node B | 동형 이유 | confidence |
  |---|--------|--------|----------|------------|
  | 1 | PATTERN_NORMALIZED_COMPLETENESS_GATE |
  STRUCT_PREDICATE_GATED_ACTION | predicate를 계산해 액션을
  게이트하는 구조가 동형이다. | 0.74 |
  | 2 | PATTERN_POST_GRADE_VISIBILITY_GATING |
  STRUCT_PREDICATE_GATED_ACTION | 불리언 플래그로 가시성/액
  션을 제어하는 게이트 구조가 동형이다. | 0.72 |
  | 3 | PATTERN_EMPTY_PROBLEMS_LOADING_GUARD |
  STRUCT_EMPTY_COLLECTION_AND_LOADING_GUARD | 공집합/로딩 기
  본값을 명시해 상태 흔들림(vacuous truth)을 막는 구조가 동
  형이다. | 0.74 |
  | 4 | PATTERN_BATCH_GRADE_PIPELINE |
  STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP | 컬렉션을 순회해
  keyed 결과를 만드는 구조가 동일하다. | 0.76 |
  | 5 | PATTERN_CANONICAL_RESULT_MAP |
  STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP | keyed map을 중간
  표현으로 고정해 후속 연산을 단순화하는 구조가 동일하다. |
  0.70 |
  | 6 | PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | 버전/스키마를 포함한
  스냅샷 저장 구조가 동형이다. | 0.68 |
  | 7 | PATTERN_RESTORE_VALIDATE_MIGRATE |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | validate 후 migrate/
  reset 분기하는 복원 구조가 동형이다. | 0.72 |
  | 8 | PATTERN_LEGACY_PARTIAL_POLICY_BRANCH |
  STRUCT_VERSIONED_SNAPSHOT_MIGRATION | legacy/partial 감지
  후 정책 분기(복원/초기화/재계산) 구조가 동형이다. | 0.70 |
  | 9 | PATTERN_EDIT_INVALIDATES_AND_REGRADES |
  STRUCT_CACHE_INVALIDATION_ON_MUTATION | mutation이 기존 결
  과를 무효화하고 재계산을 요구하는 구조가 동형이다. | 0.74
  |
  | 10 | PATTERN_RESET_CLEAR_STORAGE_AND_UI |
  STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE | persisted
  state 제거와 UI rehydrate를 함께 수행해야 일관성이 유지된
  다. | 0.72 |
  | 11 | PATTERN_STRICT_JSON_OUTPUT_VALIDATION |
  STRUCT_OUTPUT_VALIDATION_PIPELINE | 출력 형식/파싱을 게이
  트로 두어 실패를 조기에 차단하는 구조다. | 0.78 |

  ## Problem Template Specs (5~12개)

  | # | 템플릿명 | 입력 파라미터 범위 | 정답 생성식 | 오답
  생성 규칙 |
  |---|---------|------------------|-----------|------------
  ---|
  | 1 | 정규화 기반 완결성 게이트 | N:1~50,
  answers:string[], normalizeNumericInput | disabled = !
  all_i(len(norm(ans_i))>0) | raw input 기준 판정, trim만 적
  용, "0"를 빈값 처리 |
  | 2 | 공집합/로딩 기본값 가드 | loading:bool,
  problemsLen:0~50, answersMap | if loading or
  problemsLen==0 then disabled=true else disabled=!
  allAnswered | vacuous truth로 problemsLen==0에서
  allAnswered=true |
  | 3 | 단일 CTA 라벨/상태 파생 | hasGraded:bool,
  allAnswered:bool, dirtyAfterGrade:bool | label =
  (hasGraded && dirty) ? "다시 채점" : "채점하기";
  disabled=!allAnswered | 라벨 고정, dirty 무시, allAnswered
  미연결 |
  | 4 | 배치 채점 파이프라인 | problems[{id}], answersMap,
  gradeOne | resultById[id]=gradeOne(id,answers[id]);
  hasGraded=true | index 기반 키, 루프 중 setState, side-
  effect 혼합 |
  | 5 | keyed 결과맵 안정성 | reorder(problems), resultById
  keyed | render/result lookup by id는 순서 변경에 불변 | 배
  열 index로 결과/정답 매칭 |
  | 6 | 채점 후 가시성 게이트 | hasGraded:bool, score,
  resultById | show = hasGraded ? (score+results) : hidden |
  채점 전 0/N 노출, 정답 선노출, flag 누락 |
  | 7 | 버전드 스냅샷 1회 저장 | nodeId,
  payload{answers,results,version,updatedAt} |
  setItem(key(nodeId), JSON.stringify(payload))
  onceAfterGrade | merge 저장으로 partial 생성, version 누
  락, nodeId 누락 |
  | 8 | 복원 parse→validate→정책 분기 | storedStr(valid/
  invalid/legacyPartial), problemsLen, policy |
  invalid→reset; legacyPartial→policyBranch; else
  restore+set hasGraded | JSON.parse 크래시, partial을
  graded로 오인, 불일치 미처리 |
  | 9 | Reset 동기화(저장+UI) | stored 존재/미존재, uiState
  | removeItem + reset answers/results/flags | storage만 삭
  제하고 UI 잔상 유지 |
  | 10 | strict JSON 출력 검증 | jsonText 후보,
  validator(json.loads) | accept iff json.loads ok and no
  literal newline inside any string | 줄바꿈 포함 문자열, 주
  석/트레일링 콤마 허용 |

  ### 상세 템플릿 예시 (3개)

  Template 1: 공집합/로딩 기본값 가드
  - Parameters: { loading: [true,false], problemsLen:
  [0,50], answersMap: { [problemId]: string }, allAnswered:
  derived }
  - Answer: if (loading || problemsLen==0) disabled=true
  else disabled=!allAnswered
  - Distractors: [problemsLen==0에서
  allAnswered=true(vacuous truth), 로딩 중 일시 활성화,
  problemsLen 변화 시 메모 누락]
  - Required Skills: [LEARN_HANDLE_EMPTY_PROBLEMS,
  LEARN_ALL_ANSWERED_NORMALIZED]

  Template 2: 복원 parse→validate→정책 분기
  - Parameters: { storedStr: [validJSON, invalidJSON,
  legacyPartialJSON], problemsLen: [1,50], policy:
  ["reset","restoreAnswersOnly","forceRegrade"] }
  - Answer: parsed=safeParse(storedStr); if !
  validShape(parsed) -> reset; else if
  isLegacyPartial(parsed,problemsLen) -> policyBranch; else
  restore answers+results and set hasGraded
  - Distractors: [JSON.parse 예외로 런타임 크래시, partial을
  graded로 오인, nodeId/문제수 불일치 미검증]
  - Required Skills: [LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_GRADED_STATE_FLAG]

  Template 3: 배치 채점 파이프라인
  - Parameters: { problems: [{id:string}], answersMap:
  { [id]: string }, gradeOne:
  fn(id,answer)->{isCorrect,correctAnswer} }
  - Answer: resultById = reduce(problems,
  (acc,p)=>acc[p.id]=gradeOne(p.id,answersMap[p.id]));
  hasGraded=true
  - Distractors: [index 기반 배열 결과, 루프 중 setState로
  순서/클로저 버그, problemId 불일치]
  - Required Skills: [LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG]

  ## Isomorphic Triplets (동형 3세트, 5세트 이상)

  | # | 구조명 | 생활 맥락 | 데이터 맥락 | 도형 맥락 |
  |---|--------|----------|-----------|----------|
  | 1 | 조건 충족 전 잠금 해제 | 필수 입력 전 “제출” 비활성
  | required 필드 누락 시 commit 차단 | 모든 점 지정 전 “면
  적 계산” 비활성 |
  | 2 | 공집합/로딩 기본값 가드 | 장바구니 0개/로딩 중 결제
  버튼 잠금 | 빈 데이터셋/로딩 중 집계 실행 차단 | 점이 0개/
  로딩 중 다각형 계산 차단 |
  | 3 | 단일 진입점(단일 버튼) | 여러 단계 대신 “한 번에 제
  출” 버튼 | 여러 작업 대신 “한 번에 실행” 버튼 | 여러 메뉴
  대신 “한 번에 계산” 버튼 |
  | 4 | 배치 처리 파이프라인 | 영수증을 모아 한 번에 정산 |
  배치 잡으로 레코드 처리 결과맵 생성 | 여러 도형 값을 일괄
  계산해 요약 |
  | 5 | keyed 중간표현 고정 | 항목별 체크리스트를 ID로 관리
  | id→result 맵으로 집계/표시/저장 | 변/각도 라벨→값 맵으로
  계산 |
  | 6 | 완료 후 가시성 게이팅 | 완료 전 결과 공개 금지 |
  flag true일 때만 리포트 노출 | 구성 완료 후 보조선/측정값
  표시 |
  | 7 | 버전드 스냅샷 저장/복원 | 임시저장 후 이어하기(구버
  전 변환) | versioned snapshot validate→migrate/reset | CAD
  도면 저장/로드 시 버전 변환 |
  | 8 | 출력 검증 게이트 | 서식 검증 실패 시 제출 반려 |
  strict JSON 파싱 실패 시 병합 중단 | 파일 포맷 검증 실패
  시 로드 거부 |

  ### 상세 Triplet 예시 (2세트)

  Triplet 1: 공집합/로딩 기본값 가드
  - 생활: 장바구니가 비었거나 로딩 중이면 “결제” 버튼이 절대
  활성화되지 않도록 기본값을 명시한다.
  - 데이터: 데이터셋이 비었거나 로딩 중이면 집계/학습 파이프
  라인 실행을 막고 기본값(0/unknown)을 강제한다.
  - 도형: 점/변 정보가 없거나 로딩 중이면 도형 계산(면적/둘
  레)을 막아 잘못된 결과 노출을 방지한다.
  - 공통 스킬: [LEARN_HANDLE_EMPTY_PROBLEMS,
  LEARN_ALL_ANSWERED_NORMALIZED]

  Triplet 2: 버전드 스냅샷 저장/복원
  - 생활: 임시저장 후 재접속 시 동일 상태로 복원하되 구버전/
  깨진 데이터는 변환하거나 초기화한다.
  - 데이터: versioned snapshot을 읽어 validate 후 migrate/
  reset 분기하여 안전하게 rehydrate 한다.
  - 도형: CAD 도면을 저장/로드할 때 버전 정보를 통해 포맷을
  변환하고 깨진 파일은 초기화한다.
  - 공통 스킬: [LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL]

  ## Graph Patch JSON

  {
    "researcher": "R3",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type":
  "micro", "name_ko": "단일 주요 액션 진입점(하단 1버튼)",
  "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "type": "micro", "name_ko": "정규화 기반 완결성 게이트
  (allAnswered로 disabled)", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_EMPTY_PROBLEMS_LOADING_GUARD",
  "type": "micro", "name_ko": "공집합/로딩 가드(0문제
  ·loading에서 버튼 잠금)", "domain": "UX", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_BATCH_GRADE_PIPELINE", "type":
  "micro", "name_ko": "배치 채점 파이프라인(수집→채점→결과
  맵)", "domain": "FE", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_CANONICAL_RESULT_MAP", "type":
  "micro", "name_ko": "정규 키 기반 결과맵
  (resultByProblemId) 중간표현", "domain": "FE", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "type": "micro", "name_ko": "채점 후 가시성 게이팅
  (hasGraded로 score/result 노출)", "domain": "UX", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "type": "micro", "name_ko": "버전드 스냅샷 저장(채점 후 1
  회 overwrite)", "domain": "FE", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_RESTORE_VALIDATE_MIGRATE", "type":
  "micro", "name_ko": "복원 파이프라인
  (parse→validate→migrate/reset)", "domain": "FE", "rep":
  "C", "lens": ["transform"] },
      { "id": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "type": "micro", "name_ko": "legacy partial 감지 후 정책
  분기(초기화/재채점 유도)", "domain": "ARCH", "rep": "C",
  "lens": ["transform"] },
      { "id": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type":
  "micro", "name_ko": "완전 초기화(저장소 삭제+UI 상태 리
  셋)", "domain": "UX", "rep": "C", "lens": ["transform"] },
      { "id": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "type": "micro", "name_ko": "채점 후 수정 시 결과 무효화
  및 재채점 유도", "domain": "UX", "rep": "C", "lens":
  ["transform"] },
      { "id": "PATTERN_STRICT_JSON_OUTPUT_VALIDATION",
  "type": "micro", "name_ko": "산출물 strict JSON 검증 게이
  트(json.loads 통과)", "domain": "QA", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "micro", "name_ko": "predicate로 액션/가시성을 게이트하는
  구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_EMPTY_COLLECTION_AND_LOADING_GUARD",
  "type": "micro", "name_ko": "공집합/로딩 기본값을 명시해
  상태 흔들림을 막는 구조", "domain": "STRUCT", "rep": "C",
  "lens": ["transform"] },
      { "id": "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP",
  "type": "micro", "name_ko": "컬렉션을 순회해 keyed map을
  만드는 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "micro", "name_ko": "버전드 스냅샷 저장/복원 및 마이그레이
  션 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_CACHE_INVALIDATION_ON_MUTATION",
  "type": "micro", "name_ko": "mutation 시 결과/캐시 무효화
  후 재계산 구조", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] },
      { "id": "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE",
  "type": "micro", "name_ko": "persisted state 제거와 UI
  rehydrate를 동기화하는 구조", "domain": "STRUCT", "rep":
  "C", "lens": ["transform"] },
      { "id": "STRUCT_OUTPUT_VALIDATION_PIPELINE", "type":
  "micro", "name_ko": "출력 검증 파이프라인(형식/파싱/정
  책)", "domain": "STRUCT", "rep": "C", "lens":
  ["transform"] }
    ],
    "merge_aliases": [],
    "add_edges": [
      { "from": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "to":
  "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type": "enables",
  "reason": "개별 제출 경로 제거로 단일 CTA 중심 흐름으로 전
  환을 강제한다.", "confidence": 0.76 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "PATTERN_SINGLE_ACTION_ENTRYPOINT", "type": "enables",
  "reason": "하단 단일 버튼이 bulk 제출/채점의 유일 진입점
  구조를 만든다.", "confidence": 0.82 },
      { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "PATTERN_EMPTY_PROBLEMS_LOADING_GUARD", "type": "enables",
  "reason": "0문제/로딩에서 vacuous truth로 버튼이 활성화되
  는 흔들림을 막는다.", "confidence": 0.78 },
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "입력됨 predicate를 정규화 기준으로 고정하면
  disabled 판정과 채점 기준이 일치한다.", "confidence":
  0.82 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "allAnswered 파생값으로 단일 버튼 disabled 게이
  트를 안정 계산한다.", "confidence": 0.8 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "PATTERN_NORMALIZED_COMPLETENESS_GATE", "type": "enables",
  "reason": "엣지 입력 테스트 벡터가 공백/콤마/부호 입력에서
  게이트 회귀를 방지한다.", "confidence": 0.74 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "PATTERN_EMPTY_PROBLEMS_LOADING_GUARD", "type": "enables",
  "reason": "공집합/로딩 기본값 규칙을 포함해야 allAnswered
  가 안정적으로 UI에 반영된다.", "confidence": 0.72 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "PATTERN_BATCH_GRADE_PIPELINE", "type": "enables",
  "reason": "전체 문제 순회 채점을 수집→채점→결과맵 파이프라
  인으로 정리할 수 있다.", "confidence": 0.8 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "PATTERN_CANONICAL_RESULT_MAP", "type": "enables",
  "reason": "problemId keyed 결과맵이 표시/집계/저장의 공통
  중간표현이 된다.", "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "hasGraded 플래그가 점수·정오·정답 노출 조건을
  단일 기준으로 만든다.", "confidence": 0.78 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "채점 전 0/N 및 정답 선노출 같은 UX 오해를 게이
  팅으로 차단한다.", "confidence": 0.76 },
      { "from": "LEARN_SCORE_SUMMARY_CALC", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "점수 집계는 가능하더라도 노출은 hasGraded일 때
  만 한다는 구조로 전이된다.", "confidence": 0.7 },
      { "from": "LEARN_SHOW_PER_PROBLEM_RESULT", "to":
  "PATTERN_POST_GRADE_VISIBILITY_GATING", "type": "enables",
  "reason": "문제별 결과 표시도 채점 완료 이후에만 노출되는
  구조로 고정된다.", "confidence": 0.72 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "스키마 계약이 있어야 '채점 후 1회 저
  장(답안+결과)' 스냅샷 구조가 성립한다.", "confidence":
  0.78 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "UI 상태를 payload로 직렬화하는 표현
  전환이 overwrite 스냅샷 저장의 전제다.", "confidence":
  0.78 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE", "type":
  "enables", "reason": "merge 대신 overwrite 저장을 채택하면
  partial/legacy 생성 원인을 줄인다.", "confidence": 0.78 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "복원 전 검증 단계가 invalid/타 노드 데이터로 인
  한 런타임 꼬임을 막는다.", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "PATTERN_RESTORE_VALIDATE_MIGRATE", "type": "enables",
  "reason": "restore를 parse→validate→복원 분기 파이프라인으
  로 정리하면 정책 적용이 명확해진다.", "confidence":
  0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH", "type": "enables",
  "reason": "legacy partial 감지 시 초기화/재채점 유도 등 정
  책 분기 구조가 필요하다.", "confidence": 0.72 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "저장 데이터 삭제는 초기화의 근거이며 UI 리셋과
  결합되어야 한다.", "confidence": 0.78 },
      { "from": "LEARN_RESET_UI_STATE", "to":
  "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "type": "enables",
  "reason": "화면 잔상을 제거해야 초기화 UX가 즉시 체감된
  다.", "confidence": 0.8 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "PATTERN_EDIT_INVALIDATES_AND_REGRADES", "type":
  "enables", "reason": "답 변경 시 결과/hasGraded를 무효화하
  고 재채점 흐름으로 전이되어 stale 상태를 막는다.",
  "confidence": 0.74 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "PATTERN_STRICT_JSON_OUTPUT_VALIDATION", "type":
  "enables", "reason": "문자열 줄바꿈 등 포맷 오류를 파싱 단
  계에서 차단하는 품질 게이트로 전이된다.", "confidence":
  0.86 },
      { "from": "PATTERN_NORMALIZED_COMPLETENESS_GATE",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "predicate를 계산해 액션을 게이트하
  는 구조가 동형이다.", "confidence": 0.74 },
      { "from": "PATTERN_POST_GRADE_VISIBILITY_GATING",
  "to": "STRUCT_PREDICATE_GATED_ACTION", "type":
  "analog_of", "reason": "불리언 플래그로 가시성/액션을 제어
  하는 게이트 구조가 동형이다.", "confidence": 0.72 },
      { "from": "PATTERN_EMPTY_PROBLEMS_LOADING_GUARD",
  "to": "STRUCT_EMPTY_COLLECTION_AND_LOADING_GUARD", "type":
  "analog_of", "reason": "공집합/로딩 기본값을 명시해 상태
  흔들림(vacuous truth)을 막는 구조가 동형이다.",
  "confidence": 0.74 },
      { "from": "PATTERN_BATCH_GRADE_PIPELINE", "to":
  "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP", "type":
  "analog_of", "reason": "컬렉션을 순회해 keyed 결과를 만드
  는 구조가 동일하다.", "confidence": 0.76 },
      { "from": "PATTERN_CANONICAL_RESULT_MAP", "to":
  "STRUCT_MAP_OVER_COLLECTION_TO_KEYED_MAP", "type":
  "analog_of", "reason": "keyed map을 중간표현으로 고정해 후
  속 연산을 단순화하는 구조가 동일하다.", "confidence":
  0.7 },
      { "from": "PATTERN_VERSIONED_SNAPSHOT_PERSISTENCE",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "버전/스키마를 포함한 스냅샷 저장
  구조가 동형이다.", "confidence": 0.68 },
      { "from": "PATTERN_RESTORE_VALIDATE_MIGRATE", "to":
  "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "validate 후 migrate/reset 분기하는
  복원 구조가 동형이다.", "confidence": 0.72 },
      { "from": "PATTERN_LEGACY_PARTIAL_POLICY_BRANCH",
  "to": "STRUCT_VERSIONED_SNAPSHOT_MIGRATION", "type":
  "analog_of", "reason": "legacy/partial 감지 후 정책 분기
  (복원/초기화/재계산) 구조가 동형이다.", "confidence":
  0.7 },
      { "from": "PATTERN_EDIT_INVALIDATES_AND_REGRADES",
  "to": "STRUCT_CACHE_INVALIDATION_ON_MUTATION", "type":
  "analog_of", "reason": "mutation이 기존 결과를 무효화하고
  재계산을 요구하는 구조가 동형이다.", "confidence": 0.74 },
      { "from": "PATTERN_RESET_CLEAR_STORAGE_AND_UI", "to":
  "STRUCT_CLEAR_PERSISTED_STATE_AND_REHYDRATE", "type":
  "analog_of", "reason": "persisted state 제거와 UI
  rehydrate를 함께 수행해야 일관성이 유지된다.",
  "confidence": 0.72 },
      { "from": "PATTERN_STRICT_JSON_OUTPUT_VALIDATION",
  "to": "STRUCT_OUTPUT_VALIDATION_PIPELINE", "type":
  "analog_of", "reason": "출력 형식/파싱을 게이트로 두어 실
  패를 조기에 차단하는 구조다.", "confidence": 0.78 }
    ],
    "remove_edges": [],
    "notes": [
      { "claim": "LEARN_HANDLE_EMPTY_PROBLEMS는 공집합/로딩
  에서 allAnswered의 vacuous truth를 방지해 disabled 흔들림
  을 줄이는 상위 구조로 전이된다.", "reason": "문제 0개 또는
  로딩 중에 allAnswered=true가 되면 단일 버튼이 활성화되는
  UX 붕괴가 발생한다.", "confidence": 0.78 },
      { "claim": "FE/UX 티켓의 Transfer는 '문항 템플릿' 대신
  상태 전이 패턴(게이트·파이프라인·스냅샷)으로 재해석해 모델
  링할 수 있다.", "reason": "단일 버튼/disabled/저장·복원/초
  기화 요구는 모두 추상 구조로 전이 가능하다.",
  "confidence": 0.74 },
      { "claim": "strict JSON 출력 검증은 구현 내용과 독립적
  으로 병합 파이프라인을 살리는 품질 게이트로 분리하는 편이
  좋다.", "reason": "문자열 내부 줄바꿈 등은 내용이 맞아도
  json.loads 실패로 결합 검증/병합이 중단된다.",
  "confidence": 0.86 },
      { "claim": "R3 패치는 requires 잠금을 추가하지 않고
  enables/analog_of만 제안한다.", "reason": "필수 선행 잠금
  (requires)은 R2 소관이며 R3는 전이/동형 구조 연결에 집중한
  다.", "confidence": 0.9 },
      { "claim": "resultByProblemId keyed map을 단일 소스로
  두면 점수 집계/문제별 표시/저장이 같은 데이터에서 파생되어
  회귀가 줄어든다.", "reason": "배열 index 기반으로 결과를
  다루면 문제 순서 변화에서 오표시가 발생하기 쉽다.",
  "confidence": 0.76 }
    ]
  }

  ## APPENDIX: R2 Progression Report (verbatim)

  [Previous Researcher Handoff (R2 Progression Report)]

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 요약 | FE | C | bulk 전환 시 회귀/기능 공백
  을 줄이기 위한 기준선 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항의 단일 진입점 제공 |
  | 4 | LEARN_HANDLE_EMPTY_PROBLEMS | 문제 0개/로딩 상태 UI
  규칙 정의 | UX | C | allAnswered/disabled의 흔들림(공집
  합/로딩)을 방지 |
  | 5 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 미입력 판정
  predicate 정의(정규화 기반) | FE | C | disabled와 채점 기
  준 불일치로 인한 UX 붕괴 방지 |
  | 6 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | 모든 문제 입력 전까지 버튼 disabled
  구현 |
  | 7 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  테스트 벡터 | QA | C | 공백/콤마/부호 등 판정 흔들림을 사
  전에 고정 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 한 번 클릭으로 모든 문제를 채점하는 동작
  구현 |
  | 9 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장에 공통
  으로 쓰는 중간 표현 구축 |
  | 10 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 결과 노출 시점/복원 시점 기준
  을 단일 플래그로 고정 |
  | 11 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  결과 표시(게이팅) | FE | P | 채점 전 0/N 및 partial 결과
  노출 혼선 차단 |
  | 12 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | resultByProblemId 기반으로 점수 집계를 안정화 |
  | 13 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 문제 카드에 정오/정답값
  을 일관되게 렌더 |
  | 14 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | “채점 후 1회 저장” 스냅샷을 스키
  마로 고정 |
  | 15 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 submissions payload로 변환 | FE | P | UI state를
  StoredResult{submissions}로 표현전환 |
  | 16 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고 1
  회 setItem으로 단순화 |
  | 17 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/shape validate | FE | C | JSON 파싱 실패/필드 누락으로
  인한 런타임 오류 방지 |
  | 18 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 감지/정책 적용 | FE | C | 기존 merge 저장
  이 만든 partial을 bulk UX에 맞게 처리 |
  | 19 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태 복원 |
  | 20 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화 기반 마련 |
  | 21 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면 잔상(answer/result/flags)을 즉시 제거 |
  | 22 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과) 방지 |
  | 23 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장 | QA | C | 문자열 줄바꿈 등으로 병합 불
  가가 반복되는 문제 차단 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON, LEARN_HANDLE_EMPTY_PROBLEMS,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼 UX와 disabled
  기준을 함께 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | 채점→중간표현→게이팅→표시
  를 일관된 흐름으로 구성 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회 + legacy 조건부 처리 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 초기화 잔상 제거와 스테일
  결과 방지 정책을 묶어 적용 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 줄바꿈 없는 strict
  JSON으로 결합 검증/병합 가능 상태 보장 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 문제 전체 채점 결과가
  있어야 구성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 집계는 문제별 결과가 있어야 계산 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 제출/저장 경로를
  알아야 제거 후 회귀를 줄일 수 있음 | 0.76 |
  | 2 | LEARN_HANDLE_EMPTY_PROBLEMS →
  LEARN_ALL_ANSWERED_NORMALIZED | 문제 0개/로딩에서 vacuous
  truth를 막아 버튼 상태가 안정됨 | 0.72 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 기준을 먼저 고정하면 안전 | 0.70 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 클릭 이벤트를 gradeAll로 연
  결해야 UX가 완성됨 | 0.72 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 계산은 가능해도 노출은
  hasGraded일 때만 권장 | 0.70 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy 존재 시에만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_RESET_UI_STATE | 답 변경 시 결과 초기화/재채점 유도
  를 위해 상태 리셋이 필요 | 0.72 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 출력 품질 검증을 단계로 분리하
  면 병합 실패를 예방 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 직관
  과 정규화 기준이 어긋나 disabled/채점 불일치 |
  normalizeNumericInput 기반 predicate로 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개에서
  allAnswered가 흔들려 버튼 상태 불안정 |
  LEARN_HANDLE_EMPTY_PROBLEMS로 0개/로딩 규칙을 명시 | 0.74
  |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 라벨/disabled/재채점
  상태가 암묵적이면 UX 해석이 어려움 | derived state로
  label/disabled를 결정(필요 시 “다시 채점”) | 0.70 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 제거가 먼저면 채
  점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 준비 후 제거 | 0.80 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 입력 조
  회/채점 호출/상태 업데이트가 섞여 인지부하 증가 |
  gradeAll을 순수 함수로 분리해 결과 맵을 반환 | 0.78 |
  | 6 | LEARN_BUILD_RESULT_MAP | index 기반 처리로 문제 순
  서/ID 불일치 시 오표시 위험 | 항상 problemId 키로
  resultByProblemId 구성/조회 | 0.76 |
  | 7 | LEARN_GRADED_STATE_FLAG | 복원/partial에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효한 채점 결과 존재”로 정의 | 0.74 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 채점 전 0/N 노출로
  “이미 채점됨” 오해 발생 | score/result 렌더를 hasGraded로
  게이트 | 0.74 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | answers/results를
  submissions 스키마로 전환할 때 누락/불일치 발생 | 스키마
  를 submitted+isCorrect 중심으로 단일화 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK | merge 저장 습관으로
  partial이 계속 생겨 UX 충돌 | gradeAll 결과로 overwrite
  스냅샷 저장 + setItem 1회 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨짐 | try/catch +
  nodeId 검증 + shape validate | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도(또는 초기
  화) | 0.74 |
  | 13 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result 잔상이 남아 초기화가 체감되지 않음 | storage 삭제
  와 state(answer/result/flags) 리셋 동시 수행 | 0.78 |
  | 14 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해 “입력≠결과” 상태 발생 | 입력 변경 시 결과
  초기화 또는 재채점 고정 | 0.76 |
  | 15 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 줄바꿈 등
  으로 patch JSON 파싱 실패가 반복됨 | 문자열 내부 줄바꿈
  금지 + json.loads 동등 검증 | 0.90 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | “정규화 사용”보다
  “입력됨 판정”을 중간에 두면 disabled/allAnswered 정합화가
  쉬움 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 액션 연결을 단계로 묶어 구현 점프를 완화 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 불일치/누락을 줄임 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  카드 렌더를 중간 표현에만 의존하도록 분리해 오표시를 줄임
  |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 변환 단계를 추가 |
  | 6 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 저장된 데이터의 파싱/
  검증 단계를 매개로 복원 실패를 완화 |
  | 7 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 시 hasGraded 기준을 먼저 확정해 노출 규칙을 단순화 |
  | 8 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_AND_EDIT_FLOW | reset을 하나의 플로우로 묶어
  잔상/부분 초기화를 방지 |
  | 9 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  편집 이후 결과 노출을 hasGraded 기준으로 통제하면 스테일
  상태를 예방 |
  | 10 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 전에 새 진입점을 확보하면 기능 공백을 방지 |
  | 11 | (비-strict JSON 산출) → (병합/검증 실패) |
  LEARN_STRICT_JSON_OUTPUT_GUARD | 산출물 품질을 별도 노드
  로 두면 파싱 실패를 조기에 차단 |

  ## Graph Patch JSON

  {
  "researcher": "R2",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_HANDLE_EMPTY_PROBLEMS", "type":
  "micro", "name_ko": "문제 0개/로딩 상태 UI 규칙 정의",
  "domain": "UX", "rep": "C", "confidence": 0.74 },
  { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "answers/results를 submissions
  payload로 변환", "domain": "FE", "rep": "P",
  "confidence": 0.80 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장",
  "domain": "QA", "rep": "C", "confidence": 0.90 },
  { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
  { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
  { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
  ],
  "add_edges": [
  { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
  { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
  ],
  "remove_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "정규화 사용 여부보다 입력됨 predicate를 중간에
  두면 allAnswered 정의가 가능해 기존 requires 잠금은 과
  잉", "confidence": 0.78 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 requires 잠금은 과잉", "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded 정의/도입은 gradeAll과 독립적으로 가능해 단일
  선행 잠금은 과잉", "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 순서가 바뀌어도 가능하며 동시 수행만 권
  장", "confidence": 0.78 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 구현과 병렬로 확인 가능해
  requires 잠금은 과잉", "confidence": 0.70 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "restore는 키를 필요로 하지만 구현과 병렬로 결
  정 가능해 requires 잠금은 과잉", "confidence": 0.68 }
  ],
  "notes": [
  { "claim": "미입력 판정(disabled)은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  공백/콤마 입력에서 버튼 상태와 채점 결과가 불일치한다.",
  "confidence": 0.82 },
  { "claim": "버튼 추가와 allAnswered 구현은 병렬로 가
  능하며 최종적으로 disabled 조건만 연결하면 된다.",
  "reason": "UI를 먼저 만들고 이후에 allAnswered 로직을 붙
  이는 구현 경로가 자연스럽다.", "confidence": 0.70 },
  { "claim": "legacy partial은 조건부 케이스이므로
  requires보다 노트/권장 선행으로 관리하는 것이 적절하다.",
  "reason": "partial은 기존 merge 저장 데이터가 있을 때만
  발생하고 항상 필요한 선행 관계가 아니다.", "confidence":
  0.74 },
  { "claim": "score/result 노출은 hasGraded로 게이트하
  고 복원 시 hasGraded 규칙을 명확히 하는 것이 권장이다.",
  "reason": "채점 전 0/N 및 partial 노출을 통제하려면 표시
  기준을 단일 플래그로 고정해야 한다.", "confidence":
  0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력되어야 한다.", "reason": "문자열
  줄바꿈은 파싱 실패를 유발해 결합 검증/병합 파이프라인을
  중단시킨다.", "confidence": 0.90 }
  ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/merge 저장을 알아야 bulk 전환 회귀
  를
  줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 partial 의미 |
  기존 merge 저장으로 부분 submissions가 정상 생성되어 bulk
  UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 함 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 UX가 붕괴 | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정화
  필요 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", " , ",
  "0", "-0", "1,234", "+", ".", "Infinity" 등 기대값 고정
  필
  요 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재 단건 채점만 가
  능
  하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/단일 소스화 | 점수 집계/문제
  별
  표시/저장을 problemId keyed map으로 일관화해야 함 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  legacy partial 결과 노출 혼선을 막을 표시 기준 필요 | 중
  |
  |12| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 표시
  해야 UX가 일관되고 partial 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “한 번
  에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 상태 꼬임 방지 필요 | 중 |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 state 리셋이 필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/근사/분수) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | per-problem 제출 제거 → bulk 채점 미구현 | 제거가
  먼
  저면 채점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 준비 후 제거 |
  | 2 | 원문 disabled 판정 → 정규화 채점 | " , " 등에서 활
  성/비활성과 채점 기준이 엇갈려 UX 붕괴 |
  normalizeNumericInput 기반으로 미입력 판정 통일 |
  | 3 | bulk 버튼 추가 → allAnswered 부재 | disabled 조건이
  불명확하면 조기 활성/비활성이 흔들림 | problems[] 기준
  allAnswered(정규화) 먼저 고정 |
  | 4 | 저장 구현 → 복원/검증 미정 | 파싱 실패/필드 누락으
  로
  런타임 오류 및 상태 꼬임 발생 | schema+shape validate+예
  외
  처리 추가 |
  | 5 | legacy partial 복원 → 결과/점수 노출 | 부분
  submissions가 “채점됨”처럼 보이면 오해/혼선 발생 |
  partial
  감지 시 hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | 초기화(키 삭제만) → UI 잔상 | storage만 지우면
  answer/result/flags가 화면에 남음 | 키 삭제 + UI state 리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C", "confidence": 0.8 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.84 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P", "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P", "confidence": 0.75 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체 저
  장)",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C", "confidence":
  0.72 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C", "confidence": 0.74 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.84 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.75 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 기존 submissions와 병합해
  setItem하는 흐름이 확인된다.", "confidence": 0.86 },
  { "claim": "미입력 판정(disabled)은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading.ts가 normalizeNumericInput을
  사
  용하므로 원문 기준 판정은 불일치를 만든다.",
  "confidence":
  0.84 },
  { "claim": "점수/정답 노출은 hasGraded로 게이트해야 채
  점 전 0/N 및 partial 노출 혼선을 줄인다.", "reason": "현
  재
  score는 problems가 있으면 채점 전에도 0/N이 표시될 수 있
  다.", "confidence": 0.74 },
  { "claim": "legacy partial 처리는 조건부 정책이며
  restore에 과잉 잠금(requires)으로 고정하지 않는 편이 안전
  하다.", "reason": "partial은 legacy 데이터가 존재할 때만
  필요하고 reviewer도 requires 과잉 잠금을 지적했다.",
  "confidence": 0.72 },
  { "claim": "per-problem 제출 제거는 bulk 경로(버튼/
  gradeAll/저장)가 준비된 뒤 수행해야 한다.", "reason": "제
  거가 먼저면 사용자가 채점/저장할 경로가 사라져 기능 공백
  이
  생긴다.", "confidence": 0.72 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검
  증/병합을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ## QA Summary

  - Requires-only 잠금(새 requires 제안): Pass — R3 Graph
    Patch는 enables/analog_of만 포함(새 requires 미제안).
  - Requires 사이클: Pass — 새 requires 엣지 추가 없음(자체
    점검: add_edges에서 type==requires 0건 확인).
  - level 미제안: Pass — level/min_level을 표/JSON/notes 어
    디에도 제안하지 않았다.
  - 충돌 해결 규칙 적용(requires→R2, 교육과정 누락→R1,
    enables/analog_of→R3): 적용 — 본 출력은 enables/
    analog_of만 제안했다.
  - 누락 섹션 여부(coverage/progression/transfer 모두 포함):
    Pass — Transfer 포함, Appendix에 R2 Progression(및 R1
    Coverage 포함) 포함.

  [/R3 Transfer Report]

  ###DONE:28f5d43214###


› Summarize recent commits

  42% context left · ? for shortcuts

