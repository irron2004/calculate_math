
============================================================
[2026-01-08 10:04:56] RESEARCH2 (req_id: 0d3dcb2169)
============================================================

› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_0d3dcb2169.md


  59% context left



› Request 0d3dcb2169: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_0d3dcb2169.md


    Read research_0d3dcb2169.md                            

• Preparing to produce segments (5m 49s • esc to interrupt)


› Improve documentation in @filename

  50% context left · ? for shortcuts


• Explored
  └ Read research_0d3dcb2169.md, T1.md
    List curriculum_viewer_learning_bulk_submit_v1
    Read task.md
    Search \"scope\" in research_0d3dcb2169.md
    Read research_0d3dcb2169.md
    Search ^## Coverage Gap Report in
research_0d3dcb2169.md
    Search \[/R1 Coverage Report\] in
research_0d3dcb2169.md
    Search LEARN_BULK_SUBMIT_FLOW in research_0d3dcb2169.md
    Read research_0d3dcb2169.md

─ Worked for 5m 49s ───────────────────────────────────────

• Context compacted


• Explored
  └ Read research_94c501e5c8.md, research_0d3dcb2169.md
    Search Output Format in research_94c501e5c8.md
    Search Output Format in research_0d3dcb2169.md
    Search \[/R1 Coverage Report\] in
research_94c501e5c8.md
    Search \[/R1 Coverage Report\] in
research_0d3dcb2169.md
    Search ^## Coverage Gap Report in
research_94c501e5c8.md
    Search ^## Coverage Gap Report in
research_0d3dcb2169.md
    Read research_94c501e5c8.md, research_0d3dcb2169.md,
         T1_1_1.md, T1.md
    Search "add_edges" in research_94c501e5c8.md
    Read research_94c501e5c8.md
    Search "add_edges" in research_0d3dcb2169.md
    Read research_0d3dcb2169.md, task.md,
         research_94c501e5c8.md
    List inbox
    List inbox
    Search ^research_
                                                       
  │ … +3 lines  
              
    Search \[/R1 Coverage Report\]|## Output Format|# 
R       
                                 
    Search \[/R1 Coverage Report\]|#                  
R       
   1       research_6658dd0561.md


• Ran wc -l .agents/inbox/
  │ research_{c6f87df7c1,6658dd0561,bb36ea60ee,046ab3a1e7
  │ ,ad07bd8f3a,79fd857bc9,76d53e9e0f,567c4fe8fc,b4b42608
  │ … +3 lines
  └    238 .agents/inbox/research_c6f87df7c1.md
       368 .agents/inbox/research_6658dd0561.md
    … +16 lines
       336 .agents/inbox/research_0d3dcb2169.md
      7291 total

─ Worked for 20m 02s ──────────────────────────────────────

• ###BEGIN:94c501e5c8###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | COUNT_MUL_RULE_MEANING | 곱셈 원리 의미(단계 곱) |
  DA | C | 공식 암기 대신 “단계 수의 곱” 구조로 카운팅을 설
  명하기 위해 |
  | 2 | COUNT_ADD_RULE_MEANING | 덧셈 원리 의미(서로소 합)
  | DA | C | ‘겹치지 않을 때만 더한다’ 조건을 고정해 오용을
  줄이기 위해 |
  | 3 | ORDER_SENSITIVE_CHECK | 순서 민감 판단(순열/조합 분
  기) | DA | C | 도구 선택(순열 vs 조합)이 흔들리면 이후 계
  산이 연쇄 붕괴하기 때문 |
  | 4 | PERM_AS_FILLING_SLOTS | 순열 의미(자리 채우기) | DA
  | C | 조건을 “자리/순서” 구조로 모델링해 공식 항에 매핑하
  기 위해 |
  | 5 | PERM_PRODUCT_FORM | nPr을 감소곱(곱 형태)로 표현 |
  DA | P | r개 항의 감소곱을 안정적으로 쓰고 검산/전환의 기
  반을 만들기 위해 |
  | 6 | FACTORIAL_EXPANSION | 팩토리얼 전개 n!=n*(n-1)*...
  | DA | P | ‘전개→약분’ 절차로 계산을 단순화하고 블랙박스
  화를 막기 위해 |
  | 7 | FACTORIAL_ZERO_MEANING | 0! 의미 해석(경계 사례) |
  DA | A | r=0, r=n 등의 경계에서 값/식이 흔들리는 오류를
  막기 위해 |
  | 8 | FACTORIAL_CANCELLATION | 팩토리얼 약분 | DA | P |
  nCr 계산에서 약분 실수가 잦아 별도 절차로 고정할 필요가
  있음 |
  | 9 | COMB_AS_SUBSET | 조합 의미(부분집합 선택) | DA | C
  | “선택=부분집합” 관점 없이 nCr이 맥락 없는 계산으로 남기
  쉬움 |
  | 10 | COMB_AS_CHOOSE_R | r개 선택 상황 해석 | DA | C |
  ‘r개 선택’을 입력으로 고정해 조건 누락/중복을 줄이기 위해
  |
  | 11 | COMB_ORDER_IGNORED_REASON | 조합에서 순서 중복을
  r!로 나누는 이유 | DA | C | ‘왜 나누는가’를 고정하지 않으
  면 조합 공식이 암기 점프가 됨 |
  | 12 | COMB_FROM_PERM_DIVIDE | nPr/r!로 nCr을 유도 | DA |
  P | 유도 절차를 통해 nPr/nCr 혼동을 낮추기 위해 |
  | 13 | CHOOSE_THEN_ARRANGE | 선택 후 배열(nPr = nCr·r!)
  구조 | DA | C | 순열↔조합 전이의 핵심 브릿지(선택-배열 분
  해)를 제공하기 위해 |
  | 14 | SYSTEMATIC_LISTING_BASIC | 체계적 나열 기초 | DA |
  P | 표본공간/사건에서 누락·중복을 줄이는 기본 절차이기 때
  문 |
  | 15 | TREE_DIAGRAM_BASIC | 트리 다이어그램으로 경우를 표
  현 | DA | P | 순차 선택 상황의 표현 전환(rep)을 제공해 누
  락을 방지하기 위해 |
  | 16 | SET_NOTATION_BASICS | 집합 기초(원소/부분집합/기
  호) | DA | C | 사건/연산을 집합 언어로 고정하는 전제가 필
  요함 |
  | 17 | SAMPLE_SPACE_AS_SET | 표본공간=집합 | DA | C | ‘전
  체(분모)’를 고정하는 개념 축이 없으면 확률 설정이 흔들림
  |
  | 18 | EVENT_AS_SUBSET | 사건=부분집합 | DA | C | ‘분자
  (유리)’를 표본공간의 부분으로 일관되게 정의하기 위해 |
  | 19 | PROB_AS_RATIO | 확률=비율(A/S) | DA | A | 확률을
  A/S로 수치화하고 비교·해석하는 핵심 표현이기 때문 |
  | 20 | CLASSICAL_PROB_EQUIPROBABLE_CHECK | 고전확률 등확
  률 전제 확인 | DA | C | 등확률 전제 없이 A/S를 오적용하는
  오개념을 차단하기 위해 |
  | 21 | EQUIPROBABLE_DECISION | 등확률 여부 게이트(Yes/No
  분기) | DA | C | “적용 가능/불가”를 명시적으로 분기해 적
  용 범위를 고정하기 위해 |
  | 22 | COUNT_FAVORABLE_TOTAL | 유리/전체 경우의 수 분리
  카운팅(A/S) | DA | P | 분자·분모를 분리해 세는 절차가 없
  으면 설정/계산이 흔들림 |
  | 23 | INTERSECTION_UNION_MEANING | 교집합/합집합 의미(∩/
  ∪) | DA | C | 포함배제/여사건에서 항 의미를 잃으면 부호·
  항 실수가 증가 |
  | 24 | EVENT_OPERATION_EXPRESSION | 사건 연산을 집합식으
  로 표현(문장→A∪B/A∩B/A^c) | DA | P | 문장 조건을 기호로
  고정하지 못하면 항 매핑이 불안정 |
  | 25 | DISJOINT_EVENTS | 서로소 사건(겹치지 않음) 판별 |
  DA | C | 덧셈원리·합집합 처리에서 ‘겹치지 않음’ 조건이 핵
  심이기 때문 |
  | 26 | DISJOINT_OR_OVERLAP_DECISION | 서로소/겹침 판정 게
  이트 | DA | C | 서로소면 합, 겹치면 포함배제라는 분기 구
  조를 고정하기 위해 |
  | 27 | CHECK_DOUBLE_COUNTING | 중복계수(겹침) 점검 | DA |
  C | ‘중복 보정’ 관점이 없으면 포함배제가 공식 암기로 남음
  |
  | 28 | VENN_DIAGRAM_2SET | 벤 다이어그램(2집합)으로 사건
  연산 시각화 | DA | P | 연산/겹침을 시각화해 항 누락·부호
  실수를 줄이기 위해 |
  | 29 | INCL_EXCL_2SET_MEANING | 2집합 포함배제 의미(중복
  보정) | DA | C | “왜 교집합을 빼는가” 의미가 없으면 오용/
  암기 위험이 큼 |
  | 30 | APPLY_INCL_EXCL_2SET | 2집합 포함배제 식 적용 실행
  (항 매핑→대입→계산) | DA | P | 의미에서 곧바로 답으로 점
  프하지 않도록 실행 절차를 분리 |
  | 31 | COMPLEMENT_EVENT | 여사건(보완) 개념 | DA | C | 1-
  p 규칙 전에 ‘전체-부분’ 개념이 고정되어야 남용이 줄어듦 |
  | 32 | COMPLEMENT_RULE | 여사건 규칙(1-p) | DA | A | 보완
  개념을 실제 계산 규칙으로 적용하는 단계가 필요 |
  | 33 | TOTAL_MINUS_STRATEGY | 전체-부분(보완) 전략(전체에
  서 빼기) | DA | C | 계산이 쉬운 쪽(보완)을 선택하는 문제
  해결 전략을 제공 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_PERM_MODELING | 순열 모델링(순서·자리→감소곱)
  | COUNT_MUL_RULE_MEANING, ORDER_SENSITIVE_CHECK,
  PERM_AS_FILLING_SLOTS, PERM_PRODUCT_FORM | 순열 상황을 자
  리 채우기로 해석하고 감소곱까지 안정적으로 쓰는 흐름 |
  | 2 | STEP_FACTORIAL_SIMPLIFY | 팩토리얼 전개·약분으로 계
  산 단순화 | FACTORIAL_EXPANSION, FACTORIAL_ZERO_MEANING,
  FACTORIAL_CANCELLATION | 전개/약분으로 계산을 줄이고 경계
  (r=0 등)에서 검산하는 흐름 |
  | 3 | STEP_COMB_DERIVE_WORKFLOW | 조합 유도 워크플로(순열
  ÷중복) | COMB_AS_SUBSET, COMB_AS_CHOOSE_R,
  COMB_ORDER_IGNORED_REASON, COMB_FROM_PERM_DIVIDE,
  CHOOSE_THEN_ARRANGE, FACTORIAL_CANCELLATION | “선택 후 배
  열”과 r! 중복 제거로 조합을 유도하고 단순화하는 흐름 |
  | 4 | STEP_SAMPLE_SPACE_BUILD_WORKFLOW | 표본공간 구성 워
  크플로(누락/중복 점검) | SYSTEMATIC_LISTING_BASIC,
  TREE_DIAGRAM_BASIC, SET_NOTATION_BASICS,
  SAMPLE_SPACE_AS_SET, EVENT_AS_SUBSET | 전체(표본공간)→사
  건을 빠짐/중복 없이 구성하는 중간 단계 |
  | 5 | STEP_CLASSICAL_PROB_SETUP_WORKFLOW | 고전확률 설정
  (전제 확인→A/S) | CLASSICAL_PROB_EQUIPROBABLE_CHECK,
  EQUIPROBABLE_DECISION, PROB_AS_RATIO,
  COUNT_FAVORABLE_TOTAL | 등확률 전제 확인 후 A/S로 분자·분
  모를 분리 카운팅하는 흐름 |
  | 6 | STEP_EVENT_OPS_INCL_EXCL_WORKFLOW | 사건 연산→겹침
  판정→포함배제 | INTERSECTION_UNION_MEANING,
  EVENT_OPERATION_EXPRESSION, DISJOINT_EVENTS,
  DISJOINT_OR_OVERLAP_DECISION, CHECK_DOUBLE_COUNTING,
  VENN_DIAGRAM_2SET, INCL_EXCL_2SET_MEANING,
  APPLY_INCL_EXCL_2SET, COUNT_ADD_RULE_MEANING | 문장→집합
  식→겹침 분기→중복 보정(포함배제/덧셈원리)을 실행하는 흐름
  |
  | 7 | STEP_COMPLEMENT_STRATEGY_WORKFLOW | 여사건 전략(전
  체-부분/1-p) | COMPLEMENT_EVENT, COMPLEMENT_RULE,
  TOTAL_MINUS_STRATEGY | 보완 개념을 1-p/전체-부분 전략으로
  연결해 계산을 단순화 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | COUNT_MUL_RULE_MEANING → PERM_AS_FILLING_SLOTS | 자
  리 채우기 카운팅은 단계별 선택 수를 곱하는 의미가 없으면
  성립하기 어려움 | 0.83 |
  | 2 | ORDER_SENSITIVE_CHECK → PERM_AS_FILLING_SLOTS | 순
  열 해석 자체가 “순서가 결과를 바꾼다” 판단에 의존 | 0.78
  |
  | 3 | PERM_AS_FILLING_SLOTS → PERM_PRODUCT_FORM | 자리 채
  우기 해석이 있어야 감소곱의 항(개수/감소)을 안정적으로 쓸
  수 있음 | 0.76 |
  | 4 | FACTORIAL_EXPANSION → FACTORIAL_CANCELLATION | 약분
  은 전개/구조 이해 없이 기계적으로 하면 오류가 커짐 | 0.82
  |
  | 5 | PERM_PRODUCT_FORM → COMB_FROM_PERM_DIVIDE | nCr 유
  도는 nPr을 분자 형태로 세팅하는 것이 핵심 | 0.80 |
  | 6 | COMB_ORDER_IGNORED_REASON → COMB_FROM_PERM_DIVIDE |
  r!로 나누는 이유(중복 제거) 없이 유도식이 암기 점프로 변
  함 | 0.82 |
  | 7 | COMB_AS_SUBSET → COMB_AS_CHOOSE_R | “선택=부분집
  합”이 고정되어야 ‘r개 선택’ 입력이 흔들리지 않음 | 0.75 |
  | 8 | SET_NOTATION_BASICS → SAMPLE_SPACE_AS_SET | 표본공
  간을 집합으로 고정하려면 집합 언어가 필요 | 0.80 |
  | 9 | SAMPLE_SPACE_AS_SET → EVENT_AS_SUBSET | 사건을 표본
  공간의 부분으로 정의하는 데 표본공간=집합이 선행 | 0.80 |
  | 10 | CLASSICAL_PROB_EQUIPROBABLE_CHECK →
  EQUIPROBABLE_DECISION | 등확률 전제 점검이 없으면 적용/비
  적용 분기를 만들 수 없음 | 0.77 |
  | 11 | PROB_AS_RATIO → COUNT_FAVORABLE_TOTAL | A/S로 해석
  해야 분자(유리)·분모(전체) 분리 카운팅이 일관됨 | 0.77 |
  | 12 | INTERSECTION_UNION_MEANING →
  EVENT_OPERATION_EXPRESSION | ∩/∪ 의미가 있어야 문장→집합
  식 변환이 기호 나열이 아닌 의미 기반이 됨 | 0.76 |
  | 13 | DISJOINT_EVENTS → DISJOINT_OR_OVERLAP_DECISION |
  겹치지 않음(서로소) 개념이 있어야 분기(서로소/겹침)를 수
  행 가능 | 0.74 |
  | 14 | INCL_EXCL_2SET_MEANING → APPLY_INCL_EXCL_2SET | 중
  복 보정 의미 없이 공식 대입은 항/부호 실수를 크게 만든다
  | 0.78 |
  | 15 | COMPLEMENT_EVENT → COMPLEMENT_RULE | 1-p는 보완(전
  체-부분) 개념이 선행되지 않으면 규칙 남용이 발생 | 0.72 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | COUNT_ADD_RULE_MEANING → DISJOINT_EVENTS | 서로소
  조건을 ‘왜 더해도 되는가’로 연결하면 합/포함배제 오용이
  줄어듦 | 0.70 |
  | 2 | DISJOINT_OR_OVERLAP_DECISION →
  INCL_EXCL_2SET_MEANING | “겹침이면 포함배제”라는 선택 규
  칙을 먼저 고정하면 공식 암기가 줄어듦 | 0.72 |
  | 3 | VENN_DIAGRAM_2SET → INCL_EXCL_2SET_MEANING | 시각화
  가 있으면 ‘중복 보정’ 직관이 빠르게 형성됨 | 0.74 |
  | 4 | CHECK_DOUBLE_COUNTING → APPLY_INCL_EXCL_2SET | 실제
  계산에서 ‘겹침을 한 번만 보정’하는 점검이 부호 실수를 줄
  임 | 0.75 |
  | 5 | EVENT_AS_SUBSET → EVENT_OPERATION_EXPRESSION | 사건
  을 부분집합으로 고정하면 문장→집합식 전환이 더 안정적 |
  0.72 |
  | 6 | SYSTEMATIC_LISTING_BASIC → TREE_DIAGRAM_BASIC | 동
  일 카운팅을 다른 표현으로 재현하면 누락/중복 검산이 쉬움
  | 0.66 |
  | 7 | FACTORIAL_ZERO_MEANING → FACTORIAL_EXPANSION | 0!
  경계 해석이 있으면 전개/약분에서 ‘빈 곱’ 처리가 흔들리지
  않음 | 0.68 |
  | 8 | FACTORIAL_ZERO_MEANING → COMB_FROM_PERM_DIVIDE |
  r=0, r=n 경계에서 nCr 유도식/값 검산이 쉬워짐 | 0.66 |
  | 9 | CHOOSE_THEN_ARRANGE → COMB_ORDER_IGNORED_REASON |
  선택-배열 분해가 ‘왜 r!로 나누나’의 직관적 근거가 됨 |
  0.70 |
  | 10 | COMB_AS_CHOOSE_R → COMB_ORDER_IGNORED_REASON | r개
  선택 입력이 고정되면 ‘순서 중복’의 대상이 명확해짐 | 0.70
  |
  | 11 | EQUIPROBABLE_DECISION → COUNT_FAVORABLE_TOTAL | A/
  S 적용 가능한 경우에만 분자·분모 카운팅으로 들어가는 것이
  안전 | 0.73 |
  | 12 | TOTAL_MINUS_STRATEGY → COMPLEMENT_RULE | 1-p를 ‘전
  체-부분’ 전략으로 해석하면 문맥 없는 뒤집기를 줄임 | 0.70
  |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | ORDER_SENSITIVE_CHECK | “순서 바뀌면 다른 경우인
  가?” 판단 기준이 모호해 도구 선택이 흔들림 | 같은 대상의
  순서 교환 예/반예를 짝으로 제시해 ‘불변성 테스트’로 게이
  트를 고정 | 0.78 |
  | 2 | PERM_AS_FILLING_SLOTS | 조건(중복 불가/특정 자리 제
  한)을 ‘자리’로 매핑 못해 공식 항을 틀림 | 자리 박스(1~r)
  와 남은 선택 수를 표로 쓰게 하여 조건→항 매핑을 절차화 |
  0.76 |
  | 3 | PERM_PRODUCT_FORM | r개 항 개수, 시작값/끝값(감소)
  에서 오프바이원 실수 | “첫 항=가능 수, 항 개수=r” 체크리
  스트 + 소규모 수로 샘플 검산 | 0.74 |
  | 4 | FACTORIAL_EXPANSION | 필요 이상으로 전개하거나, 전
  개 방향을 잃어 계산이 복잡해짐 | “약분에 필요한 만큼만 전
  개” 규칙 + 공통인수 표시 후 전개 | 0.80 |
  | 5 | FACTORIAL_CANCELLATION | (n-r)! 같은 괄호 단위를 놓
  쳐 약분/전개 오류 | 약분 전 ‘팩토리얼 블록’ 단위 표시(괄
  호)→공통구간만 소거 | 0.77 |
  | 6 | COMB_ORDER_IGNORED_REASON | ‘왜 r!로 나눠야 하는
  지’가 직관 없이 공식 암기로 남음 | 동일 선택 집합의 서로
  다른 배열이 r!개임을 직접 나열/트리로 확인 | 0.80 |
  | 7 | COMB_FROM_PERM_DIVIDE | nPr/nCr를 뒤섞거나 분모 r!
  의 위치를 혼동 | “선택(nCr) 후 배열(r!)”로 역방향 재구성
  해 유도식을 재현 | 0.76 |
  | 8 | STEP_SAMPLE_SPACE_BUILD_WORKFLOW | 표본공간에서 누
  락/중복이 생겨 분모가 흔들림 | 체계적 나열→트리→개수 일치
  2중 검산, ‘서로소 분할’로 조각내기 | 0.75 |
  | 9 | CLASSICAL_PROB_EQUIPROBABLE_CHECK | 등확률이 아닌데
  도 A/S를 적용(대표성/대칭 착각) | “각 원소의 확률이 같은
  가?” 체크 후 아니면 다른 모델(가중)로 분기하도록 게이트
  사용 | 0.77 |
  | 10 | COUNT_FAVORABLE_TOTAL | 분자/분모가 뒤바뀌거나 사
  건을 전체로 착각 | 먼저 S(전체) 고정 후 A(조건)만 필터링
  하는 2단계 기록 템플릿 | 0.74 |
  | 11 | EVENT_OPERATION_EXPRESSION | 언어 조건(또는/그리
  고/아니고)을 ∪/∩/여집합으로 바꾸는 표현전환 부담 | 키워드
  사전(또는=∪, 그리고=∩, ~아니다=^c) + 벤 다이어그램으로 교
  차 확인 | 0.72 |
  | 12 | INCL_EXCL_2SET_MEANING | “왜 교집합을 빼는가” 의미
  가 없어서 부호를 외우다 실수 | 겹치는 영역이 두 번 세어짐
  을 도형으로 표시하고 ‘중복 1회 보정’ 문장으로 고정 | 0.78
  |
  | 13 | APPLY_INCL_EXCL_2SET | 항(A,B,A∩B) 매핑이 틀리거나
  대입 후 산술 실수 | 항 매핑(표)→대입→결과 범위(0~전체)
  sanity check를 강제 | 0.73 |
  | 14 | COMPLEMENT_RULE | 1-p를 문맥 없이 적용해 사건이 바
  뀌는 오류 | “여사건을 먼저 말로 정의”→그 사건의 A를 다시
  세는 절차로 규칙을 붙임 | 0.72 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | COUNT_MUL_RULE_MEANING → PERM_PRODUCT_FORM |
  PERM_AS_FILLING_SLOTS | ‘자리 채우기’ 해석이 있어야 감소
  곱이 의미를 가진다 |
  | 2 | ORDER_SENSITIVE_CHECK → COMB_FROM_PERM_DIVIDE |
  CHOOSE_THEN_ARRANGE | 순서 게이트 이후 “선택→배열” 구조가
  조합 유도의 중간 다리 |
  | 3 | PERM_PRODUCT_FORM → COMB_FROM_PERM_DIVIDE |
  COMB_ORDER_IGNORED_REASON | r!로 나누는 이유가 없으면
  nPr/r!이 암기식으로 남음 |
  | 4 | FACTORIAL_EXPANSION → COMB_FROM_PERM_DIVIDE |
  FACTORIAL_CANCELLATION | 유도식 단순화에서 약분 절차가 빠
  지면 계산이 폭발한다 |
  | 5 | COMB_AS_SUBSET → COMB_FROM_PERM_DIVIDE |
  COMB_AS_CHOOSE_R | ‘r개 선택’ 입력을 고정하면 유도식의 의
  미(무엇을 세나)가 명확해짐 |
  | 6 | SET_NOTATION_BASICS → EVENT_OPERATION_EXPRESSION |
  EVENT_AS_SUBSET | 사건=부분집합이 중간에 있어야 문장→집합
  식 전환이 안정된다 |
  | 7 | SYSTEMATIC_LISTING_BASIC → COUNT_FAVORABLE_TOTAL |
  STEP_SAMPLE_SPACE_BUILD_WORKFLOW | 전체(분모) 고정 단계를
  거치면 분모 오류가 줄어든다 |
  | 8 | CLASSICAL_PROB_EQUIPROBABLE_CHECK → PROB_AS_RATIO |
  EQUIPROBABLE_DECISION | 전제 확인 후 Yes/No 분기를 거쳐야
  A/S 적용이 안전하다 |
  | 9 | EVENT_OPERATION_EXPRESSION → APPLY_INCL_EXCL_2SET |
  INCL_EXCL_2SET_MEANING | 의미(중복 보정)가 없으면 실행은
  부호/항 실수로 이어진다 |
  | 10 | COMPLEMENT_EVENT → TOTAL_MINUS_STRATEGY |
  COMPLEMENT_RULE | 개념을 1-p 규칙으로 연결하면 ‘전체-부
  분’ 전략이 문맥화된다 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "TS_COMB_PROB",
    "add_nodes": [
      { "id": "COUNT_MUL_RULE_MEANING", "type": "micro",
  "name_ko": "곱셈 원리 의미(단계 곱)", "domain": "DA",
  "rep": "C", "confidence": 0.84 },
      { "id": "COUNT_ADD_RULE_MEANING", "type": "micro",
  "name_ko": "덧셈 원리 의미(서로소 합)", "domain": "DA",
  "rep": "C", "confidence": 0.80 },
      { "id": "ORDER_SENSITIVE_CHECK", "type": "micro",
  "name_ko": "순서 민감 판단(순열/조합 분기)", "domain":
  "DA", "rep": "C", "confidence": 0.78 },
      { "id": "PERM_AS_FILLING_SLOTS", "type": "micro",
  "name_ko": "순열 의미(자리 채우기)", "domain": "DA",
  "rep": "C", "confidence": 0.80 },
      { "id": "PERM_PRODUCT_FORM", "type": "micro",
  "name_ko": "nPr을 감소곱(곱 형태)로 표현", "domain":
  "DA", "rep": "P", "confidence": 0.76 },
      { "id": "FACTORIAL_EXPANSION", "type": "micro",
  "name_ko": "팩토리얼 전개 n!=n*(n-1)*...", "domain":
  "DA", "rep": "P", "confidence": 0.82 },
      { "id": "FACTORIAL_ZERO_MEANING", "type": "micro",
  "name_ko": "0! 의미 해석(경계 사례)", "domain": "DA",
  "rep": "A", "confidence": 0.74 },
      { "id": "FACTORIAL_CANCELLATION", "type": "micro",
  "name_ko": "팩토리얼 약분", "domain": "DA", "rep": "P",
  "confidence": 0.78 },
      { "id": "COMB_AS_SUBSET", "type": "micro", "name_ko":
  "조합 의미(부분집합 선택)", "domain": "DA", "rep": "C",
  "confidence": 0.80 },
      { "id": "COMB_AS_CHOOSE_R", "type": "micro",
  "name_ko": "r개 선택 상황 해석", "domain": "DA", "rep":
  "C", "confidence": 0.75 },
      { "id": "COMB_ORDER_IGNORED_REASON", "type": "micro",
  "name_ko": "조합에서 순서 중복을 r!로 나누는 이유",
  "domain": "DA", "rep": "C", "confidence": 0.80 },
      { "id": "COMB_FROM_PERM_DIVIDE", "type": "micro",
  "name_ko": "nPr/r!로 nCr을 유도", "domain": "DA", "rep":
  "P", "confidence": 0.76 },
      { "id": "CHOOSE_THEN_ARRANGE", "type": "micro",
  "name_ko": "선택 후 배열(nPr = nCr·r!) 구조", "domain":
  "DA", "rep": "C", "confidence": 0.72 },
      { "id": "SYSTEMATIC_LISTING_BASIC", "type": "micro",
  "name_ko": "체계적 나열 기초", "domain": "DA", "rep":
  "P", "confidence": 0.78 },
      { "id": "TREE_DIAGRAM_BASIC", "type": "micro",
  "name_ko": "트리 다이어그램으로 경우를 표현", "domain":
  "DA", "rep": "P", "confidence": 0.70 },
      { "id": "SET_NOTATION_BASICS", "type": "micro",
  "name_ko": "집합 기초(원소/부분집합/기호)", "domain":
  "DA", "rep": "C", "confidence": 0.78 },
      { "id": "SAMPLE_SPACE_AS_SET", "type": "micro",
  "name_ko": "표본공간=집합", "domain": "DA", "rep": "C",
  "confidence": 0.80 },
      { "id": "EVENT_AS_SUBSET", "type": "micro",
  "name_ko": "사건=부분집합", "domain": "DA", "rep": "C",
  "confidence": 0.80 },
      { "id": "PROB_AS_RATIO", "type": "micro", "name_ko":
  "확률=비율(A/S)", "domain": "DA", "rep": "A",
  "confidence": 0.76 },
      { "id": "CLASSICAL_PROB_EQUIPROBABLE_CHECK", "type":
  "micro", "name_ko": "고전확률 등확률 전제 확인",
  "domain": "DA", "rep": "C", "confidence": 0.77 },
      { "id": "EQUIPROBABLE_DECISION", "type": "micro",
  "name_ko": "등확률 여부 게이트(Yes/No 분기)", "domain":
  "DA", "rep": "C", "confidence": 0.74 },
      { "id": "COUNT_FAVORABLE_TOTAL", "type": "micro",
  "name_ko": "유리/전체 경우의 수 분리 카운팅(A/S)",
  "domain": "DA", "rep": "P", "confidence": 0.77 },
      { "id": "INTERSECTION_UNION_MEANING", "type":
  "micro", "name_ko": "교집합/합집합 의미(∩/∪)", "domain":
  "DA", "rep": "C", "confidence": 0.76 },
      { "id": "EVENT_OPERATION_EXPRESSION", "type":
  "micro", "name_ko": "사건 연산을 집합식으로 표현(문장
  →A∪B/A∩B/A^c)", "domain": "DA", "rep": "P", "confidence":
  0.76 },
      { "id": "DISJOINT_EVENTS", "type": "micro",
  "name_ko": "서로소 사건(겹치지 않음) 판별", "domain":
  "DA", "rep": "C", "confidence": 0.74 },
      { "id": "DISJOINT_OR_OVERLAP_DECISION", "type":
  "micro", "name_ko": "서로소/겹침 판정 게이트", "domain":
  "DA", "rep": "C", "confidence": 0.74 },
      { "id": "CHECK_DOUBLE_COUNTING", "type": "micro",
  "name_ko": "중복계수(겹침) 점검", "domain": "DA", "rep":
  "C", "confidence": 0.74 },
      { "id": "VENN_DIAGRAM_2SET", "type": "micro",
  "name_ko": "벤 다이어그램(2집합)으로 사건 연산 시각화",
  "domain": "DA", "rep": "P", "confidence": 0.74 },
      { "id": "INCL_EXCL_2SET_MEANING", "type": "micro",
  "name_ko": "2집합 포함배제 의미(중복 보정)", "domain":
  "DA", "rep": "C", "confidence": 0.78 },
      { "id": "APPLY_INCL_EXCL_2SET", "type": "micro",
  "name_ko": "2집합 포함배제 식 적용 실행(항 매핑→대입→계
  산)", "domain": "DA", "rep": "P", "confidence": 0.75 },
      { "id": "COMPLEMENT_EVENT", "type": "micro",
  "name_ko": "여사건(보완) 개념", "domain": "DA", "rep":
  "C", "confidence": 0.74 },
      { "id": "COMPLEMENT_RULE", "type": "micro",
  "name_ko": "여사건 규칙(1-p)", "domain": "DA", "rep":
  "A", "confidence": 0.74 },
      { "id": "TOTAL_MINUS_STRATEGY", "type": "micro",
  "name_ko": "전체-부분(보완) 전략(전체에서 빼기)",
  "domain": "DA", "rep": "C", "confidence": 0.68 },
      { "id": "STEP_PERM_MODELING", "type": "step",
  "name_ko": "순열 모델링(순서·자리→감소곱)", "domain":
  "DA", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_FACTORIAL_SIMPLIFY", "type": "step",
  "name_ko": "팩토리얼 전개·약분으로 계산 단순화",
  "domain": "DA", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_COMB_DERIVE_WORKFLOW", "type": "step",
  "name_ko": "조합 유도 워크플로(순열÷중복)", "domain":
  "DA", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_SAMPLE_SPACE_BUILD_WORKFLOW", "type":
  "step", "name_ko": "표본공간 구성 워크플로(누락/중복 점
  검)", "domain": "DA", "rep": "C", "confidence": 0.75 },
      { "id": "STEP_CLASSICAL_PROB_SETUP_WORKFLOW", "type":
  "step", "name_ko": "고전확률 설정(전제 확인→A/S)",
  "domain": "DA", "rep": "C", "confidence": 0.76 },
      { "id": "STEP_EVENT_OPS_INCL_EXCL_WORKFLOW", "type":
  "step", "name_ko": "사건 연산→겹침 판정→포함배제",
  "domain": "DA", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_COMPLEMENT_STRATEGY_WORKFLOW", "type":
  "step", "name_ko": "여사건 전략(전체-부분/1-p)",
  "domain": "DA", "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "COUNT_MUL_RULE_MEANING", "to":
  "PERM_AS_FILLING_SLOTS", "type": "requires",
  "confidence": 0.83 },
      { "from": "ORDER_SENSITIVE_CHECK", "to":
  "PERM_AS_FILLING_SLOTS", "type": "requires",
  "confidence": 0.78 },
      { "from": "PERM_AS_FILLING_SLOTS", "to":
  "PERM_PRODUCT_FORM", "type": "requires", "confidence":
  0.76 },
      { "from": "FACTORIAL_EXPANSION", "to":
  "FACTORIAL_CANCELLATION", "type": "requires",
  "confidence": 0.82 },
      { "from": "PERM_PRODUCT_FORM", "to":
  "COMB_FROM_PERM_DIVIDE", "type": "requires",
  "confidence": 0.80 },
      { "from": "COMB_ORDER_IGNORED_REASON", "to":
  "COMB_FROM_PERM_DIVIDE", "type": "requires",
  "confidence": 0.82 },
      { "from": "COMB_AS_SUBSET", "to": "COMB_AS_CHOOSE_R",
  "type": "requires", "confidence": 0.75 },
      { "from": "SET_NOTATION_BASICS", "to":
  "SAMPLE_SPACE_AS_SET", "type": "requires", "confidence":
  0.80 },
      { "from": "SAMPLE_SPACE_AS_SET", "to":
  "EVENT_AS_SUBSET", "type": "requires", "confidence":
  0.80 },
      { "from": "CLASSICAL_PROB_EQUIPROBABLE_CHECK", "to":
  "EQUIPROBABLE_DECISION", "type": "requires",
  "confidence": 0.77 },
      { "from": "PROB_AS_RATIO", "to":
  "COUNT_FAVORABLE_TOTAL", "type": "requires",
  "confidence": 0.77 },
      { "from": "INTERSECTION_UNION_MEANING", "to":
  "EVENT_OPERATION_EXPRESSION", "type": "requires",
  "confidence": 0.76 },
      { "from": "DISJOINT_EVENTS", "to":
  "DISJOINT_OR_OVERLAP_DECISION", "type": "requires",
  "confidence": 0.74 },
      { "from": "INCL_EXCL_2SET_MEANING", "to":
  "APPLY_INCL_EXCL_2SET", "type": "requires", "confidence":
  0.78 },
      { "from": "COMPLEMENT_EVENT", "to":
  "COMPLEMENT_RULE", "type": "requires", "confidence":
  0.72 }
    ],
    "remove_edges": [
      { "from": "PERM_PRODUCT_FORM", "to":
  "FACTORIAL_EXPANSION", "type": "requires", "reason": "팩
  토리얼 전개는 nPr보다 기초라 선후관계가 역전될 수 있음",
  "confidence": 0.75 },
      { "from": "FACTORIAL_ZERO_MEANING", "to":
  "STEP_PERM_DERIVE", "type": "requires", "reason": "0! 경
  계 해석은 유도 단계의 필수라기보다 경계 검산용",
  "confidence": 0.70 }
    ],
    "notes": [
      { "claim": "CHOOSE_THEN_ARRANGE는
  COMB_FROM_PERM_DIVIDE로 가는 권장 브릿지다.", "reason":
  "선택(nCr)과 배열(r!)을 분리하면 r!로 나누는 이유가 직관
  화되어 암기 점프가 줄어든다.", "confidence": 0.70 },
      { "claim": "FACTORY_ZERO_MEANING은 경계(r=0,r=n)에서
  만 높은 중요도를 가지며 requires로 강제하기보다 검산 노드
  로 두는 편이 안전하다.", "reason": "대부분의 본문 문제는
  경계가 아니어서 0!를 필수로 잠그면 과잉 선행이 될 수 있
  다.", "confidence": 0.68 },
      { "claim": "EQUIPROBABLE_DECISION은 A/S 적용 전에 배
  치하는 게이트로 두는 것이 안전하다.", "reason": "등확률
  전제 없이 고전확률을 적용하면 표본공간/가중치가 다른 상황
  에서 오개념이 고착된다.", "confidence": 0.76 },
      { "claim": "VENN_DIAGRAM_2SET은
  INCL_EXCL_2SET_MEANING의 권장 보조 표현이다.", "reason":
  "겹침(중복) 영역을 시각화하면 -교집합 부호가 공식이 아니
  라 중복 보정으로 연결된다.", "confidence": 0.74 },
      { "claim": "EVENT_AS_SUBSET과
  EVENT_OPERATION_EXPRESSION 사이에는 문장→기호 매핑 연습을
  권장한다.", "reason": "언어 조건을 ∪/∩/^c로 고정하지 못하
  면 포함배제/여사건에서 항 누락·부호 실수가 증가한다.",
  "confidence": 0.72 },
      { "claim": "CHECK_DOUBLE_COUNTING은
  APPLY_INCL_EXCL_2SET 직전의 오류 방지 체크포인트로 권장한
  다.", "reason": "겹침을 두 번 세었는지 확인하는 한 문장
  점검만으로도 계산 실수가 크게 줄어든다.", "confidence":
  0.75 },
      { "claim": "TOTAL_MINUS_STRATEGY는 COMPLEMENT_RULE과
  함께 전략 노드로 두되 requires로 강제하지 않는다.",
  "reason": "보완으로 푸는 경로는 대체 전략이 많아 잠금으로
  강제하면 과잉 제약이 될 수 있다.", "confidence": 0.70 },
      { "claim": "COUNT_ADD_RULE_MEANING은 서로소(겹치지 않
  음) 조건과 함께 학습되도록 권장한다.", "reason": "서로소
  조건 없이 ‘더한다’를 적용하면 합집합/포함배제에서 중복 계
  산 오개념이 생긴다.", "confidence": 0.71 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | COUNT_MUL_RULE_MEANING(곱셈 원리 의미) | 순열/조합/
  표본공간 카운팅
  의 기반인데 단계-곱 의미가 비면 공식/절차가 암기형으로 굳
  음 | 높음 |
  | 2 | ORDER_SENSITIVE_CHECK(순서 민감 판단) | 순열/조합
  분기 기준이 없으
  면 도구 선택이 흔들려 오답이 고착 | 높음 |
  | 3 | PERM_AS_FILLING_SLOTS(순열 의미: 자리 채우기) | nPr
  을 “배열/배
  치”로 해석하지 못하면 조건을 공식 항에 매핑하기 어려움 |
  높음 |
  | 4 | PERM_PRODUCT_FORM(nPr의 감소곱 형태) | 곱 형태가 없
  으면 팩토리얼
  표기/검산으로의 표현 전환이 끊김 | 중 |
  | 5 | FACTORIAL_EXPANSION(팩토리얼 전개) | n!=n*(n-1)*…
  구조 부재 시 유
  도/검산이 블랙박스가 됨 | 높음 |
  | 6 | FACTORIAL_ZERO_MEANING(0! 의미) | r=0, r=n 같은 경
  계에서 값/식이
  흔들리면 전체 체계가 붕괴 | 중 |
  | 7 | FACTORIAL_CANCELLATION(팩토리얼 약분) | 조합 계산에
  서 약분 절차가
  없으면 nCr 계산이 기계적/오류 다발 | 중 |
  | 8 | COMB_AS_SUBSET(조합 의미: 부분집합 선택) | 선택=부
  분집합 관점이 없
  으면 조합 공식이 맥락 없는 계산으로 남음 | 높음 |
  | 9 | COMB_AS_CHOOSE_R(r개 선택 해석) | “r개 선택”을 입력
  으로 고정하지
  못하면 조건 누락/중복으로 연결 | 중 |
  |10| COMB_ORDER_IGNORED_REASON(왜 r!로 나누는가) | ‘중복
  제거’ 이유가 없
  으면 조합 유도/공식이 암기 점프로 변함 | 높음 |
  |11| COMB_FROM_PERM_DIVIDE(nPr/r! 유도) | 유도 절차 부재
  시 조합 공식으
  로의 전이가 과격해짐 | 중 |
  |12| SET_NOTATION_BASICS(집합 기초 기호) | 사건/연산을 집
  합 언어로 고정
  하는 전제가 없으면 조건을 수식화하기 어려움 | 높음 |
  |13| STEP_SAMPLE_SPACE_BUILD(표본공간 구성 단계) | “전체
  (분모) 고정” 중
  간 단계가 없으면 고전확률 설정에서 분모 오류 반복 | 높음
  |
  |14| CLASSICAL_PROB_EQUIPROBABLE_CHECK(등확률 전제 확인)
  | 등확률 전제
  없이 A/S를 오적용하는 오개념 차단 장치가 필요 | 높음 |
  |15| EQUIPROBABLE_DECISION(등확률 게이트) | “적용 가능/불
  가” 분기가 없으
  면 고전확률 적용 범위가 흐려짐 | 중 |
  |16| COUNT_FAVORABLE_TOTAL(유리/전체 분리 카운팅) | 분자/
  분모를 분리해
  세는 절차가 없으면 설정/계산이 흔들림 | 높음 |
  |17| EVENT_OPERATION_EXPRESSION(문장→집합식) | 문장을
  A∪B/A∩B/A^c로 고정
  하지 못하면 포함배제/여사건에서 항 매핑·부호 실수 증가 |
  높음 |
  |18| INCL_EXCL_2SET_MEANING(2집합 포함배제 의미) | “왜 교
  집합을 빼는가
  (중복 보정)” 의미 없이 공식만 주면 오용/암기 위험 | 높음
  |
  |19| APPLY_INCL_EXCL_2SET(포함배제 계산 실행) | 의미에서
  곧바로 단계 완
  성으로 점프하면 항 매핑→대입→계산 실행이 불안정 | 중 |
  |20| COMPLEMENT_EVENT(여사건/보완 개념) | 1-p 규칙 전에
  보완(전체-부분)
  개념이 고정되어야 규칙 남용이 줄어듦 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 조건부확률 | 분모 재정의/사건 분할이 필요해
  TS_COMB_PROB 기초에서
  인지부하가 큼 | 별도 심화 단원으로 분리 |
  | 2 | 베이즈 정리 | 조건부확률+역확률까지 요구하는 고난도
  전이 | 범위외/
  선택 심화 |
  | 3 | 독립 사건/독립의 곱 | 적용 조건이 미세해 “무작위=독
  립” 오개념 유발
  가능 | 후순위(심화)로 이관 |
  | 4 | 확률변수/기댓값/분산 | 사건 확률에서 분포/통계로 축
  이 바뀌는 별도
  영역 | 별도 보스/단원 분리 |
  | 5 | 확률분포(이항/정규 등) | 모델링/분포는 기초 조합·확
  률 커버리지 밖
  | 별도 보스/단원 분리 |
  | 6 | 3집합 이상 포함배제 일반식 | 2집합 의미 정착 전에는
  기호/계산 부담
  과도 | 기본은 2집합으로 제한 |
  | 7 | 중복순열/원순열/중복조합 | 추가 동치/중복 처리 규칙
  이 필요해 기초
  학습에 과잉 | 범위외/선택 심화 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | COUNT_MUL_RULE_MEANING → PERM_BASIC | 단계 곱에서
  곧바로 순열 단원
  으로 점프하면 의미(자리 채우기)와 표기(감소곱/팩토리얼)가
  분리되어 공식
  암기화 | PERM_AS_FILLING_SLOTS + PERM_PRODUCT_FORM +
  FACTORIAL_EXPANSION

  - STEP_PERM_DERIVE |
    | 2 | PERM_BASIC → COMB_BASIC | 순열에서 조합으로 넘어
    갈 때 “순서 무시/
    중복 제거”가 비면 nPr/nCr 혼동이 고착 |
    COMB_ORDER_IGNORED_REASON +
    COMB_FROM_PERM_DIVIDE + STEP_COMB_DERIVE |
    | 3 | ORDER_SENSITIVE_CHECK → COMB_BASIC | 순서 게이트
    만 있고 “선택=부분
    집합/ r개 선택 입력”이 비면 조합 해석이 불안정 |
    COMB_AS_SUBSET +
    COMB_AS_CHOOSE_R |
    | 4 | SYSTEMATIC_LISTING_BASIC → STEP_PROB_SETUP | 나열
    에서 바로 확률 설
    정으로 가면 “전체(분모) 고정”이 약해 분모 오류 반복 |
    STEP_SAMPLE_SPACE_BUILD |
    | 5 | SAMPLE_SPACE_AS_SET → STEP_PROB_SETUP | 표본공간
    을 알아도 등확률
    전제/유리-전체 카운팅 절차가 비면 A/S 오적용 |
    CLASSICAL_PROB_EQUIPROBABLE_CHECK +
    EQUIPROBABLE_DECISION +
    COUNT_FAVORABLE_TOTAL + PROB_AS_RATIO |
    | 6 | SET_NOTATION_BASICS → STEP_INCL_EXCL_2SET | 집합
    기호를 알아도 문
    장→집합식→겹침 판정이 없으면 포함배제가 공식 점프로 됨
    |
    EVENT_OPERATION_EXPRESSION +
    DISJOINT_OR_OVERLAP_DECISION +
    STEP_EVENT_OPS_INCL_EXCL |
    | 7 | INCL_EXCL_2SET_MEANING → STEP_INCL_EXCL_2SET | 의
    미에서 단계 완성
    으로 바로 가면 항 매핑/대입/계산 실행이 비어 실수 증가
    |
    APPLY_INCL_EXCL_2SET |
    | 8 | COMPLEMENT_EVENT → PROB_BASIC | 개념에서 곧바로
    1-p로 점프하면 규
    칙 남용(문맥 없는 뒤집기) 위험 | COMPLEMENT_RULE (필요
    시
    TOTAL_MINUS_STRATEGY 권장) |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "TS_COMB_PROB",
  "add_nodes": [
  { "id": "COUNT_MUL_RULE_MEANING", "type": "micro",
  "name_ko": "곱셈
  원리 의미(단계 곱)", "domain": "DA", "rep": "C",
  "confidence": 0.83 },
  { "id": "COUNT_ADD_RULE_MEANING", "type": "micro",
  "name_ko": "덧셈
  원리 의미(서로소 합)", "domain": "DA", "rep": "C",
  "confidence": 0.8 },
  { "id": "ORDER_SENSITIVE_CHECK", "type": "micro",
  "name_ko": "순서
  민감 판단(순열/조합 분기)", "domain": "DA", "rep": "C",
  "confidence":
  0.76 },
  { "id": "PERM_AS_FILLING_SLOTS", "type": "micro",
  "name_ko": "순열
  의미(자리 채우기)", "domain": "DA", "rep": "C",
  "confidence": 0.78 },
  { "id": "PERM_PRODUCT_FORM", "type": "micro", "name_ko":
  "nPr을 감소
  곱(곱 형태)로 표현", "domain": "DA", "rep": "P",
  "confidence": 0.74 },
  { "id": "FACTORIAL_EXPANSION", "type": "micro",
  "name_ko": "팩토리얼
  전개 n!=n*(n-1)*...", "domain": "DA", "rep": "P",
  "confidence": 0.82 },
  { "id": "FACTORIAL_ZERO_MEANING", "type": "micro",
  "name_ko": "0! 의
  미 해석(경계 사례)", "domain": "DA", "rep": "A",
  "confidence": 0.74 },
  { "id": "FACTORIAL_CANCELLATION", "type": "micro",
  "name_ko": "팩토
  리얼 약분", "domain": "DA", "rep": "P", "confidence":
  0.78 },
  { "id": "STEP_PERM_DERIVE", "type": "step", "name_ko":
  "순열 공식 유
  도 단계", "domain": "DA", "rep": "C", "confidence":
  0.74 },

        { "id": "COMB_AS_SUBSET", "type": "micro",
  "name_ko": "조합 의미(부

  분집합 선택)", "domain": "DA", "rep": "C", "confidence":
  0.8 },
  { "id": "COMB_AS_CHOOSE_R", "type": "micro", "name_ko":
  "r개 선택 상
  황 해석", "domain": "DA", "rep": "C", "confidence":
  0.75 },
  { "id": "COMB_ORDER_IGNORED_REASON", "type": "micro",
  "name_ko": "조
  합에서 순서 중복을 r!로 나누는 이유", "domain": "DA",
  "rep": "C",
  "confidence": 0.8 },
  { "id": "COMB_FROM_PERM_DIVIDE", "type": "micro",
  "name_ko": "nPr/r!
  로 nCr을 유도", "domain": "DA", "rep": "P", "confidence":
  0.74 },
  { "id": "CHOOSE_THEN_ARRANGE", "type": "micro",
  "name_ko": "선택 후
  배열( nPr = nCr·r! ) 구조", "domain": "DA", "rep": "C",
  "confidence":
  0.72 },
  { "id": "STEP_COMB_DERIVE", "type": "step", "name_ko":
  "조합 공식 유
  도 단계", "domain": "DA", "rep": "C", "confidence":
  0.74 },

        { "id": "SYSTEMATIC_LISTING_BASIC", "type":
  "micro", "name_ko": "체

  계적 나열 기초", "domain": "DA", "rep": "P",
  "confidence": 0.78 },
  { "id": "TREE_DIAGRAM_BASIC", "type": "micro", "name_ko":
  "트리 다이
  어그램으로 경우를 표현", "domain": "DA", "rep": "P",
  "confidence":
  0.7 },
  { "id": "STEP_SAMPLE_SPACE_BUILD", "type": "step",
  "name_ko": "표본
  공간 구성 단계(빠짐/중복 점검)", "domain": "DA", "rep":
  "C",
  "confidence": 0.75 },

        { "id": "SET_NOTATION_BASICS", "type": "micro",
  "name_ko": "집합 기

  초(원소/부분집합/기호)", "domain": "DA", "rep": "C",
  "confidence":
  0.78 },
  { "id": "SAMPLE_SPACE_AS_SET", "type": "micro",
  "name_ko": "표본공간
  =집합", "domain": "DA", "rep": "C", "confidence": 0.8 },
  { "id": "EVENT_AS_SUBSET", "type": "micro", "name_ko":
  "사건=부분집
  합", "domain": "DA", "rep": "C", "confidence": 0.8 },
  { "id": "PROB_AS_RATIO", "type": "micro", "name_ko": "확
  률=비율(A/
  S)", "domain": "DA", "rep": "A", "confidence": 0.76 },
  { "id": "CLASSICAL_PROB_EQUIPROBABLE_CHECK", "type":
  "micro",
  "name_ko": "고전확률 등확률 전제 확인", "domain": "DA",
  "rep": "C",
  "confidence": 0.77 },
  { "id": "EQUIPROBABLE_DECISION", "type": "micro",
  "name_ko": "등확률
  여부 게이트(Yes/No 분기)", "domain": "DA", "rep": "C",
  "confidence":
  0.74 },
  { "id": "COUNT_FAVORABLE_TOTAL", "type": "micro",
  "name_ko": "유리/
  전체 경우의 수 분리 카운팅(A/S)", "domain": "DA", "rep":
  "P",
  "confidence": 0.77 },
  { "id": "STEP_PROB_SETUP", "type": "step", "name_ko": "고
  전확률 설정
  단계(전체→사건→전제→A/S)", "domain": "DA", "rep": "C",
  "confidence":
  0.76 },

        { "id": "EVENT_OPERATION_EXPRESSION", "type":
  "micro", "name_ko":

  "사건 연산을 집합식으로 표현(문장→A∪B/A∩B/A^c)",
  "domain": "DA", "rep":
  "P", "confidence": 0.76 },
  { "id": "INTERSECTION_UNION_MEANING", "type": "micro",
  "name_ko":
  "교집합/합집합 의미(∩/∪)", "domain": "DA", "rep": "C",
  "confidence":
  0.76 },
  { "id": "CHECK_DOUBLE_COUNTING", "type": "micro",
  "name_ko": "중복계
  수(겹침) 점검", "domain": "DA", "rep": "C", "confidence":
  0.74 },
  { "id": "DISJOINT_EVENTS", "type": "micro", "name_ko":
  "서로소 사건
  (겹치지 않음) 판별", "domain": "DA", "rep": "C",
  "confidence": 0.74 },
  { "id": "VENN_DIAGRAM_2SET", "type": "micro", "name_ko":
  "벤 다이어
  그램(2집합)으로 사건 연산 시각화", "domain": "DA", "rep":
  "P",
  "confidence": 0.74 },
  { "id": "DISJOINT_OR_OVERLAP_DECISION", "type": "micro",
  "name_ko":
  "서로소/겹침 판정 게이트", "domain": "DA", "rep": "C",
  "confidence":
  0.74 },
  { "id": "STEP_EVENT_OPS_INCL_EXCL", "type": "step",
  "name_ko": "문장
  →집합식→겹침 판정→중복 보정 단계", "domain": "DA", "rep":
  "C",
  "confidence": 0.74 },
  { "id": "INCL_EXCL_2SET_MEANING", "type": "micro",
  "name_ko": "2집합
  포함배제 의미(중복 보정)", "domain": "DA", "rep": "C",
  "confidence":
  0.78 },
  { "id": "APPLY_INCL_EXCL_2SET", "type": "micro",
  "name_ko": "2집합
  포함배제 식 적용 실행(항 매핑→대입→계산)", "domain":
  "DA", "rep": "P",
  "confidence": 0.75 },
  { "id": "STEP_INCL_EXCL_2SET", "type": "step", "name_ko":
  "2집합 포
  함배제 단계", "domain": "DA", "rep": "C", "confidence":
  0.73 },

        { "id": "COMPLEMENT_EVENT", "type": "micro",
  "name_ko": "여사건(보

  완) 개념", "domain": "DA", "rep": "C", "confidence":
  0.74 },
  { "id": "COMPLEMENT_RULE", "type": "micro", "name_ko":
  "여사건 규칙
  (1-p)", "domain": "DA", "rep": "A", "confidence": 0.74 },
  { "id": "TOTAL_MINUS_STRATEGY", "type": "micro",
  "name_ko": "전체-부
  분(보완) 전략(전체에서 빼기)", "domain": "DA", "rep":
  "C", "confidence":
  0.68 }
  ],
  "merge_aliases": [
  { "alias": "COUNT_MUL_RULE", "keep":
  "COUNT_MUL_RULE_MEANING" },
  { "alias": "COUNT_ADD_RULE", "keep":
  "COUNT_ADD_RULE_MEANING" },
  { "alias": "PERM_MEANING_SLOT", "keep":
  "PERM_AS_FILLING_SLOTS" },
  { "alias": "FACTORIAL_CONCEPT", "keep":
  "FACTORIAL_EXPANSION" },
  { "alias": "FACTORIAL_ZERO", "keep":
  "FACTORIAL_ZERO_MEANING" },
  { "alias": "COMB_MEANING_SUBSET", "keep":
  "COMB_AS_SUBSET" },
  { "alias": "COMB_DERIVE_FROM_PERM_DIVIDE", "keep":
  "COMB_FROM_PERM_DIVIDE" },
  { "alias": "SAMPLE_SPACE_DEFINE", "keep":
  "SAMPLE_SPACE_AS_SET" },
  { "alias": "EVENT_DEFINE", "keep": "EVENT_AS_SUBSET" },
  { "alias": "SET_INTERSECTION_UNION", "keep":
  "INTERSECTION_UNION_MEANING" },
  { "alias": "INCLUSION_EXCLUSION_2SET_MEANING", "keep":
  "INCL_EXCL_2SET_MEANING" }
  ],
  "add_edges": [
  { "from": "COUNT_MUL_RULE_MEANING", "to":
  "PERM_AS_FILLING_SLOTS",
  "type": "requires", "confidence": 0.83 },
  { "from": "PERM_AS_FILLING_SLOTS", "to":
  "PERM_PRODUCT_FORM",
  "type": "requires", "confidence": 0.74 },
  { "from": "PERM_PRODUCT_FORM", "to":
  "FACTORIAL_EXPANSION", "type":
  "requires", "confidence": 0.72 },
  { "from": "FACTORIAL_EXPANSION", "to":
  "STEP_PERM_DERIVE", "type":
  "requires", "confidence": 0.74 },
  { "from": "FACTORIAL_ZERO_MEANING", "to":
  "STEP_PERM_DERIVE",
  "type": "requires", "confidence": 0.66 },
  { "from": "STEP_PERM_DERIVE", "to": "PERM_BASIC", "type":
  "requires", "confidence": 0.74 },

        { "from": "ORDER_SENSITIVE_CHECK", "to":
  "STEP_COMB_DERIVE", "type":

  "requires", "confidence": 0.73 },
  { "from": "COMB_AS_SUBSET", "to": "COMB_AS_CHOOSE_R",
  "type":
  "requires", "confidence": 0.75 },
  { "from": "COMB_AS_CHOOSE_R", "to": "STEP_COMB_DERIVE",
  "type":
  "requires", "confidence": 0.74 },
  { "from": "COMB_AS_SUBSET", "to":
  "COMB_ORDER_IGNORED_REASON",
  "type": "requires", "confidence": 0.74 },
  { "from": "COMB_ORDER_IGNORED_REASON", "to":
  "COMB_FROM_PERM_DIVIDE", "type": "requires",
  "confidence": 0.82 },
  { "from": "PERM_PRODUCT_FORM", "to":
  "COMB_FROM_PERM_DIVIDE",
  "type": "requires", "confidence": 0.8 },
  { "from": "FACTORIAL_CANCELLATION", "to":
  "STEP_COMB_DERIVE",
  "type": "requires", "confidence": 0.74 },
  { "from": "COMB_FROM_PERM_DIVIDE", "to":
  "STEP_COMB_DERIVE", "type":
  "requires", "confidence": 0.74 },
  { "from": "STEP_COMB_DERIVE", "to": "COMB_BASIC", "type":
  "requires", "confidence": 0.74 },

        { "from": "SET_NOTATION_BASICS", "to":
  "SAMPLE_SPACE_AS_SET",

  "type": "requires", "confidence": 0.74 },
  { "from": "SET_NOTATION_BASICS", "to": "EVENT_AS_SUBSET",
  "type":
  "requires", "confidence": 0.74 },
  { "from": "SYSTEMATIC_LISTING_BASIC", "to":
  "STEP_SAMPLE_SPACE_BUILD", "type": "requires",
  "confidence": 0.76 },
  { "from": "SAMPLE_SPACE_AS_SET", "to":
  "STEP_SAMPLE_SPACE_BUILD",
  "type": "requires", "confidence": 0.75 },
  { "from": "STEP_SAMPLE_SPACE_BUILD", "to":
  "STEP_PROB_SETUP",
  "type": "requires", "confidence": 0.76 },
  { "from": "EVENT_AS_SUBSET", "to": "STEP_PROB_SETUP",
  "type":
  "requires", "confidence": 0.78 },
  { "from": "PROB_AS_RATIO", "to": "STEP_PROB_SETUP",
  "type":
  "requires", "confidence": 0.76 },
  { "from": "CLASSICAL_PROB_EQUIPROBABLE_CHECK", "to":
  "EQUIPROBABLE_DECISION", "type": "requires",
  "confidence": 0.77 },
  { "from": "EQUIPROBABLE_DECISION", "to":
  "STEP_PROB_SETUP", "type":
  "requires", "confidence": 0.74 },
  { "from": "COUNT_FAVORABLE_TOTAL", "to":
  "STEP_PROB_SETUP", "type":
  "requires", "confidence": 0.77 },
  { "from": "STEP_PROB_SETUP", "to": "PROB_BASIC", "type":
  "requires",
  "confidence": 0.72 },

        { "from": "INTERSECTION_UNION_MEANING", "to":

  "INCL_EXCL_2SET_MEANING", "type": "requires",
  "confidence": 0.76 },
  { "from": "CHECK_DOUBLE_COUNTING", "to":
  "INCL_EXCL_2SET_MEANING",
  "type": "requires", "confidence": 0.75 },
  { "from": "DISJOINT_EVENTS", "to":
  "DISJOINT_OR_OVERLAP_DECISION",
  "type": "requires", "confidence": 0.74 },
  { "from": "DISJOINT_OR_OVERLAP_DECISION", "to":
  "STEP_EVENT_OPS_INCL_EXCL", "type": "requires",
  "confidence": 0.72 },
  { "from": "EVENT_OPERATION_EXPRESSION", "to":
  "STEP_EVENT_OPS_INCL_EXCL", "type": "requires",
  "confidence": 0.7 },
  { "from": "STEP_EVENT_OPS_INCL_EXCL", "to":
  "STEP_INCL_EXCL_2SET",
  "type": "requires", "confidence": 0.73 },
  { "from": "INCL_EXCL_2SET_MEANING", "to":
  "APPLY_INCL_EXCL_2SET",
  "type": "requires", "confidence": 0.78 },
  { "from": "APPLY_INCL_EXCL_2SET", "to":
  "STEP_INCL_EXCL_2SET",
  "type": "requires", "confidence": 0.75 },
  { "from": "STEP_INCL_EXCL_2SET", "to": "PROB_BASIC",
  "type":
  "requires", "confidence": 0.69 },

        { "from": "COMPLEMENT_EVENT", "to":
  "COMPLEMENT_RULE", "type":

  "requires", "confidence": 0.72 },
  { "from": "COMPLEMENT_RULE", "to": "PROB_BASIC", "type":
  "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "R3 전이 산출물에서 참조되는 핵심 ID(예:
  COMB_AS_CHOOSE_R, FACTORIAL_ZERO_MEANING, STEP_* 등)는 본
  파일의
  add_nodes/merge_aliases로 존재/정의가 확인되어야 한다.",
  "reason":
  "dev_handoff 단일 파일만으로도 병합·DAG 검증·충돌 해결을
  진행할 수 있어
  야 한다.", "confidence": 0.74 },
  { "claim": "COMPLEMENT_EVENT(개념)과 COMPLEMENT_RULE(1-p
  규칙)은
  alias 병합 없이 단계적으로 연결하는 편이 안전하다.",
  "reason": "개념과
  계산 규칙은 추상 수준/사용처가 달라 동일시하면 규칙 남용
  이 생길 수 있
  다.", "confidence": 0.78 },
  { "claim": "메타 수준 동형(예: 경계 케이스 패턴, 표현 전
  환 패턴)은
  requires(잠금)로 강제하지 않는 편이 안전하다.", "reason":
  "대체 경로가
  많아 잠금으로 강제하면 과잉 선행/혼동을 만들 수 있다.",
  "confidence":
  0.7 },
  { "claim": "STEP_SAMPLE_SPACE_BUILD→STEP_PROB_SETUP 경로
  를 두면 확률
  의 분모/분자 설정 오류가 감소한다.", "reason": "전체(표본
  공간) 고정→사건
  정의→전제(등확률) 확인→A/S 카운팅 순서가 흔들릴 때 분모가
  바뀌거나 사건
  을 전체로 착각한다.", "confidence": 0.76 },
  { "claim": "EVENT_OPERATION_EXPRESSION과
  DISJOINT_OR_OVERLAP_DECISION을 포함배제 앞에 두면 부호·항
  누락이 줄어든
  다.", "reason": "문장 조건을 집합식으로 고정하고 겹침 여
  부를 먼저 분기하
  면 -교집합이 공식 암기가 아니라 중복 보정으로 연결된다.",
  "confidence":
  0.75 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: COUNT_MUL_RULE_MEANING,
    COUNT_ADD_RULE_MEANING,
    ORDER_SENSITIVE_CHECK, PERM_AS_FILLING_SLOTS,
    PERM_PRODUCT_FORM,
    FACTORIAL_EXPANSION, FACTORIAL_ZERO_MEANING,
    FACTORIAL_CANCELLATION,
    STEP_PERM_DERIVE, COMB_AS_SUBSET, COMB_AS_CHOOSE_R,
    COMB_ORDER_IGNORED_REASON, COMB_FROM_PERM_DIVIDE,
    CHOOSE_THEN_ARRANGE,
    STEP_COMB_DERIVE, SYSTEMATIC_LISTING_BASIC,
    TREE_DIAGRAM_BASIC,
    STEP_SAMPLE_SPACE_BUILD, SET_NOTATION_BASICS,
    SAMPLE_SPACE_AS_SET,
    EVENT_AS_SUBSET, PROB_AS_RATIO,
    CLASSICAL_PROB_EQUIPROBABLE_CHECK,
    EQUIPROBABLE_DECISION, COUNT_FAVORABLE_TOTAL,
    STEP_PROB_SETUP,
    EVENT_OPERATION_EXPRESSION, INTERSECTION_UNION_MEANING,
    CHECK_DOUBLE_COUNTING, DISJOINT_EVENTS,
    VENN_DIAGRAM_2SET,
    DISJOINT_OR_OVERLAP_DECISION, STEP_EVENT_OPS_INCL_EXCL,
    INCL_EXCL_2SET_MEANING, APPLY_INCL_EXCL_2SET,
    STEP_INCL_EXCL_2SET,
    COMPLEMENT_EVENT, COMPLEMENT_RULE, TOTAL_MINUS_STRATEGY
  - 수정된 태그: COUNT_MUL_RULE(→COUNT_MUL_RULE_MEANING),
    COUNT_ADD_RULE(→COUNT_ADD_RULE_MEANING),
    PERM_MEANING_SLOT(→PERM_AS_FILLING_SLOTS),
    FACTORIAL_CONCEPT(→FACTORIAL_EXPANSION),
    FACTORIAL_ZERO(→FACTORIAL_ZERO_MEANING),
    COMB_MEANING_SUBSET(→COMB_AS_SUBSET),
    COMB_DERIVE_FROM_PERM_DIVIDE(→COMB_FROM_PERM_DIVIDE),
    SAMPLE_SPACE_DEFINE(→SAMPLE_SPACE_AS_SET),
    EVENT_DEFINE(→EVENT_AS_SUBSET),
    SET_INTERSECTION_UNION(→INTERSECTION_UNION_MEANING),
    INCLUSION_EXCLUSION_2SET_MEANING(→INCL_EXCL_2SET_MEANIN
    G)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:94c501e5c8###

  ###BEGIN:0d3dcb2169###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 파악 | FE | C | 변경 전 상태/스키마를 기준점
  으로 고정해야 회귀를 줄일 수 있음 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1)의 핵심 변경(개별 제출 흐
  름 제거) |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 유일한 진입점
  UI를 구성 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | “입력됨/미입력” 판정이 grading과 불일치하면 UX가 붕괴
  |
  | 5 | LEARN_DISABLED_EDGECASES_12 | disabled 판정 입력 엣
  지케이스 12종 정의 | QA | C | 빈값/공백/콤마/0 등 예외를
  명시해 disabled/채점 불일치를 방지 |
  | 6 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | 버튼 활성화 조건(모든 문제 입력)을
  안정적으로 계산 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 순
  회 채점으로 전환하는 핵심 동작 |
  | 8 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | “채점 전/후”를 분리하지 않
  으면 점수/결과가 조기 노출됨 |
  | 9 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵 기
  반) | FE | P | 일괄 채점 결과로 상단 점수 요약을 계산/표
  시 |
  | 10 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 UI 혼란(0/N 노
  출 등)을 방지 |
  | 11 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 채점 후 재입력 정책에
  따라 버튼 의미를 일관되게 유지 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 정의 | FE | C | 저장/복원/마이그레이션의 계약
  (Contract)을 먼저 고정 |
  | 13 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(개
  별→일괄) 전환 |
  | 14 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 복원 동작을 충족
  (상태 재구성) |
  | 15 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  부분 제출 데이터 호환/마이그레이션 규칙 | FE | C | 기존
  submissions 일부 저장 데이터가 남아 있을 때 UX 꼬임 방지
  |
  | 16 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장된 결과/
  답안을 제거 |
  | 17 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answerByProblemId/results) | FE | P | 스토리지 삭제만으
  로는 화면이 갱신되지 않으므로 UI 리셋이 필요 |
  | 18 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 결과/점
  수의 일관성 정책을 명시해야 스테일 상태를 막음 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_WORKFLOW | bulk 제출 UI 구성
  (disabled까지) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출 제거 후
  단일 버튼을 추가하고, 정규화 기반 allAnswered로 disabled
  를 안정화 |
  | 2 | STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 일괄 채점→상
  태/표시 업데이트 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SCORE_AND_RESULT_GATING,
  LEARN_GRADE_BUTTON_LABEL_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | gradeAll 결과를 상태로 고
  정하고, hasGraded 기반으로 점수/결과 표시 및 후속 UX(재입
  력/다시채점)를 정합화 |
  | 3 | STEP_PERSIST_RESTORE_WORKFLOW | 저장/복원/호환 처리
  | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 스키마 계약
  을 고정한 뒤 bulk 저장/복원과 legacy partial 대응을 연결
  |
  | 4 | STEP_RESET_WORKFLOW | 다시 풀기(스토리지+UI) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered가 정규화 기반
  이면 먼저 “입력됨” 기준을 normalizeNumericInput으로 고정
  해야 함 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | 점수 X/N은 문제별 채점 결과가
  있어야 계산 가능 | 0.78 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 채점 이후 상태(hasGraded 등)를
  올려야 ‘채점 전/후’가 분리됨 | 0.74 |
  | 4 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 같은
  플래그 없이는 정의/구현이 불가 | 0.76 |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 스키마 계약이 먼저 필요 | 0.80 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 상태를 재구성하므로 선행 필요 | 0.80 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK | “일괄 채점 후 한 번에 저
  장”은 채점 결과 생성이 선행 | 0.80 |
  | 8 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_CLEAR_STORAGE | reset은 삭제 대상 키/데이터를
  알아야 하므로 저장 계약이 선행 | 0.74 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  스토리지 삭제만으로는 화면 상태가 남아 UI 리셋이 필요 |
  0.78 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 결과를 복원했다면 ‘채점됨’ 상태
  를 함께 복원해야 표시가 일관됨 | 0.72 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 최종 disabled 기준을 굳히
  기 전에 엣지케이스 목록이 있으면 불일치 회귀가 줄어듦 |
  0.76 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 설계가 액션 인터페이스를 구체화하는 데 도움 | 0.70 |
  | 3 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 submitProblem 흐름
  을 알면 제거 시 사이드이펙트(저장/상태) 회귀를 줄일 수 있
  음 | 0.65 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | UX 공백을 피하려면 제거/추
  가를 함께 설계하는 것이 안전(필수는 아님) | 0.68 |
  | 5 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial이 있을
  때만 필요하므로 requires로 잠그지 않고 조건부로 권장 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨은 ‘채점 전/후’
  화면 상태와 함께 설계하면 혼란이 줄어듦 | 0.66 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 정책(입력 변경 시 결과 유
  지/초기화)이 게이팅과 함께 맞물리므로 동시 설계를 권장 |
  0.70 |
  | 8 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_RESET_UI_STATE | ‘초기화’와 ‘입력 변경’이 상태를 어
  떻게 되돌리는지 일관되게 정의하는 데 도움 | 0.62 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | 복원 시에도 채점 결과가
  표시되도록 게이팅 조건을 함께 검토하는 것이 권장 | 0.70 |
  | 10 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼을 먼저 만들고 나중에
  disabled를 붙일 수 있으나, 함께 설계하면 UX 디테일이 빨리
  안정화 | 0.65 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 기존 저장 스키마/
  submitProblem 흐름을 모르고 수정해 회귀 발생 | 현재 상태
  흐름(단건 채점→merge 저장)을 1페이지로 먼저 고정 | 0.74 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI 입
  력 판정(원문)과 채점 판정(정규화)이 불일치 |
  normalizeNumericInput 기준으로 “입력됨”을 단일 정의로 통
  일 | 0.82 |
  | 3 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", "."
  같은 케이스에서 disabled/채점이 엇갈림 | 엣지케이스 목록
  을 테스트 벡터로 만들어 allAnswered/normalize에 대입 |
  0.76 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 흔들림 | problems 기준으
  로 계산(useMemo)하고 로딩/빈 배열 처리 규칙을 명시 | 0.72
  |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 상태 업
  데이트/결과 맵 생성에서 누락/순서 오류 | “문제 목록→정규
  화→grade→result map”을 순수 함수로 분리해 생성 | 0.75 |
  | 6 | LEARN_GRADED_STATE_FLAG | 결과가 하나라도 있으면 0/
  N이 노출되는 등 ‘채점 전/후’ 경계가 흐림 | hasGraded 플래
  그를 단일 진실 소스로 두고 표시를 전부 게이팅 | 0.78 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | 점수 계산이 부분 결과/문
  제 수와 어긋나 X/N이 틀림 | 결과 맵 기준으로 correct
  count를 계산하고 분모는 problems.length로 고정 | 0.72 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 복원 시/채점 전 표
  시 조건이 뒤섞여 UI가 어색해짐 | “복원됨=채점됨” 여부를
  명확히 결정(플래그와 함께 저장/복원) | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | 무엇을 저장해야 하
  는지(답만? 결과까지?)가 흔들려 스키마가 빈번히 바뀜 |
  StoredResult 계약을 먼저 문서화(answers + isCorrect +
  updatedAt) | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial이 남아 복원/disabled/표시가 꼬임 |
  “partial 감지→초기화 or 마이그레이션” 정책을 명시하고 구
  현 | 0.74 |
  | 11 | LEARN_RESET_CLEAR_STORAGE | 스토리지만 지우고 UI
  상태가 남아 ‘초기화’가 체감되지 않음 | 키 삭제 + 로컬 상
  태(answer/results/flags) 초기화를 한 액션으로 묶기 | 0.78
  |
  | 12 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과가 스테일(불일치) 상태로 남음 | 입력 변경 시 결과
  초기화(또는 버튼을 다시 채점으로 전환) 정책을 고정 | 0.72
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 즉시 새 진입점(UI)을 제공해 기능 공백을 막는다
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BULK_GRADE_ALL_ACTION | 저장은 ‘채점 결과 생성’이
  있어야 의미가 생긴다 |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 버튼 자체보다 먼저 “활성
  조건” 계산이 브릿지로 필요하다 |
  | 4 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴한다 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 저장/복원은 동일 스키마
  계약이 중간 다리다 |
  | 6 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy는 복원 시점에서
  감지/정책 적용이 자연스럽다 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_GRADE_BUTTON_LABEL_STATE |
  LEARN_SCORE_AND_RESULT_GATING | 표시/게이팅 상태를 고정하
  면 버튼 라벨 정책이 쉬워진다 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_AFTER_GRADE_EDIT_POLICY | LEARN_GRADED_STATE_FLAG |
  ‘채점됨’ 상태가 있어야 입력 변경 정책의 대상 상태가 명확
  해진다 |
  | 9 | LEARN_LOCALSTORAGE_SAVE_BULK → LEARN_RESET_UI_STATE
  | LEARN_RESET_CLEAR_STORAGE | reset은 먼저 저장 키 삭제를
  수행한 뒤 UI 초기화로 이어진다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_STORE_RESULT_SCHEMA_BULK |
  LEARN_LOCALSTORAGE_SAVE_BULK | 기존
  StoredResult(submissions) 기반을 이해해야 bulk 저장 계약
  을 무리 없이 정의한다 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 파
  악", "domain": "FE", "rep": "C", "confidence": 0.72 },
      { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
      { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기) 추
  가", "domain": "FE", "rep": "P", "confidence": 0.85 },
      { "id":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "type":
  "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C", "confidence": 0.82 },
      { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
      { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
      { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
      { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
      { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
      { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
      { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
      { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
      { "id":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "micro", "name_ko": "기존 부분 제출 데이터 호환/마이그레
  이션 규칙", "domain": "FE", "rep": "C", "confidence":
  0.74 },
      { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
      { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
      { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화/다시
  채점)", "domain": "UX", "rep": "C", "confidence": 0.70 },
      { "id": "STEP_BULK_SUBMIT_UI_WORKFLOW", "type":
  "step", "name_ko": "bulk 제출 UI 구성(disabled까지)",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW",
  "type": "step", "name_ko": "일괄 채점→상태/표시 업데이
  트", "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_WORKFLOW", "type":
  "step", "name_ko": "저장/복원/호환 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_WORKFLOW", "type": "step",
  "name_ko": "다시 풀기(스토리지+UI)", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 }
    ],
    "remove_edges": [
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 없이도 가능하며 비활성
  조건은 권장 설계로 두는 편이 안전", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "reset은 저장된 키/데이터를 전제로 하므로 방향
  이 반대이며 requires로도 부적절", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅과 재입력 정책은 상호 영향은 있으나 필수
  선후로 잠글 관계는 아님", "confidence": 0.70 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "엣지케이스 목록은 견고성을 높이는 권장 사항이
  며 기본 allAnswered 구현의 필수 선행은 아님",
  "confidence": 0.76 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가는 순서가 바뀌어도 구현 가능하므로
  requires로 잠그지 않는다", "confidence": 0.72 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "migration은 legacy 데이터가 있을 때만 필요하므
  로 requires가 아니라 조건부 권장", "confidence": 0.74 }
    ],
    "notes": [
      { "claim": "LEARN_ALL_ANSWERED_NORMALIZED는 버튼 존재
  와 무관하게 정의될 수 있으므로 requires로 잠그지 말고 UI
  에서 조건부로 사용한다.", "reason": "버튼을 먼저 렌더링하
  고 disabled만 나중에 붙이는 구현 경로가 자연스럽고 회귀
  위험이 낮다.", "confidence": 0.70 },
      { "claim": "LEARN_DISABLED_EDGECASES_12는 최종
  disabled 품질을 위한 권장 선행이다.", "reason":
  "normalizeNumericInput과의 일관성을 10+ 입력 벡터로 검증
  하면 빈값/0 처리 등에서 UX 불일치가 줄어든다.",
  "confidence": 0.76 },
      { "claim": "LEARN_STORE_RESULT_SCHEMA_BULK를 먼저 고
  정하면 저장/복원/마이그레이션 논의가 단순해진다.",
  "reason": "답안과 결과를 함께 저장한다는 계약이 흔들리면
  상태 플래그/게이팅/점수 계산까지 연쇄로 흔들린다.",
  "confidence": 0.78 },
      { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "일부 노드/사용자는 legacy 데이터가 없을 수 있
  어 requires 잠금은 과잉 선행이 된다.", "confidence":
  0.74 },
      { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 게이팅과
  함께 설계하되 requires로 강제하지 않는다.", "reason": "정
  책은 '입력 변경 시 결과 초기화' 또는 '다시 채점 버튼 제
  공' 등 대체 경로가 존재한다.", "confidence": 0.70 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 단일 버튼 UX(페이지 하단 채점하기/전체 제출) | 현재
  는 문제 카드별 제출만 존재해 “모든 문제 후 일괄 채점” 요
  구
  를 충족하지 못함 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 1)에서 제거가
  핵심인데 현재 UI는 per-problem 제출 흐름에 고정되어 있음
  |
  높음 |
  | 3 | 채점하기 disabled 조건 정의(정규화 일관성) | 버튼
  disabled 기준이 normalizeNumericInput()과 일관되게 정의되
  어야 하나 현재는 해당 UX 자체가 없음 | 높음 |
  | 4 | “모든 문제 미입력” 판정 로직(allAnswered) |
  problems[] 전체를 기준으로 answerByProblemId가 모두 채워
  졌
  는지 판단하는 상태/계산이 필요(문제 수 변화/로딩 타이밍
  포
  함) | 높음 |
  | 5 | 입력 엣지케이스(10개+) 목록/정의 | AC 요구(10개+)가
  문서/설계로 존재해야 하는데 현재 정의가 없음(예: "", "
  ", "\t\n", ",", " , , ", "1,234", " 1 234 ", "0",
  "-0", "+", ".", "Infinity" 등) | 중 |
  | 6 | 일괄 채점 동작(전체 순회→채점→결과 맵 생성) | 현재
  는
  submitProblem(problem)로 단건 채점만 가능하며, 전체 문제
  를
  한 번에 채점해 결과를 고정하는 액션이 없음 | 높음 |
  | 7 | 채점 이후 UI 상태 정의(채점 전/후) | 현재는 결과가
  하나라도 있으면 점수 0/N이 항상 표시될 수 있고, “채점 전/
  후” 상태(예: hasGraded/isSubmitted) 기준이 없음 | 중 |
  | 8 | “채점 후 재입력” UX 정책 | bulk 채점 후 입력을 수정
  할 때 결과/점수의 일관성(자동 결과 초기화 vs “다시 채점”
  버튼) 정책이 필요하나 정의 없음 | 중 |
  | 9 | localStorage 저장 시점 변경(개별→일괄) | 현재는 개
  별
  제출 시 submissions를 merge 저장; 요구는 일괄 채점 후 답
  안
  +결과를 한 번에 저장 | 높음 |
  |10| 저장/복원 스키마 호환/마이그레이션 | 기존 키
  (curriculum-viewer:learn:lastResult:${nodeId})에 부분 제
  출
  데이터가 남아있을 수 있어 bulk 전환 시 호환 규칙이 필요 |
  높음 |
  |11| 초기화/다시 풀기(키 삭제 + 상태 리셋) | 요구사항 4)
  다시 풀기 버튼 및 저장된 결과/답안 삭제가 필요하나 현재
  없
  음 | 높음 |
  |12| Out of Scope 가드레일 명시(무엇을 안 바꿀지) | 구현
  중 문제 타입 확장/서버 연동/커리큘럼 구조 변경으로 범위가
  새는 것을 막는 체크리스트가 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 기반 요구를 흐림 | 금지(요구 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 변경의 핵심
  은 “제출 UX/저장/복원”이며 타입 확장은 범위 밖 | 금지(향
  후
  별도 티켓) |
  | 3 | 문제은행 JSON 스키마 변경 | 현재는 problems_v1.json
  로딩으로 충분하며 스키마 변경은 회귀 위험만 큼 | 기존 스
  키
  마 유지 |
  | 4 | grading 로직 대개편(분수/근삿값/허용오차 등) | 요구
  는 제출 UX이며 채점 확장은 별도 사양 필요 |
  gradeNumericAnswer() 유지, 필요 시 후속 티켓 |
  | 5 | 대형 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 해결 가능, 도입은 과잉 | React state/
  useMemo로 해결 |
  | 6 | “입력 중 실시간 저장(autosave)” | 요구는 “채점 후
  한
  번에 저장”이며 autosave는 UX/스키마를 복잡하게 함 | 이번
  범위에서 제외(필요 시 옵션) |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk UX 미구현 | 제거만 하면 채
  점
  경로가 사라져 기능 공백 발생 | 단일 채점하기 버튼 +
  gradeAll 액션 먼저 추가 후 제거 |
  | 2 | disabled 판정(원문 입력 기준) → 실제 채점(정규화 기
  준) | " , " 같은 입력이 disabled 해제되거나 반대로 0이 미
  입력 처리되는 불일치 위험 | disabled는
  normalizeNumericInput(answer).length>0로 고정 |
  | 3 | 저장 시점 변경(개별→일괄) → 기존 localStorage 데이
  터
  무시 | 기존 submissions가 부분만 존재할 수 있어 복원/버튼
  상태가 꼬일 수 있음 | “legacy partial” 감지(개수/키) 후
  초
  기화 또는 안내/정책 적용 |
  | 4 | 점수 표시(항상 0/N) → 채점 UX | 채점 전부터 점수가
  보이면 사용자가 이미 채점된 것으로 오해 | hasGraded 도입
  후 채점 후에만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 생김 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(다시 풀기) 없음 → 상태 복원 유지 | 사용자가
  저장된 결과를 지울 방법이 없어 UX 막힘 | 다시 풀기(키 삭
  제
  +상태 리셋) 추가 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "모든 문제 미입력 판정(allAnswered,
  정
  규화 기반)", "domain": "FE", "rep": "P", "confidence":
  0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출(submissions
  일
  부) 데이터 호환/마이그레이션 규칙", "domain": "FE",
  "rep":
  "C", "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기(초기화): 저장 키 삭제 + 상태 리셋",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  (빈
  값/공백/콤마/0/부호/소수점 등)", "domain": "QA", "rep":
  "C", "confidence": 0.76 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점/단건 저장을 수행하며,
  StoredResult는 { nodeId, updatedAt, submissions:
  { [problemId]: { submitted, isCorrect } } } 형태이다.",
  "reason": "LearnPage.tsx에서 gradeNumericAnswer 호출 및
  localStorage merge 저장 로직과 StoredResult 타입 정의가
  확
  인된다.", "confidence": 0.86 },
  { "claim": "bulk UX의 disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 모든
  problems가 채워졌는지 검사해야 grading과 일관된다.",
  "reason": "grading.ts의 normalizeNumericInput은 공백/콤마
  제거를 수행하므로, 동일 기준을 쓰지 않으면 '미입력/입력
  됨'
  판단이 채점 결과와 어긋난다.", "confidence": 0.82 },
  { "claim": "점수/정오/정답 표시는 채점 전/후 상태
  (hasGraded 등)로 게이팅하지 않으면 채점 전에도 0/N이 노출
  되는 혼란이 발생할 수 있다.", "reason": "현재 score 계산
  은
  problems.length만으로 0/N을 만들 수 있어 bulk 전환 시 '채
  점 전' 상태를 별도로 분리하는 것이 안전하다.",
  "confidence": 0.74 },
  { "claim": "기존 localStorage에 부분 제출(submissions
  일부) 데이터가 남아 있을 수 있으므로 bulk 전환 시 호환 규
  칙(초기화/마이그레이션/안내)이 필요하다.", "reason": "기
  존
  구현은 문제별 제출 시마다 submissions를 merge 저장하므로,
  저장된 문제 수가 전체 problems 수보다 적은 legacy 데이터
  가
  자연스럽게 생성된다.", "confidence": 0.78 },
  { "claim": "Out of Scope(문제 타입 확장/서버 연동/커리
  큘럼 구조 변경)를 피하고 LearnPage.tsx 중심으로 제출 UX/
  저
  장 시점만 바꾸는 것이 회귀 위험이 낮다.", "reason":
  "task.md가 수정 중심 파일과 비범위를 명시하며, 현재 문제
  로딩/채점 로직은 요구 충족에 충분한 기반을 제공한다.",
  "confidence": 0.76 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그:
    LEARN_SINGLE_SUBMIT_FLOW(→LEARN_BULK_SUBMIT_FLOW),
    LEARN_STORAGE_UPDATE_PER_PROBLEM(→LEARN_STORAGE_SAVE_AF
    T
    ER_BULK_GRADE)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:0d3dcb2169###


› Improve documentation in @filename

  59% context left · ? for shortcuts


============================================================
[2026-01-08 10:33:02] RESEARCH2 (req_id: df518817a7)
============================================================
  0.76 },
  { "id": "PERM_AS_FILLING_SLOTS", "type": "micro",
  "name_ko": "순열
  의미(자리 채우기)", "domain": "DA", "rep": "C",
  "confidence": 0.78 },
  { "id": "PERM_PRODUCT_FORM", "type": "micro", "name_ko":
  "nPr을 감소
  곱(곱 형태)로 표현", "domain": "DA", "rep": "P",
  "confidence": 0.74 },
  { "id": "FACTORIAL_EXPANSION", "type": "micro",
  "name_ko": "팩토리얼
  전개 n!=n*(n-1)*...", "domain": "DA", "rep": "P",
  "confidence": 0.82 },
  { "id": "FACTORIAL_ZERO_MEANING", "type": "micro",
  "name_ko": "0! 의
  미 해석(경계 사례)", "domain": "DA", "rep": "A",
  "confidence": 0.74 },
  { "id": "FACTORIAL_CANCELLATION", "type": "micro",
  "name_ko": "팩토
  리얼 약분", "domain": "DA", "rep": "P", "confidence":
  0.78 },
  { "id": "STEP_PERM_DERIVE", "type": "step", "name_ko":
  "순열 공식 유
  도 단계", "domain": "DA", "rep": "C", "confidence":
  0.74 },

        { "id": "COMB_AS_SUBSET", "type": "micro",
  "name_ko": "조합 의미(부

  분집합 선택)", "domain": "DA", "rep": "C", "confidence":
  0.8 },
  { "id": "COMB_AS_CHOOSE_R", "type": "micro", "name_ko":
  "r개 선택 상
  황 해석", "domain": "DA", "rep": "C", "confidence":
  0.75 },
  { "id": "COMB_ORDER_IGNORED_REASON", "type": "micro",
  "name_ko": "조
  합에서 순서 중복을 r!로 나누는 이유", "domain": "DA",
  "rep": "C",
  "confidence": 0.8 },
  { "id": "COMB_FROM_PERM_DIVIDE", "type": "micro",
  "name_ko": "nPr/r!
  로 nCr을 유도", "domain": "DA", "rep": "P", "confidence":
  0.74 },
  { "id": "CHOOSE_THEN_ARRANGE", "type": "micro",
  "name_ko": "선택 후
  배열( nPr = nCr·r! ) 구조", "domain": "DA", "rep": "C",
  "confidence":
  0.72 },
  { "id": "STEP_COMB_DERIVE", "type": "step", "name_ko":
  "조합 공식 유
  도 단계", "domain": "DA", "rep": "C", "confidence":
  0.74 },

        { "id": "SYSTEMATIC_LISTING_BASIC", "type":
  "micro", "name_ko": "체

  계적 나열 기초", "domain": "DA", "rep": "P",
  "confidence": 0.78 },
  { "id": "TREE_DIAGRAM_BASIC", "type": "micro", "name_ko":
  "트리 다이
  어그램으로 경우를 표현", "domain": "DA", "rep": "P",
  "confidence":
  0.7 },
  { "id": "STEP_SAMPLE_SPACE_BUILD", "type": "step",
  "name_ko": "표본
  공간 구성 단계(빠짐/중복 점검)", "domain": "DA", "rep":
  "C",
  "confidence": 0.75 },

        { "id": "SET_NOTATION_BASICS", "type": "micro",
  "name_ko": "집합 기

  초(원소/부분집합/기호)", "domain": "DA", "rep": "C",
  "confidence":
  0.78 },
  { "id": "SAMPLE_SPACE_AS_SET", "type": "micro",
  "name_ko": "표본공간
  =집합", "domain": "DA", "rep": "C", "confidence": 0.8 },
  { "id": "EVENT_AS_SUBSET", "type": "micro", "name_ko":
  "사건=부분집
  합", "domain": "DA", "rep": "C", "confidence": 0.8 },
  { "id": "PROB_AS_RATIO", "type": "micro", "name_ko": "확
  률=비율(A/
  S)", "domain": "DA", "rep": "A", "confidence": 0.76 },
  { "id": "CLASSICAL_PROB_EQUIPROBABLE_CHECK", "type":
  "micro",
  "name_ko": "고전확률 등확률 전제 확인", "domain": "DA",
  "rep": "C",
  "confidence": 0.77 },
  { "id": "EQUIPROBABLE_DECISION", "type": "micro",
  "name_ko": "등확률
  여부 게이트(Yes/No 분기)", "domain": "DA", "rep": "C",
  "confidence":
  0.74 },
  { "id": "COUNT_FAVORABLE_TOTAL", "type": "micro",
  "name_ko": "유리/
  전체 경우의 수 분리 카운팅(A/S)", "domain": "DA", "rep":
  "P",
  "confidence": 0.77 },
  { "id": "STEP_PROB_SETUP", "type": "step", "name_ko": "고
  전확률 설정
  단계(전체→사건→전제→A/S)", "domain": "DA", "rep": "C",
  "confidence":
  0.76 },

        { "id": "EVENT_OPERATION_EXPRESSION", "type":
  "micro", "name_ko":

  "사건 연산을 집합식으로 표현(문장→A∪B/A∩B/A^c)",
  "domain": "DA", "rep":
  "P", "confidence": 0.76 },
  { "id": "INTERSECTION_UNION_MEANING", "type": "micro",
  "name_ko":
  "교집합/합집합 의미(∩/∪)", "domain": "DA", "rep": "C",
  "confidence":
  0.76 },
  { "id": "CHECK_DOUBLE_COUNTING", "type": "micro",
  "name_ko": "중복계
  수(겹침) 점검", "domain": "DA", "rep": "C", "confidence":
  0.74 },
  { "id": "DISJOINT_EVENTS", "type": "micro", "name_ko":
  "서로소 사건
  (겹치지 않음) 판별", "domain": "DA", "rep": "C",
  "confidence": 0.74 },
  { "id": "VENN_DIAGRAM_2SET", "type": "micro", "name_ko":
  "벤 다이어
  그램(2집합)으로 사건 연산 시각화", "domain": "DA", "rep":
  "P",
  "confidence": 0.74 },
  { "id": "DISJOINT_OR_OVERLAP_DECISION", "type": "micro",
  "name_ko":
  "서로소/겹침 판정 게이트", "domain": "DA", "rep": "C",
  "confidence":
  0.74 },
  { "id": "STEP_EVENT_OPS_INCL_EXCL", "type": "step",
  "name_ko": "문장
  →집합식→겹침 판정→중복 보정 단계", "domain": "DA", "rep":
  "C",
  "confidence": 0.74 },
  { "id": "INCL_EXCL_2SET_MEANING", "type": "micro",
  "name_ko": "2집합
  포함배제 의미(중복 보정)", "domain": "DA", "rep": "C",
  "confidence":
  0.78 },
  { "id": "APPLY_INCL_EXCL_2SET", "type": "micro",
  "name_ko": "2집합
  포함배제 식 적용 실행(항 매핑→대입→계산)", "domain":
  "DA", "rep": "P",
  "confidence": 0.75 },
  { "id": "STEP_INCL_EXCL_2SET", "type": "step", "name_ko":
  "2집합 포
  함배제 단계", "domain": "DA", "rep": "C", "confidence":
  0.73 },

        { "id": "COMPLEMENT_EVENT", "type": "micro",
  "name_ko": "여사건(보

  완) 개념", "domain": "DA", "rep": "C", "confidence":
  0.74 },
  { "id": "COMPLEMENT_RULE", "type": "micro", "name_ko":
  "여사건 규칙
  (1-p)", "domain": "DA", "rep": "A", "confidence": 0.74 },
  { "id": "TOTAL_MINUS_STRATEGY", "type": "micro",
  "name_ko": "전체-부
  분(보완) 전략(전체에서 빼기)", "domain": "DA", "rep":
  "C", "confidence":
  0.68 }
  ],
  "merge_aliases": [
  { "alias": "COUNT_MUL_RULE", "keep":
  "COUNT_MUL_RULE_MEANING" },
  { "alias": "COUNT_ADD_RULE", "keep":
  "COUNT_ADD_RULE_MEANING" },
  { "alias": "PERM_MEANING_SLOT", "keep":
  "PERM_AS_FILLING_SLOTS" },
  { "alias": "FACTORIAL_CONCEPT", "keep":
  "FACTORIAL_EXPANSION" },
  { "alias": "FACTORIAL_ZERO", "keep":
  "FACTORIAL_ZERO_MEANING" },
  { "alias": "COMB_MEANING_SUBSET", "keep":
  "COMB_AS_SUBSET" },
  { "alias": "COMB_DERIVE_FROM_PERM_DIVIDE", "keep":
  "COMB_FROM_PERM_DIVIDE" },
  { "alias": "SAMPLE_SPACE_DEFINE", "keep":
  "SAMPLE_SPACE_AS_SET" },
  { "alias": "EVENT_DEFINE", "keep": "EVENT_AS_SUBSET" },
  { "alias": "SET_INTERSECTION_UNION", "keep":
  "INTERSECTION_UNION_MEANING" },
  { "alias": "INCLUSION_EXCLUSION_2SET_MEANING", "keep":
  "INCL_EXCL_2SET_MEANING" }
  ],
  "add_edges": [
  { "from": "COUNT_MUL_RULE_MEANING", "to":
  "PERM_AS_FILLING_SLOTS",
  "type": "requires", "confidence": 0.83 },
  { "from": "PERM_AS_FILLING_SLOTS", "to":
  "PERM_PRODUCT_FORM",
  "type": "requires", "confidence": 0.74 },
  { "from": "PERM_PRODUCT_FORM", "to":
  "FACTORIAL_EXPANSION", "type":
  "requires", "confidence": 0.72 },
  { "from": "FACTORIAL_EXPANSION", "to":
  "STEP_PERM_DERIVE", "type":
  "requires", "confidence": 0.74 },
  { "from": "FACTORIAL_ZERO_MEANING", "to":
  "STEP_PERM_DERIVE",
  "type": "requires", "confidence": 0.66 },
  { "from": "STEP_PERM_DERIVE", "to": "PERM_BASIC", "type":
  "requires", "confidence": 0.74 },

        { "from": "ORDER_SENSITIVE_CHECK", "to":
  "STEP_COMB_DERIVE", "type":

  "requires", "confidence": 0.73 },
  { "from": "COMB_AS_SUBSET", "to": "COMB_AS_CHOOSE_R",
  "type":
  "requires", "confidence": 0.75 },
  { "from": "COMB_AS_CHOOSE_R", "to": "STEP_COMB_DERIVE",
  "type":
  "requires", "confidence": 0.74 },
  { "from": "COMB_AS_SUBSET", "to":
  "COMB_ORDER_IGNORED_REASON",
  "type": "requires", "confidence": 0.74 },
  { "from": "COMB_ORDER_IGNORED_REASON", "to":
  "COMB_FROM_PERM_DIVIDE", "type": "requires",
  "confidence": 0.82 },
  { "from": "PERM_PRODUCT_FORM", "to":
  "COMB_FROM_PERM_DIVIDE",
  "type": "requires", "confidence": 0.8 },
  { "from": "FACTORIAL_CANCELLATION", "to":
  "STEP_COMB_DERIVE",
  "type": "requires", "confidence": 0.74 },
  { "from": "COMB_FROM_PERM_DIVIDE", "to":
  "STEP_COMB_DERIVE", "type":
  "requires", "confidence": 0.74 },
  { "from": "STEP_COMB_DERIVE", "to": "COMB_BASIC", "type":
  "requires", "confidence": 0.74 },

        { "from": "SET_NOTATION_BASICS", "to":
  "SAMPLE_SPACE_AS_SET",

  "type": "requires", "confidence": 0.74 },
  { "from": "SET_NOTATION_BASICS", "to": "EVENT_AS_SUBSET",
  "type":
  "requires", "confidence": 0.74 },
  { "from": "SYSTEMATIC_LISTING_BASIC", "to":
  "STEP_SAMPLE_SPACE_BUILD", "type": "requires",
  "confidence": 0.76 },
  { "from": "SAMPLE_SPACE_AS_SET", "to":
  "STEP_SAMPLE_SPACE_BUILD",
  "type": "requires", "confidence": 0.75 },
  { "from": "STEP_SAMPLE_SPACE_BUILD", "to":
  "STEP_PROB_SETUP",
  "type": "requires", "confidence": 0.76 },
  { "from": "EVENT_AS_SUBSET", "to": "STEP_PROB_SETUP",
  "type":
  "requires", "confidence": 0.78 },
  { "from": "PROB_AS_RATIO", "to": "STEP_PROB_SETUP",
  "type":
  "requires", "confidence": 0.76 },
  { "from": "CLASSICAL_PROB_EQUIPROBABLE_CHECK", "to":
  "EQUIPROBABLE_DECISION", "type": "requires",
  "confidence": 0.77 },
  { "from": "EQUIPROBABLE_DECISION", "to":
  "STEP_PROB_SETUP", "type":
  "requires", "confidence": 0.74 },
  { "from": "COUNT_FAVORABLE_TOTAL", "to":
  "STEP_PROB_SETUP", "type":
  "requires", "confidence": 0.77 },
  { "from": "STEP_PROB_SETUP", "to": "PROB_BASIC", "type":
  "requires",
  "confidence": 0.72 },

        { "from": "INTERSECTION_UNION_MEANING", "to":

  "INCL_EXCL_2SET_MEANING", "type": "requires",
  "confidence": 0.76 },
  { "from": "CHECK_DOUBLE_COUNTING", "to":
  "INCL_EXCL_2SET_MEANING",
  "type": "requires", "confidence": 0.75 },
  { "from": "DISJOINT_EVENTS", "to":
  "DISJOINT_OR_OVERLAP_DECISION",
  "type": "requires", "confidence": 0.74 },
  { "from": "DISJOINT_OR_OVERLAP_DECISION", "to":
  "STEP_EVENT_OPS_INCL_EXCL", "type": "requires",
  "confidence": 0.72 },
  { "from": "EVENT_OPERATION_EXPRESSION", "to":
  "STEP_EVENT_OPS_INCL_EXCL", "type": "requires",
  "confidence": 0.7 },
  { "from": "STEP_EVENT_OPS_INCL_EXCL", "to":
  "STEP_INCL_EXCL_2SET",
  "type": "requires", "confidence": 0.73 },
  { "from": "INCL_EXCL_2SET_MEANING", "to":
  "APPLY_INCL_EXCL_2SET",
  "type": "requires", "confidence": 0.78 },
  { "from": "APPLY_INCL_EXCL_2SET", "to":
  "STEP_INCL_EXCL_2SET",
  "type": "requires", "confidence": 0.75 },
  { "from": "STEP_INCL_EXCL_2SET", "to": "PROB_BASIC",
  "type":
  "requires", "confidence": 0.69 },

        { "from": "COMPLEMENT_EVENT", "to":
  "COMPLEMENT_RULE", "type":

  "requires", "confidence": 0.72 },
  { "from": "COMPLEMENT_RULE", "to": "PROB_BASIC", "type":
  "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "R3 전이 산출물에서 참조되는 핵심 ID(예:
  COMB_AS_CHOOSE_R, FACTORIAL_ZERO_MEANING, STEP_* 등)는 본
  파일의
  add_nodes/merge_aliases로 존재/정의가 확인되어야 한다.",
  "reason":
  "dev_handoff 단일 파일만으로도 병합·DAG 검증·충돌 해결을
  진행할 수 있어
  야 한다.", "confidence": 0.74 },
  { "claim": "COMPLEMENT_EVENT(개념)과 COMPLEMENT_RULE(1-p
  규칙)은
  alias 병합 없이 단계적으로 연결하는 편이 안전하다.",
  "reason": "개념과
  계산 규칙은 추상 수준/사용처가 달라 동일시하면 규칙 남용
  이 생길 수 있
  다.", "confidence": 0.78 },
  { "claim": "메타 수준 동형(예: 경계 케이스 패턴, 표현 전
  환 패턴)은
  requires(잠금)로 강제하지 않는 편이 안전하다.", "reason":
  "대체 경로가
  많아 잠금으로 강제하면 과잉 선행/혼동을 만들 수 있다.",
  "confidence":
  0.7 },
  { "claim": "STEP_SAMPLE_SPACE_BUILD→STEP_PROB_SETUP 경로
  를 두면 확률
  의 분모/분자 설정 오류가 감소한다.", "reason": "전체(표본
  공간) 고정→사건
  정의→전제(등확률) 확인→A/S 카운팅 순서가 흔들릴 때 분모가
  바뀌거나 사건
  을 전체로 착각한다.", "confidence": 0.76 },
  { "claim": "EVENT_OPERATION_EXPRESSION과
  DISJOINT_OR_OVERLAP_DECISION을 포함배제 앞에 두면 부호·항
  누락이 줄어든
  다.", "reason": "문장 조건을 집합식으로 고정하고 겹침 여
  부를 먼저 분기하
  면 -교집합이 공식 암기가 아니라 중복 보정으로 연결된다.",
  "confidence":
  0.75 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: COUNT_MUL_RULE_MEANING,
    COUNT_ADD_RULE_MEANING,
    ORDER_SENSITIVE_CHECK, PERM_AS_FILLING_SLOTS,
    PERM_PRODUCT_FORM,
    FACTORIAL_EXPANSION, FACTORIAL_ZERO_MEANING,
    FACTORIAL_CANCELLATION,
    STEP_PERM_DERIVE, COMB_AS_SUBSET, COMB_AS_CHOOSE_R,
    COMB_ORDER_IGNORED_REASON, COMB_FROM_PERM_DIVIDE,
    CHOOSE_THEN_ARRANGE,
    STEP_COMB_DERIVE, SYSTEMATIC_LISTING_BASIC,
    TREE_DIAGRAM_BASIC,
    STEP_SAMPLE_SPACE_BUILD, SET_NOTATION_BASICS,
    SAMPLE_SPACE_AS_SET,
    EVENT_AS_SUBSET, PROB_AS_RATIO,
    CLASSICAL_PROB_EQUIPROBABLE_CHECK,
    EQUIPROBABLE_DECISION, COUNT_FAVORABLE_TOTAL,
    STEP_PROB_SETUP,
    EVENT_OPERATION_EXPRESSION, INTERSECTION_UNION_MEANING,
    CHECK_DOUBLE_COUNTING, DISJOINT_EVENTS,
    VENN_DIAGRAM_2SET,
    DISJOINT_OR_OVERLAP_DECISION, STEP_EVENT_OPS_INCL_EXCL,
    INCL_EXCL_2SET_MEANING, APPLY_INCL_EXCL_2SET,
    STEP_INCL_EXCL_2SET,
    COMPLEMENT_EVENT, COMPLEMENT_RULE, TOTAL_MINUS_STRATEGY
  - 수정된 태그: COUNT_MUL_RULE(→COUNT_MUL_RULE_MEANING),
    COUNT_ADD_RULE(→COUNT_ADD_RULE_MEANING),
    PERM_MEANING_SLOT(→PERM_AS_FILLING_SLOTS),
    FACTORIAL_CONCEPT(→FACTORIAL_EXPANSION),
    FACTORIAL_ZERO(→FACTORIAL_ZERO_MEANING),
    COMB_MEANING_SUBSET(→COMB_AS_SUBSET),
    COMB_DERIVE_FROM_PERM_DIVIDE(→COMB_FROM_PERM_DIVIDE),
    SAMPLE_SPACE_DEFINE(→SAMPLE_SPACE_AS_SET),
    EVENT_DEFINE(→EVENT_AS_SUBSET),
    SET_INTERSECTION_UNION(→INTERSECTION_UNION_MEANING),
    INCLUSION_EXCLUSION_2SET_MEANING(→INCL_EXCL_2SET_MEANIN
    G)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:94c501e5c8###

  ###BEGIN:0d3dcb2169###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 파악 | FE | C | 변경 전 상태/스키마를 기준점
  으로 고정해야 회귀를 줄일 수 있음 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1)의 핵심 변경(개별 제출 흐
  름 제거) |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 유일한 진입점
  UI를 구성 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | “입력됨/미입력” 판정이 grading과 불일치하면 UX가 붕괴
  |
  | 5 | LEARN_DISABLED_EDGECASES_12 | disabled 판정 입력 엣
  지케이스 12종 정의 | QA | C | 빈값/공백/콤마/0 등 예외를
  명시해 disabled/채점 불일치를 방지 |
  | 6 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | 버튼 활성화 조건(모든 문제 입력)을
  안정적으로 계산 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 순
  회 채점으로 전환하는 핵심 동작 |
  | 8 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | “채점 전/후”를 분리하지 않
  으면 점수/결과가 조기 노출됨 |
  | 9 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵 기
  반) | FE | P | 일괄 채점 결과로 상단 점수 요약을 계산/표
  시 |
  | 10 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 UI 혼란(0/N 노
  출 등)을 방지 |
  | 11 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 채점 후 재입력 정책에
  따라 버튼 의미를 일관되게 유지 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 정의 | FE | C | 저장/복원/마이그레이션의 계약
  (Contract)을 먼저 고정 |
  | 13 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(개
  별→일괄) 전환 |
  | 14 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 복원 동작을 충족
  (상태 재구성) |
  | 15 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  부분 제출 데이터 호환/마이그레이션 규칙 | FE | C | 기존
  submissions 일부 저장 데이터가 남아 있을 때 UX 꼬임 방지
  |
  | 16 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장된 결과/
  답안을 제거 |
  | 17 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answerByProblemId/results) | FE | P | 스토리지 삭제만으
  로는 화면이 갱신되지 않으므로 UI 리셋이 필요 |
  | 18 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 결과/점
  수의 일관성 정책을 명시해야 스테일 상태를 막음 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_WORKFLOW | bulk 제출 UI 구성
  (disabled까지) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출 제거 후
  단일 버튼을 추가하고, 정규화 기반 allAnswered로 disabled
  를 안정화 |
  | 2 | STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW | 일괄 채점→상
  태/표시 업데이트 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SCORE_AND_RESULT_GATING,
  LEARN_GRADE_BUTTON_LABEL_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | gradeAll 결과를 상태로 고
  정하고, hasGraded 기반으로 점수/결과 표시 및 후속 UX(재입
  력/다시채점)를 정합화 |
  | 3 | STEP_PERSIST_RESTORE_WORKFLOW | 저장/복원/호환 처리
  | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 스키마 계약
  을 고정한 뒤 bulk 저장/복원과 legacy partial 대응을 연결
  |
  | 4 | STEP_RESET_WORKFLOW | 다시 풀기(스토리지+UI) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered가 정규화 기반
  이면 먼저 “입력됨” 기준을 normalizeNumericInput으로 고정
  해야 함 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | 점수 X/N은 문제별 채점 결과가
  있어야 계산 가능 | 0.78 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 채점 이후 상태(hasGraded 등)를
  올려야 ‘채점 전/후’가 분리됨 | 0.74 |
  | 4 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 같은
  플래그 없이는 정의/구현이 불가 | 0.76 |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 스키마 계약이 먼저 필요 | 0.80 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 상태를 재구성하므로 선행 필요 | 0.80 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK | “일괄 채점 후 한 번에 저
  장”은 채점 결과 생성이 선행 | 0.80 |
  | 8 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_CLEAR_STORAGE | reset은 삭제 대상 키/데이터를
  알아야 하므로 저장 계약이 선행 | 0.74 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  스토리지 삭제만으로는 화면 상태가 남아 UI 리셋이 필요 |
  0.78 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 결과를 복원했다면 ‘채점됨’ 상태
  를 함께 복원해야 표시가 일관됨 | 0.72 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 최종 disabled 기준을 굳히
  기 전에 엣지케이스 목록이 있으면 불일치 회귀가 줄어듦 |
  0.76 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 설계가 액션 인터페이스를 구체화하는 데 도움 | 0.70 |
  | 3 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 submitProblem 흐름
  을 알면 제거 시 사이드이펙트(저장/상태) 회귀를 줄일 수 있
  음 | 0.65 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | UX 공백을 피하려면 제거/추
  가를 함께 설계하는 것이 안전(필수는 아님) | 0.68 |
  | 5 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial이 있을
  때만 필요하므로 requires로 잠그지 않고 조건부로 권장 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨은 ‘채점 전/후’
  화면 상태와 함께 설계하면 혼란이 줄어듦 | 0.66 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 정책(입력 변경 시 결과 유
  지/초기화)이 게이팅과 함께 맞물리므로 동시 설계를 권장 |
  0.70 |
  | 8 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_RESET_UI_STATE | ‘초기화’와 ‘입력 변경’이 상태를 어
  떻게 되돌리는지 일관되게 정의하는 데 도움 | 0.62 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | 복원 시에도 채점 결과가
  표시되도록 게이팅 조건을 함께 검토하는 것이 권장 | 0.70 |
  | 10 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼을 먼저 만들고 나중에
  disabled를 붙일 수 있으나, 함께 설계하면 UX 디테일이 빨리
  안정화 | 0.65 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 기존 저장 스키마/
  submitProblem 흐름을 모르고 수정해 회귀 발생 | 현재 상태
  흐름(단건 채점→merge 저장)을 1페이지로 먼저 고정 | 0.74 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI 입
  력 판정(원문)과 채점 판정(정규화)이 불일치 |
  normalizeNumericInput 기준으로 “입력됨”을 단일 정의로 통
  일 | 0.82 |
  | 3 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", "."
  같은 케이스에서 disabled/채점이 엇갈림 | 엣지케이스 목록
  을 테스트 벡터로 만들어 allAnswered/normalize에 대입 |
  0.76 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 흔들림 | problems 기준으
  로 계산(useMemo)하고 로딩/빈 배열 처리 규칙을 명시 | 0.72
  |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 상태 업
  데이트/결과 맵 생성에서 누락/순서 오류 | “문제 목록→정규
  화→grade→result map”을 순수 함수로 분리해 생성 | 0.75 |
  | 6 | LEARN_GRADED_STATE_FLAG | 결과가 하나라도 있으면 0/
  N이 노출되는 등 ‘채점 전/후’ 경계가 흐림 | hasGraded 플래
  그를 단일 진실 소스로 두고 표시를 전부 게이팅 | 0.78 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | 점수 계산이 부분 결과/문
  제 수와 어긋나 X/N이 틀림 | 결과 맵 기준으로 correct
  count를 계산하고 분모는 problems.length로 고정 | 0.72 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 복원 시/채점 전 표
  시 조건이 뒤섞여 UI가 어색해짐 | “복원됨=채점됨” 여부를
  명확히 결정(플래그와 함께 저장/복원) | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | 무엇을 저장해야 하
  는지(답만? 결과까지?)가 흔들려 스키마가 빈번히 바뀜 |
  StoredResult 계약을 먼저 문서화(answers + isCorrect +
  updatedAt) | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial이 남아 복원/disabled/표시가 꼬임 |
  “partial 감지→초기화 or 마이그레이션” 정책을 명시하고 구
  현 | 0.74 |
  | 11 | LEARN_RESET_CLEAR_STORAGE | 스토리지만 지우고 UI
  상태가 남아 ‘초기화’가 체감되지 않음 | 키 삭제 + 로컬 상
  태(answer/results/flags) 초기화를 한 액션으로 묶기 | 0.78
  |
  | 12 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과가 스테일(불일치) 상태로 남음 | 입력 변경 시 결과
  초기화(또는 버튼을 다시 채점으로 전환) 정책을 고정 | 0.72
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 즉시 새 진입점(UI)을 제공해 기능 공백을 막는다
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BULK_GRADE_ALL_ACTION | 저장은 ‘채점 결과 생성’이
  있어야 의미가 생긴다 |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 버튼 자체보다 먼저 “활성
  조건” 계산이 브릿지로 필요하다 |
  | 4 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴한다 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 저장/복원은 동일 스키마
  계약이 중간 다리다 |
  | 6 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy는 복원 시점에서
  감지/정책 적용이 자연스럽다 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_GRADE_BUTTON_LABEL_STATE |
  LEARN_SCORE_AND_RESULT_GATING | 표시/게이팅 상태를 고정하
  면 버튼 라벨 정책이 쉬워진다 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_AFTER_GRADE_EDIT_POLICY | LEARN_GRADED_STATE_FLAG |
  ‘채점됨’ 상태가 있어야 입력 변경 정책의 대상 상태가 명확
  해진다 |
  | 9 | LEARN_LOCALSTORAGE_SAVE_BULK → LEARN_RESET_UI_STATE
  | LEARN_RESET_CLEAR_STORAGE | reset은 먼저 저장 키 삭제를
  수행한 뒤 UI 초기화로 이어진다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_STORE_RESULT_SCHEMA_BULK |
  LEARN_LOCALSTORAGE_SAVE_BULK | 기존
  StoredResult(submissions) 기반을 이해해야 bulk 저장 계약
  을 무리 없이 정의한다 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 파
  악", "domain": "FE", "rep": "C", "confidence": 0.72 },
      { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
      { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기) 추
  가", "domain": "FE", "rep": "P", "confidence": 0.85 },
      { "id":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "type":
  "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C", "confidence": 0.82 },
      { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
      { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
      { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
      { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
      { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
      { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
      { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
      { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
      { "id":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "micro", "name_ko": "기존 부분 제출 데이터 호환/마이그레
  이션 규칙", "domain": "FE", "rep": "C", "confidence":
  0.74 },
      { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
      { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
      { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화/다시
  채점)", "domain": "UX", "rep": "C", "confidence": 0.70 },
      { "id": "STEP_BULK_SUBMIT_UI_WORKFLOW", "type":
  "step", "name_ko": "bulk 제출 UI 구성(disabled까지)",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_AND_DISPLAY_WORKFLOW",
  "type": "step", "name_ko": "일괄 채점→상태/표시 업데이
  트", "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_WORKFLOW", "type":
  "step", "name_ko": "저장/복원/호환 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_WORKFLOW", "type": "step",
  "name_ko": "다시 풀기(스토리지+UI)", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 }
    ],
    "remove_edges": [
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 없이도 가능하며 비활성
  조건은 권장 설계로 두는 편이 안전", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "reset은 저장된 키/데이터를 전제로 하므로 방향
  이 반대이며 requires로도 부적절", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅과 재입력 정책은 상호 영향은 있으나 필수
  선후로 잠글 관계는 아님", "confidence": 0.70 },
      { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "엣지케이스 목록은 견고성을 높이는 권장 사항이
  며 기본 allAnswered 구현의 필수 선행은 아님",
  "confidence": 0.76 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가는 순서가 바뀌어도 구현 가능하므로
  requires로 잠그지 않는다", "confidence": 0.72 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "migration은 legacy 데이터가 있을 때만 필요하므
  로 requires가 아니라 조건부 권장", "confidence": 0.74 }
    ],
    "notes": [
      { "claim": "LEARN_ALL_ANSWERED_NORMALIZED는 버튼 존재
  와 무관하게 정의될 수 있으므로 requires로 잠그지 말고 UI
  에서 조건부로 사용한다.", "reason": "버튼을 먼저 렌더링하
  고 disabled만 나중에 붙이는 구현 경로가 자연스럽고 회귀
  위험이 낮다.", "confidence": 0.70 },
      { "claim": "LEARN_DISABLED_EDGECASES_12는 최종
  disabled 품질을 위한 권장 선행이다.", "reason":
  "normalizeNumericInput과의 일관성을 10+ 입력 벡터로 검증
  하면 빈값/0 처리 등에서 UX 불일치가 줄어든다.",
  "confidence": 0.76 },
      { "claim": "LEARN_STORE_RESULT_SCHEMA_BULK를 먼저 고
  정하면 저장/복원/마이그레이션 논의가 단순해진다.",
  "reason": "답안과 결과를 함께 저장한다는 계약이 흔들리면
  상태 플래그/게이팅/점수 계산까지 연쇄로 흔들린다.",
  "confidence": 0.78 },
      { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "일부 노드/사용자는 legacy 데이터가 없을 수 있
  어 requires 잠금은 과잉 선행이 된다.", "confidence":
  0.74 },
      { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 게이팅과
  함께 설계하되 requires로 강제하지 않는다.", "reason": "정
  책은 '입력 변경 시 결과 초기화' 또는 '다시 채점 버튼 제
  공' 등 대체 경로가 존재한다.", "confidence": 0.70 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 단일 버튼 UX(페이지 하단 채점하기/전체 제출) | 현재
  는 문제 카드별 제출만 존재해 “모든 문제 후 일괄 채점” 요
  구
  를 충족하지 못함 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 1)에서 제거가
  핵심인데 현재 UI는 per-problem 제출 흐름에 고정되어 있음
  |
  높음 |
  | 3 | 채점하기 disabled 조건 정의(정규화 일관성) | 버튼
  disabled 기준이 normalizeNumericInput()과 일관되게 정의되
  어야 하나 현재는 해당 UX 자체가 없음 | 높음 |
  | 4 | “모든 문제 미입력” 판정 로직(allAnswered) |
  problems[] 전체를 기준으로 answerByProblemId가 모두 채워
  졌
  는지 판단하는 상태/계산이 필요(문제 수 변화/로딩 타이밍
  포
  함) | 높음 |
  | 5 | 입력 엣지케이스(10개+) 목록/정의 | AC 요구(10개+)가
  문서/설계로 존재해야 하는데 현재 정의가 없음(예: "", "
  ", "\t\n", ",", " , , ", "1,234", " 1 234 ", "0",
  "-0", "+", ".", "Infinity" 등) | 중 |
  | 6 | 일괄 채점 동작(전체 순회→채점→결과 맵 생성) | 현재
  는
  submitProblem(problem)로 단건 채점만 가능하며, 전체 문제
  를
  한 번에 채점해 결과를 고정하는 액션이 없음 | 높음 |
  | 7 | 채점 이후 UI 상태 정의(채점 전/후) | 현재는 결과가
  하나라도 있으면 점수 0/N이 항상 표시될 수 있고, “채점 전/
  후” 상태(예: hasGraded/isSubmitted) 기준이 없음 | 중 |
  | 8 | “채점 후 재입력” UX 정책 | bulk 채점 후 입력을 수정
  할 때 결과/점수의 일관성(자동 결과 초기화 vs “다시 채점”
  버튼) 정책이 필요하나 정의 없음 | 중 |
  | 9 | localStorage 저장 시점 변경(개별→일괄) | 현재는 개
  별
  제출 시 submissions를 merge 저장; 요구는 일괄 채점 후 답
  안
  +결과를 한 번에 저장 | 높음 |
  |10| 저장/복원 스키마 호환/마이그레이션 | 기존 키
  (curriculum-viewer:learn:lastResult:${nodeId})에 부분 제
  출
  데이터가 남아있을 수 있어 bulk 전환 시 호환 규칙이 필요 |
  높음 |
  |11| 초기화/다시 풀기(키 삭제 + 상태 리셋) | 요구사항 4)
  다시 풀기 버튼 및 저장된 결과/답안 삭제가 필요하나 현재
  없
  음 | 높음 |
  |12| Out of Scope 가드레일 명시(무엇을 안 바꿀지) | 구현
  중 문제 타입 확장/서버 연동/커리큘럼 구조 변경으로 범위가
  새는 것을 막는 체크리스트가 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 기반 요구를 흐림 | 금지(요구 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 변경의 핵심
  은 “제출 UX/저장/복원”이며 타입 확장은 범위 밖 | 금지(향
  후
  별도 티켓) |
  | 3 | 문제은행 JSON 스키마 변경 | 현재는 problems_v1.json
  로딩으로 충분하며 스키마 변경은 회귀 위험만 큼 | 기존 스
  키
  마 유지 |
  | 4 | grading 로직 대개편(분수/근삿값/허용오차 등) | 요구
  는 제출 UX이며 채점 확장은 별도 사양 필요 |
  gradeNumericAnswer() 유지, 필요 시 후속 티켓 |
  | 5 | 대형 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 해결 가능, 도입은 과잉 | React state/
  useMemo로 해결 |
  | 6 | “입력 중 실시간 저장(autosave)” | 요구는 “채점 후
  한
  번에 저장”이며 autosave는 UX/스키마를 복잡하게 함 | 이번
  범위에서 제외(필요 시 옵션) |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk UX 미구현 | 제거만 하면 채
  점
  경로가 사라져 기능 공백 발생 | 단일 채점하기 버튼 +
  gradeAll 액션 먼저 추가 후 제거 |
  | 2 | disabled 판정(원문 입력 기준) → 실제 채점(정규화 기
  준) | " , " 같은 입력이 disabled 해제되거나 반대로 0이 미
  입력 처리되는 불일치 위험 | disabled는
  normalizeNumericInput(answer).length>0로 고정 |
  | 3 | 저장 시점 변경(개별→일괄) → 기존 localStorage 데이
  터
  무시 | 기존 submissions가 부분만 존재할 수 있어 복원/버튼
  상태가 꼬일 수 있음 | “legacy partial” 감지(개수/키) 후
  초
  기화 또는 안내/정책 적용 |
  | 4 | 점수 표시(항상 0/N) → 채점 UX | 채점 전부터 점수가
  보이면 사용자가 이미 채점된 것으로 오해 | hasGraded 도입
  후 채점 후에만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 생김 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(다시 풀기) 없음 → 상태 복원 유지 | 사용자가
  저장된 결과를 지울 방법이 없어 UX 막힘 | 다시 풀기(키 삭
  제
  +상태 리셋) 추가 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "모든 문제 미입력 판정(allAnswered,
  정
  규화 기반)", "domain": "FE", "rep": "P", "confidence":
  0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출(submissions
  일
  부) 데이터 호환/마이그레이션 규칙", "domain": "FE",
  "rep":
  "C", "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기(초기화): 저장 키 삭제 + 상태 리셋",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  (빈
  값/공백/콤마/0/부호/소수점 등)", "domain": "QA", "rep":
  "C", "confidence": 0.76 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점/단건 저장을 수행하며,
  StoredResult는 { nodeId, updatedAt, submissions:
  { [problemId]: { submitted, isCorrect } } } 형태이다.",
  "reason": "LearnPage.tsx에서 gradeNumericAnswer 호출 및
  localStorage merge 저장 로직과 StoredResult 타입 정의가
  확
  인된다.", "confidence": 0.86 },
  { "claim": "bulk UX의 disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 모든
  problems가 채워졌는지 검사해야 grading과 일관된다.",
  "reason": "grading.ts의 normalizeNumericInput은 공백/콤마
  제거를 수행하므로, 동일 기준을 쓰지 않으면 '미입력/입력
  됨'
  판단이 채점 결과와 어긋난다.", "confidence": 0.82 },
  { "claim": "점수/정오/정답 표시는 채점 전/후 상태
  (hasGraded 등)로 게이팅하지 않으면 채점 전에도 0/N이 노출
  되는 혼란이 발생할 수 있다.", "reason": "현재 score 계산
  은
  problems.length만으로 0/N을 만들 수 있어 bulk 전환 시 '채
  점 전' 상태를 별도로 분리하는 것이 안전하다.",
  "confidence": 0.74 },
  { "claim": "기존 localStorage에 부분 제출(submissions
  일부) 데이터가 남아 있을 수 있으므로 bulk 전환 시 호환 규
  칙(초기화/마이그레이션/안내)이 필요하다.", "reason": "기
  존
  구현은 문제별 제출 시마다 submissions를 merge 저장하므로,
  저장된 문제 수가 전체 problems 수보다 적은 legacy 데이터
  가
  자연스럽게 생성된다.", "confidence": 0.78 },
  { "claim": "Out of Scope(문제 타입 확장/서버 연동/커리
  큘럼 구조 변경)를 피하고 LearnPage.tsx 중심으로 제출 UX/
  저
  장 시점만 바꾸는 것이 회귀 위험이 낮다.", "reason":
  "task.md가 수정 중심 파일과 비범위를 명시하며, 현재 문제
  로딩/채점 로직은 요구 충족에 충분한 기반을 제공한다.",
  "confidence": 0.76 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그:
    LEARN_SINGLE_SUBMIT_FLOW(→LEARN_BULK_SUBMIT_FLOW),
    LEARN_STORAGE_UPDATE_PER_PROBLEM(→LEARN_STORAGE_SAVE_AF
    T
    ER_BULK_GRADE)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:0d3dcb2169###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_df518817a7.md


  59% context left



› Request df518817a7: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_df518817a7.md


    Read research_df518817a7.md                         

• Analyzing requirements and edges (5m 14s • esc to interru


› Improve documentation in @filename

  95% context left · ? for shortcuts


• Explored
  └ Read research_df518817a7.md
    Search Output Format|## Rules|\[/R1 Coverage Report\]|
^##
           Coverage Gap Report in research_df518817a7.md
    Read research_df518817a7.md

─ Worked for 5m 14s ───────────────────────────────────────

• ###BEGIN:df518817a7###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 파악 | FE | C | 변경 전 기준점(상태/스키마)
  을 고정해야 회귀를 줄일 수 있음 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화는 동일 키 계약을 알아야
  수행 가능 |
  | 3 | LEARN_BUILD_ANSWER_STATE_MAP | answerByProblemId 상
  태 맵 유지 | FE | P | allAnswered/일괄 채점을 위해 “문제
  ID→답안” 표현이 필요 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | per-problem 제출 흐름을 제거해야 UX
  요구사항 1) 충족 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 단일 진입점을
  구성 |
  | 6 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | “입력됨/미입력” 기준이 grading과 불일치하면 UX가 붕괴
  |
  | 7 | LEARN_DISABLED_EDGECASES_12 | disabled/정규화 입력
  엣지케이스 12종 정의 | QA | C | 빈값/공백/콤마/0 등 예외
  에서 버튼 상태가 흔들리는 것을 방지 |
  | 8 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지
  disabled”를 안정적으로 계산 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 10 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장을 위해
  결과를 문제ID 기준으로 고정 |
  | 11 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전/후 표시, 복원 시
  상태 일관성을 위해 필요 |
  | 12 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 채점 후 상단 점수 요약(X/N)을 계산/표시
  |
  | 13 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 0/N 노출 등 혼
  란을 방지 |
  | 14 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 결과 표시를 충
  족 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 정책을 고정 |
  | 16 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 상태/정책에 맞게 버튼
  의미를 일관되게 전달 |
  | 17 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션의
  계약(Contract)을 먼저 고정 |
  | 18 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/검증 규칙 | FE | P | 잘못된/legacy 데이터로 인한 런타
  임 오류와 UX 꼬임 방지 |
  | 19 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(일
  괄 채점 후) 충족 |
  | 20 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 복원 동작 충족 |
  | 21 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 호환/마이그레이션 정책 | FE | C | 기존 부
  분 제출 데이터가 남아 있을 때 복원/disabled/표시 충돌 방
  지 |
  | 22 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장 데이터
  삭제 |
  | 23 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  갱신되지 않으므로 UI 리셋이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_UI_SETUP | bulk 제출 UI 구성(disabled까
  지) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_BUILD_ANSWER_STATE_MAP,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출 제거 후
  단일 버튼을 추가하고 정규화 기반 allAnswered로 disabled를
  안정화 |
  | 2 | STEP_BULK_GRADE_AND_RENDER | 일괄 채점→결과 표시/점
  수/버튼 상태 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT,
  LEARN_AFTER_GRADE_EDIT_POLICY,
  LEARN_GRADE_BUTTON_LABEL_STATE | gradeAll 결과를 상태로
  고정하고, 채점 후에만 결과/점수를 노출하며 재입력 시 정책
  에 따라 버튼/결과를 정합화 |
  | 3 | STEP_PERSIST_RESTORE | 저장/복원/호환 처리 |
  LEARN_IDENTIFY_STORAGE_KEY,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 키/스키마
  계약을 고정한 뒤 bulk 저장·복원과 legacy partial 대응을
  연결 |
  | 4 | STEP_RESET_WORKFLOW | 다시 풀기(키 삭제+UI 리셋) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장하려면 어떤 키에 쓰는
  지(계약)가 선행되어야 함 | 0.72 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원하려면 어떤 키에서
  읽는지(계약)가 선행되어야 함 | 0.72 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_RESET_CLEAR_STORAGE | 초기화는 삭제 대상 키를 알아
  야 수행 가능 | 0.72 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 ‘입력됨’ 기준을 먼저 고정해야 함 | 0.82 |
  | 5 | LEARN_BUILD_ANSWER_STATE_MAP →
  LEARN_ALL_ANSWERED_NORMALIZED | 모든 문제 답 입력 여부는
  answers 맵(표현)이 있어야 순회/판정 가능 | 0.75 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 전체 채점 결과를 생성
  한 뒤에야 구성 가능 | 0.78 |
  | 7 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점은 문제별 결과가 있어야 집계 가능 | 0.76 |
  | 8 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과 맵이 선행되어야 함 | 0.78 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 채점 전/후 상태는 bulk 채점 액
  션 이후에 정의/세팅 가능 | 0.74 |
  | 10 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 채점 전/후 플래
  그 없이는 구현 불가 | 0.76 |
  | 11 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 계약이 먼저 필요 | 0.80 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 상태를 재구성하므로 선행 필요 | 0.80 |
  | 13 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK | 요구사항은 “일괄 채점 후”
  저장이므로 채점 결과 생성이 선행 | 0.80 |
  | 14 | LEARN_GRADED_STATE_FLAG →
  LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨 전환은 채점 상
  태(hasGraded 등)에 의존 | 0.70 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 엣지케이스 테스트 벡터가
  있으면 disabled/정규화 불일치 회귀가 줄어듦 | 0.76 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 UI는 먼저 만들 수 있으
  나, disabled까지 함께 설계하면 UX가 빨리 안정화 | 0.65 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 실제 구현은 독립 가능하지
  만, UI 이벤트 연결을 고려하면 함께 설계하는 편이 안전 |
  0.70 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 게이팅을 같이 설계하면 채
  점 전 결과 노출을 예방 | 0.70 |
  | 5 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADE_BUTTON_LABEL_STATE | 재입력 정책에 따라 버튼
  이 “다시 채점/채점하기”로 일관되게 전환됨 | 0.70 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 입력 변경 시 결과를 유지/
  초기화할지에 따라 게이팅/표시 규칙이 달라짐 | 0.70 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 검증 규칙은 스키마 계
  약(필드/타입/버전)을 알아야 정의 가능 | 0.74 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 파싱/검증을 붙이면 잘못
  된 저장 데이터로 인한 런타임 오류를 줄임 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial은 조건부
  이므로, 발견 시 정책 적용(초기화/재채점 요구) 흐름을 권장
  | 0.74 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_BUILD_ANSWER_STATE_MAP | 복원된 답안을 answers 맵에
  채워야 allAnswered/입력 UI가 일관됨 | 0.72 |
  | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_BUILD_RESULT_MAP | 복원된 결과를 결과 맵으로 재구성
  하면 점수/표시가 재현됨 | 0.70 |
  | 12 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거만 먼저 하면 기능 공백
  이 생길 수 있어, 단일 버튼을 먼저 마련하는 순서를 권장 |
  0.68 |
  | 13 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  “완전 초기화” UX를 위해 키 삭제와 UI 리셋을 함께 수행하는
  것을 권장 | 0.78 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 기존 흐름(단건 채점
  →merge 저장) 이해 없이 수정해 저장/복원 회귀 발생 | 현재
  StoredResult{submissions} 계약과 submitProblem 저장 시점
  을 1페이지로 먼저 고정 | 0.74 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI
  “입력됨” 판정과 grading “입력됨” 판정이 다르면 disabled/
  채점이 엇갈림 | normalizeNumericInput(answer).length>0를
  단일 기준으로 고정하고 모든 판정에서 재사용 | 0.82 |
  | 3 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", ".",
  "Infinity" 등에서 빈값/유효값 기준이 흔들림 | 엣지케이스
  를 테스트 벡터로 문서화하고 normalize 결과 기준으로 기대
  값을 명시 | 0.76 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems 기준으로 계산(useMemo)하고 로딩 중/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 5 | LEARN_BUILD_ANSWER_STATE_MAP | 문제 ID와 답안 상태
  가 어긋나 특정 문제 답이 덮어써지거나 누락 |
  answerByProblemId를 problemId 키로만 갱신하고, problems
  변경 시 상태 정합성 점검 | 0.70 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 상태 업
  데이트를 섞어 부수효과/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 7 | LEARN_BUILD_RESULT_MAP | resultByProblemId 키 매칭
  이 틀리면 점수/표시가 전부 어긋남 | 문제 목록의 problemId
  를 단일 키로 사용하고 결과 생성 시 동일 키로만 맵을 구성
  | 0.74 |
  | 8 | LEARN_GRADED_STATE_FLAG | hasGraded 기준이 불명확해
  채점 전에도 0/N 또는 결과가 노출 | hasGraded를 “bulk 채점
  실행 완료(또는 복원된 결과 존재)”로 정의하고 게이팅에 사
  용 | 0.78 |
  | 9 | LEARN_SCORE_SUMMARY_CALC | 부분 결과/legacy 데이터
  로 분모/분자가 맞지 않아 X/N이 틀림 | 분모는
  problems.length로 고정하고 분자는 결과 맵의 isCorrect 집
  계로 계산 | 0.72 |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과
  만 저장 등 스키마가 흔들려 복원/게이팅이 꼬임 | “answers
  + submissions(or resultMap) + updatedAt(+version)” 최소
  계약을 먼저 고정 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON 파싱 실패/
  필드 누락/문제 수 변경으로 복원이 불안정 |
  parse→validate→(필요 시) 초기화/마이그레이션 분기로 복원
  파이프라인을 분리 | 0.76 |
  | 12 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충돌
  | partial 감지(저장된 문제 수 < problems.length) 후 정책
  (초기화/재채점 요구)을 명시 | 0.74 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과/점수가 스테일(불일치) 상태로 남음 | 입력 변경 시
  결과 초기화 또는 “다시 채점” 유도(버튼 라벨 전환) 정책을
  고정 | 0.72 |
  | 14 | LEARN_RESET_UI_STATE | 키 삭제만 하고 UI가 그대로
  라 “초기화”가 체감되지 않음 | removeItem + answer/result/
  hasGraded를 한 액션으로 리셋해 즉시 UI 반영 | 0.78 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새로운 제출 진입점(UI)을 먼저 확보해 기능 공백
  을 막음 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BULK_GRADE_ALL_ACTION | 저장은 “채점 결과 생성” 이
  후에 의미가 생김(요구사항도 채점 후 저장) |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_BULK_GRADE_ALL_ACTION |
  LEARN_ALL_ANSWERED_NORMALIZED | 입력 판정이 안정화되어야
  “모든 문제 입력 후 채점” UX가 일관됨 |
  | 4 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴하므로 기준 노드가 브릿
  지 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  UI 표시는 결과를 problemId로 고정한 맵이 중간 표현으로 필
  요 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계도 동일 결과 맵을 기반으로 해야 일관됨 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | ‘채점 후에만 표시’ 규칙을
  중간에 두면 조기 노출을 방지 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 스키마 계약을 검증 규
  칙으로 연결하면 복원 안정성이 증가 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원된 결과를 ‘채점됨’ 상태로 재구성해야 표시 게이팅이 자
  연스러움 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 초기화
  는 먼저 저장 키 삭제를 수행한 뒤 UI 리셋으로 이어지는 흐
  름이 안전 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type":
  "micro", "name_ko": "localStorage 키 포맷 식별",
  "domain": "FE", "rep": "C", "confidence": 0.72 },
      { "id": "LEARN_BUILD_ANSWER_STATE_MAP", "type":
  "micro", "name_ko": "answerByProblemId 상태 맵 유지",
  "domain": "FE", "rep": "P", "confidence": 0.72 },
      { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
      { "id": "STEP_BULK_UI_SETUP", "type": "step",
  "name_ko": "bulk 제출 UI 구성(disabled까지)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_AND_RENDER", "type": "step",
  "name_ko": "일괄 채점→결과 표시/점수/버튼 상태",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE", "type": "step",
  "name_ko": "저장/복원/호환 처리", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
      { "id": "STEP_RESET_WORKFLOW", "type": "step",
  "name_ko": "다시 풀기(키 삭제+UI 리셋)", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_BUILD_ANSWER_STATE_MAP", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.75 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_GRADE_BUTTON_LABEL_STATE", "type": "requires",
  "confidence": 0.70 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 과잉 잠금", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부이므로 requires가 아니
  라 권장/노트로 두는 편이 안전", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원된 결과로 hasGraded를 파생할 수도 있어 단일 선행 잠
  금은 과잉", "confidence": 0.70 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "UI
  리셋과 키 삭제는 함께 수행이 권장되지만 선후를 잠글 필수
  관계는 아님", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 정책
  은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires로 잠그지 않는다", "confidence": 0.72 }
    ],
    "notes": [
      { "claim": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE는 복원
  안정성을 위한 권장 노드다.", "reason": "parse 실패/필드
  누락/legacy 데이터로 인한 런타임 오류와 UX 꼬임을 줄이기
  위해 validate 단계를 두는 편이 안전하다.", "confidence":
  0.78 },
      { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "모든 사용자에게 legacy 데이터가 존재하는 것은
  아니므로 requires 잠금은 과잉 선행이 될 수 있다.",
  "confidence": 0.74 },
      { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 입력 변경
  시 결과 스테일 문제를 다루는 권장 정책 노드다.",
  "reason": "결과 초기화 또는 다시 채점 유도 등 대체 경로가
  있어 requires로 강제하지 않고 UX 결정으로 남기는 편이 안
  전하다.", "confidence": 0.70 },
      { "claim": "완전 초기화 UX는
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만으로는 화면
  상태가 즉시 초기화되지 않아 사용자 체감이 어긋날 수 있
  다.", "confidence": 0.78 },
      { "claim": "LEARN_BUILD_RESULT_MAP은 결과 표시/점수/
  저장의 공통 중간 표현이다.", "reason": "problemId 기반 결
  과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되어
  오류가 줄어든다.", "confidence": 0.74 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작 1페이지 요약(상태 흐름/데이터 스키마) |
  LearnPage는 문제별 제출→단건 채점→localStorage merge 저장
  흐름이며 StoredResult{submissions} 계약이 기준점인데, 이
  를
  명시 요약하지 않으면 변경 시 회귀가 발생 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 핵심(개별 제
  출
  제거)인데 현재 UI는 per-problem 제출에 고정 | 높음 |
  | 3 | 페이지 하단 단일 버튼 채점하기(전체 제출) | 일괄 채
  점 UX의 유일한 진입점이 필요하나 현재 없음 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 버튼 활성/비활성이 채점과 엇갈림 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | “모든 문제 답 입력
  전까지 disabled”를 problems[] 기준으로 안정적으로 계산하
  는
  로직이 필요(로딩/문제수 변화 포함) | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요: "", "   ", "\t\n", ",", " , , ",
  "1,234", " 1 234 ", "0", "-0", "+", ".", "Infinity" | 중
  |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem(problem)만 존재해 “한 번에 전체 채
  점” 동작이 없음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전에도 점수/정답이 노출되거나(0/N) 저장/복원 시 상태가 꼬
  이는 것을 막기 위한 상태 기준이 필요 | 중 |
  | 9 | 문제별 결과 표시(정오/정답) 정책(일괄 채점 후) | 요
  구는 채점 후 각 문제 카드에 정오/정답 표시인데, 현재는 단
  건 제출 시에만 결과가 생김 | 높음 |
  |10| 총점 X/N 표시 정책(채점 후에만) | 상단 점수는 채점
  후
  에만 의미가 있으나 현재 구조는 “결과 일부 존재”만으로 0/N
  노출 가능 | 중 |
  |11| 저장/복원 계약(답안+채점결과를 한 번에 저장/복원) |
  요구는 일괄 채점 후 저장/복원인데, 현재는 문제별 제출 시
  마
  다 submissions를 merge 저장 | 높음 |
  |12| legacy partial(기존 부분 제출 데이터) 호환/마이그레
  이
  션 | 기존 데이터가 일부 문제만 채점/저장된 형태로 남아 있
  을 수 있어 bulk 전환 시 복원/disabled/표시가 꼬임 | 높음
  |
  |13| 다시 풀기(초기화): 키 삭제 + UI 상태 리셋 | 요구사항
  4)인데 현재는 사용자가 저장된 결과/답안을 삭제할 UX가 없
  음
  | 높음 |
  |14| 채점 후 재입력 정책(스테일 결과 처리) | 채점 후 입력
  변경 시 결과/점수와 입력이 불일치하는 스테일 상태가 발생
  할
  수 있어 정책이 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope(서버 연동) 위반이
  며
  localStorage 요구를 흐림 | 금지(이번 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 티켓은 제출
  UX/저장/복원이며 타입 확장은 별도 사양 필요 | 금지(후속
  티
  켓) |
  | 3 | grading 대개편(허용오차/분수/근삿값) | 요구는 일괄
  제출 UX이며 채점 정책 변경은 회귀 위험만 증대 | 기존
  gradeNumericAnswer() 유지 |
  | 4 | 문제은행 JSON 스키마 변경 | 로딩/데이터 구조 변경은
  범위 밖이며 회귀 위험 큼 | 기존 problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 충분, 도입은 과잉 | React state/useMemo로
  해결 |
  | 6 | 입력 중 실시간 autosave | 요구는 “채점 후 한 번에
  저
  장”이며 autosave는 정책/호환을 복잡화 | 이번 범위에서 제
  외
  |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 제출 미구현 | 제거만 하면
  채
  점/저장 경로가 사라져 기능 공백 발생 | 단일 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 입력 기준) → 채점(정규화 기준) | " ,
  "
  같은 케이스에서 버튼 활성/비활성과 채점 결과가 불일치 |
  disabled 판정은 normalizeNumericInput(answer).length>0로
  고정 |
  | 3 | 일괄 저장(한 번에 저장) → 기존 partial 데이터 복원
  |
  legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충돌
  | partial 감지 후 정책(초기화/답안만 복원/재채점 요구) 정
  의 |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 0/N 노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 발생 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | localStorage만
  지
  우면 화면은 이전 결과/답안을 계속 표시 | 키 삭제 +
  answerByProblemId/resultByProblemId/hasGraded 리셋 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled/정규화 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출 데이터 호환/
  마
  이그레이션 규칙", "domain": "FE", "rep": "C",
  "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results/hasGraded)", "domain": "FE", "rep": "P",
  "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입과 submitProblem의
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason": "grading.ts의
  normalizeNumericInput은 공백/콤마 제거를 수행하므로,
  disabled가 원문 기준이면 '입력됨/미입력'이 채점과 불일치
  한
  다.", "confidence": 0.82 },
  { "claim": "bulk 전환 시 legacy partial(일부 문제만
  submissions에 존재) 데이터가 자연스럽게 존재하므로 호환/
  마
  이그레이션 정책이 필요하다.", "reason": "기존 구현은 문제
  별 제출 시마다 submissions를 누적 저장하므로 전체 문제 수
  보다 적은 저장 데이터가 생성된다.", "confidence": 0.78 },
  { "claim": "점수/정오/정답 표시는 hasGraded 같은 상태
  로 게이팅해야 한다.", "reason": "채점 전 0/N 노출 및 저
  장/
  복원 시 표시 기준 혼란을 막기 위해 채점 전/후를 분리해야
  한다.", "confidence": 0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI 상태
  리셋을 함께 수행해야 한다.", "reason": "키 삭제만으로는
  화
  면에 남아있는 answer/result 상태가 즉시 초기화되지 않아
  UX
  가 어긋난다.", "confidence": 0.78 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:df518817a7###


› Improve documentation in @filename

  61% context left · ? for shortcuts


============================================================
[2026-01-08 11:03:07] RESEARCH2 (req_id: 638d80efe8)
============================================================
  "confidence": 0.76 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가는 순서가 바뀌어도 구현 가능하므로
  requires로 잠그지 않는다", "confidence": 0.72 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "migration은 legacy 데이터가 있을 때만 필요하므
  로 requires가 아니라 조건부 권장", "confidence": 0.74 }
    ],
    "notes": [
      { "claim": "LEARN_ALL_ANSWERED_NORMALIZED는 버튼 존재
  와 무관하게 정의될 수 있으므로 requires로 잠그지 말고 UI
  에서 조건부로 사용한다.", "reason": "버튼을 먼저 렌더링하
  고 disabled만 나중에 붙이는 구현 경로가 자연스럽고 회귀
  위험이 낮다.", "confidence": 0.70 },
      { "claim": "LEARN_DISABLED_EDGECASES_12는 최종
  disabled 품질을 위한 권장 선행이다.", "reason":
  "normalizeNumericInput과의 일관성을 10+ 입력 벡터로 검증
  하면 빈값/0 처리 등에서 UX 불일치가 줄어든다.",
  "confidence": 0.76 },
      { "claim": "LEARN_STORE_RESULT_SCHEMA_BULK를 먼저 고
  정하면 저장/복원/마이그레이션 논의가 단순해진다.",
  "reason": "답안과 결과를 함께 저장한다는 계약이 흔들리면
  상태 플래그/게이팅/점수 계산까지 연쇄로 흔들린다.",
  "confidence": 0.78 },
      { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "일부 노드/사용자는 legacy 데이터가 없을 수 있
  어 requires 잠금은 과잉 선행이 된다.", "confidence":
  0.74 },
      { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 게이팅과
  함께 설계하되 requires로 강제하지 않는다.", "reason": "정
  책은 '입력 변경 시 결과 초기화' 또는 '다시 채점 버튼 제
  공' 등 대체 경로가 존재한다.", "confidence": 0.70 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 단일 버튼 UX(페이지 하단 채점하기/전체 제출) | 현재
  는 문제 카드별 제출만 존재해 “모든 문제 후 일괄 채점” 요
  구
  를 충족하지 못함 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 1)에서 제거가
  핵심인데 현재 UI는 per-problem 제출 흐름에 고정되어 있음
  |
  높음 |
  | 3 | 채점하기 disabled 조건 정의(정규화 일관성) | 버튼
  disabled 기준이 normalizeNumericInput()과 일관되게 정의되
  어야 하나 현재는 해당 UX 자체가 없음 | 높음 |
  | 4 | “모든 문제 미입력” 판정 로직(allAnswered) |
  problems[] 전체를 기준으로 answerByProblemId가 모두 채워
  졌
  는지 판단하는 상태/계산이 필요(문제 수 변화/로딩 타이밍
  포
  함) | 높음 |
  | 5 | 입력 엣지케이스(10개+) 목록/정의 | AC 요구(10개+)가
  문서/설계로 존재해야 하는데 현재 정의가 없음(예: "", "
  ", "\t\n", ",", " , , ", "1,234", " 1 234 ", "0",
  "-0", "+", ".", "Infinity" 등) | 중 |
  | 6 | 일괄 채점 동작(전체 순회→채점→결과 맵 생성) | 현재
  는
  submitProblem(problem)로 단건 채점만 가능하며, 전체 문제
  를
  한 번에 채점해 결과를 고정하는 액션이 없음 | 높음 |
  | 7 | 채점 이후 UI 상태 정의(채점 전/후) | 현재는 결과가
  하나라도 있으면 점수 0/N이 항상 표시될 수 있고, “채점 전/
  후” 상태(예: hasGraded/isSubmitted) 기준이 없음 | 중 |
  | 8 | “채점 후 재입력” UX 정책 | bulk 채점 후 입력을 수정
  할 때 결과/점수의 일관성(자동 결과 초기화 vs “다시 채점”
  버튼) 정책이 필요하나 정의 없음 | 중 |
  | 9 | localStorage 저장 시점 변경(개별→일괄) | 현재는 개
  별
  제출 시 submissions를 merge 저장; 요구는 일괄 채점 후 답
  안
  +결과를 한 번에 저장 | 높음 |
  |10| 저장/복원 스키마 호환/마이그레이션 | 기존 키
  (curriculum-viewer:learn:lastResult:${nodeId})에 부분 제
  출
  데이터가 남아있을 수 있어 bulk 전환 시 호환 규칙이 필요 |
  높음 |
  |11| 초기화/다시 풀기(키 삭제 + 상태 리셋) | 요구사항 4)
  다시 풀기 버튼 및 저장된 결과/답안 삭제가 필요하나 현재
  없
  음 | 높음 |
  |12| Out of Scope 가드레일 명시(무엇을 안 바꿀지) | 구현
  중 문제 타입 확장/서버 연동/커리큘럼 구조 변경으로 범위가
  새는 것을 막는 체크리스트가 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 기반 요구를 흐림 | 금지(요구 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 변경의 핵심
  은 “제출 UX/저장/복원”이며 타입 확장은 범위 밖 | 금지(향
  후
  별도 티켓) |
  | 3 | 문제은행 JSON 스키마 변경 | 현재는 problems_v1.json
  로딩으로 충분하며 스키마 변경은 회귀 위험만 큼 | 기존 스
  키
  마 유지 |
  | 4 | grading 로직 대개편(분수/근삿값/허용오차 등) | 요구
  는 제출 UX이며 채점 확장은 별도 사양 필요 |
  gradeNumericAnswer() 유지, 필요 시 후속 티켓 |
  | 5 | 대형 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 해결 가능, 도입은 과잉 | React state/
  useMemo로 해결 |
  | 6 | “입력 중 실시간 저장(autosave)” | 요구는 “채점 후
  한
  번에 저장”이며 autosave는 UX/스키마를 복잡하게 함 | 이번
  범위에서 제외(필요 시 옵션) |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk UX 미구현 | 제거만 하면 채
  점
  경로가 사라져 기능 공백 발생 | 단일 채점하기 버튼 +
  gradeAll 액션 먼저 추가 후 제거 |
  | 2 | disabled 판정(원문 입력 기준) → 실제 채점(정규화 기
  준) | " , " 같은 입력이 disabled 해제되거나 반대로 0이 미
  입력 처리되는 불일치 위험 | disabled는
  normalizeNumericInput(answer).length>0로 고정 |
  | 3 | 저장 시점 변경(개별→일괄) → 기존 localStorage 데이
  터
  무시 | 기존 submissions가 부분만 존재할 수 있어 복원/버튼
  상태가 꼬일 수 있음 | “legacy partial” 감지(개수/키) 후
  초
  기화 또는 안내/정책 적용 |
  | 4 | 점수 표시(항상 0/N) → 채점 UX | 채점 전부터 점수가
  보이면 사용자가 이미 채점된 것으로 오해 | hasGraded 도입
  후 채점 후에만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 생김 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(다시 풀기) 없음 → 상태 복원 유지 | 사용자가
  저장된 결과를 지울 방법이 없어 UX 막힘 | 다시 풀기(키 삭
  제
  +상태 리셋) 추가 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "모든 문제 미입력 판정(allAnswered,
  정
  규화 기반)", "domain": "FE", "rep": "P", "confidence":
  0.82 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출(submissions
  일
  부) 데이터 호환/마이그레이션 규칙", "domain": "FE",
  "rep":
  "C", "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기(초기화): 저장 키 삭제 + 상태 리셋",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled 판정 입력 엣지케이스 12종
  (빈
  값/공백/콤마/0/부호/소수점 등)", "domain": "QA", "rep":
  "C", "confidence": 0.76 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_DISABLED_EDGECASES_12", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점/단건 저장을 수행하며,
  StoredResult는 { nodeId, updatedAt, submissions:
  { [problemId]: { submitted, isCorrect } } } 형태이다.",
  "reason": "LearnPage.tsx에서 gradeNumericAnswer 호출 및
  localStorage merge 저장 로직과 StoredResult 타입 정의가
  확
  인된다.", "confidence": 0.86 },
  { "claim": "bulk UX의 disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 모든
  problems가 채워졌는지 검사해야 grading과 일관된다.",
  "reason": "grading.ts의 normalizeNumericInput은 공백/콤마
  제거를 수행하므로, 동일 기준을 쓰지 않으면 '미입력/입력
  됨'
  판단이 채점 결과와 어긋난다.", "confidence": 0.82 },
  { "claim": "점수/정오/정답 표시는 채점 전/후 상태
  (hasGraded 등)로 게이팅하지 않으면 채점 전에도 0/N이 노출
  되는 혼란이 발생할 수 있다.", "reason": "현재 score 계산
  은
  problems.length만으로 0/N을 만들 수 있어 bulk 전환 시 '채
  점 전' 상태를 별도로 분리하는 것이 안전하다.",
  "confidence": 0.74 },
  { "claim": "기존 localStorage에 부분 제출(submissions
  일부) 데이터가 남아 있을 수 있으므로 bulk 전환 시 호환 규
  칙(초기화/마이그레이션/안내)이 필요하다.", "reason": "기
  존
  구현은 문제별 제출 시마다 submissions를 merge 저장하므로,
  저장된 문제 수가 전체 problems 수보다 적은 legacy 데이터
  가
  자연스럽게 생성된다.", "confidence": 0.78 },
  { "claim": "Out of Scope(문제 타입 확장/서버 연동/커리
  큘럼 구조 변경)를 피하고 LearnPage.tsx 중심으로 제출 UX/
  저
  장 시점만 바꾸는 것이 회귀 위험이 낮다.", "reason":
  "task.md가 수정 중심 파일과 비범위를 명시하며, 현재 문제
  로딩/채점 로직은 요구 충족에 충분한 기반을 제공한다.",
  "confidence": 0.76 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그:
    LEARN_SINGLE_SUBMIT_FLOW(→LEARN_BULK_SUBMIT_FLOW),
    LEARN_STORAGE_UPDATE_PER_PROBLEM(→LEARN_STORAGE_SAVE_AF
    T
    ER_BULK_GRADE)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:0d3dcb2169###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_df518817a7.md


  59% context left



› Request df518817a7: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_df518817a7.md


    Read research_df518817a7.md                         

• Analyzing requirements and edges (5m 14s • esc to interru


› Improve documentation in @filename

  95% context left · ? for shortcuts


• Explored
  └ Read research_df518817a7.md
    Search Output Format|## Rules|\[/R1 Coverage Report\]|
^##
           Coverage Gap Report in research_df518817a7.md
    Read research_df518817a7.md

─ Worked for 5m 14s ───────────────────────────────────────

• ###BEGIN:df518817a7###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 파악 | FE | C | 변경 전 기준점(상태/스키마)
  을 고정해야 회귀를 줄일 수 있음 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화는 동일 키 계약을 알아야
  수행 가능 |
  | 3 | LEARN_BUILD_ANSWER_STATE_MAP | answerByProblemId 상
  태 맵 유지 | FE | P | allAnswered/일괄 채점을 위해 “문제
  ID→답안” 표현이 필요 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | per-problem 제출 흐름을 제거해야 UX
  요구사항 1) 충족 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 단일 진입점을
  구성 |
  | 6 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | “입력됨/미입력” 기준이 grading과 불일치하면 UX가 붕괴
  |
  | 7 | LEARN_DISABLED_EDGECASES_12 | disabled/정규화 입력
  엣지케이스 12종 정의 | QA | C | 빈값/공백/콤마/0 등 예외
  에서 버튼 상태가 흔들리는 것을 방지 |
  | 8 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지
  disabled”를 안정적으로 계산 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 10 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장을 위해
  결과를 문제ID 기준으로 고정 |
  | 11 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전/후 표시, 복원 시
  상태 일관성을 위해 필요 |
  | 12 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 채점 후 상단 점수 요약(X/N)을 계산/표시
  |
  | 13 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 0/N 노출 등 혼
  란을 방지 |
  | 14 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 결과 표시를 충
  족 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 정책을 고정 |
  | 16 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 상태/정책에 맞게 버튼
  의미를 일관되게 전달 |
  | 17 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션의
  계약(Contract)을 먼저 고정 |
  | 18 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/검증 규칙 | FE | P | 잘못된/legacy 데이터로 인한 런타
  임 오류와 UX 꼬임 방지 |
  | 19 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(일
  괄 채점 후) 충족 |
  | 20 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 복원 동작 충족 |
  | 21 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 호환/마이그레이션 정책 | FE | C | 기존 부
  분 제출 데이터가 남아 있을 때 복원/disabled/표시 충돌 방
  지 |
  | 22 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장 데이터
  삭제 |
  | 23 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  갱신되지 않으므로 UI 리셋이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_UI_SETUP | bulk 제출 UI 구성(disabled까
  지) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_BUILD_ANSWER_STATE_MAP,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출 제거 후
  단일 버튼을 추가하고 정규화 기반 allAnswered로 disabled를
  안정화 |
  | 2 | STEP_BULK_GRADE_AND_RENDER | 일괄 채점→결과 표시/점
  수/버튼 상태 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT,
  LEARN_AFTER_GRADE_EDIT_POLICY,
  LEARN_GRADE_BUTTON_LABEL_STATE | gradeAll 결과를 상태로
  고정하고, 채점 후에만 결과/점수를 노출하며 재입력 시 정책
  에 따라 버튼/결과를 정합화 |
  | 3 | STEP_PERSIST_RESTORE | 저장/복원/호환 처리 |
  LEARN_IDENTIFY_STORAGE_KEY,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 키/스키마
  계약을 고정한 뒤 bulk 저장·복원과 legacy partial 대응을
  연결 |
  | 4 | STEP_RESET_WORKFLOW | 다시 풀기(키 삭제+UI 리셋) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장하려면 어떤 키에 쓰는
  지(계약)가 선행되어야 함 | 0.72 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원하려면 어떤 키에서
  읽는지(계약)가 선행되어야 함 | 0.72 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_RESET_CLEAR_STORAGE | 초기화는 삭제 대상 키를 알아
  야 수행 가능 | 0.72 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 ‘입력됨’ 기준을 먼저 고정해야 함 | 0.82 |
  | 5 | LEARN_BUILD_ANSWER_STATE_MAP →
  LEARN_ALL_ANSWERED_NORMALIZED | 모든 문제 답 입력 여부는
  answers 맵(표현)이 있어야 순회/판정 가능 | 0.75 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 전체 채점 결과를 생성
  한 뒤에야 구성 가능 | 0.78 |
  | 7 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점은 문제별 결과가 있어야 집계 가능 | 0.76 |
  | 8 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과 맵이 선행되어야 함 | 0.78 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 채점 전/후 상태는 bulk 채점 액
  션 이후에 정의/세팅 가능 | 0.74 |
  | 10 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 채점 전/후 플래
  그 없이는 구현 불가 | 0.76 |
  | 11 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 계약이 먼저 필요 | 0.80 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 상태를 재구성하므로 선행 필요 | 0.80 |
  | 13 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK | 요구사항은 “일괄 채점 후”
  저장이므로 채점 결과 생성이 선행 | 0.80 |
  | 14 | LEARN_GRADED_STATE_FLAG →
  LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨 전환은 채점 상
  태(hasGraded 등)에 의존 | 0.70 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 엣지케이스 테스트 벡터가
  있으면 disabled/정규화 불일치 회귀가 줄어듦 | 0.76 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 UI는 먼저 만들 수 있으
  나, disabled까지 함께 설계하면 UX가 빨리 안정화 | 0.65 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 실제 구현은 독립 가능하지
  만, UI 이벤트 연결을 고려하면 함께 설계하는 편이 안전 |
  0.70 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 게이팅을 같이 설계하면 채
  점 전 결과 노출을 예방 | 0.70 |
  | 5 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADE_BUTTON_LABEL_STATE | 재입력 정책에 따라 버튼
  이 “다시 채점/채점하기”로 일관되게 전환됨 | 0.70 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 입력 변경 시 결과를 유지/
  초기화할지에 따라 게이팅/표시 규칙이 달라짐 | 0.70 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 검증 규칙은 스키마 계
  약(필드/타입/버전)을 알아야 정의 가능 | 0.74 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 파싱/검증을 붙이면 잘못
  된 저장 데이터로 인한 런타임 오류를 줄임 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial은 조건부
  이므로, 발견 시 정책 적용(초기화/재채점 요구) 흐름을 권장
  | 0.74 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_BUILD_ANSWER_STATE_MAP | 복원된 답안을 answers 맵에
  채워야 allAnswered/입력 UI가 일관됨 | 0.72 |
  | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_BUILD_RESULT_MAP | 복원된 결과를 결과 맵으로 재구성
  하면 점수/표시가 재현됨 | 0.70 |
  | 12 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거만 먼저 하면 기능 공백
  이 생길 수 있어, 단일 버튼을 먼저 마련하는 순서를 권장 |
  0.68 |
  | 13 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  “완전 초기화” UX를 위해 키 삭제와 UI 리셋을 함께 수행하는
  것을 권장 | 0.78 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 기존 흐름(단건 채점
  →merge 저장) 이해 없이 수정해 저장/복원 회귀 발생 | 현재
  StoredResult{submissions} 계약과 submitProblem 저장 시점
  을 1페이지로 먼저 고정 | 0.74 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI
  “입력됨” 판정과 grading “입력됨” 판정이 다르면 disabled/
  채점이 엇갈림 | normalizeNumericInput(answer).length>0를
  단일 기준으로 고정하고 모든 판정에서 재사용 | 0.82 |
  | 3 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", ".",
  "Infinity" 등에서 빈값/유효값 기준이 흔들림 | 엣지케이스
  를 테스트 벡터로 문서화하고 normalize 결과 기준으로 기대
  값을 명시 | 0.76 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems 기준으로 계산(useMemo)하고 로딩 중/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 5 | LEARN_BUILD_ANSWER_STATE_MAP | 문제 ID와 답안 상태
  가 어긋나 특정 문제 답이 덮어써지거나 누락 |
  answerByProblemId를 problemId 키로만 갱신하고, problems
  변경 시 상태 정합성 점검 | 0.70 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 상태 업
  데이트를 섞어 부수효과/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 7 | LEARN_BUILD_RESULT_MAP | resultByProblemId 키 매칭
  이 틀리면 점수/표시가 전부 어긋남 | 문제 목록의 problemId
  를 단일 키로 사용하고 결과 생성 시 동일 키로만 맵을 구성
  | 0.74 |
  | 8 | LEARN_GRADED_STATE_FLAG | hasGraded 기준이 불명확해
  채점 전에도 0/N 또는 결과가 노출 | hasGraded를 “bulk 채점
  실행 완료(또는 복원된 결과 존재)”로 정의하고 게이팅에 사
  용 | 0.78 |
  | 9 | LEARN_SCORE_SUMMARY_CALC | 부분 결과/legacy 데이터
  로 분모/분자가 맞지 않아 X/N이 틀림 | 분모는
  problems.length로 고정하고 분자는 결과 맵의 isCorrect 집
  계로 계산 | 0.72 |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과
  만 저장 등 스키마가 흔들려 복원/게이팅이 꼬임 | “answers
  + submissions(or resultMap) + updatedAt(+version)” 최소
  계약을 먼저 고정 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON 파싱 실패/
  필드 누락/문제 수 변경으로 복원이 불안정 |
  parse→validate→(필요 시) 초기화/마이그레이션 분기로 복원
  파이프라인을 분리 | 0.76 |
  | 12 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충돌
  | partial 감지(저장된 문제 수 < problems.length) 후 정책
  (초기화/재채점 요구)을 명시 | 0.74 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과/점수가 스테일(불일치) 상태로 남음 | 입력 변경 시
  결과 초기화 또는 “다시 채점” 유도(버튼 라벨 전환) 정책을
  고정 | 0.72 |
  | 14 | LEARN_RESET_UI_STATE | 키 삭제만 하고 UI가 그대로
  라 “초기화”가 체감되지 않음 | removeItem + answer/result/
  hasGraded를 한 액션으로 리셋해 즉시 UI 반영 | 0.78 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새로운 제출 진입점(UI)을 먼저 확보해 기능 공백
  을 막음 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BULK_GRADE_ALL_ACTION | 저장은 “채점 결과 생성” 이
  후에 의미가 생김(요구사항도 채점 후 저장) |
  | 3 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_BULK_GRADE_ALL_ACTION |
  LEARN_ALL_ANSWERED_NORMALIZED | 입력 판정이 안정화되어야
  “모든 문제 입력 후 채점” UX가 일관됨 |
  | 4 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴하므로 기준 노드가 브릿
  지 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  UI 표시는 결과를 problemId로 고정한 맵이 중간 표현으로 필
  요 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계도 동일 결과 맵을 기반으로 해야 일관됨 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | ‘채점 후에만 표시’ 규칙을
  중간에 두면 조기 노출을 방지 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 스키마 계약을 검증 규
  칙으로 연결하면 복원 안정성이 증가 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원된 결과를 ‘채점됨’ 상태로 재구성해야 표시 게이팅이 자
  연스러움 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 초기화
  는 먼저 저장 키 삭제를 수행한 뒤 UI 리셋으로 이어지는 흐
  름이 안전 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type":
  "micro", "name_ko": "localStorage 키 포맷 식별",
  "domain": "FE", "rep": "C", "confidence": 0.72 },
      { "id": "LEARN_BUILD_ANSWER_STATE_MAP", "type":
  "micro", "name_ko": "answerByProblemId 상태 맵 유지",
  "domain": "FE", "rep": "P", "confidence": 0.72 },
      { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
      { "id": "STEP_BULK_UI_SETUP", "type": "step",
  "name_ko": "bulk 제출 UI 구성(disabled까지)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_AND_RENDER", "type": "step",
  "name_ko": "일괄 채점→결과 표시/점수/버튼 상태",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE", "type": "step",
  "name_ko": "저장/복원/호환 처리", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
      { "id": "STEP_RESET_WORKFLOW", "type": "step",
  "name_ko": "다시 풀기(키 삭제+UI 리셋)", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_BUILD_ANSWER_STATE_MAP", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.75 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_GRADE_BUTTON_LABEL_STATE", "type": "requires",
  "confidence": 0.70 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 과잉 잠금", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부이므로 requires가 아니
  라 권장/노트로 두는 편이 안전", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원된 결과로 hasGraded를 파생할 수도 있어 단일 선행 잠
  금은 과잉", "confidence": 0.70 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "UI
  리셋과 키 삭제는 함께 수행이 권장되지만 선후를 잠글 필수
  관계는 아님", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 정책
  은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires로 잠그지 않는다", "confidence": 0.72 }
    ],
    "notes": [
      { "claim": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE는 복원
  안정성을 위한 권장 노드다.", "reason": "parse 실패/필드
  누락/legacy 데이터로 인한 런타임 오류와 UX 꼬임을 줄이기
  위해 validate 단계를 두는 편이 안전하다.", "confidence":
  0.78 },
      { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "모든 사용자에게 legacy 데이터가 존재하는 것은
  아니므로 requires 잠금은 과잉 선행이 될 수 있다.",
  "confidence": 0.74 },
      { "claim": "LEARN_AFTER_GRADE_EDIT_POLICY는 입력 변경
  시 결과 스테일 문제를 다루는 권장 정책 노드다.",
  "reason": "결과 초기화 또는 다시 채점 유도 등 대체 경로가
  있어 requires로 강제하지 않고 UX 결정으로 남기는 편이 안
  전하다.", "confidence": 0.70 },
      { "claim": "완전 초기화 UX는
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만으로는 화면
  상태가 즉시 초기화되지 않아 사용자 체감이 어긋날 수 있
  다.", "confidence": 0.78 },
      { "claim": "LEARN_BUILD_RESULT_MAP은 결과 표시/점수/
  저장의 공통 중간 표현이다.", "reason": "problemId 기반 결
  과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되어
  오류가 줄어든다.", "confidence": 0.74 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작 1페이지 요약(상태 흐름/데이터 스키마) |
  LearnPage는 문제별 제출→단건 채점→localStorage merge 저장
  흐름이며 StoredResult{submissions} 계약이 기준점인데, 이
  를
  명시 요약하지 않으면 변경 시 회귀가 발생 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 핵심(개별 제
  출
  제거)인데 현재 UI는 per-problem 제출에 고정 | 높음 |
  | 3 | 페이지 하단 단일 버튼 채점하기(전체 제출) | 일괄 채
  점 UX의 유일한 진입점이 필요하나 현재 없음 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 버튼 활성/비활성이 채점과 엇갈림 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | “모든 문제 답 입력
  전까지 disabled”를 problems[] 기준으로 안정적으로 계산하
  는
  로직이 필요(로딩/문제수 변화 포함) | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요: "", "   ", "\t\n", ",", " , , ",
  "1,234", " 1 234 ", "0", "-0", "+", ".", "Infinity" | 중
  |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem(problem)만 존재해 “한 번에 전체 채
  점” 동작이 없음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전에도 점수/정답이 노출되거나(0/N) 저장/복원 시 상태가 꼬
  이는 것을 막기 위한 상태 기준이 필요 | 중 |
  | 9 | 문제별 결과 표시(정오/정답) 정책(일괄 채점 후) | 요
  구는 채점 후 각 문제 카드에 정오/정답 표시인데, 현재는 단
  건 제출 시에만 결과가 생김 | 높음 |
  |10| 총점 X/N 표시 정책(채점 후에만) | 상단 점수는 채점
  후
  에만 의미가 있으나 현재 구조는 “결과 일부 존재”만으로 0/N
  노출 가능 | 중 |
  |11| 저장/복원 계약(답안+채점결과를 한 번에 저장/복원) |
  요구는 일괄 채점 후 저장/복원인데, 현재는 문제별 제출 시
  마
  다 submissions를 merge 저장 | 높음 |
  |12| legacy partial(기존 부분 제출 데이터) 호환/마이그레
  이
  션 | 기존 데이터가 일부 문제만 채점/저장된 형태로 남아 있
  을 수 있어 bulk 전환 시 복원/disabled/표시가 꼬임 | 높음
  |
  |13| 다시 풀기(초기화): 키 삭제 + UI 상태 리셋 | 요구사항
  4)인데 현재는 사용자가 저장된 결과/답안을 삭제할 UX가 없
  음
  | 높음 |
  |14| 채점 후 재입력 정책(스테일 결과 처리) | 채점 후 입력
  변경 시 결과/점수와 입력이 불일치하는 스테일 상태가 발생
  할
  수 있어 정책이 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope(서버 연동) 위반이
  며
  localStorage 요구를 흐림 | 금지(이번 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 티켓은 제출
  UX/저장/복원이며 타입 확장은 별도 사양 필요 | 금지(후속
  티
  켓) |
  | 3 | grading 대개편(허용오차/분수/근삿값) | 요구는 일괄
  제출 UX이며 채점 정책 변경은 회귀 위험만 증대 | 기존
  gradeNumericAnswer() 유지 |
  | 4 | 문제은행 JSON 스키마 변경 | 로딩/데이터 구조 변경은
  범위 밖이며 회귀 위험 큼 | 기존 problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 충분, 도입은 과잉 | React state/useMemo로
  해결 |
  | 6 | 입력 중 실시간 autosave | 요구는 “채점 후 한 번에
  저
  장”이며 autosave는 정책/호환을 복잡화 | 이번 범위에서 제
  외
  |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 제출 미구현 | 제거만 하면
  채
  점/저장 경로가 사라져 기능 공백 발생 | 단일 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 입력 기준) → 채점(정규화 기준) | " ,
  "
  같은 케이스에서 버튼 활성/비활성과 채점 결과가 불일치 |
  disabled 판정은 normalizeNumericInput(answer).length>0로
  고정 |
  | 3 | 일괄 저장(한 번에 저장) → 기존 partial 데이터 복원
  |
  legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충돌
  | partial 감지 후 정책(초기화/답안만 복원/재채점 요구) 정
  의 |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 0/N 노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 발생 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | localStorage만
  지
  우면 화면은 이전 결과/답안을 계속 표시 | 키 삭제 +
  answerByProblemId/resultByProblemId/hasGraded 리셋 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled/정규화 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출 데이터 호환/
  마
  이그레이션 규칙", "domain": "FE", "rep": "C",
  "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results/hasGraded)", "domain": "FE", "rep": "P",
  "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입과 submitProblem의
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason": "grading.ts의
  normalizeNumericInput은 공백/콤마 제거를 수행하므로,
  disabled가 원문 기준이면 '입력됨/미입력'이 채점과 불일치
  한
  다.", "confidence": 0.82 },
  { "claim": "bulk 전환 시 legacy partial(일부 문제만
  submissions에 존재) 데이터가 자연스럽게 존재하므로 호환/
  마
  이그레이션 정책이 필요하다.", "reason": "기존 구현은 문제
  별 제출 시마다 submissions를 누적 저장하므로 전체 문제 수
  보다 적은 저장 데이터가 생성된다.", "confidence": 0.78 },
  { "claim": "점수/정오/정답 표시는 hasGraded 같은 상태
  로 게이팅해야 한다.", "reason": "채점 전 0/N 노출 및 저
  장/
  복원 시 표시 기준 혼란을 막기 위해 채점 전/후를 분리해야
  한다.", "confidence": 0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI 상태
  리셋을 함께 수행해야 한다.", "reason": "키 삭제만으로는
  화
  면에 남아있는 answer/result 상태가 즉시 초기화되지 않아
  UX
  가 어긋난다.", "confidence": 0.78 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:df518817a7###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_638d80efe8.md


  61% context left



› Request 638d80efe8: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_638d80efe8.md


    Read research_638d80efe8.md                         

• Ensuring name consistency in JSON (5m 21s • esc to interr


› Improve documentation in @filename

  94% context left · ? for shortcuts


• Explored
  └ Read research_638d80efe8.md
    Search Output Format|## Rules|\[/R1 Coverage Report\]|
^##
           Coverage Gap Report in research_638d80efe8.md
    Read research_638d80efe8.md

─ Worked for 5m 21s ───────────────────────────────────────

• ###BEGIN:638d80efe8###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 1페이지 요약 | FE | C | 변경 전 기준선(상태/
  저장 시점)을 고정해 회귀를 줄이기 위해 |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA | StoredResult/
  submissions 스키마 문서화 | FE | C | bulk 저장/복원/호환
  을 설계하려면 기존 저장 계약을 먼저 명시해야 함 |
  | 3 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1)의 핵심(개별 제출 경로 제
  거)을 독립 작업으로 분리 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 단일 진입점을
  구현하기 위해 |
  | 5 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | UI 입력 판정과 grading 판정이 어긋나면 기능/UX가 붕괴
  하기 때문 |
  | 6 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  정의(빈값/공백/콤마/0/부호/소수점 등) | QA | C |
  disabled/정규화 일관성을 케이스 기반으로 고정해 회귀를 줄
  이기 위해 |
  | 7 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지
  disabled”를 problems[] 기준으로 안정화 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 9 | LEARN_BUILD_RESULT_MAP | problemId→채점결과
  (resultByProblemId) 맵 생성 | FE | P | 점수/표시/저장을
  같은 키로 정렬하는 중간 표현이 필요 |
  | 10 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전 점수 노출, 복원 후
  표시 기준 혼선을 막는 기준점 |
  | 11 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 요구사항 2) 점수 요약 표시를 별도 계산
  단위로 분리 |
  | 12 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 결과 노출 및
  legacy partial 노출 혼란을 차단 |
  | 13 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 문제 카드별 결
  과 표시를 독립 작업으로 분리 |
  | 14 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션/
  초기화의 공통 계약을 고정 |
  | 15 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 저장 시점(개별→일괄) 전환
  을 독립 작업으로 분리 |
  | 16 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 저장된 상태를 UI 상태
  (answer/results/flags)로 재구성하기 위해 |
  | 17 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 스
  키마 검증(파싱 실패/필드 누락 방지) | QA | P | 잘못된
  JSON/legacy 데이터로 인한 런타임 오류/UX 꼬임을 방지 |
  | 18 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 데이터 감지/정책 정의 | FE | C | 기존
  submissions 일부 저장 데이터가 bulk UX와 충돌하는 문제를
  분리 |
  | 19 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장 데이터
  삭제 동작을 독립 작업으로 분리 |
  | 20 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  남아있을 수 있어 즉시 상태 초기화 필요 |
  | 21 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 상태를 방지하는 규칙을 고정 |
  | 22 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장(문자열 줄바꿈 금지) | QA | C | reviewer
  요구: 결합 패치 파싱/병합을 위해 strict JSON이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출을 제거하
  고 단일 채점 버튼을 추가한 뒤, 정규화 기반 allAnswered로
  disabled를 안정화 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT | gradeAll 결과를 result 맵
  으로 고정하고 hasGraded 게이팅 하에 점수/정답을 표시 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 기반을 이해한 뒤 bulk 스키마로 저장/복원하고
  legacy partial을 감지/정책화 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 다시 풀기 시 저장/화면 상
  태를 함께 리셋하고, 채점 후 재입력 시 결과 처리 규칙을 정
  함 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 최종 결합 패치 검증/병
  합 파이프라인을 위해 문자열 내부 줄바꿈 없이 JSON을 출력
  |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 “입력됨/미입력” 기준을 먼저
  normalizeNumericInput으로 고정해야 함 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | result 맵은 전체 채점 결과(문제
  별 결과)가 있어야 생성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  점수 X/N은 problemId별 isCorrect 집계가 선행되어야 계산
  가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  problemId별 결과가 선행되어야 함 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 “채점됨” 상태
  (hasGraded 등) 없이 구현할 수 없음 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장은 스키마 계약(저장 필
  드/형태)을 먼저 정의해야 함 | 0.80 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 UI 상태를 재구성하므로 선행 필요 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 구현은 선후가 바뀔 수
  있으나, disabled까지 함께 설계하면 UX가 빨리 안정화 |
  0.65 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 UI와 액션을 함께 설계하는 것이 안전 | 0.70 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 보통 gradeAll 완료 시 hasGraded
  를 세팅하는 흐름이 자연 | 0.74 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능하지만, 표시
  시점은 게이팅과 함께 설계하는 것이 혼란을 줄임 | 0.70 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 결과 표시도 채점
  후에만 노출되도록 게이팅과 함께 설계 권장 | 0.70 |
  | 6 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 submissions 계약을
  이해해야 bulk 저장 계약/호환 정책이 안정화 | 0.74 |
  | 7 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | validate를 복원 파이프
  라인에 넣으면 parse/legacy 오류로 인한 회귀가 감소 | 0.78
  |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial이 있을
  때만 필요하므로 조건부(권장)로 배치 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원된 결과가 있다면 “채점됨”
  상태를 함께 재구성하는 것이 자연 | 0.70 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 화면이 남아 UX가 어긋나므로 함께 수행을
  권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 재입력 시 결과를 초기화할
  지 여부가 게이팅/표시 규칙에 영향을 줌 | 0.70 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 결합 검증 파이프라인이 JSON 파
  싱에 의존하므로 strict JSON 가드가 선행됨 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI는
  원문 입력, grading은 정규화 입력을 기준으로 삼아 “입력됨/
  미입력” 판정이 어긋남 |
  normalizeNumericInput(answer).length>0를 단일 기준으로 고
  정하고 disabled/채점에서 재사용 | 0.82 |
  | 2 | LEARN_DISABLED_EDGECASES_12 | "", " ", ",", "0",
  "+", "." 같은 케이스에서 기대 동작이 불명확해 로직이 흔들
  림 | 엣지케이스 벡터를 문서화하고 normalize 결과 기반으로
  기대값을 명시 | 0.76 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems[] 기준으로 계산(useMemo)하고 로딩/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 state 업
  데이트를 섞어 사이드이펙트/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 5 | LEARN_BUILD_RESULT_MAP | 결과를 problemId로 정렬하
  지 못해 점수/표시/저장 키가 어긋남 | problemId를 단일 키
  로 고정하고 resultByProblemId를 중간 표현으로 둠 | 0.74 |
  | 6 | LEARN_GRADED_STATE_FLAG | hasGraded의 의미(gradeAll
  완료 vs 복원됨)가 불명확해 게이팅/표시가 꼬임 | “gradeAll
  수행 또는 복원된 결과 존재”를 hasGraded 정의로 명시하고
  동일 기준을 사용 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 노
  출 가능, legacy partial 결과 노출 등 표시 기준 혼란 | 점
  수/정오/정답 표시는 hasGraded일 때만 노출하도록 단일 게이
  팅 규칙 적용 | 0.74 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과만
  저장 등 스키마가 흔들리면 복원/게이팅이 연쇄로 흔들림 |
  answers+results(또는 submissions)+updatedAt(+version) 최
  소 계약을 먼저 고정 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 일부 저장 데이터가 bulk UX에서 “채점됨”처럼
  보이거나 allAnswered와 충돌 | partial 감지(저장된 문제 수
  < problems.length) 후 정책(초기화/재채점 유도)을 명시 |
  0.74 |
  | 10 | LEARN_RESET_UI_STATE | 키 삭제만 수행해 화면에 이
  전 answer/result/flags가 남아 “초기화”가 체감되지 않음 |
  reset 액션에서 localStorage 삭제와 UI 상태 리셋을 함께 수
  행 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과/점수가 스테일(불일치) 상태로 남음 | 입력 변경 시
  결과 초기화 또는 버튼을 “다시 채점”으로 전환하는 정책을
  고정 | 0.72 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 내부 줄바
  꿈 때문에 JSON 파싱이 실패해 결합 패치 검증/병합이 중단됨
  | JSON 문자열은 한 줄로 유지(또는 \n 이스케이프)하고
  strict JSON으로 출력 | 0.84 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새 제출 진입점(UI)을 먼저 제공해 기능 공백을 방
  지 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 기준 정의에서 바로 UI로
  점프하지 않고 “활성 조건 계산”을 중간에 둠 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계의 공통 입력을 result 맵으로 정규화 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  문제별 표시도 동일한 result 맵을 중간 입력으로 사용 |
  | 5 | LEARN_GRADED_STATE_FLAG → LEARN_SCORE_SUMMARY_CALC
  | LEARN_SCORE_AND_RESULT_GATING | 계산과 표시 시점을 분리
  해 채점 전 노출을 차단 |
  | 6 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 결과 표시는 게이팅을 중간
  에 두어 조기 노출을 방지 |
  | 7 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 schema 이해→새
  schema 계약→legacy 정책으로 연결하면 충돌이 줄어듦 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 전에 validate를
  두면 파싱 실패/누락 필드로 인한 회귀가 감소 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원된 결과를 “채점됨” 상태로 재구성하면 게이팅 기준이 단
  순해짐 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 저장된
  키 삭제 후 UI 리셋으로 이어지는 초기화 흐름이 자연 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_SUMMARY_CALC | LEARN_GRADED_STATE_FLAG | 편집
  정책은 “채점된 상태”를 기준으로 점수/표시 갱신 규칙을 정
  의할 수 있음 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_PERSIST_RESTORE_MIGRATION_FLOW |
  STEP_STRICT_JSON_HANDOFF | 기능 구현과 별개로 산출물
  (strict JSON) 보장이 결합 검증 파이프라인을 가능하게 함 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이지 요약", "domain": "FE", "rep": "C", "confidence":
  0.72 },
      { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA",
  "type": "micro", "name_ko": "StoredResult/submissions 스
  키마 문서화", "domain": "FE", "rep": "C", "confidence":
  0.74 },
      { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
      { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기) 추
  가", "domain": "FE", "rep": "P", "confidence": 0.85 },
      { "id":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "type":
  "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C", "confidence": 0.82 },
      { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
      { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
      { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
      { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "problemId→채점결과(resultByProblemId) 맵 생
  성", "domain": "FE", "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
      { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
      { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)", "domain": "FE", "rep": "P", "confidence": 0.78 },
      { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
      { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
      { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 스키마 검증(파싱 실패/필
  드 누락 방지)", "domain": "QA", "rep": "P", "confidence":
  0.74 },
      { "id":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "micro", "name_ko": "legacy partial 데이터 감지/정책 정
  의", "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
      { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
      { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화/다시
  채점)", "domain": "UX", "rep": "C", "confidence": 0.70 },
      { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
      { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
    ],
    "add_edges": [
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires", "reason": "스키마 문서화는 흐름 요약과 독립적
  으로도 가능해 requires 잠금은 과잉", "confidence":
  0.72 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 과잉 잠금", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부로만 필요하므로
  requires가 아니라 권장/노트가 적절", "confidence":
  0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
    ],
    "notes": [
      { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "정규화(공백/콤마 제거)
  기준과 UI 기준이 다르면 \" , \" 같은 입력에서 버튼 상태와
  채점 결과가 불일치한다.", "confidence": 0.82 },
      { "claim": "legacy partial은 조건부로 감지해 초기화/
  재채점 유도 등 정책을 적용하는 편이 안전하다.", "reason":
  "기존 per-problem 저장은 submissions 일부만 남는 것이 정
  상 동작이었고, 이를 bulk UX에 그대로 노출하면 혼란이 생긴
  다.", "confidence": 0.74 },
      { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, 점수/정답 표시는 hasGraded일 때만 노
  출한다.", "reason": "채점 전 0/N 노출 및 부분 저장 데이터
  노출을 통제하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
      { "claim": "LEARN_BUILD_RESULT_MAP은 점수/표시/저장의
  공통 중간 표현으로 유용하다.", "reason": "problemId 기반
  결과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되
  어 오류가 줄어든다.", "confidence": 0.74 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력해야 결합 패치 검증/병합이 가능하
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 DAG/
  충돌 포함 자동 검증 파이프라인을 중단시킨다.",
  "confidence": 0.84 },
      { "claim": "allAnswered와 버튼 추가는 requires로 잠그
  지 않고 병렬 구현 가능하며, disabled 로직만 연결하면 된
  다.", "reason": "UI를 먼저 만들고 disabled 조건을 나중에
  붙이는 구현 경로가 자연스럽고 회귀 위험이 낮다.",
  "confidence": 0.70 },
      { "claim": "reset은 localStorage 키 삭제와 UI 상태 리
  셋을 함께 수행하는 것이 UX 상 권장이다.", "reason": "키
  삭제만 수행하면 화면에 남아있는 answer/result/flags가 그
  대로여서 사용자가 초기화를 체감하지 못한다.",
  "confidence": 0.78 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작/상태 흐름 1페이지 요약 | LearnPage는 “문
  제
  별 제출→단건 채점→localStorage merge 저장” 구조인데, 이를
  기준선으로 요약하지 않으면 bulk 전환 시 회귀 원인을 추적
  하
  기 어려움 | 높음 |
  | 2 | StoredResult 스키마 명시(현재: submissions) | 저장/
  복원 계약이 { nodeId, updatedAt, submissions }인데 bulk
  저
  장으로 바뀔 때 호환/마이그레이션 규칙이 필요 | 높음 |
  | 3 | 단일 버튼 채점하기 UX(하단 고정) | 요구사항은 “모든
  문제 입력 후 한 번에 제출”인데 현재 UI는 문제 카드별 제출
  만 존재 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일치) | disabled 판정
  이 normalizeNumericInput()과 일관되지 않으면 " , " 같은
  입
  력에서 활성/비활성이 채점과 불일치 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | problems[] 전체에
  대
  해 정규화 후 빈 값 여부를 확인해야 “모든 문제 입력 전까지
  disabled”를 구현 가능 | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요(빈값/공백/콤마/0/부호/소수점/Infinity
  등) | 중 |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem만 있어 “한 번에 전체 채점” 동작이
  없
  음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 0/N 노출, 복원 후 표시 기준 혼란을 막기 위해 채점 전/
  후
  상태를 분리해야 함 | 중 |
  | 9 | 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노
  출
  해야 사용자 혼란(채점 전 점수 노출/legacy partial) 최소화
  | 중 |
  |10| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 “개별 제출”이 아니라 “일괄 채점 후”로 바뀌어야
  함 | 높음 |
  |11| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 한
  번
  에 복원해 UI 상태를 재구성해야 함 | 높음 |
  |12| legacy partial 호환/마이그레이션 정책 | 기존 per-
  problem 저장은 submissions 일부만 남기는 데이터가 자연스
  럽
  게 생성되므로 bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |13| 초기화(다시 풀기): localStorage 삭제 + UI 리셋 | 요
  구
  사항 4)인데 현재 사용자가 저장된 결과/답안을 지울 방법이
  없음 | 높음 |
  |14| strict JSON 출력 가드(줄바꿈 금지) | reviewer 지적처
  럼 문자열 내부 줄바꿈이 있으면 자동 파싱/병합이 실패하므
  로
  산출물 JSON은 strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 요구를 흐림 | 금지 |
  | 2 | 문제 타입 확장(서술형/객관식) | 이번 티켓은 제출
  UX/
  저장/복원이며 타입 확장은 별도 설계 필요 | 금지(후속 티
  켓)
  |
  | 3 | 채점 정책 확장(허용오차/분수/근사) | bulk 제출 UX와
  무관하며 회귀 위험만 증가 | gradeNumericAnswer() 유지 |
  | 4 | 문제은행 스키마 변경 | 데이터 구조 변경은 범위 밖이
  며 회귀 위험 큼 | problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | autosave(입력 즉시 저장) | 요구는 “채점 후 한 번에
  저장”이며 호환/정책을 복잡화 | 제외 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 액션/버튼 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 상태/표시와 충돌
  |
  legacy partial 감지 후 정책(초기화/답안만 복원/재채점 유
  도) |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 점수
  노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남아있는 answer/result/flags가 그대로 | 키 삭제 +
  UI 상태 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/ submisions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 데
  이터 호환/정책", "domain": "FE", "rep": "C",
  "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload))가 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "legacy partial 데이터는 bulk 전환 시 필연
  적으로 존재할 수 있어 복원 단계에서 감지/정책화가 필요하
  다.", "reason": "기존 per-problem 저장은 전체 문제 수보다
  적은 submissions를 남기는 것이 정상 동작이었다.",
  "confidence": 0.74 },
  { "claim": "채점 전/후 게이팅(hasGraded)은 점수/정답
  조기 노출과 저장/복원 혼선을 줄인다.", "reason": "채점 전
  0/N 노출, 부분 저장 데이터 노출을 통제하려면 표시 기준이
  필요하다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:638d80efe8###


› Improve documentation in @filename

  50% context left · ? for shortcuts


============================================================
[2026-01-08 11:27:18] RESEARCH2 (req_id: 726064d7ea)
============================================================
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만으로는 화면
  상태가 즉시 초기화되지 않아 사용자 체감이 어긋날 수 있
  다.", "confidence": 0.78 },
      { "claim": "LEARN_BUILD_RESULT_MAP은 결과 표시/점수/
  저장의 공통 중간 표현이다.", "reason": "problemId 기반 결
  과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되어
  오류가 줄어든다.", "confidence": 0.74 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작 1페이지 요약(상태 흐름/데이터 스키마) |
  LearnPage는 문제별 제출→단건 채점→localStorage merge 저장
  흐름이며 StoredResult{submissions} 계약이 기준점인데, 이
  를
  명시 요약하지 않으면 변경 시 회귀가 발생 | 높음 |
  | 2 | 문제 카드별 제출 버튼 제거 | 요구사항 핵심(개별 제
  출
  제거)인데 현재 UI는 per-problem 제출에 고정 | 높음 |
  | 3 | 페이지 하단 단일 버튼 채점하기(전체 제출) | 일괄 채
  점 UX의 유일한 진입점이 필요하나 현재 없음 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 버튼 활성/비활성이 채점과 엇갈림 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | “모든 문제 답 입력
  전까지 disabled”를 problems[] 기준으로 안정적으로 계산하
  는
  로직이 필요(로딩/문제수 변화 포함) | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요: "", "   ", "\t\n", ",", " , , ",
  "1,234", " 1 234 ", "0", "-0", "+", ".", "Infinity" | 중
  |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem(problem)만 존재해 “한 번에 전체 채
  점” 동작이 없음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전에도 점수/정답이 노출되거나(0/N) 저장/복원 시 상태가 꼬
  이는 것을 막기 위한 상태 기준이 필요 | 중 |
  | 9 | 문제별 결과 표시(정오/정답) 정책(일괄 채점 후) | 요
  구는 채점 후 각 문제 카드에 정오/정답 표시인데, 현재는 단
  건 제출 시에만 결과가 생김 | 높음 |
  |10| 총점 X/N 표시 정책(채점 후에만) | 상단 점수는 채점
  후
  에만 의미가 있으나 현재 구조는 “결과 일부 존재”만으로 0/N
  노출 가능 | 중 |
  |11| 저장/복원 계약(답안+채점결과를 한 번에 저장/복원) |
  요구는 일괄 채점 후 저장/복원인데, 현재는 문제별 제출 시
  마
  다 submissions를 merge 저장 | 높음 |
  |12| legacy partial(기존 부분 제출 데이터) 호환/마이그레
  이
  션 | 기존 데이터가 일부 문제만 채점/저장된 형태로 남아 있
  을 수 있어 bulk 전환 시 복원/disabled/표시가 꼬임 | 높음
  |
  |13| 다시 풀기(초기화): 키 삭제 + UI 상태 리셋 | 요구사항
  4)인데 현재는 사용자가 저장된 결과/답안을 삭제할 UX가 없
  음
  | 높음 |
  |14| 채점 후 재입력 정책(스테일 결과 처리) | 채점 후 입력
  변경 시 결과/점수와 입력이 불일치하는 스테일 상태가 발생
  할
  수 있어 정책이 필요 | 중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope(서버 연동) 위반이
  며
  localStorage 요구를 흐림 | 금지(이번 범위 밖) |
  | 2 | 문제 타입 확장(서술형/객관식 등) | 이번 티켓은 제출
  UX/저장/복원이며 타입 확장은 별도 사양 필요 | 금지(후속
  티
  켓) |
  | 3 | grading 대개편(허용오차/분수/근삿값) | 요구는 일괄
  제출 UX이며 채점 정책 변경은 회귀 위험만 증대 | 기존
  gradeNumericAnswer() 유지 |
  | 4 | 문제은행 JSON 스키마 변경 | 로딩/데이터 구조 변경은
  범위 밖이며 회귀 위험 큼 | 기존 problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand 등) | LearnPage 단
  일 화면 상태로 충분, 도입은 과잉 | React state/useMemo로
  해결 |
  | 6 | 입력 중 실시간 autosave | 요구는 “채점 후 한 번에
  저
  장”이며 autosave는 정책/호환을 복잡화 | 이번 범위에서 제
  외
  |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 제출 미구현 | 제거만 하면
  채
  점/저장 경로가 사라져 기능 공백 발생 | 단일 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 입력 기준) → 채점(정규화 기준) | " ,
  "
  같은 케이스에서 버튼 활성/비활성과 채점 결과가 불일치 |
  disabled 판정은 normalizeNumericInput(answer).length>0로
  고정 |
  | 3 | 일괄 저장(한 번에 저장) → 기존 partial 데이터 복원
  |
  legacy partial이 “채점됨”처럼 보이거나 allAnswered와 충돌
  | partial 감지 후 정책(초기화/답안만 복원/재채점 요구) 정
  의 |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 0/N 노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과/점수 유지 | 입력과 결과가
  불일치(스테일) 상태가 발생 | 입력 변경 시 결과 초기화 또
  는
  버튼을 다시 채점으로 전환 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | localStorage만
  지
  우면 화면은 이전 결과/답안을 계속 표시 | 키 삭제 +
  answerByProblemId/resultByProblemId/hasGraded 리셋 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "disabled/정규화 입력 엣지케이스 12종
  정의", "domain": "QA", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "기존 부분 제출 데이터 호환/
  마
  이그레이션 규칙", "domain": "FE", "rep": "C",
  "confidence": 0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answerByProblemId/
  results/hasGraded)", "domain": "FE", "rep": "P",
  "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제 카드별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입과 submitProblem의
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason": "grading.ts의
  normalizeNumericInput은 공백/콤마 제거를 수행하므로,
  disabled가 원문 기준이면 '입력됨/미입력'이 채점과 불일치
  한
  다.", "confidence": 0.82 },
  { "claim": "bulk 전환 시 legacy partial(일부 문제만
  submissions에 존재) 데이터가 자연스럽게 존재하므로 호환/
  마
  이그레이션 정책이 필요하다.", "reason": "기존 구현은 문제
  별 제출 시마다 submissions를 누적 저장하므로 전체 문제 수
  보다 적은 저장 데이터가 생성된다.", "confidence": 0.78 },
  { "claim": "점수/정오/정답 표시는 hasGraded 같은 상태
  로 게이팅해야 한다.", "reason": "채점 전 0/N 노출 및 저
  장/
  복원 시 표시 기준 혼란을 막기 위해 채점 전/후를 분리해야
  한다.", "confidence": 0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI 상태
  리셋을 함께 수행해야 한다.", "reason": "키 삭제만으로는
  화
  면에 남아있는 answer/result 상태가 즉시 초기화되지 않아
  UX
  가 어긋난다.", "confidence": 0.78 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:df518817a7###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_638d80efe8.md


  61% context left



› Request 638d80efe8: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_638d80efe8.md


    Read research_638d80efe8.md                         

• Ensuring name consistency in JSON (5m 21s • esc to interr


› Improve documentation in @filename

  94% context left · ? for shortcuts


• Explored
  └ Read research_638d80efe8.md
    Search Output Format|## Rules|\[/R1 Coverage Report\]|
^##
           Coverage Gap Report in research_638d80efe8.md
    Read research_638d80efe8.md

─ Worked for 5m 21s ───────────────────────────────────────

• ###BEGIN:638d80efe8###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 1페이지 요약 | FE | C | 변경 전 기준선(상태/
  저장 시점)을 고정해 회귀를 줄이기 위해 |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA | StoredResult/
  submissions 스키마 문서화 | FE | C | bulk 저장/복원/호환
  을 설계하려면 기존 저장 계약을 먼저 명시해야 함 |
  | 3 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1)의 핵심(개별 제출 경로 제
  거)을 독립 작업으로 분리 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON | 페이지 하단 단일 버튼
  (채점하기) 추가 | FE | P | 일괄 채점 UX의 단일 진입점을
  구현하기 위해 |
  | 5 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 판정 기준을 normalizeNumericInput과 일치 | FE |
  C | UI 입력 판정과 grading 판정이 어긋나면 기능/UX가 붕괴
  하기 때문 |
  | 6 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  정의(빈값/공백/콤마/0/부호/소수점 등) | QA | C |
  disabled/정규화 일관성을 케이스 기반으로 고정해 회귀를 줄
  이기 위해 |
  | 7 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지
  disabled”를 problems[] 기준으로 안정화 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 9 | LEARN_BUILD_RESULT_MAP | problemId→채점결과
  (resultByProblemId) 맵 생성 | FE | P | 점수/표시/저장을
  같은 키로 정렬하는 중간 표현이 필요 |
  | 10 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전 점수 노출, 복원 후
  표시 기준 혼선을 막는 기준점 |
  | 11 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 요구사항 2) 점수 요약 표시를 별도 계산
  단위로 분리 |
  | 12 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 결과 노출 및
  legacy partial 노출 혼란을 차단 |
  | 13 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 문제 카드별 결
  과 표시를 독립 작업으로 분리 |
  | 14 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션/
  초기화의 공통 계약을 고정 |
  | 15 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 저장 시점(개별→일괄) 전환
  을 독립 작업으로 분리 |
  | 16 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 저장된 상태를 UI 상태
  (answer/results/flags)로 재구성하기 위해 |
  | 17 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 스
  키마 검증(파싱 실패/필드 누락 방지) | QA | P | 잘못된
  JSON/legacy 데이터로 인한 런타임 오류/UX 꼬임을 방지 |
  | 18 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 데이터 감지/정책 정의 | FE | C | 기존
  submissions 일부 저장 데이터가 bulk UX와 충돌하는 문제를
  분리 |
  | 19 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장 데이터
  삭제 동작을 독립 작업으로 분리 |
  | 20 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  남아있을 수 있어 즉시 상태 초기화 필요 |
  | 21 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 상태를 방지하는 규칙을 고정 |
  | 22 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장(문자열 줄바꿈 금지) | QA | C | reviewer
  요구: 결합 패치 파싱/병합을 위해 strict JSON이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출을 제거하
  고 단일 채점 버튼을 추가한 뒤, 정규화 기반 allAnswered로
  disabled를 안정화 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT | gradeAll 결과를 result 맵
  으로 고정하고 hasGraded 게이팅 하에 점수/정답을 표시 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 기반을 이해한 뒤 bulk 스키마로 저장/복원하고
  legacy partial을 감지/정책화 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 다시 풀기 시 저장/화면 상
  태를 함께 리셋하고, 채점 후 재입력 시 결과 처리 규칙을 정
  함 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 최종 결합 패치 검증/병
  합 파이프라인을 위해 문자열 내부 줄바꿈 없이 JSON을 출력
  |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 “입력됨/미입력” 기준을 먼저
  normalizeNumericInput으로 고정해야 함 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | result 맵은 전체 채점 결과(문제
  별 결과)가 있어야 생성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  점수 X/N은 problemId별 isCorrect 집계가 선행되어야 계산
  가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  problemId별 결과가 선행되어야 함 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 “채점됨” 상태
  (hasGraded 등) 없이 구현할 수 없음 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장은 스키마 계약(저장 필
  드/형태)을 먼저 정의해야 함 | 0.80 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 UI 상태를 재구성하므로 선행 필요 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 구현은 선후가 바뀔 수
  있으나, disabled까지 함께 설계하면 UX가 빨리 안정화 |
  0.65 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 UI와 액션을 함께 설계하는 것이 안전 | 0.70 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 보통 gradeAll 완료 시 hasGraded
  를 세팅하는 흐름이 자연 | 0.74 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능하지만, 표시
  시점은 게이팅과 함께 설계하는 것이 혼란을 줄임 | 0.70 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 결과 표시도 채점
  후에만 노출되도록 게이팅과 함께 설계 권장 | 0.70 |
  | 6 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 submissions 계약을
  이해해야 bulk 저장 계약/호환 정책이 안정화 | 0.74 |
  | 7 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | validate를 복원 파이프
  라인에 넣으면 parse/legacy 오류로 인한 회귀가 감소 | 0.78
  |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial이 있을
  때만 필요하므로 조건부(권장)로 배치 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원된 결과가 있다면 “채점됨”
  상태를 함께 재구성하는 것이 자연 | 0.70 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 화면이 남아 UX가 어긋나므로 함께 수행을
  권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 재입력 시 결과를 초기화할
  지 여부가 게이팅/표시 규칙에 영향을 줌 | 0.70 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 결합 검증 파이프라인이 JSON 파
  싱에 의존하므로 strict JSON 가드가 선행됨 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI는
  원문 입력, grading은 정규화 입력을 기준으로 삼아 “입력됨/
  미입력” 판정이 어긋남 |
  normalizeNumericInput(answer).length>0를 단일 기준으로 고
  정하고 disabled/채점에서 재사용 | 0.82 |
  | 2 | LEARN_DISABLED_EDGECASES_12 | "", " ", ",", "0",
  "+", "." 같은 케이스에서 기대 동작이 불명확해 로직이 흔들
  림 | 엣지케이스 벡터를 문서화하고 normalize 결과 기반으로
  기대값을 명시 | 0.76 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems[] 기준으로 계산(useMemo)하고 로딩/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 state 업
  데이트를 섞어 사이드이펙트/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 5 | LEARN_BUILD_RESULT_MAP | 결과를 problemId로 정렬하
  지 못해 점수/표시/저장 키가 어긋남 | problemId를 단일 키
  로 고정하고 resultByProblemId를 중간 표현으로 둠 | 0.74 |
  | 6 | LEARN_GRADED_STATE_FLAG | hasGraded의 의미(gradeAll
  완료 vs 복원됨)가 불명확해 게이팅/표시가 꼬임 | “gradeAll
  수행 또는 복원된 결과 존재”를 hasGraded 정의로 명시하고
  동일 기준을 사용 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 노
  출 가능, legacy partial 결과 노출 등 표시 기준 혼란 | 점
  수/정오/정답 표시는 hasGraded일 때만 노출하도록 단일 게이
  팅 규칙 적용 | 0.74 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과만
  저장 등 스키마가 흔들리면 복원/게이팅이 연쇄로 흔들림 |
  answers+results(또는 submissions)+updatedAt(+version) 최
  소 계약을 먼저 고정 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 일부 저장 데이터가 bulk UX에서 “채점됨”처럼
  보이거나 allAnswered와 충돌 | partial 감지(저장된 문제 수
  < problems.length) 후 정책(초기화/재채점 유도)을 명시 |
  0.74 |
  | 10 | LEARN_RESET_UI_STATE | 키 삭제만 수행해 화면에 이
  전 answer/result/flags가 남아 “초기화”가 체감되지 않음 |
  reset 액션에서 localStorage 삭제와 UI 상태 리셋을 함께 수
  행 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 입력 수정
  시 결과/점수가 스테일(불일치) 상태로 남음 | 입력 변경 시
  결과 초기화 또는 버튼을 “다시 채점”으로 전환하는 정책을
  고정 | 0.72 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 내부 줄바
  꿈 때문에 JSON 파싱이 실패해 결합 패치 검증/병합이 중단됨
  | JSON 문자열은 한 줄로 유지(또는 \n 이스케이프)하고
  strict JSON으로 출력 | 0.84 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새 제출 진입점(UI)을 먼저 제공해 기능 공백을 방
  지 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 기준 정의에서 바로 UI로
  점프하지 않고 “활성 조건 계산”을 중간에 둠 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계의 공통 입력을 result 맵으로 정규화 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  문제별 표시도 동일한 result 맵을 중간 입력으로 사용 |
  | 5 | LEARN_GRADED_STATE_FLAG → LEARN_SCORE_SUMMARY_CALC
  | LEARN_SCORE_AND_RESULT_GATING | 계산과 표시 시점을 분리
  해 채점 전 노출을 차단 |
  | 6 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 결과 표시는 게이팅을 중간
  에 두어 조기 노출을 방지 |
  | 7 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 schema 이해→새
  schema 계약→legacy 정책으로 연결하면 충돌이 줄어듦 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 전에 validate를
  두면 파싱 실패/누락 필드로 인한 회귀가 감소 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원된 결과를 “채점됨” 상태로 재구성하면 게이팅 기준이 단
  순해짐 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 저장된
  키 삭제 후 UI 리셋으로 이어지는 초기화 흐름이 자연 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_SUMMARY_CALC | LEARN_GRADED_STATE_FLAG | 편집
  정책은 “채점된 상태”를 기준으로 점수/표시 갱신 규칙을 정
  의할 수 있음 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_PERSIST_RESTORE_MIGRATION_FLOW |
  STEP_STRICT_JSON_HANDOFF | 기능 구현과 별개로 산출물
  (strict JSON) 보장이 결합 검증 파이프라인을 가능하게 함 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이지 요약", "domain": "FE", "rep": "C", "confidence":
  0.72 },
      { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA",
  "type": "micro", "name_ko": "StoredResult/submissions 스
  키마 문서화", "domain": "FE", "rep": "C", "confidence":
  0.74 },
      { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
      { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기) 추
  가", "domain": "FE", "rep": "P", "confidence": 0.85 },
      { "id":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "type":
  "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C", "confidence": 0.82 },
      { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
      { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
      { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
      { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "problemId→채점결과(resultByProblemId) 맵 생
  성", "domain": "FE", "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
      { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.74 },
      { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
      { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)", "domain": "FE", "rep": "P", "confidence": 0.78 },
      { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
      { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
      { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 스키마 검증(파싱 실패/필
  드 누락 방지)", "domain": "QA", "rep": "P", "confidence":
  0.74 },
      { "id":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "type":
  "micro", "name_ko": "legacy partial 데이터 감지/정책 정
  의", "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
      { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
      { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화/다시
  채점)", "domain": "UX", "rep": "C", "confidence": 0.70 },
      { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
      { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
    ],
    "add_edges": [
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires", "reason": "스키마 문서화는 흐름 요약과 독립적
  으로도 가능해 requires 잠금은 과잉", "confidence":
  0.72 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 과잉 잠금", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부로만 필요하므로
  requires가 아니라 권장/노트가 적절", "confidence":
  0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
    ],
    "notes": [
      { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "정규화(공백/콤마 제거)
  기준과 UI 기준이 다르면 \" , \" 같은 입력에서 버튼 상태와
  채점 결과가 불일치한다.", "confidence": 0.82 },
      { "claim": "legacy partial은 조건부로 감지해 초기화/
  재채점 유도 등 정책을 적용하는 편이 안전하다.", "reason":
  "기존 per-problem 저장은 submissions 일부만 남는 것이 정
  상 동작이었고, 이를 bulk UX에 그대로 노출하면 혼란이 생긴
  다.", "confidence": 0.74 },
      { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, 점수/정답 표시는 hasGraded일 때만 노
  출한다.", "reason": "채점 전 0/N 노출 및 부분 저장 데이터
  노출을 통제하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
      { "claim": "LEARN_BUILD_RESULT_MAP은 점수/표시/저장의
  공통 중간 표현으로 유용하다.", "reason": "problemId 기반
  결과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되
  어 오류가 줄어든다.", "confidence": 0.74 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력해야 결합 패치 검증/병합이 가능하
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 DAG/
  충돌 포함 자동 검증 파이프라인을 중단시킨다.",
  "confidence": 0.84 },
      { "claim": "allAnswered와 버튼 추가는 requires로 잠그
  지 않고 병렬 구현 가능하며, disabled 로직만 연결하면 된
  다.", "reason": "UI를 먼저 만들고 disabled 조건을 나중에
  붙이는 구현 경로가 자연스럽고 회귀 위험이 낮다.",
  "confidence": 0.70 },
      { "claim": "reset은 localStorage 키 삭제와 UI 상태 리
  셋을 함께 수행하는 것이 UX 상 권장이다.", "reason": "키
  삭제만 수행하면 화면에 남아있는 answer/result/flags가 그
  대로여서 사용자가 초기화를 체감하지 못한다.",
  "confidence": 0.78 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작/상태 흐름 1페이지 요약 | LearnPage는 “문
  제
  별 제출→단건 채점→localStorage merge 저장” 구조인데, 이를
  기준선으로 요약하지 않으면 bulk 전환 시 회귀 원인을 추적
  하
  기 어려움 | 높음 |
  | 2 | StoredResult 스키마 명시(현재: submissions) | 저장/
  복원 계약이 { nodeId, updatedAt, submissions }인데 bulk
  저
  장으로 바뀔 때 호환/마이그레이션 규칙이 필요 | 높음 |
  | 3 | 단일 버튼 채점하기 UX(하단 고정) | 요구사항은 “모든
  문제 입력 후 한 번에 제출”인데 현재 UI는 문제 카드별 제출
  만 존재 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일치) | disabled 판정
  이 normalizeNumericInput()과 일관되지 않으면 " , " 같은
  입
  력에서 활성/비활성이 채점과 불일치 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | problems[] 전체에
  대
  해 정규화 후 빈 값 여부를 확인해야 “모든 문제 입력 전까지
  disabled”를 구현 가능 | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요(빈값/공백/콤마/0/부호/소수점/Infinity
  등) | 중 |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem만 있어 “한 번에 전체 채점” 동작이
  없
  음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 0/N 노출, 복원 후 표시 기준 혼란을 막기 위해 채점 전/
  후
  상태를 분리해야 함 | 중 |
  | 9 | 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노
  출
  해야 사용자 혼란(채점 전 점수 노출/legacy partial) 최소화
  | 중 |
  |10| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 “개별 제출”이 아니라 “일괄 채점 후”로 바뀌어야
  함 | 높음 |
  |11| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 한
  번
  에 복원해 UI 상태를 재구성해야 함 | 높음 |
  |12| legacy partial 호환/마이그레이션 정책 | 기존 per-
  problem 저장은 submissions 일부만 남기는 데이터가 자연스
  럽
  게 생성되므로 bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |13| 초기화(다시 풀기): localStorage 삭제 + UI 리셋 | 요
  구
  사항 4)인데 현재 사용자가 저장된 결과/답안을 지울 방법이
  없음 | 높음 |
  |14| strict JSON 출력 가드(줄바꿈 금지) | reviewer 지적처
  럼 문자열 내부 줄바꿈이 있으면 자동 파싱/병합이 실패하므
  로
  산출물 JSON은 strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 요구를 흐림 | 금지 |
  | 2 | 문제 타입 확장(서술형/객관식) | 이번 티켓은 제출
  UX/
  저장/복원이며 타입 확장은 별도 설계 필요 | 금지(후속 티
  켓)
  |
  | 3 | 채점 정책 확장(허용오차/분수/근사) | bulk 제출 UX와
  무관하며 회귀 위험만 증가 | gradeNumericAnswer() 유지 |
  | 4 | 문제은행 스키마 변경 | 데이터 구조 변경은 범위 밖이
  며 회귀 위험 큼 | problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | autosave(입력 즉시 저장) | 요구는 “채점 후 한 번에
  저장”이며 호환/정책을 복잡화 | 제외 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 액션/버튼 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 상태/표시와 충돌
  |
  legacy partial 감지 후 정책(초기화/답안만 복원/재채점 유
  도) |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 점수
  노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남아있는 answer/result/flags가 그대로 | 키 삭제 +
  UI 상태 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/ submisions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 데
  이터 호환/정책", "domain": "FE", "rep": "C",
  "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload))가 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "legacy partial 데이터는 bulk 전환 시 필연
  적으로 존재할 수 있어 복원 단계에서 감지/정책화가 필요하
  다.", "reason": "기존 per-problem 저장은 전체 문제 수보다
  적은 submissions를 남기는 것이 정상 동작이었다.",
  "confidence": 0.74 },
  { "claim": "채점 전/후 게이팅(hasGraded)은 점수/정답
  조기 노출과 저장/복원 혼선을 줄인다.", "reason": "채점 전
  0/N 노출, 부분 저장 데이터 노출을 통제하려면 표시 기준이
  필요하다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:638d80efe8###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_726064d7ea.md


  50% context left



› Request 726064d7ea: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_726064d7ea.md


    Read research_726064d7ea.md                         

• Planning New Graph Nodes and Edges (5m 43s • esc to inter


› Improve documentation in @filename

  91% context left · ? for shortcuts


• Explored
  └ Read research_726064d7ea.md
    Search Output Format|## Rules|\[/R1 Coverage Report\]|
^##
           Coverage Gap Report in research_726064d7ea.md
    Read research_726064d7ea.md

─ Worked for 5m 43s ───────────────────────────────────────

• ###BEGIN:726064d7ea###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 기준선 요약 | FE | C | 변경 전 상태(단건 채
  점/merge 저장)를 기준점으로 고정해야 회귀를 줄일 수 있음
  |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA |
  StoredResult(submissions) 스키마 명시 | FE | C | 저장/복
  원 계약이 흔들리면 bulk 전환 시 호환/마이그레이션 논의가
  붕괴 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화가 모두 동일 키 계약에 의
  존 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1) 핵심 변경(개별 제출 경로
  제거)을 독립 작업으로 분리 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기(전
  체 제출) 버튼 추가 | FE | P | bulk UX의 단일 진입점을 구
  현하기 위해 |
  | 6 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 기준을 normalizeNumericInput과 일치 | FE | C |
  입력 판정이 grading과 불일치하면 disabled/채점 결과가 엇
  갈려 UX가 붕괴 |
  | 7 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  정의(빈값/공백/콤마/0/부호/소수점 등) | QA | C |
  disabled/정규화 일관성을 케이스 기반으로 고정해 회귀를 줄
  이기 위해 |
  | 8 | LEARN_BUILD_ANSWER_STATE_MAP | answerByProblemId 상
  태 맵 유지 | FE | P | allAnswered/저장/복원을 위해 “문제
  ID→답” 표현을 안정화 |
  | 9 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지 disabled”
  조건을 problems[] 기준으로 안정화 |
  | 10 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 11 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장을 동일
  키(problemId)로 정렬하는 중간 표현이 필요 |
  | 12 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전 0/N 노출, 복원 후
  표시 기준 혼란을 막는 기준점 |
  | 13 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 요구사항 2) 상단 점수 요약을 안정적으로
  집계/표시 |
  | 14 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 결과 노출 및
  legacy partial 노출 혼란을 차단 |
  | 15 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 문제 카드별 결
  과 표시를 독립 작업으로 분리 |
  | 16 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 채점 후 재입력 정책과
  결합해 사용자가 다음 행동을 오해하지 않게 하기 위해 |
  | 17 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 상태를 방지하는 규칙을 고정 |
  | 18 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션/
  초기화의 공통 계약을 고정 |
  | 19 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(일
  괄 채점 후) 전환을 구현 |
  | 20 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/검증 규칙(JSON shape validate) | FE | C | 잘못된/
  legacy 데이터로 인한 런타임 오류와 UX 꼬임을 방지 |
  | 21 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 저장된 상태를 UI
  상태로 재구성 |
  | 22 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial(부분 제출) 호환/정책 | FE | C | 기존
  submissions 일부 저장 데이터가 bulk UX와 충돌하는 문제를
  분리 |
  | 23 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장된 결과/
  답안을 삭제 |
  | 24 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  즉시 초기화되지 않아 UI 리셋이 필요 |
  | 25 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장(문자열 줄바꿈 금지) | QA | C | 자동 파
  싱/병합 파이프라인을 위해 산출물 JSON 형식을 실제로 보장
  |
  | 26 | LEARN_JSON_VALIDATE_PARSE | Graph Patch JSON 파싱
  검증(파서 통과 확인) | QA | P | “strict JSON” 준수 여부를
  자동으로 확인할 단일 체크 동작이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_UI_DISABLED_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_BUILD_ANSWER_STATE_MAP,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출을 제거하
  고 단일 채점 버튼을 추가한 뒤, 정규화 기반 allAnswered로
  disabled를 안정화 |
  | 2 | STEP_BULK_GRADE_DISPLAY_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT,
  LEARN_AFTER_GRADE_EDIT_POLICY,
  LEARN_GRADE_BUTTON_LABEL_STATE | gradeAll 결과를 result
  맵으로 고정하고 hasGraded 게이팅 하에 점수/정답을 표시,
  채점 후 편집 정책에 따라 버튼 상태를 정합화 |
  | 3 | STEP_STORAGE_FLOW | 저장/복원/legacy 처리 |
  LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
  LEARN_IDENTIFY_STORAGE_KEY,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존 저장
  계약을 이해한 뒤 bulk 스키마로 저장/복원하고 legacy
  partial을 감지/정책화 |
  | 4 | STEP_RESET_FLOW | 다시 풀기(키 삭제+UI 리셋) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |
  | 5 | STEP_OUTPUT_STRICT_JSON_FLOW | 산출물 strict JSON
  보장 | LEARN_STRICT_JSON_OUTPUT_GUARD,
  LEARN_JSON_VALIDATE_PARSE | 결합 패치 검증/병합이 가능하
  도록 JSON 문자열 줄바꿈 금지 및 파싱 검증을 수행 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장 대상 키를 모르면 저장
  위치가 달라져 저장/복원/초기화가 불일치함 | 0.72 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 특정 키에서 읽어
  야 하므로 키 계약이 선행되어야 함 | 0.72 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_RESET_CLEAR_STORAGE | 초기화는 삭제 대상 키를 알아
  야 수행 가능 | 0.72 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 “입력됨/미입력” 기준을 먼저 고정해야 함 |
  0.82 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | result 맵은 문제별 채점 결과가
  있어야 생성 가능 | 0.78 |
  | 6 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 X/N은 problemId별 결과 집계가 선행되어야 계산 가능 |
  0.76 |
  | 7 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  problemId별 결과가 선행되어야 함 | 0.78 |
  | 8 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 “채점됨” 상태
  (hasGraded 등) 없이 구현할 수 없음 | 0.76 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 계약이 먼저 필요 | 0.80 |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 UI 상태를 재구성하므로 선행 필요 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 submitProblem/저장
  흐름을 알면 제거 시 사이드이펙트 회귀를 줄일 수 있음 |
  0.65 |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 submissions 계약을
  이해해야 bulk 저장 계약/호환 정책이 안정화 | 0.74 |
  | 3 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 엣지케이스 벡터가 있으면
  disabled/정규화 불일치 회귀가 감소 | 0.76 |
  | 4 | LEARN_BUILD_ANSWER_STATE_MAP →
  LEARN_ALL_ANSWERED_NORMALIZED | 답안 상태 표현을 안정화하
  면 allAnswered 계산이 단순/견고해짐 | 0.72 |
  | 5 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 UI는 독립 구현 가능하
  지만, disabled까지 함께 설계하면 UX가 빨리 안정화 | 0.65
  |
  | 6 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 UI와 액션을 함께 설계하는 것이 안전 | 0.70 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 보통 gradeAll 완료 시 hasGraded
  를 세팅하는 흐름이 자연 | 0.74 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능하지만, 표시
  시점은 게이팅과 함께 설계하는 것이 혼란을 줄임 | 0.70 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과 표시는 채점 후에만
  노출되도록 게이팅과 함께 설계 권장 | 0.70 |
  | 10 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | validate를 복원 파이프
  라인에 넣으면 parse/legacy 오류로 인한 회귀가 감소 | 0.78
  |
  | 11 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial은 조건부
  이므로 발견 시 정책 적용 흐름을 권장 | 0.74 |
  | 12 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 화면이 남아 UX가 어긋나므로 함께 수행을
  권장 | 0.78 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADE_BUTTON_LABEL_STATE | 편집 정책에 따라 버튼이
  “다시 채점/채점하기”로 일관되게 전환됨 | 0.70 |
  | 14 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  LEARN_JSON_VALIDATE_PARSE | 가드(규칙)만 두지 말고 실제
  파싱 검증으로 준수 여부를 확인하는 것이 안전 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI는
  원문 입력을 보고, grading은 정규화 입력을 보는 불일치로
  disabled/채점이 엇갈림 |
  normalizeNumericInput(answer).length>0를 단일 기준으로 고
  정하고 모든 판정에서 재사용 | 0.82 |
  | 2 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", ".",
  "Infinity" 등에서 “미입력/입력” 기대가 모호해 구현이 흔들
  림 | 엣지케이스를 테스트 벡터로 문서화하고 normalize 결과
  기반 기대값을 명시 | 0.76 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems[] 기준으로 계산(useMemo)하고 로딩/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 4 | LEARN_BUILD_ANSWER_STATE_MAP | 문제 ID 매칭/상태 업
  데이트가 꼬여 특정 문제 답이 누락/덮어씀 |
  answerByProblemId는 problemId 키로만 갱신하고 problems 변
  경 시 정합성 점검 | 0.70 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 state 업
  데이트를 섞어 사이드이펙트/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 6 | LEARN_BUILD_RESULT_MAP | 결과를 problemId로 정렬하
  지 못해 점수/표시/저장 키가 어긋남 | resultByProblemId를
  단일 중간 표현으로 두고 모든 집계/표시에 동일 키를 사용 |
  0.74 |
  | 7 | LEARN_GRADED_STATE_FLAG | hasGraded의 의미(gradeAll
  완료 vs 복원됨 vs partial)가 불명확해 게이팅이 꼬임 |
  “bulk 결과 존재 시 graded” 등 단일 정의를 정하고 저장/복
  원 시 동일 기준 적용 | 0.74 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 노
  출, legacy partial 노출 등 표시 기준 혼란 | 점수/정오/정
  답 표시는 hasGraded일 때만 노출하도록 단일 게이팅 규칙 적
  용 | 0.74 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과만
  저장 등 스키마가 흔들리면 복원/게이팅이 연쇄로 흔들림 |
  answers+results(+updatedAt/+version) 최소 계약을 먼저 고
  정하고 이를 기준으로 구현 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 일부 저장 데이터가 bulk UX에서 “채점됨”처럼
  보이거나 allAnswered와 충돌 | partial 감지(저장된 문제 수
  < problems.length) 후 정책(초기화/재채점 유도)을 명시 |
  0.74 |
  | 11 | LEARN_RESET_UI_STATE | 키 삭제만 수행해 화면에 이
  전 answer/result/flags가 남아 “초기화”가 체감되지 않음 |
  reset 액션에서 localStorage 삭제와 UI 상태 리셋을 함께 수
  행 | 0.78 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 내부 줄바
  꿈 때문에 JSON 파싱이 실패해 결합 패치 검증/병합이 중단됨
  | 모든 문자열을 한 줄로 유지(또는 \n 이스케이프)하고
  LEARN_JSON_VALIDATE_PARSE로 파싱 통과를 확인 | 0.84 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새 제출 진입점(UI)을 먼저 제공해 기능 공백을 방
  지 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 기준 정의에서 UI로 점프하
  지 않고 “활성 조건 계산”을 중간에 둠 |
  | 3 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴하므로 기준 노드가 브릿
  지 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계의 공통 입력을 result 맵으로 정규화 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  문제별 표시도 동일한 result 맵을 중간 입력으로 사용 |
  | 6 | LEARN_GRADED_STATE_FLAG → LEARN_SCORE_SUMMARY_CALC
  | LEARN_SCORE_AND_RESULT_GATING | 계산과 표시 시점을 분리
  해 채점 전 노출을 차단 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 결과 표시는 게이팅을 중간
  에 두어 조기 노출을 방지 |
  | 8 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 schema 이해→새
  schema 계약→legacy 정책으로 연결하면 충돌이 줄어듦 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 전에 validate를
  두면 파싱 실패/누락 필드로 인한 회귀가 감소 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 저장된
  키 삭제 후 UI 리셋으로 이어지는 초기화 흐름이 자연 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_SUMMARY_CALC | LEARN_GRADE_BUTTON_LABEL_STATE
  | 정책을 버튼 상태 전환으로 연결하면 사용자가 “다시 채점”
  필요를 이해하기 쉬움 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD → Graph Patch JSON
  출력 | LEARN_JSON_VALIDATE_PARSE | 가드만 두지 말고 파서
  통과 검증을 중간에 둬서 “실제 strict”를 보장 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type":
  "micro", "name_ko": "localStorage 키 포맷 식별",
  "domain": "FE", "rep": "C", "confidence": 0.72 },
      { "id": "LEARN_BUILD_ANSWER_STATE_MAP", "type":
  "micro", "name_ko": "answerByProblemId 상태 맵 유지",
  "domain": "FE", "rep": "P", "confidence": 0.72 },
      { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
      { "id": "LEARN_JSON_VALIDATE_PARSE", "type": "micro",
  "name_ko": "Graph Patch JSON 파싱 검증(파서 통과 확인)",
  "domain": "QA", "rep": "P", "confidence": 0.84 },
      { "id": "STEP_BULK_UI_DISABLED_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_DISPLAY_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_STORAGE_FLOW", "type": "step",
  "name_ko": "저장/복원/legacy 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_FLOW", "type": "step", "name_ko":
  "다시 풀기(키 삭제+UI 리셋)", "domain": "FE", "rep": "C",
  "confidence": 0.72 },
      { "id": "STEP_OUTPUT_STRICT_JSON_FLOW", "type":
  "step", "name_ko": "산출물 strict JSON 보장", "domain":
  "QA", "rep": "C", "confidence": 0.84 }
    ],
    "add_edges": [
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.72 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires", "reason": "흐름 요약과 스키마 문서화는 병렬로
  도 가능해 requires 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 UI는 allAnswered 구현과 독립적으로 가능하
  므로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "validate는 안정성을 높이는 권장 선행이며 복원
  의 필수 잠금은 아님", "confidence": 0.78 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부이므로 requires가 아니
  라 권장/노트가 적절", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원된 결과 존재로 hasGraded를 파생할 수 있어 단일 잠금
  은 과잉", "confidence": 0.70 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
    ],
    "notes": [
      { "claim": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE는 복원
  안정성을 높이는 권장 선행이며 requires로 잠그지 않는다.",
  "reason": "parse/shape validation이 없어도 복원은 가능하
  지만, 잘못된 데이터로 인한 런타임 오류를 줄이려면
  validate 단계가 유용하다.", "confidence": 0.78 },
      { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "모든 사용자에게 legacy 데이터가 존재하는 것은
  아니므로 requires 잠금은 과잉 선행이 될 수 있다.",
  "confidence": 0.74 },
      { "claim": "완전 초기화 UX는
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만 수행하면
  화면에 남아있는 answer/result/flags가 그대로여서 사용자가
  초기화를 체감하지 못한다.", "confidence": 0.78 },
      { "claim": "LEARN_GRADE_BUTTON_LABEL_STATE는 채점 후
  편집 정책을 사용자가 이해하는 데 도움이 된다.", "reason":
  "입력 변경 시 결과를 초기화하는 경우 버튼을 \"다시 채점
  \"으로 전환하면 스테일 결과를 줄이고 다음 행동을 안내한
  다.", "confidence": 0.70 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력하고, LEARN_JSON_VALIDATE_PARSE로
  파싱 통과를 확인한다.", "reason": "reviewer 지적처럼 JSON
  파싱 실패는 결합 패치 검증/병합 파이프라인을 중단시킨
  다.", "confidence": 0.84 },
      { "claim": "R3 Transfer 산출물은 FE/UX 티켓에서는 상
  태 전이(입력→활성화→채점→저장→복원→초기화) 예시로 대체하
  거나 N/A를 명시하는 방식이 적합하다.", "reason": "problem
  templates/triplets은 도메인 부적합일 수 있어 reviewer 권
  고대로 도메인 맞춤 전이 근거로 전환하는 편이 안전하다.",
  "confidence": 0.74 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 제출/저장 흐름 기준선 요약 | 현재는
  문제별 제출→단건 채점→submissions merge 저장 구조라, bulk
  전환 시 무엇이 바뀌는지 기준선이 필요 | 높음 |
  | 2 | StoredResult(submissions) 스키마 명시 |
  localStorage
  저장/복원 계약이 명시되지 않으면 bulk 저장으로 전환 시 호
  환/마이그레이션 규칙이 흔들림 | 높음 |
  | 3 | 문제 카드별 제출 버튼 제거 | 요구사항 1) 핵심인데
  현
  재 UI는 per-problem 제출에 고정 | 높음 |
  | 4 | 하단 단일 채점하기(전체 제출) 버튼 | 요구 UX의 유일
  한 진입점이 필요하나 현재 없음 | 높음 |
  | 5 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 활성/비활성이 채점과 엇갈림 | 높음 |
  | 6 | allAnswered 계산(정규화 기반) | problems[] 전체를
  기
  준으로 “모두 입력됨”을 안정적으로 계산해야 함(로딩 타이
  밍/
  문제 수 변화 포함) | 높음 |
  | 7 | 입력 엣지케이스 10+ 정의 | AC 요구 충족을 위해 최소
  벡터가 필요(예: "", " ", ",", " , ", "0", "-0", "1,234",
  "
  1 234 ", "+", ".", "Infinity" 등) | 중 |
  | 8 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 submitProblem(problem)로 단건 채점만 가능해 bulk 채점
  동작이 없음 | 높음 |
  | 9 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 점수/정답 노출(0/N) 및 복원 후 표시 기준 혼란을 막기
  위
  해 필요 | 중 |
  |10| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노출
  해야 UX가 일관되고 legacy partial 데이터 혼선을 줄임 | 중
  |
  |11| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 개별 제출이 아니라 일괄 채점 후로 바뀌어야 함 |
  높음 |
  |12| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 복원
  해 상태를 재구성해야 함 | 높음 |
  |13| legacy partial 호환/정책 | 기존 per-problem 저장은
  submissions 일부만 남기는 데이터가 정상으로 생성되므로,
  bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |14| 다시 풀기(초기화): 키 삭제 + UI 리셋 | 요구사항 4)이
  며 키 삭제만으로는 화면이 즉시 초기화되지 않음 | 높음 |
  |15| strict JSON 산출 가드 | reviewer 지적처럼 문자열 내
  부
  줄바꿈이 있으면 파싱/병합이 실패하므로 산출물 JSON은
  strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | R3 Transfer 템플릿/트리플릿 강제 | 본 티켓은 FE/UX
  개선이며 problem templates/triplets은 도메인 부적합(또는
  N/A 처리 필요) | N/A 명시 또는 최소 전이(상태 전이) 예시
  로
  대체 |
  | 2 | 서버 연동/DB 저장 | Out of Scope 위반, localStorage
  요구를 흐림 | 금지 |
  | 3 | 문제 타입 확장(서술형/객관식) | 이번 티켓 범위를 벗
  어남 | 금지(후속 티켓) |
  | 4 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하며 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 5 | 문제은행 JSON 스키마 변경 | 데이터 구조 변경은 범위
  밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 6 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 버튼/액션 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 표시/disabled와
  충
  돌 | partial 감지 후 정책(초기화/답안만 복원/재채점 유도)
  |
  | 4 | 점수 표시 → 채점 UX | 채점 전 0/N 노출은 “이미 채점
  됨” 오해 유발 | hasGraded 도입 후 채점 후에만 점수/정답
  표
  시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남은 answer/result/flags가 그대로 | 키 삭제 + UI
  리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙(JSON
  shape
  validate)", "domain": "FE", "rep": "C", "confidence":
  0.78 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 호
  환/정책", "domain": "FE", "rep": "C", "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "R3 Transfer 산출물은 본 티켓(UX/FE)에서는
  problem templates/triplets 대신 상태 전이(입력→활성화→채
  점
  →저장→복원→초기화) 전이 예시로 대체하거나 N/A를 명시하는
  방식이 적합하다.", "reason": "reviewer도 FE/UX 티켓에서
  Transfer 항목을 N/A 처리 또는 도메인 맞춤 예시로 대체하라
  고 권고했다.", "confidence": 0.74 },
  { "claim": "legacy partial(부분 제출) 데이터는 bulk 전
  환 시 필연적으로 존재할 수 있어 복원 단계에서 감지/정책화
  가 필요하다.", "reason": "기존 per-problem 저장은 전체 문
  제 수보다 적은 submissions를 남기는 것이 정상 동작이었
  다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:726064d7ea###


› Improve documentation in @filename

  41% context left · ? for shortcuts


============================================================
[2026-01-08 12:10:34] RESEARCH2 (req_id: 6c75ecb0f6)
============================================================
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
    ],
    "notes": [
      { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "정규화(공백/콤마 제거)
  기준과 UI 기준이 다르면 \" , \" 같은 입력에서 버튼 상태와
  채점 결과가 불일치한다.", "confidence": 0.82 },
      { "claim": "legacy partial은 조건부로 감지해 초기화/
  재채점 유도 등 정책을 적용하는 편이 안전하다.", "reason":
  "기존 per-problem 저장은 submissions 일부만 남는 것이 정
  상 동작이었고, 이를 bulk UX에 그대로 노출하면 혼란이 생긴
  다.", "confidence": 0.74 },
      { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, 점수/정답 표시는 hasGraded일 때만 노
  출한다.", "reason": "채점 전 0/N 노출 및 부분 저장 데이터
  노출을 통제하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
      { "claim": "LEARN_BUILD_RESULT_MAP은 점수/표시/저장의
  공통 중간 표현으로 유용하다.", "reason": "problemId 기반
  결과 맵을 중간에 두면 집계/표시/직렬화가 동일 키로 정렬되
  어 오류가 줄어든다.", "confidence": 0.74 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력해야 결합 패치 검증/병합이 가능하
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 DAG/
  충돌 포함 자동 검증 파이프라인을 중단시킨다.",
  "confidence": 0.84 },
      { "claim": "allAnswered와 버튼 추가는 requires로 잠그
  지 않고 병렬 구현 가능하며, disabled 로직만 연결하면 된
  다.", "reason": "UI를 먼저 만들고 disabled 조건을 나중에
  붙이는 구현 경로가 자연스럽고 회귀 위험이 낮다.",
  "confidence": 0.70 },
      { "claim": "reset은 localStorage 키 삭제와 UI 상태 리
  셋을 함께 수행하는 것이 UX 상 권장이다.", "reason": "키
  삭제만 수행하면 화면에 남아있는 answer/result/flags가 그
  대로여서 사용자가 초기화를 체감하지 못한다.",
  "confidence": 0.78 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 동작/상태 흐름 1페이지 요약 | LearnPage는 “문
  제
  별 제출→단건 채점→localStorage merge 저장” 구조인데, 이를
  기준선으로 요약하지 않으면 bulk 전환 시 회귀 원인을 추적
  하
  기 어려움 | 높음 |
  | 2 | StoredResult 스키마 명시(현재: submissions) | 저장/
  복원 계약이 { nodeId, updatedAt, submissions }인데 bulk
  저
  장으로 바뀔 때 호환/마이그레이션 규칙이 필요 | 높음 |
  | 3 | 단일 버튼 채점하기 UX(하단 고정) | 요구사항은 “모든
  문제 입력 후 한 번에 제출”인데 현재 UI는 문제 카드별 제출
  만 존재 | 높음 |
  | 4 | 채점하기 disabled 기준(정규화 일치) | disabled 판정
  이 normalizeNumericInput()과 일관되지 않으면 " , " 같은
  입
  력에서 활성/비활성이 채점과 불일치 | 높음 |
  | 5 | allAnswered 계산(정규화 기반) | problems[] 전체에
  대
  해 정규화 후 빈 값 여부를 확인해야 “모든 문제 입력 전까지
  disabled”를 구현 가능 | 높음 |
  | 6 | 입력 엣지케이스 10+ 정의 | AC 요구(10개+) 충족을 위
  해 최소 벡터가 필요(빈값/공백/콤마/0/부호/소수점/Infinity
  등) | 중 |
  | 7 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 단건 submitProblem만 있어 “한 번에 전체 채점” 동작이
  없
  음 | 높음 |
  | 8 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 0/N 노출, 복원 후 표시 기준 혼란을 막기 위해 채점 전/
  후
  상태를 분리해야 함 | 중 |
  | 9 | 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노
  출
  해야 사용자 혼란(채점 전 점수 노출/legacy partial) 최소화
  | 중 |
  |10| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 “개별 제출”이 아니라 “일괄 채점 후”로 바뀌어야
  함 | 높음 |
  |11| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 한
  번
  에 복원해 UI 상태를 재구성해야 함 | 높음 |
  |12| legacy partial 호환/마이그레이션 정책 | 기존 per-
  problem 저장은 submissions 일부만 남기는 데이터가 자연스
  럽
  게 생성되므로 bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |13| 초기화(다시 풀기): localStorage 삭제 + UI 리셋 | 요
  구
  사항 4)인데 현재 사용자가 저장된 결과/답안을 지울 방법이
  없음 | 높음 |
  |14| strict JSON 출력 가드(줄바꿈 금지) | reviewer 지적처
  럼 문자열 내부 줄바꿈이 있으면 자동 파싱/병합이 실패하므
  로
  산출물 JSON은 strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope 위반이며
  localStorage 요구를 흐림 | 금지 |
  | 2 | 문제 타입 확장(서술형/객관식) | 이번 티켓은 제출
  UX/
  저장/복원이며 타입 확장은 별도 설계 필요 | 금지(후속 티
  켓)
  |
  | 3 | 채점 정책 확장(허용오차/분수/근사) | bulk 제출 UX와
  무관하며 회귀 위험만 증가 | gradeNumericAnswer() 유지 |
  | 4 | 문제은행 스키마 변경 | 데이터 구조 변경은 범위 밖이
  며 회귀 위험 큼 | problems_v1.json 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | autosave(입력 즉시 저장) | 요구는 “채점 후 한 번에
  저장”이며 호환/정책을 복잡화 | 제외 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 액션/버튼 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 상태/표시와 충돌
  |
  legacy partial 감지 후 정책(초기화/답안만 복원/재채점 유
  도) |
  | 4 | 점수 표시(항상 0/N 가능) → 채점 UX | 채점 전 점수
  노
  출은 “이미 채점됨” 오해 유발 | hasGraded 도입 후 채점 후
  에
  만 점수/정답 표시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남아있는 answer/result/flags가 그대로 | 키 삭제 +
  UI 상태 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/ submisions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded/isSubmitted)
  정의", "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 데
  이터 호환/정책", "domain": "FE", "rep": "C",
  "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload))가 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "legacy partial 데이터는 bulk 전환 시 필연
  적으로 존재할 수 있어 복원 단계에서 감지/정책화가 필요하
  다.", "reason": "기존 per-problem 저장은 전체 문제 수보다
  적은 submissions를 남기는 것이 정상 동작이었다.",
  "confidence": 0.74 },
  { "claim": "채점 전/후 게이팅(hasGraded)은 점수/정답
  조기 노출과 저장/복원 혼선을 줄인다.", "reason": "채점 전
  0/N 노출, 부분 저장 데이터 노출을 통제하려면 표시 기준이
  필요하다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:638d80efe8###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_726064d7ea.md


  50% context left



› Request 726064d7ea: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_726064d7ea.md


    Read research_726064d7ea.md                         

• Planning New Graph Nodes and Edges (5m 43s • esc to inter


› Improve documentation in @filename

  91% context left · ? for shortcuts


• Explored
  └ Read research_726064d7ea.md
    Search Output Format|## Rules|\[/R1 Coverage Report\]|
^##
           Coverage Gap Report in research_726064d7ea.md
    Read research_726064d7ea.md

─ Worked for 5m 43s ───────────────────────────────────────

• ###BEGIN:726064d7ea###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 기준선 요약 | FE | C | 변경 전 상태(단건 채
  점/merge 저장)를 기준점으로 고정해야 회귀를 줄일 수 있음
  |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA |
  StoredResult(submissions) 스키마 명시 | FE | C | 저장/복
  원 계약이 흔들리면 bulk 전환 시 호환/마이그레이션 논의가
  붕괴 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화가 모두 동일 키 계약에 의
  존 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 요구사항 1) 핵심 변경(개별 제출 경로
  제거)을 독립 작업으로 분리 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기(전
  체 제출) 버튼 추가 | FE | P | bulk UX의 단일 진입점을 구
  현하기 위해 |
  | 6 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT |
  disabled 기준을 normalizeNumericInput과 일치 | FE | C |
  입력 판정이 grading과 불일치하면 disabled/채점 결과가 엇
  갈려 UX가 붕괴 |
  | 7 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  정의(빈값/공백/콤마/0/부호/소수점 등) | QA | C |
  disabled/정규화 일관성을 케이스 기반으로 고정해 회귀를 줄
  이기 위해 |
  | 8 | LEARN_BUILD_ANSWER_STATE_MAP | answerByProblemId 상
  태 맵 유지 | FE | P | allAnswered/저장/복원을 위해 “문제
  ID→답” 표현을 안정화 |
  | 9 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 답 입력 전까지 disabled”
  조건을 problems[] 기준으로 안정화 |
  | 10 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회→gradeNumericAnswer) | FE | P | 단건 채점에서 전체 채
  점으로 전환하는 핵심 동작 |
  | 11 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장을 동일
  키(problemId)로 정렬하는 중간 표현이 필요 |
  | 12 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded 등) 정의 | FE | C | 채점 전 0/N 노출, 복원 후
  표시 기준 혼란을 막는 기준점 |
  | 13 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 계산(결과 맵
  기반) | FE | P | 요구사항 2) 상단 점수 요약을 안정적으로
  집계/표시 |
  | 14 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  정오/정답 표시(게이팅) | FE | P | 채점 전 결과 노출 및
  legacy partial 노출 혼란을 차단 |
  | 15 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 요구사항 2) 문제 카드별 결
  과 표시를 독립 작업으로 분리 |
  | 16 | LEARN_GRADE_BUTTON_LABEL_STATE | 버튼 라벨/상태 전
  환(채점하기↔다시 채점) | UX | P | 채점 후 재입력 정책과
  결합해 사용자가 다음 행동을 오해하지 않게 하기 위해 |
  | 17 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 재입력 정
  책(결과 초기화/다시 채점) | UX | C | 입력 변경 시 스테일
  결과(불일치) 상태를 방지하는 규칙을 고정 |
  | 18 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 스키마
  (답안+결과) 계약 정의 | FE | C | 저장/복원/마이그레이션/
  초기화의 공통 계약을 고정 |
  | 19 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후 답안
  +결과를 한 번에 저장 | FE | P | 요구사항 3) 저장 시점(일
  괄 채점 후) 전환을 구현 |
  | 20 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/검증 규칙(JSON shape validate) | FE | C | 잘못된/
  legacy 데이터로 인한 런타임 오류와 UX 꼬임을 방지 |
  | 21 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 결과/답안 복원 | FE | P | 요구사항 3) 저장된 상태를 UI
  상태로 재구성 |
  | 22 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial(부분 제출) 호환/정책 | FE | C | 기존
  submissions 일부 저장 데이터가 bulk UX와 충돌하는 문제를
  분리 |
  | 23 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 요구사항 4) 저장된 결과/
  답안을 삭제 |
  | 24 | LEARN_RESET_UI_STATE | 다시 풀기: UI 상태 리셋
  (answer/results/flags) | FE | P | 키 삭제만으로는 화면이
  즉시 초기화되지 않아 UI 리셋이 필요 |
  | 25 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장(문자열 줄바꿈 금지) | QA | C | 자동 파
  싱/병합 파이프라인을 위해 산출물 JSON 형식을 실제로 보장
  |
  | 26 | LEARN_JSON_VALIDATE_PARSE | Graph Patch JSON 파싱
  검증(파서 통과 확인) | QA | P | “strict JSON” 준수 여부를
  자동으로 확인할 단일 체크 동작이 필요 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_UI_DISABLED_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
  LEARN_DISABLED_EDGECASES_12,
  LEARN_BUILD_ANSWER_STATE_MAP,
  LEARN_ALL_ANSWERED_NORMALIZED | per-problem 제출을 제거하
  고 단일 채점 버튼을 추가한 뒤, 정규화 기반 allAnswered로
  disabled를 안정화 |
  | 2 | STEP_BULK_GRADE_DISPLAY_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SHOW_PER_PROBLEM_RESULT,
  LEARN_AFTER_GRADE_EDIT_POLICY,
  LEARN_GRADE_BUTTON_LABEL_STATE | gradeAll 결과를 result
  맵으로 고정하고 hasGraded 게이팅 하에 점수/정답을 표시,
  채점 후 편집 정책에 따라 버튼 상태를 정합화 |
  | 3 | STEP_STORAGE_FLOW | 저장/복원/legacy 처리 |
  LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
  LEARN_IDENTIFY_STORAGE_KEY,
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_RESTORE_BULK,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존 저장
  계약을 이해한 뒤 bulk 스키마로 저장/복원하고 legacy
  partial을 감지/정책화 |
  | 4 | STEP_RESET_FLOW | 다시 풀기(키 삭제+UI 리셋) |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE | 저장된
  결과/답안을 삭제하고 화면 상태를 초기 상태로 되돌림 |
  | 5 | STEP_OUTPUT_STRICT_JSON_FLOW | 산출물 strict JSON
  보장 | LEARN_STRICT_JSON_OUTPUT_GUARD,
  LEARN_JSON_VALIDATE_PARSE | 결합 패치 검증/병합이 가능하
  도록 JSON 문자열 줄바꿈 금지 및 파싱 검증을 수행 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_SAVE_BULK | 저장 대상 키를 모르면 저장
  위치가 달라져 저장/복원/초기화가 불일치함 | 0.72 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 특정 키에서 읽어
  야 하므로 키 계약이 선행되어야 함 | 0.72 |
  | 3 | LEARN_IDENTIFY_STORAGE_KEY →
  LEARN_RESET_CLEAR_STORAGE | 초기화는 삭제 대상 키를 알아
  야 수행 가능 | 0.72 |
  | 4 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered를 정규화 기준
  으로 계산하려면 “입력됨/미입력” 기준을 먼저 고정해야 함 |
  0.82 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | result 맵은 문제별 채점 결과가
  있어야 생성 가능 | 0.78 |
  | 6 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 X/N은 problemId별 결과 집계가 선행되어야 계산 가능 |
  0.76 |
  | 7 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  problemId별 결과가 선행되어야 함 | 0.78 |
  | 8 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 “채점됨” 상태
  (hasGraded 등) 없이 구현할 수 없음 | 0.76 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK | 무엇을 저장하는지(답안+결
  과) 계약이 먼저 필요 | 0.80 |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 복원은 저장 스키마를 기
  준으로 UI 상태를 재구성하므로 선행 필요 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 submitProblem/저장
  흐름을 알면 제거 시 사이드이펙트 회귀를 줄일 수 있음 |
  0.65 |
  | 2 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 submissions 계약을
  이해해야 bulk 저장 계약/호환 정책이 안정화 | 0.74 |
  | 3 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED | 엣지케이스 벡터가 있으면
  disabled/정규화 불일치 회귀가 감소 | 0.76 |
  | 4 | LEARN_BUILD_ANSWER_STATE_MAP →
  LEARN_ALL_ANSWERED_NORMALIZED | 답안 상태 표현을 안정화하
  면 allAnswered 계산이 단순/견고해짐 | 0.72 |
  | 5 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | 버튼 UI는 독립 구현 가능하
  지만, disabled까지 함께 설계하면 UX가 빨리 안정화 | 0.65
  |
  | 6 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트 연결을 고려하면
  버튼 UI와 액션을 함께 설계하는 것이 안전 | 0.70 |
  | 7 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | 보통 gradeAll 완료 시 hasGraded
  를 세팅하는 흐름이 자연 | 0.74 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능하지만, 표시
  시점은 게이팅과 함께 설계하는 것이 혼란을 줄임 | 0.70 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과 표시는 채점 후에만
  노출되도록 게이팅과 함께 설계 권장 | 0.70 |
  | 10 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | validate를 복원 파이프
  라인에 넣으면 parse/legacy 오류로 인한 회귀가 감소 | 0.78
  |
  | 11 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy partial은 조건부
  이므로 발견 시 정책 적용 흐름을 권장 | 0.74 |
  | 12 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 화면이 남아 UX가 어긋나므로 함께 수행을
  권장 | 0.78 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADE_BUTTON_LABEL_STATE | 편집 정책에 따라 버튼이
  “다시 채점/채점하기”로 일관되게 전환됨 | 0.70 |
  | 14 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  LEARN_JSON_VALIDATE_PARSE | 가드(규칙)만 두지 말고 실제
  파싱 검증으로 준수 여부를 확인하는 것이 안전 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | UI는
  원문 입력을 보고, grading은 정규화 입력을 보는 불일치로
  disabled/채점이 엇갈림 |
  normalizeNumericInput(answer).length>0를 단일 기준으로 고
  정하고 모든 판정에서 재사용 | 0.82 |
  | 2 | LEARN_DISABLED_EDGECASES_12 | "0", " , ", "+", ".",
  "Infinity" 등에서 “미입력/입력” 기대가 모호해 구현이 흔들
  림 | 엣지케이스를 테스트 벡터로 문서화하고 normalize 결과
  기반 기대값을 명시 | 0.76 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩 타이
  밍/문제 수 변화로 allAnswered가 순간적으로 잘못 계산됨 |
  problems[] 기준으로 계산(useMemo)하고 로딩/빈 배열 처리
  규칙을 정의 | 0.72 |
  | 4 | LEARN_BUILD_ANSWER_STATE_MAP | 문제 ID 매칭/상태 업
  데이트가 꼬여 특정 문제 답이 누락/덮어씀 |
  answerByProblemId는 problemId 키로만 갱신하고 problems 변
  경 시 정합성 점검 | 0.70 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 전체 순회 중 state 업
  데이트를 섞어 사이드이펙트/순서 버그가 발생 | “입력 수집
  →grade→결과 생성”을 순수 계산으로 만들고 마지막에 한 번에
  setState | 0.75 |
  | 6 | LEARN_BUILD_RESULT_MAP | 결과를 problemId로 정렬하
  지 못해 점수/표시/저장 키가 어긋남 | resultByProblemId를
  단일 중간 표현으로 두고 모든 집계/표시에 동일 키를 사용 |
  0.74 |
  | 7 | LEARN_GRADED_STATE_FLAG | hasGraded의 의미(gradeAll
  완료 vs 복원됨 vs partial)가 불명확해 게이팅이 꼬임 |
  “bulk 결과 존재 시 graded” 등 단일 정의를 정하고 저장/복
  원 시 동일 기준 적용 | 0.74 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 노
  출, legacy partial 노출 등 표시 기준 혼란 | 점수/정오/정
  답 표시는 hasGraded일 때만 노출하도록 단일 게이팅 규칙 적
  용 | 0.74 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | 답안만 저장/결과만
  저장 등 스키마가 흔들리면 복원/게이팅이 연쇄로 흔들림 |
  answers+results(+updatedAt/+version) 최소 계약을 먼저 고
  정하고 이를 기준으로 구현 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL | 기존
  submissions 일부 저장 데이터가 bulk UX에서 “채점됨”처럼
  보이거나 allAnswered와 충돌 | partial 감지(저장된 문제 수
  < problems.length) 후 정책(초기화/재채점 유도)을 명시 |
  0.74 |
  | 11 | LEARN_RESET_UI_STATE | 키 삭제만 수행해 화면에 이
  전 answer/result/flags가 남아 “초기화”가 체감되지 않음 |
  reset 액션에서 localStorage 삭제와 UI 상태 리셋을 함께 수
  행 | 0.78 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 내부 줄바
  꿈 때문에 JSON 파싱이 실패해 결합 패치 검증/병합이 중단됨
  | 모든 문자열을 한 줄로 유지(또는 \n 이스케이프)하고
  LEARN_JSON_VALIDATE_PARSE로 파싱 통과를 확인 | 0.84 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 후 새 제출 진입점(UI)을 먼저 제공해 기능 공백을 방
  지 |
  | 2 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ADD_BULK_GRADE_BUTTON |
  LEARN_ALL_ANSWERED_NORMALIZED | 기준 정의에서 UI로 점프하
  지 않고 “활성 조건 계산”을 중간에 둠 |
  | 3 | LEARN_DISABLED_EDGECASES_12 →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT | 엣지케이스
  는 결국 normalize 기준 정의로 수렴하므로 기준 노드가 브릿
  지 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계의 공통 입력을 result 맵으로 정규화 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  문제별 표시도 동일한 result 맵을 중간 입력으로 사용 |
  | 6 | LEARN_GRADED_STATE_FLAG → LEARN_SCORE_SUMMARY_CALC
  | LEARN_SCORE_AND_RESULT_GATING | 계산과 표시 시점을 분리
  해 채점 전 노출을 차단 |
  | 7 | LEARN_GRADED_STATE_FLAG →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 결과 표시는 게이팅을 중간
  에 두어 조기 노출을 방지 |
  | 8 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA →
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 schema 이해→새
  schema 계약→legacy 정책으로 연결하면 충돌이 줄어듦 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 전에 validate를
  두면 파싱 실패/누락 필드로 인한 회귀가 감소 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_RESET_UI_STATE | LEARN_RESET_CLEAR_STORAGE | 저장된
  키 삭제 후 UI 리셋으로 이어지는 초기화 흐름이 자연 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_SUMMARY_CALC | LEARN_GRADE_BUTTON_LABEL_STATE
  | 정책을 버튼 상태 전환으로 연결하면 사용자가 “다시 채점”
  필요를 이해하기 쉬움 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD → Graph Patch JSON
  출력 | LEARN_JSON_VALIDATE_PARSE | 가드만 두지 말고 파서
  통과 검증을 중간에 둬서 “실제 strict”를 보장 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type":
  "micro", "name_ko": "localStorage 키 포맷 식별",
  "domain": "FE", "rep": "C", "confidence": 0.72 },
      { "id": "LEARN_BUILD_ANSWER_STATE_MAP", "type":
  "micro", "name_ko": "answerByProblemId 상태 맵 유지",
  "domain": "FE", "rep": "P", "confidence": 0.72 },
      { "id": "LEARN_GRADE_BUTTON_LABEL_STATE", "type":
  "micro", "name_ko": "버튼 라벨/상태 전환(채점하기↔다시 채
  점)", "domain": "UX", "rep": "P", "confidence": 0.68 },
      { "id": "LEARN_JSON_VALIDATE_PARSE", "type": "micro",
  "name_ko": "Graph Patch JSON 파싱 검증(파서 통과 확인)",
  "domain": "QA", "rep": "P", "confidence": 0.84 },
      { "id": "STEP_BULK_UI_DISABLED_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_DISPLAY_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_STORAGE_FLOW", "type": "step",
  "name_ko": "저장/복원/legacy 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_FLOW", "type": "step", "name_ko":
  "다시 풀기(키 삭제+UI 리셋)", "domain": "FE", "rep": "C",
  "confidence": 0.72 },
      { "id": "STEP_OUTPUT_STRICT_JSON_FLOW", "type":
  "step", "name_ko": "산출물 strict JSON 보장", "domain":
  "QA", "rep": "C", "confidence": 0.84 }
    ],
    "add_edges": [
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.72 },
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires", "reason": "흐름 요약과 스키마 문서화는 병렬로
  도 가능해 requires 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 UI는 allAnswered 구현과 독립적으로 가능하
  므로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 독립적으로 가능하므로
  requires 잠금은 과잉 제약", "confidence": 0.76 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "validate는 안정성을 높이는 권장 선행이며 복원
  의 필수 잠금은 아님", "confidence": 0.78 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부이므로 requires가 아니
  라 권장/노트가 적절", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원된 결과 존재로 hasGraded를 파생할 수 있어 단일 잠금
  은 과잉", "confidence": 0.70 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
    ],
    "notes": [
      { "claim": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE는 복원
  안정성을 높이는 권장 선행이며 requires로 잠그지 않는다.",
  "reason": "parse/shape validation이 없어도 복원은 가능하
  지만, 잘못된 데이터로 인한 런타임 오류를 줄이려면
  validate 단계가 유용하다.", "confidence": 0.78 },
      { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "모든 사용자에게 legacy 데이터가 존재하는 것은
  아니므로 requires 잠금은 과잉 선행이 될 수 있다.",
  "confidence": 0.74 },
      { "claim": "완전 초기화 UX는
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만 수행하면
  화면에 남아있는 answer/result/flags가 그대로여서 사용자가
  초기화를 체감하지 못한다.", "confidence": 0.78 },
      { "claim": "LEARN_GRADE_BUTTON_LABEL_STATE는 채점 후
  편집 정책을 사용자가 이해하는 데 도움이 된다.", "reason":
  "입력 변경 시 결과를 초기화하는 경우 버튼을 \"다시 채점
  \"으로 전환하면 스테일 결과를 줄이고 다음 행동을 안내한
  다.", "confidence": 0.70 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력하고, LEARN_JSON_VALIDATE_PARSE로
  파싱 통과를 확인한다.", "reason": "reviewer 지적처럼 JSON
  파싱 실패는 결합 패치 검증/병합 파이프라인을 중단시킨
  다.", "confidence": 0.84 },
      { "claim": "R3 Transfer 산출물은 FE/UX 티켓에서는 상
  태 전이(입력→활성화→채점→저장→복원→초기화) 예시로 대체하
  거나 N/A를 명시하는 방식이 적합하다.", "reason": "problem
  templates/triplets은 도메인 부적합일 수 있어 reviewer 권
  고대로 도메인 맞춤 전이 근거로 전환하는 편이 안전하다.",
  "confidence": 0.74 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 제출/저장 흐름 기준선 요약 | 현재는
  문제별 제출→단건 채점→submissions merge 저장 구조라, bulk
  전환 시 무엇이 바뀌는지 기준선이 필요 | 높음 |
  | 2 | StoredResult(submissions) 스키마 명시 |
  localStorage
  저장/복원 계약이 명시되지 않으면 bulk 저장으로 전환 시 호
  환/마이그레이션 규칙이 흔들림 | 높음 |
  | 3 | 문제 카드별 제출 버튼 제거 | 요구사항 1) 핵심인데
  현
  재 UI는 per-problem 제출에 고정 | 높음 |
  | 4 | 하단 단일 채점하기(전체 제출) 버튼 | 요구 UX의 유일
  한 진입점이 필요하나 현재 없음 | 높음 |
  | 5 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 활성/비활성이 채점과 엇갈림 | 높음 |
  | 6 | allAnswered 계산(정규화 기반) | problems[] 전체를
  기
  준으로 “모두 입력됨”을 안정적으로 계산해야 함(로딩 타이
  밍/
  문제 수 변화 포함) | 높음 |
  | 7 | 입력 엣지케이스 10+ 정의 | AC 요구 충족을 위해 최소
  벡터가 필요(예: "", " ", ",", " , ", "0", "-0", "1,234",
  "
  1 234 ", "+", ".", "Infinity" 등) | 중 |
  | 8 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 submitProblem(problem)로 단건 채점만 가능해 bulk 채점
  동작이 없음 | 높음 |
  | 9 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 점수/정답 노출(0/N) 및 복원 후 표시 기준 혼란을 막기
  위
  해 필요 | 중 |
  |10| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노출
  해야 UX가 일관되고 legacy partial 데이터 혼선을 줄임 | 중
  |
  |11| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 개별 제출이 아니라 일괄 채점 후로 바뀌어야 함 |
  높음 |
  |12| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 복원
  해 상태를 재구성해야 함 | 높음 |
  |13| legacy partial 호환/정책 | 기존 per-problem 저장은
  submissions 일부만 남기는 데이터가 정상으로 생성되므로,
  bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |14| 다시 풀기(초기화): 키 삭제 + UI 리셋 | 요구사항 4)이
  며 키 삭제만으로는 화면이 즉시 초기화되지 않음 | 높음 |
  |15| strict JSON 산출 가드 | reviewer 지적처럼 문자열 내
  부
  줄바꿈이 있으면 파싱/병합이 실패하므로 산출물 JSON은
  strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | R3 Transfer 템플릿/트리플릿 강제 | 본 티켓은 FE/UX
  개선이며 problem templates/triplets은 도메인 부적합(또는
  N/A 처리 필요) | N/A 명시 또는 최소 전이(상태 전이) 예시
  로
  대체 |
  | 2 | 서버 연동/DB 저장 | Out of Scope 위반, localStorage
  요구를 흐림 | 금지 |
  | 3 | 문제 타입 확장(서술형/객관식) | 이번 티켓 범위를 벗
  어남 | 금지(후속 티켓) |
  | 4 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하며 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 5 | 문제은행 JSON 스키마 변경 | 데이터 구조 변경은 범위
  밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 6 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 버튼/액션 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 표시/disabled와
  충
  돌 | partial 감지 후 정책(초기화/답안만 복원/재채점 유도)
  |
  | 4 | 점수 표시 → 채점 UX | 채점 전 0/N 노출은 “이미 채점
  됨” 오해 유발 | hasGraded 도입 후 채점 후에만 점수/정답
  표
  시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남은 answer/result/flags가 그대로 | 키 삭제 + UI
  리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙(JSON
  shape
  validate)", "domain": "FE", "rep": "C", "confidence":
  0.78 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 호
  환/정책", "domain": "FE", "rep": "C", "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "R3 Transfer 산출물은 본 티켓(UX/FE)에서는
  problem templates/triplets 대신 상태 전이(입력→활성화→채
  점
  →저장→복원→초기화) 전이 예시로 대체하거나 N/A를 명시하는
  방식이 적합하다.", "reason": "reviewer도 FE/UX 티켓에서
  Transfer 항목을 N/A 처리 또는 도메인 맞춤 예시로 대체하라
  고 권고했다.", "confidence": 0.74 },
  { "claim": "legacy partial(부분 제출) 데이터는 bulk 전
  환 시 필연적으로 존재할 수 있어 복원 단계에서 감지/정책화
  가 필요하다.", "reason": "기존 per-problem 저장은 전체 문
  제 수보다 적은 submissions를 남기는 것이 정상 동작이었
  다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:726064d7ea###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_6c75ecb0f6.md


  41% context left



› Request 6c75ecb0f6: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_6c75ecb0f6.md


    Read research_6c75ecb0f6.md                         

◦ Checking output format (55s • esc to interrupt)    


› Improve documentation in @filename

  47% context left · ? for shortcuts


• Explored
  └ Read research_6c75ecb0f6.md
    Search Output Format|## Rules|\[/R1 Coverage Report\]|
^##
           Coverage Gap Report in research_6c75ecb0f6.md
    Read research_6c75ecb0f6.md

─ Worked for 55s ──────────────────────────────────────────

• Context compacted

         research_6c75ecb0f6.md                         

◦ Proposing a bridging node (12m 01s • esc to interrupt)   


› Improve documentation in @filename

  100% context left · ? for shortcuts


• Explored
  └ List inbox
    Search ^## (Output Format|Rules|Coverage Gap Report)\b|
^\[/
           R1 Coverage Report\]|^\[/R2 Progression
Report\]|
           ^###DONE: in research_6c75ecb0f6.md
    Search R1 Coverage Report in research_6c75ecb0f6.md
    Read research_6c75ecb0f6.md
    Search "type"\s*:\s*"step" in research_*.md
    Read research_f0805f8d87.md, T1.md
    List curriculum_viewer_learning_bulk_submit_v1
    Read task.md
    Search ## Graph Patch JSON in research_638d80efe8.md
    Read research_638d80efe8.md, LearnPage.tsx,
         research_6c75ecb0f6.md

─ Worked for 12m 01s ──────────────────────────────────────

• ###BEGIN:6c75ecb0f6###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항 1의 단일 진입점 제공 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 입력됨 판정 기
  준(predicate) 정의(정규화 기반) | FE | C | disabled/채점
  기준 불일치로 인한 UX 붕괴 방지 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled” 구
  현 핵심 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 단일 클릭으로 문제 전체 채점 수행 |
  | 6 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 채점 전 0/N 및 결과 노출을 제
  어하기 위한 기준 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/결
  과 표시(게이팅) | FE | P | 채점 전 표시 혼선(0/N,
  partial) 차단 |
  | 8 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | 상단 점수 표시 계산을 분리해 회귀 방지 |
  | 9 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표
  시(일괄 채점 후) | FE | P | 문제 카드별 피드백 제공(정답/
  오답/정답값) |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | 저장/복원/legacy 처리의 기준 스
  키마 확정 |
  | 11 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | UI 상태에서
  submissions payload 생성 | FE | P | gradeAll 출력과
  StoredResult{submissions} 저장을 연결 |
  | 12 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | “채점 후 한 번에 저장”
  요구사항 3 충족 |
  | 13 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 학습 연속성 확보 및 새로고침
  회귀 방지 |
  | 14 | LEARN_RESET_UI_STATE | 다시 풀기: 저장 삭제 + UI
  state 리셋 | FE | P | 초기화가 화면에 즉시 반영되도록 보
  장 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  를 방지하고 재채점 유도 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 제출 UI를 단일 버튼으로
  바꾸고 disabled 규칙을 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_GRADED_STATE_FLAG, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SHOW_PER_PROBLEM_RESULT |
  gradeAll 이후 표시/게이팅/점수 집계를 일관되게 렌더 |
  | 3 | STEP_PERSIST_RESTORE_FLOW | 저장/복원 계약 구현 |
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회로 단순화 |
  | 4 | STEP_RESET_EDIT_FLOW | 초기화 + 채점 후 편집 정책 |
  LEARN_RESET_UI_STATE, LEARN_AFTER_GRADE_EDIT_POLICY |
  reset과 편집 정책으로 스테일/잔상 상태를 제거 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이는 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | 총점은 문제별 채점 결과가 있어
  야 집계 가능 | 0.78 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | 정오/정답 표시는 채점 결
  과 생성이 선행 | 0.78 |
  | 4 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 정의에
  의존 | 0.76 |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 6 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거 전에 대체 진입점을 마
  련하면 기능 공백을 방지 | 0.80 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 정의가 유용 | 0.70 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트를 gradeAll로 연결
  해야 UX 완성 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅이 표
  시 기준을 단순화 | 0.74 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능해도 노출은
  hasGraded일 때 권장 | 0.70 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 정오/정답도 hasGraded일
  때만 노출하는 편이 안정 | 0.72 |
  | 7 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정 권장 | 0.70 |
  | 8 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADED_STATE_FLAG | 답 변경 시 hasGraded 초기화/재
  채점 유도 규칙이 필요 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_ALL_ANSWERED_NORMALIZED | 복원된 답안도 disabled 판
  정에 반영되어야 함 | 0.72 |
  | 10 | LEARN_RESET_UI_STATE →
  LEARN_ALL_ANSWERED_NORMALIZED | reset 후 allAnswered가 다
  시 false가 되도록 초기화 | 0.72 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 공백/콤마/0 입
  력에서 “입력됨” 직관과 채점 기준이 어긋남 |
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩/0개
  상태에서 allAnswered가 흔들려 버튼 상태가 불안정 |
  problems 길이 0이면 disabled 또는 버튼 숨김 규칙을 먼저
  고정 | 0.75 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 버튼의 위
  치/disabled/라벨이 산재하면 UX 일관성이 깨짐 | 단일 버튼
  을 페이지 하단에 고정하고 상태를 derived로 계산 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 answer
  map 조회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → submissions 맵을 반환하는
  순수 함수로 분리 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG | 복원/부분 데이터에서
  hasGraded의 의미가 모호해 결과 노출이 흔들림 | hasGraded
  를 “유효한 제출 결과 존재”로 정의하고 일관되게 세팅 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | UI 렌더를
  hasGraded로 게이트하고 채점 전에는 score/result를 숨김 |
  0.74 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | problems 변경/정렬과 결
  과 맵 키가 불일치하면 점수 집계가 틀어짐 | score는
  problems 배열을 기준으로 problem.id 키로 집계하도록 고정
  | 0.70 |
  | 8 | LEARN_SHOW_PER_PROBLEM_RESULT | 결과를 문제 카드에
  매핑할 때 key/순서 혼동으로 오표시 가능 | 항상 problem.id
  로 result를 조회해 동일 카드에 렌더 | 0.76 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | UI state(answers/
  results)와 StoredResult{submissions} 표현 전환이 어려움 |
  저장 계약을 answers+isCorrect 중심으로 명시하고 단일
  payload로 합침 | 0.80 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | 기존 merge 저장
  습관으로 partial/legacy 데이터가 섞여 UX 충돌 | gradeAll
  출력으로 submissions를 새로 구성해 overwrite 저장 | 0.78
  |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성/회귀 추적이 어려움 | 채점 버튼 클릭 시점
  에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_RESET_UI_STATE | storage만 삭제하면 화면의
  answer/result/flags 잔상이 남아 초기화가 체감되지 않음 |
  storage 삭제와 함께 state(answer/result/hasGraded)를 초기
  값으로 리셋 | 0.78 |
  | 14 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태가 발생 | 입력 변경 시
  결과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 기준을 명시
  해 disabled/allAnswered/테스트에서 재사용 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서 유연화
  |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류 감소 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터로 hasGraded를 결정한 뒤 노출을 게이트하도록
  중간 기준 제공 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제 차단 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후에는 결과를 숨기거
  나 재채점을 유도하는 게이트를 중간에 둠 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 추가 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | legacy/partial 처리도 최
  종 스키마 기준으로 판정하도록 기준점을 둠 |
  | 9 | LEARN_SCORE_SUMMARY_CALC →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_BULK_GRADE_ALL_ACTION | 점수/표시 둘 다 동일한
  gradeAll 결과를 단일 소스로 삼아 불일치 방지 |
  | 10 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 전에 새 진입점(단일 버튼)을 확보해 기능 공백을 방
  지 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "입력됨 판정 기준(predicate) 정의(정
  규화 기반)", "domain": "FE", "rep": "C", "confidence":
  0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원 계약 구현", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
      { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "0개/로딩 처리는 권장이지만 allAnswered 구현의
  필수 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires", "reason":
  "result 맵 설계/구현은 액션과 동시 설계가 가능해 단일 선
  행 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 액션에서 세팅하길 권장하지만 정의/도입은 독
  립적으로 가능", "confidence": 0.74 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부 케이스로서 requires보
  다 권장/노트가 적절", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 }
    ],
    "notes": [
      { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "UI 기준과 채점 기준이 다
  르면 \" , \" 같은 입력에서 버튼 상태와 채점 결과가 불일치
  한다.", "confidence": 0.82 },
      { "claim": "hasGraded를 도입하고 score/result는
  hasGraded일 때만 노출하는 것이 UX 혼선을 줄인다.",
  "reason": "채점 전 0/N 노출 및 부분 저장 데이터 노출을 통
  제하려면 표시 기준을 단일 플래그로 고정해야 한다.",
  "confidence": 0.74 },
      { "claim": "일괄 제출은 submissions를 merge하지 말고
  gradeAll 결과로 overwrite 저장하는 편이 안전하다.",
  "reason": "merge 저장은 legacy partial을 필연적으로 만들
  고 bulk UX에서 복원/표시 충돌을 유발한다.", "confidence":
  0.78 },
      { "claim": "복원은 try/catch + nodeId 검증 +
  submissions 최소 shape 검증으로 런타임 오류를 방어하는 것
  이 권장이다.", "reason": "잘못된/legacy 데이터는
  JSON.parse 실패나 필드 누락으로 즉시 크래시/UX 꼬임을 만
  든다.", "confidence": 0.74 },
      { "claim": "채점 후 답 변경 시 결과를 초기화하거나 재
  채점 플로우를 고정해야 스테일 상태를 피할 수 있다.",
  "reason": "입력과 결과가 불일치하면 학습자가 상태를 해석
  하기 어렵고 신뢰도가 급락한다.", "confidence": 0.76 },
      { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/hasGraded) 리셋을 함께 수행하는 것이
  권장이다.", "reason": "키 삭제만 수행하면 화면에 남아있는
  상태 때문에 초기화를 체감하지 못한다.", "confidence":
  0.78 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 로직을 알아야 bulk 전환 시 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마/partial 의미 | 기
  존
  은 submissions merge로 부분 데이터가 정상 생성되어 bulk
  UX
  와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점이 필요(라벨/disabled/재채점 포함) | 높음 |
  | 6 | 미입력 판정 기준 정합화 | disabled 판정이
  normalizeNumericInput()과 불일치하면 채점과 UX가 엇갈림 |
  높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/빈 배열 포함 안정적으
  로
  계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 테스트 벡터(12종+) | 공백/콤마/0/부
  호/소수점/Infinity 등에서 기대값이 흔들려 회귀가 잦음 |
  중
  |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 문제 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성 및 결과 표시 규칙 | 문제별 정
  오/정답 표시와 점수 집계를 problemId 기준으로 정렬해야 함
  | 중 |
  |11| hasGraded 게이팅(채점 후 표시) | 채점 전 0/N 및
  partial 결과 노출 혼선을 막기 위한 표시 시점 규칙 필요 |
  중 |
  |12| 일괄 저장(전체 submissions 1회 저장) | 요구사항 3)
  저
  장 시점을 “일괄 채점 후 setItem 1회”로 전환해야 함 | 높음
  |
  |13| 복원 파이프라인(파싱/검증/legacy 정책) | 잘못된/
  legacy 데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함
  | 중 |
  |14| 다시 풀기: storage 삭제 + UI state 리셋 | 키 삭제만
  으
  로는 화면이 즉시 초기화되지 않아 state(answer/result/
  flags) 리셋이 필요 | 높음 |
  |15| 채점 후 답 변경 처리 정책 | 입력 변경 시 결과가 스테
  일해지므로 결과 초기화 또는 재채점 플로우를 고정해야 함 |
  중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓 분리) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 로직 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | gradeNumericAnswer 유지 |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 구현
  후
  제거 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 없으면 버
  튼 활성/비활성 기준이 흔들림 | normalize 기반 allAnswered
  를 먼저 고정 |
  | 3 | 원문 disabled 판정 → gradeNumericAnswer(정규화) |
  " , " 같은 입력에서 활성/채점 결과가 불일치해 UX 붕괴 |
  normalizeNumericInput(answer).length>0로 통일 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마/검증 없이 복원하
  면 파싱 실패·필드 누락이 런타임 문제로 이어짐 | schema 정
  의 + shape validate + 예외 처리 |
  | 5 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | restored partial에서 점
  수/
  결과 노출 기준이 불명확 | hasGraded 세팅 규칙(완전 제출만
  true 등) 정의 |
  | 6 | LEARN_RESET_CLEAR_STORAGE → (UI state 유지) |
  storage만 지우면 화면에 남은 answer/result/flags가 그대로
  | 키 삭제 + state 리셋 동시 수행 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY 미정 → 결과 표시 유지
  | 답 변경 후 스테일 결과(입력≠결과) 상태가 발생 | 입력 변
  경 시 결과 초기화 또는 “다시 채점” 플로우 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_HANDLE_EMPTY_PROBLEMS", "type":
  "micro", "name_ko": "문제 0개/로딩 상태 UI 규칙",
  "domain": "UX", "rep": "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" },
  { "from": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx의 submitProblem과
  StoredResult{submissions} setItem 흐름을 확인.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로만 '입력
  됨'을 판정해야 한다.", "reason": "grading이
  normalizeNumericInput을 사용하므로 원문 기준 disabled는
  활
  성/채점 불일치를 만든다.", "confidence": 0.82 },
  { "claim": "현재 score는 problems가 있으면 채점 전에도
  0/N이 노출될 수 있어 hasGraded 게이팅이 필요하다.",
  "reason": "score 계산은 resultByProblemId가 비어도
  {correct:0,total:N}을 반환한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 데이터는
  bulk UX에서 복원/점수/표시와 충돌하므로 정책이 필요하
  다.",
  "reason": "기존 per-problem 저장은 submissions를 merge하
  여
  부분 데이터가 정상적으로 생성된다.", "confidence":
  0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제만으로는
  충분하지 않고 UI state(answer/result/flags) 리셋이 필요하
  다.", "reason": "LearnPage는 answerByProblemId/
  resultByProblemId를 state로 유지하므로 화면이 남을 수 있
  다.", "confidence": 0.78 },
  { "claim": "일괄 제출은 setItem 1회로 전체 submissions
  를 저장해야 저장/복원/초기화 계약이 단순해진다.",
  "reason": "요구사항은 일괄 채점 후 한 번에 저장이며,
  merge
  저장은 partial을 필연적으로 만든다.", "confidence": 0.8 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_HANDLE_EMPTY_PROBLEMS,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:6c75ecb0f6###


› Improve documentation in @filename

  72% context left · ? for shortcuts 


============================================================
[2026-01-08 12:35:27] RESEARCH2 (req_id: 4541b0237a)
============================================================
  "복원된 결과 존재로 hasGraded를 파생할 수 있어 단일 잠금
  은 과잉", "confidence": 0.70 },
      { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "reason": "reset은 저장 유무와 무관하게 키 삭제로 구현 가
  능하므로 requires 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "reason": "strict JSON은 산출물 포맷 품질이며 기능/스키마
  설계의 필수 선행 관계가 아님", "confidence": 0.84 }
    ],
    "notes": [
      { "claim": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE는 복원
  안정성을 높이는 권장 선행이며 requires로 잠그지 않는다.",
  "reason": "parse/shape validation이 없어도 복원은 가능하
  지만, 잘못된 데이터로 인한 런타임 오류를 줄이려면
  validate 단계가 유용하다.", "confidence": 0.78 },
      { "claim":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL는 조건부
  (legacy 존재 시) 정책 노드로 두는 것이 안전하다.",
  "reason": "모든 사용자에게 legacy 데이터가 존재하는 것은
  아니므로 requires 잠금은 과잉 선행이 될 수 있다.",
  "confidence": 0.74 },
      { "claim": "완전 초기화 UX는
  LEARN_RESET_CLEAR_STORAGE와 LEARN_RESET_UI_STATE를 함께
  수행하는 것을 권장한다.", "reason": "키 삭제만 수행하면
  화면에 남아있는 answer/result/flags가 그대로여서 사용자가
  초기화를 체감하지 못한다.", "confidence": 0.78 },
      { "claim": "LEARN_GRADE_BUTTON_LABEL_STATE는 채점 후
  편집 정책을 사용자가 이해하는 데 도움이 된다.", "reason":
  "입력 변경 시 결과를 초기화하는 경우 버튼을 \"다시 채점
  \"으로 전환하면 스테일 결과를 줄이고 다음 행동을 안내한
  다.", "confidence": 0.70 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력하고, LEARN_JSON_VALIDATE_PARSE로
  파싱 통과를 확인한다.", "reason": "reviewer 지적처럼 JSON
  파싱 실패는 결합 패치 검증/병합 파이프라인을 중단시킨
  다.", "confidence": 0.84 },
      { "claim": "R3 Transfer 산출물은 FE/UX 티켓에서는 상
  태 전이(입력→활성화→채점→저장→복원→초기화) 예시로 대체하
  거나 N/A를 명시하는 방식이 적합하다.", "reason": "problem
  templates/triplets은 도메인 부적합일 수 있어 reviewer 권
  고대로 도메인 맞춤 전이 근거로 전환하는 편이 안전하다.",
  "confidence": 0.74 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 제출/저장 흐름 기준선 요약 | 현재는
  문제별 제출→단건 채점→submissions merge 저장 구조라, bulk
  전환 시 무엇이 바뀌는지 기준선이 필요 | 높음 |
  | 2 | StoredResult(submissions) 스키마 명시 |
  localStorage
  저장/복원 계약이 명시되지 않으면 bulk 저장으로 전환 시 호
  환/마이그레이션 규칙이 흔들림 | 높음 |
  | 3 | 문제 카드별 제출 버튼 제거 | 요구사항 1) 핵심인데
  현
  재 UI는 per-problem 제출에 고정 | 높음 |
  | 4 | 하단 단일 채점하기(전체 제출) 버튼 | 요구 UX의 유일
  한 진입점이 필요하나 현재 없음 | 높음 |
  | 5 | 채점하기 disabled 기준(정규화 일관성) | disabled 판
  정이 normalizeNumericInput()과 불일치하면 " , " 같은 입력
  에서 활성/비활성이 채점과 엇갈림 | 높음 |
  | 6 | allAnswered 계산(정규화 기반) | problems[] 전체를
  기
  준으로 “모두 입력됨”을 안정적으로 계산해야 함(로딩 타이
  밍/
  문제 수 변화 포함) | 높음 |
  | 7 | 입력 엣지케이스 10+ 정의 | AC 요구 충족을 위해 최소
  벡터가 필요(예: "", " ", ",", " , ", "0", "-0", "1,234",
  "
  1 234 ", "+", ".", "Infinity" 등) | 중 |
  | 8 | 일괄 채점 액션(전체 순회→gradeNumericAnswer) | 현재
  는 submitProblem(problem)로 단건 채점만 가능해 bulk 채점
  동작이 없음 | 높음 |
  | 9 | 채점 전/후 상태 플래그(hasGraded/isSubmitted) | 채
  점
  전 점수/정답 노출(0/N) 및 복원 후 표시 기준 혼란을 막기
  위
  해 필요 | 중 |
  |10| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 노출
  해야 UX가 일관되고 legacy partial 데이터 혼선을 줄임 | 중
  |
  |11| bulk 저장(답안+결과를 한 번에 저장) | 요구사항 3) 저
  장 시점이 개별 제출이 아니라 일괄 채점 후로 바뀌어야 함 |
  높음 |
  |12| bulk 복원(재진입/새로고침) | 저장된 답안/결과를 복원
  해 상태를 재구성해야 함 | 높음 |
  |13| legacy partial 호환/정책 | 기존 per-problem 저장은
  submissions 일부만 남기는 데이터가 정상으로 생성되므로,
  bulk 전환 후 충돌 방지 정책이 필요 | 높음 |
  |14| 다시 풀기(초기화): 키 삭제 + UI 리셋 | 요구사항 4)이
  며 키 삭제만으로는 화면이 즉시 초기화되지 않음 | 높음 |
  |15| strict JSON 산출 가드 | reviewer 지적처럼 문자열 내
  부
  줄바꿈이 있으면 파싱/병합이 실패하므로 산출물 JSON은
  strict JSON이어야 함 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | R3 Transfer 템플릿/트리플릿 강제 | 본 티켓은 FE/UX
  개선이며 problem templates/triplets은 도메인 부적합(또는
  N/A 처리 필요) | N/A 명시 또는 최소 전이(상태 전이) 예시
  로
  대체 |
  | 2 | 서버 연동/DB 저장 | Out of Scope 위반, localStorage
  요구를 흐림 | 금지 |
  | 3 | 문제 타입 확장(서술형/객관식) | 이번 티켓 범위를 벗
  어남 | 금지(후속 티켓) |
  | 4 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하며 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 5 | 문제은행 JSON 스키마 변경 | 데이터 구조 변경은 범위
  밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 6 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | 문제별 제출 제거 → bulk 버튼/액션 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | 채점하기
  +gradeAll 구현 후 제거 |
  | 2 | disabled(원문 기준) → 채점(정규화 기준) | " , " 등
  에
  서 활성/비활성과 채점이 불일치해 UX 붕괴 | disabled는
  normalizeNumericInput(answer).length>0로 통일 |
  | 3 | bulk 저장 도입 → legacy partial 복원 | 기존
  submissions 일부만 저장된 데이터가 bulk 표시/disabled와
  충
  돌 | partial 감지 후 정책(초기화/답안만 복원/재채점 유도)
  |
  | 4 | 점수 표시 → 채점 UX | 채점 전 0/N 노출은 “이미 채점
  됨” 오해 유발 | hasGraded 도입 후 채점 후에만 점수/정답
  표
  시 |
  | 5 | 채점 후 입력 수정 → 결과 유지 | 입력과 결과가 불일
  치
  (스테일) 상태 발생 | 입력 변경 시 결과 초기화 또는 다시
  채
  점 플로우 |
  | 6 | 초기화(키 삭제만) → UI 상태 유지 | 저장소만 지우면
  화면에 남은 answer/result/flags가 그대로 | 키 삭제 + UI
  리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 1페
  이
  지 요약", "domain": "FE", "rep": "C", "confidence":
  0.86 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 문서
  화", "domain": "FE", "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "페이지 하단 단일 버튼(채점하기/전체
  제출) 추가", "domain": "FE", "rep": "P", "confidence":
  0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.82 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 정의(빈값/공백/
  콤마/0/부호/소수점 등)", "domain": "QA", "rep": "C",
  "confidence": 0.76 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회
  →gradeNumericAnswer)", "domain": "FE", "rep": "P",
  "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded 등) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 계산(결과 맵 기반)", "domain": "FE",
  "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/정오/정답 표시(게이
  팅)", "domain": "FE", "rep": "P", "confidence": 0.76 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 스키마(답안+결과) 계약 정
  의", "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/검증 규칙(JSON
  shape
  validate)", "domain": "FE", "rep": "C", "confidence":
  0.78 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 답안+결과를 한 번에 저
  장", "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 결과/답안 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(부분 제출) 호
  환/정책", "domain": "FE", "rep": "C", "confidence":
  0.74 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI 상태 리셋(answer/results/
  flags)", "domain": "FE", "rep": "P", "confidence":
  0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 재입력 정책(결과 초기화 또는
  다시 채점)", "domain": "UX", "rep": "C", "confidence":
  0.7 },
  { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장(문
  자열 줄바꿈 금지)", "domain": "QA", "rep": "C",
  "confidence": 0.84 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_LOCALSTORAGE_SAVE_BULK", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.74 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_STRICT_JSON_OUTPUT_GUARD", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires",
  "confidence": 0.74 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "현재 LearnPage는 문제별 제출
  (submitProblem)로 단건 채점 후 submissions를 localStorage
  키(curriculum-viewer:learn:lastResult:${nodeId})에 merge
  저장한다.", "reason": "LearnPage.tsx에서
  StoredResult{submissions} 타입 정의와
  setItem(JSON.stringify(payload)) 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은 normalizeNumericInput과 동
  일 기준으로 정의해야 한다.", "reason":
  "normalizeNumericInput이 공백/콤마 제거를 수행하므로 원문
  기준 disabled는 채점과 불일치해 UX가 붕괴한다.",
  "confidence": 0.82 },
  { "claim": "R3 Transfer 산출물은 본 티켓(UX/FE)에서는
  problem templates/triplets 대신 상태 전이(입력→활성화→채
  점
  →저장→복원→초기화) 전이 예시로 대체하거나 N/A를 명시하는
  방식이 적합하다.", "reason": "reviewer도 FE/UX 티켓에서
  Transfer 항목을 N/A 처리 또는 도메인 맞춤 예시로 대체하라
  고 권고했다.", "confidence": 0.74 },
  { "claim": "legacy partial(부분 제출) 데이터는 bulk 전
  환 시 필연적으로 존재할 수 있어 복원 단계에서 감지/정책화
  가 필요하다.", "reason": "기존 per-problem 저장은 전체 문
  제 수보다 적은 submissions를 남기는 것이 정상 동작이었
  다.", "confidence": 0.74 },
  { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈이 있
  으면 파서가 실패하므로 strict JSON으로 재출력되어야 한
  다.", "reason": "reviewer 지적처럼 JSON 파싱 실패는 결합
  패치 검증/병합 파이프라인을 중단시킨다.", "confidence":
  0.84 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY,
    LEARN_STRICT_JSON_OUTPUT_GUARD
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:726064d7ea###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_6c75ecb0f6.md


  41% context left



› Request 6c75ecb0f6: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_6c75ecb0f6.md


    Read research_6c75ecb0f6.md                         

◦ Checking output format (55s • esc to interrupt)    


› Improve documentation in @filename

  47% context left · ? for shortcuts


• Explored
  └ Read research_6c75ecb0f6.md
    Search Output Format|## Rules|\[/R1 Coverage Report\]|
^##
           Coverage Gap Report in research_6c75ecb0f6.md
    Read research_6c75ecb0f6.md

─ Worked for 55s ──────────────────────────────────────────

• Context compacted

         research_6c75ecb0f6.md                         

◦ Proposing a bridging node (12m 01s • esc to interrupt)   


› Improve documentation in @filename

  100% context left · ? for shortcuts


• Explored
  └ List inbox
    Search ^## (Output Format|Rules|Coverage Gap Report)\b|
^\[/
           R1 Coverage Report\]|^\[/R2 Progression
Report\]|
           ^###DONE: in research_6c75ecb0f6.md
    Search R1 Coverage Report in research_6c75ecb0f6.md
    Read research_6c75ecb0f6.md
    Search "type"\s*:\s*"step" in research_*.md
    Read research_f0805f8d87.md, T1.md
    List curriculum_viewer_learning_bulk_submit_v1
    Read task.md
    Search ## Graph Patch JSON in research_638d80efe8.md
    Read research_638d80efe8.md, LearnPage.tsx,
         research_6c75ecb0f6.md

─ Worked for 12m 01s ──────────────────────────────────────

• ###BEGIN:6c75ecb0f6###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항 1의 단일 진입점 제공 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 입력됨 판정 기
  준(predicate) 정의(정규화 기반) | FE | C | disabled/채점
  기준 불일치로 인한 UX 붕괴 방지 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled” 구
  현 핵심 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 단일 클릭으로 문제 전체 채점 수행 |
  | 6 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 채점 전 0/N 및 결과 노출을 제
  어하기 위한 기준 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/결
  과 표시(게이팅) | FE | P | 채점 전 표시 혼선(0/N,
  partial) 차단 |
  | 8 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | 상단 점수 표시 계산을 분리해 회귀 방지 |
  | 9 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표
  시(일괄 채점 후) | FE | P | 문제 카드별 피드백 제공(정답/
  오답/정답값) |
  | 10 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | 저장/복원/legacy 처리의 기준 스
  키마 확정 |
  | 11 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | UI 상태에서
  submissions payload 생성 | FE | P | gradeAll 출력과
  StoredResult{submissions} 저장을 연결 |
  | 12 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | “채점 후 한 번에 저장”
  요구사항 3 충족 |
  | 13 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 학습 연속성 확보 및 새로고침
  회귀 방지 |
  | 14 | LEARN_RESET_UI_STATE | 다시 풀기: 저장 삭제 + UI
  state 리셋 | FE | P | 초기화가 화면에 즉시 반영되도록 보
  장 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  를 방지하고 재채점 유도 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 제출 UI를 단일 버튼으로
  바꾸고 disabled 규칙을 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_GRADED_STATE_FLAG, LEARN_SCORE_AND_RESULT_GATING,
  LEARN_SCORE_SUMMARY_CALC, LEARN_SHOW_PER_PROBLEM_RESULT |
  gradeAll 이후 표시/게이팅/점수 집계를 일관되게 렌더 |
  | 3 | STEP_PERSIST_RESTORE_FLOW | 저장/복원 계약 구현 |
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회로 단순화 |
  | 4 | STEP_RESET_EDIT_FLOW | 초기화 + 채점 후 편집 정책 |
  LEARN_RESET_UI_STATE, LEARN_AFTER_GRADE_EDIT_POLICY |
  reset과 편집 정책으로 스테일/잔상 상태를 제거 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이는 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | 총점은 문제별 채점 결과가 있어
  야 집계 가능 | 0.78 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | 정오/정답 표시는 채점 결
  과 생성이 선행 | 0.78 |
  | 4 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 정의에
  의존 | 0.76 |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 6 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거 전에 대체 진입점을 마
  련하면 기능 공백을 방지 | 0.80 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 정의가 유용 | 0.70 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트를 gradeAll로 연결
  해야 UX 완성 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅이 표
  시 기준을 단순화 | 0.74 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능해도 노출은
  hasGraded일 때 권장 | 0.70 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 정오/정답도 hasGraded일
  때만 노출하는 편이 안정 | 0.72 |
  | 7 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정 권장 | 0.70 |
  | 8 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADED_STATE_FLAG | 답 변경 시 hasGraded 초기화/재
  채점 유도 규칙이 필요 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_ALL_ANSWERED_NORMALIZED | 복원된 답안도 disabled 판
  정에 반영되어야 함 | 0.72 |
  | 10 | LEARN_RESET_UI_STATE →
  LEARN_ALL_ANSWERED_NORMALIZED | reset 후 allAnswered가 다
  시 false가 되도록 초기화 | 0.72 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 공백/콤마/0 입
  력에서 “입력됨” 직관과 채점 기준이 어긋남 |
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩/0개
  상태에서 allAnswered가 흔들려 버튼 상태가 불안정 |
  problems 길이 0이면 disabled 또는 버튼 숨김 규칙을 먼저
  고정 | 0.75 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 버튼의 위
  치/disabled/라벨이 산재하면 UX 일관성이 깨짐 | 단일 버튼
  을 페이지 하단에 고정하고 상태를 derived로 계산 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 answer
  map 조회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → submissions 맵을 반환하는
  순수 함수로 분리 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG | 복원/부분 데이터에서
  hasGraded의 의미가 모호해 결과 노출이 흔들림 | hasGraded
  를 “유효한 제출 결과 존재”로 정의하고 일관되게 세팅 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | UI 렌더를
  hasGraded로 게이트하고 채점 전에는 score/result를 숨김 |
  0.74 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | problems 변경/정렬과 결
  과 맵 키가 불일치하면 점수 집계가 틀어짐 | score는
  problems 배열을 기준으로 problem.id 키로 집계하도록 고정
  | 0.70 |
  | 8 | LEARN_SHOW_PER_PROBLEM_RESULT | 결과를 문제 카드에
  매핑할 때 key/순서 혼동으로 오표시 가능 | 항상 problem.id
  로 result를 조회해 동일 카드에 렌더 | 0.76 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | UI state(answers/
  results)와 StoredResult{submissions} 표현 전환이 어려움 |
  저장 계약을 answers+isCorrect 중심으로 명시하고 단일
  payload로 합침 | 0.80 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | 기존 merge 저장
  습관으로 partial/legacy 데이터가 섞여 UX 충돌 | gradeAll
  출력으로 submissions를 새로 구성해 overwrite 저장 | 0.78
  |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성/회귀 추적이 어려움 | 채점 버튼 클릭 시점
  에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_RESET_UI_STATE | storage만 삭제하면 화면의
  answer/result/flags 잔상이 남아 초기화가 체감되지 않음 |
  storage 삭제와 함께 state(answer/result/hasGraded)를 초기
  값으로 리셋 | 0.78 |
  | 14 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태가 발생 | 입력 변경 시
  결과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 기준을 명시
  해 disabled/allAnswered/테스트에서 재사용 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서 유연화
  |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류 감소 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터로 hasGraded를 결정한 뒤 노출을 게이트하도록
  중간 기준 제공 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제 차단 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후에는 결과를 숨기거
  나 재채점을 유도하는 게이트를 중간에 둠 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 추가 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | legacy/partial 처리도 최
  종 스키마 기준으로 판정하도록 기준점을 둠 |
  | 9 | LEARN_SCORE_SUMMARY_CALC →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_BULK_GRADE_ALL_ACTION | 점수/표시 둘 다 동일한
  gradeAll 결과를 단일 소스로 삼아 불일치 방지 |
  | 10 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 전에 새 진입점(단일 버튼)을 확보해 기능 공백을 방
  지 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "입력됨 판정 기준(predicate) 정의(정
  규화 기반)", "domain": "FE", "rep": "C", "confidence":
  0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원 계약 구현", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
      { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "0개/로딩 처리는 권장이지만 allAnswered 구현의
  필수 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires", "reason":
  "result 맵 설계/구현은 액션과 동시 설계가 가능해 단일 선
  행 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 액션에서 세팅하길 권장하지만 정의/도입은 독
  립적으로 가능", "confidence": 0.74 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부 케이스로서 requires보
  다 권장/노트가 적절", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 }
    ],
    "notes": [
      { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "UI 기준과 채점 기준이 다
  르면 \" , \" 같은 입력에서 버튼 상태와 채점 결과가 불일치
  한다.", "confidence": 0.82 },
      { "claim": "hasGraded를 도입하고 score/result는
  hasGraded일 때만 노출하는 것이 UX 혼선을 줄인다.",
  "reason": "채점 전 0/N 노출 및 부분 저장 데이터 노출을 통
  제하려면 표시 기준을 단일 플래그로 고정해야 한다.",
  "confidence": 0.74 },
      { "claim": "일괄 제출은 submissions를 merge하지 말고
  gradeAll 결과로 overwrite 저장하는 편이 안전하다.",
  "reason": "merge 저장은 legacy partial을 필연적으로 만들
  고 bulk UX에서 복원/표시 충돌을 유발한다.", "confidence":
  0.78 },
      { "claim": "복원은 try/catch + nodeId 검증 +
  submissions 최소 shape 검증으로 런타임 오류를 방어하는 것
  이 권장이다.", "reason": "잘못된/legacy 데이터는
  JSON.parse 실패나 필드 누락으로 즉시 크래시/UX 꼬임을 만
  든다.", "confidence": 0.74 },
      { "claim": "채점 후 답 변경 시 결과를 초기화하거나 재
  채점 플로우를 고정해야 스테일 상태를 피할 수 있다.",
  "reason": "입력과 결과가 불일치하면 학습자가 상태를 해석
  하기 어렵고 신뢰도가 급락한다.", "confidence": 0.76 },
      { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/hasGraded) 리셋을 함께 수행하는 것이
  권장이다.", "reason": "키 삭제만 수행하면 화면에 남아있는
  상태 때문에 초기화를 체감하지 못한다.", "confidence":
  0.78 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 로직을 알아야 bulk 전환 시 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마/partial 의미 | 기
  존
  은 submissions merge로 부분 데이터가 정상 생성되어 bulk
  UX
  와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점이 필요(라벨/disabled/재채점 포함) | 높음 |
  | 6 | 미입력 판정 기준 정합화 | disabled 판정이
  normalizeNumericInput()과 불일치하면 채점과 UX가 엇갈림 |
  높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/빈 배열 포함 안정적으
  로
  계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 테스트 벡터(12종+) | 공백/콤마/0/부
  호/소수점/Infinity 등에서 기대값이 흔들려 회귀가 잦음 |
  중
  |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 문제 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성 및 결과 표시 규칙 | 문제별 정
  오/정답 표시와 점수 집계를 problemId 기준으로 정렬해야 함
  | 중 |
  |11| hasGraded 게이팅(채점 후 표시) | 채점 전 0/N 및
  partial 결과 노출 혼선을 막기 위한 표시 시점 규칙 필요 |
  중 |
  |12| 일괄 저장(전체 submissions 1회 저장) | 요구사항 3)
  저
  장 시점을 “일괄 채점 후 setItem 1회”로 전환해야 함 | 높음
  |
  |13| 복원 파이프라인(파싱/검증/legacy 정책) | 잘못된/
  legacy 데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함
  | 중 |
  |14| 다시 풀기: storage 삭제 + UI state 리셋 | 키 삭제만
  으
  로는 화면이 즉시 초기화되지 않아 state(answer/result/
  flags) 리셋이 필요 | 높음 |
  |15| 채점 후 답 변경 처리 정책 | 입력 변경 시 결과가 스테
  일해지므로 결과 초기화 또는 재채점 플로우를 고정해야 함 |
  중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓 분리) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 로직 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | gradeNumericAnswer 유지 |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 구현
  후
  제거 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 없으면 버
  튼 활성/비활성 기준이 흔들림 | normalize 기반 allAnswered
  를 먼저 고정 |
  | 3 | 원문 disabled 판정 → gradeNumericAnswer(정규화) |
  " , " 같은 입력에서 활성/채점 결과가 불일치해 UX 붕괴 |
  normalizeNumericInput(answer).length>0로 통일 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마/검증 없이 복원하
  면 파싱 실패·필드 누락이 런타임 문제로 이어짐 | schema 정
  의 + shape validate + 예외 처리 |
  | 5 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | restored partial에서 점
  수/
  결과 노출 기준이 불명확 | hasGraded 세팅 규칙(완전 제출만
  true 등) 정의 |
  | 6 | LEARN_RESET_CLEAR_STORAGE → (UI state 유지) |
  storage만 지우면 화면에 남은 answer/result/flags가 그대로
  | 키 삭제 + state 리셋 동시 수행 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY 미정 → 결과 표시 유지
  | 답 변경 후 스테일 결과(입력≠결과) 상태가 발생 | 입력 변
  경 시 결과 초기화 또는 “다시 채점” 플로우 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_HANDLE_EMPTY_PROBLEMS", "type":
  "micro", "name_ko": "문제 0개/로딩 상태 UI 규칙",
  "domain": "UX", "rep": "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" },
  { "from": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx의 submitProblem과
  StoredResult{submissions} setItem 흐름을 확인.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로만 '입력
  됨'을 판정해야 한다.", "reason": "grading이
  normalizeNumericInput을 사용하므로 원문 기준 disabled는
  활
  성/채점 불일치를 만든다.", "confidence": 0.82 },
  { "claim": "현재 score는 problems가 있으면 채점 전에도
  0/N이 노출될 수 있어 hasGraded 게이팅이 필요하다.",
  "reason": "score 계산은 resultByProblemId가 비어도
  {correct:0,total:N}을 반환한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 데이터는
  bulk UX에서 복원/점수/표시와 충돌하므로 정책이 필요하
  다.",
  "reason": "기존 per-problem 저장은 submissions를 merge하
  여
  부분 데이터가 정상적으로 생성된다.", "confidence":
  0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제만으로는
  충분하지 않고 UI state(answer/result/flags) 리셋이 필요하
  다.", "reason": "LearnPage는 answerByProblemId/
  resultByProblemId를 state로 유지하므로 화면이 남을 수 있
  다.", "confidence": 0.78 },
  { "claim": "일괄 제출은 setItem 1회로 전체 submissions
  를 저장해야 저장/복원/초기화 계약이 단순해진다.",
  "reason": "요구사항은 일괄 채점 후 한 번에 저장이며,
  merge
  저장은 partial을 필연적으로 만든다.", "confidence": 0.8 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_HANDLE_EMPTY_PROBLEMS,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:6c75ecb0f6###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_4541b0237a.md


  72% context left



› Request 4541b0237a: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_4541b0237a.md


    Read research_4541b0237a.md  

◦ Reviewing edge removals (4m 11s • esc to interrupt)      


› Improve documentation in @filename

  100% context left · ? for shortcuts


• Explored
  └ Search ^## (Output Format|Rules|Coverage Gap Report)\b|
^\[/
           R1 Coverage Report\]|^\[/R2 Progression
Report\]|
           ^\[/R3 Transfer Report\]|^###DONE: in
           research_4541b0237a.md
    Read research_4541b0237a.md
    Search ^\s*\[/R1 Coverage Report\] in
           research_4541b0237a.md
    Read research_4541b0237a.md

─ Worked for 4m 11s ───────────────────────────────────────

• ###BEGIN:4541b0237a###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 요약 | FE | C | bulk 전환 시 회귀/기능공백을
  추적할 기준선을 만든다 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화가 같은 키 계약에 의존하
  므로 전제 확인이 필요하다 |
  | 3 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA | StoredResult/
  submissions 스키마 확인 | FE | C | bulk 저장으로 바꿔도
  호환되는 데이터 계약을 명시해야 한다 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  한다 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항의 단일 진입점(채점하기/전체
  제출)을 제공한다 |
  | 6 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 미입력 판정
  predicate 정의(정규화 기반) | FE | C | disabled/채점 기준
  불일치로 인한 UX 붕괴를 방지한다 |
  | 7 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled”를
  안정적으로 계산한다 |
  | 8 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  테스트 벡터 | QA | C | 공백/콤마/부호 등에서 판정 흔들림
  을 사전에 고정한다 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 한 번의 클릭으로 모든 문제를 채점하는 동
  작을 만든다 |
  | 10 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장에 공통
  으로 쓰는 중간 표현을 만든다 |
  | 11 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 채점 전 0/N 노출 및 partial
  결과 노출 혼선을 제어한다 |
  | 12 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  결과 표시(게이팅) | FE | P | 결과 노출 시점을 고정해 UX를
  일관되게 만든다 |
  | 13 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | 상단 점수 표시를 문제별 결과에서 안정적으로 계산한
  다 |
  | 14 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 문제 카드에 정오/정답값
  을 일관되게 렌더한다 |
  | 15 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | “채점 후 1회 저장” 스냅샷 구조를
  스키마로 고정한다 |
  | 16 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | UI 상태에서
  submissions payload 생성 | FE | P | answers/results를
  StoredResult{submissions}로 직렬화한다 |
  | 17 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고 1
  회 setItem으로 저장 시점을 단순화한다 |
  | 18 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터
  shape validate | FE | C | 잘못된/누락 필드로 인한 런타임
  오류와 UX 꼬임을 방지한다 |
  | 19 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial(submissions 일부) 처리 정책 | FE | C | 기
  존 merge 저장이 만든 partial을 bulk UX에 맞게 처리한다 |
  | 20 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태를 복원한다 |
  | 21 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화의 근거를 만든다 |
  | 22 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면에 남는 answer/result/flags 잔상을 제거한다
  |
  | 23 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과)를 방지한다 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼과 disabled 규칙
  을 묶어 UX 기준을 고정한다 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | gradeAll 결과를 중간 표현
  으로 만들고 게이팅/표시를 일관화한다 |
  | 3 | STEP_PERSIST_RESTORE_FLOW | 저장/복원/legacy 처리 |
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 저장 계약을 먼저 고정하
  고 복원/legacy 정책을 조건부로 적용한다 |
  | 4 | STEP_RESET_EDIT_FLOW | 초기화 + 채점 후 편집 정책 |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | reset과 편집 정책으로 잔
  상/스테일 상태를 제거한다 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이는 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 일괄 채점은 문제별 결과 맵 생성
  (또는 동등 표현)을 포함해야 완성 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점은 문제별 채점 결과가 있어야 집계 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 제출/저장 경로를
  알아야 제거 후 회귀를 줄일 수 있음 | 0.76 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거 전에 대체 진입점을 마
  련하면 기능 공백을 방지 | 0.80 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 정의가 유용 | 0.70 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트를 gradeAll로 연결
  해야 UX 완성 | 0.72 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능해도 노출은
  hasGraded일 때 권장 | 0.70 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy가 있을 때만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADED_STATE_FLAG | 답 변경 시 hasGraded 초기화/재
  채점 유도 규칙이 필요 | 0.74 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정하는 편이 안정 | 0.70 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | UI의 “입력됨”
  직관과 정규화 기준이 어긋나 disabled/채점이 불일치 |
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개 상태
  에서 allAnswered가 흔들려 버튼 상태가 불안정 | problems
  길이 0/로딩 상태의 disabled 규칙을 명시하고 안정적으로 계
  산 | 0.74 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 버튼 라벨/disabled/재
  채점 상태가 분산되면 UX가 일관되지 않음 | 단일 버튼을 하
  단 고정 + derived state로 label/disabled를 결정 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점 중 입력 조
  회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → resultByProblemId 반환으로
  순수 함수화 | 0.78 |
  | 5 | LEARN_BUILD_RESULT_MAP | 결과를 index 기반으로 다루
  면 문제 순서 변경 시 오표시 위험 | 항상 problem.id 키로
  resultByProblemId를 구성/조회하도록 고정 | 0.76 |
  | 6 | LEARN_GRADED_STATE_FLAG | 복원/partial 데이터에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효한 채점 결과 존재”로 정의하고 일관되게 세팅 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | score/result
  렌더를 hasGraded로 게이트하고 채점 전에는 숨김 | 0.74 |
  | 8 | LEARN_SCORE_SUMMARY_CALC | results가 비어도 0/N이
  계산되어 채점 전 표시 혼선이 생김 | 계산은 하되 UI 노출은
  hasGraded일 때만 하도록 분리 | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | merge 저장 습관이
  남으면 partial/legacy가 계속 생겨 UX가 꼬임 | bulk는
  overwrite 스냅샷 저장으로 고정하고 schema로 명시 | 0.78 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 StoredResult{submissions}로 변환할 때 필드/형식 누락이
  발생 | gradeAll 결과를 단일 소스로 payload를 구성하고 직
  렬화 경로를 단순화 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성 및 회귀 추적이 어려움 | 채점 버튼 클릭 시
  점에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도(또는 초기
  화) | 0.74 |
  | 14 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result/flags 잔상이 남아 초기화가 체감되지 않음 | storage
  삭제와 함께 state(answer/result/hasGraded)를 초기값으로
  리셋 | 0.78 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태 발생 | 입력 변경 시 결
  과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 동시에 정
  합화한다 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서를 유연
  하게 만든다 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류를 줄인다 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터에서 hasGraded를 결정한 뒤 노출을 게이트하면
  표시 규칙이 단순해진다 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제를 차단한다 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 이후 결과 노출 여부
  를 게이트로 통제하면 스테일 상태를 예방한다 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 둔다 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | legacy/partial 판정과
  복원을 검증 단계로 매개해 런타임 꼬임을 줄인다 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 불일치를 줄
  인다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 흐름에서 bulk 저장
  으로 전환할 때 스키마를 중간 기준점으로 두면 회귀 추적이
  쉬워진다 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원/legacy 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "정규화 기준 자체보다 '입력됨 predicate'를 중간
  노드로 두면 disabled/allAnswered를 한 번에 정합화할 수 있
  어 기존 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded 정의/도입은 gradeAll과 병렬로 가능해 단일 선행
  잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 구현 중 즉시 확인 가능해 필수
  선행 잠금보다 노트가 적절", "confidence": 0.70 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 restore 구현의 필수 개념이지만
  requires 잠금으로 강제할 필요는 낮음", "confidence":
  0.68 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 단일 선행 잠금은 과
  잉", "confidence": 0.78 }
    ],
    "notes": [
      { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  \" , \" 같은 입력에서 버튼 상태와 채점 결과가 불일치한
  다.", "confidence": 0.82 },
      { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, score/result 노출은 hasGraded일 때만
  하는 것이 권장이다.", "reason": "채점 전 0/N 및 legacy
  partial 노출을 통제하려면 표시 기준을 단일 플래그로 고정
  해야 한다.", "confidence": 0.74 },
      { "claim": "per-problem 제출 제거는 bulk 경로(버튼/
  gradeAll/저장)가 준비된 뒤 진행하는 것이 권장이다.",
  "reason": "제거가 먼저면 채점/저장 경로가 사라져 기능 공
  백이 발생한다.", "confidence": 0.72 },
      { "claim": "legacy partial(submissions 일부) 데이터는
  조건부로 감지해 초기화 또는 재채점 유도 등 정책을 적용하
  는 것이 권장이다.", "reason": "기존 merge 저장으로 부분
  데이터가 정상 생성되었고, 이를 그대로 노출하면 \"채점됨\"
  오해가 생긴다.", "confidence": 0.74 },
      { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행하는 것이 권장
  이다.", "reason": "키 삭제만 수행하면 화면에 남은 상태 때
  문에 초기화가 즉시 반영되지 않는다.", "confidence":
  0.78 },
      { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)로 문자열 내부 줄바꿈 없이 출력해야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검증/병합 파이프라인을 중단시킨다.", "confidence": 0.90 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | 기존
  submitProblem/저장 merge 동작을 알아야 bulk 전환 시 기능
  공백/회귀를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 partial 의미 |
  기존 per-problem 저장은 submissions 일부만 남기는 데이터
  가
  정상 생성되어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 동작/표시가 일
  관됨 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 " , " 등에서 UX가 붕괴
  | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정
  적으로 계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", " , ",
  "0", "-0", "1,234", "+", ".", "Infinity" 등에서 기대값이
  흔들림 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/집계 기준 | 점수/결과 표시/저
  장을 problemId로 정렬하는 중간 표현이 필요 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  legacy partial 결과 노출 혼선을 막을 표시 기준이 필요 |
  중
  |
  |12| 결과/점수 표시 게이팅 규칙 | 채점 후에만 점수/정오/
  정
  답을 표시해야 UX가 일관되고 partial 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “일괄
  채점 후 한 번에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함 | 중 |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 answer/result/flags 리셋이
  필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | per-problem 제출 제거 → bulk 채점 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 구현 후 제거 |
  | 2 | 원문 disabled → 정규화 채점 | " , " 등에서 활성/비
  활
  성과 채점 기준이 엇갈려 UX 붕괴 | normalizeNumericInput
  기
  반으로 미입력 판정 통일 |
  | 3 | bulk 버튼 추가 → allAnswered 부재 | disabled 조건이
  불명확해 조기 활성/비활성이 흔들림 | problems[] 기반
  allAnswered(정규화) 먼저 고정 |
  | 4 | 저장 구현 → 복원/검증 미정 | 파싱 실패/필드 누락 시
  런타임 오류 및 상태 꼬임 | schema+shape validate+예외 처
  리
  추가 |
  | 5 | legacy partial 복원 → 결과 노출 | 부분 submissions
  가
  “채점됨”처럼 보이면 오해/혼선 발생 | partial 감지 시
  hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | 초기화(키 삭제만) → UI 잔상 | storage만 지우면
  answer/result/flags가 화면에 남음 | 키 삭제 + UI state 리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submitProblem과
  StoredResult{submissions} setItem 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled의 '입력됨' 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading이 normalizeNumericInput을 사용
  하므로 원문 기준 disabled는 채점과 불일치해 UX를 망친
  다.",
  "confidence": 0.84 },
  { "claim": "점수/정오/정답 표시는 hasGraded로 게이트해
  야 채점 전 0/N 및 partial 노출 혼선을 줄인다.", "reason":
  "현재 score는 problems가 있으면 result가 비어도 0/N을 표
  시
  할 수 있어 오해를 유발한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 처리는 조
  건부 정책이며 restore를 migration에 과잉 잠금(requires)하
  지 않는 편이 안전하다.", "reason": "migration은 legacy가
  존재할 때만 필요하고 reviewer도 requires 과잉 잠금을 지적
  했다.", "confidence": 0.72 },
  { "claim": "per-problem 제출 제거는 권장 순서이며,
  bulk 경로(버튼/gradeAll/저장)가 준비된 뒤 제거해야 기능
  공
  백을 피한다.", "reason": "제거가 먼저면 채점/저장 경로가
  사라져 사용자가 진행 불가 상태가 된다.", "confidence":
  0.72 },
  { "claim": "다시 풀기는 localStorage 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태 때문에 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검
  증/병합 파이프라인을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:4541b0237a###


› Improve documentation in @filename

  73% context left · ? for shortcuts 


============================================================
[2026-01-08 13:11:29] RESEARCH2 (req_id: 4faa8473cc)
============================================================
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | problems 로딩/0개
  상태에서 allAnswered가 흔들려 버튼 상태가 불안정 |
  problems 길이 0이면 disabled 또는 버튼 숨김 규칙을 먼저
  고정 | 0.75 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 버튼의 위
  치/disabled/라벨이 산재하면 UX 일관성이 깨짐 | 단일 버튼
  을 페이지 하단에 고정하고 상태를 derived로 계산 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 answer
  map 조회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → submissions 맵을 반환하는
  순수 함수로 분리 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG | 복원/부분 데이터에서
  hasGraded의 의미가 모호해 결과 노출이 흔들림 | hasGraded
  를 “유효한 제출 결과 존재”로 정의하고 일관되게 세팅 |
  0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | UI 렌더를
  hasGraded로 게이트하고 채점 전에는 score/result를 숨김 |
  0.74 |
  | 7 | LEARN_SCORE_SUMMARY_CALC | problems 변경/정렬과 결
  과 맵 키가 불일치하면 점수 집계가 틀어짐 | score는
  problems 배열을 기준으로 problem.id 키로 집계하도록 고정
  | 0.70 |
  | 8 | LEARN_SHOW_PER_PROBLEM_RESULT | 결과를 문제 카드에
  매핑할 때 key/순서 혼동으로 오표시 가능 | 항상 problem.id
  로 result를 조회해 동일 카드에 렌더 | 0.76 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | UI state(answers/
  results)와 StoredResult{submissions} 표현 전환이 어려움 |
  저장 계약을 answers+isCorrect 중심으로 명시하고 단일
  payload로 합침 | 0.80 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | 기존 merge 저장
  습관으로 partial/legacy 데이터가 섞여 UX 충돌 | gradeAll
  출력으로 submissions를 새로 구성해 overwrite 저장 | 0.78
  |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성/회귀 추적이 어려움 | 채점 버튼 클릭 시점
  에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_RESET_UI_STATE | storage만 삭제하면 화면의
  answer/result/flags 잔상이 남아 초기화가 체감되지 않음 |
  storage 삭제와 함께 state(answer/result/hasGraded)를 초기
  값으로 리셋 | 0.78 |
  | 14 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태가 발생 | 입력 변경 시
  결과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76
  |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 기준을 명시
  해 disabled/allAnswered/테스트에서 재사용 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서 유연화
  |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류 감소 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터로 hasGraded를 결정한 뒤 노출을 게이트하도록
  중간 기준 제공 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제 차단 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후에는 결과를 숨기거
  나 재채점을 유도하는 게이트를 중간에 둠 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 추가 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | legacy/partial 처리도 최
  종 스키마 기준으로 판정하도록 기준점을 둠 |
  | 9 | LEARN_SCORE_SUMMARY_CALC →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_BULK_GRADE_ALL_ACTION | 점수/표시 둘 다 동일한
  gradeAll 결과를 단일 소스로 삼아 불일치 방지 |
  | 10 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 전에 새 진입점(단일 버튼)을 확보해 기능 공백을 방
  지 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "입력됨 판정 기준(predicate) 정의(정
  규화 기반)", "domain": "FE", "rep": "C", "confidence":
  0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원 계약 구현", "domain": "FE", "rep":
  "C", "confidence": 0.74 },
      { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
      { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "0개/로딩 처리는 권장이지만 allAnswered 구현의
  필수 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires", "reason":
  "result 맵 설계/구현은 액션과 동시 설계가 가능해 단일 선
  행 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 액션에서 세팅하길 권장하지만 정의/도입은 독
  립적으로 가능", "confidence": 0.74 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "legacy partial은 조건부 케이스로서 requires보
  다 권장/노트가 적절", "confidence": 0.74 },
      { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "복원 시 hasGraded를 저장 필드로 두거나 결과 존재로 파생
  할 수 있어 단일 잠금은 과잉", "confidence": 0.70 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "reason": "게이팅은 hasGraded만으로도 정의 가능하며 편집
  정책은 대체 경로가 있어 필수 선행이 아님", "confidence":
  0.70 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires",
  "reason": "제거/추가/액션 구현은 순서가 바뀌어도 가능하므
  로 requires 잠금은 과잉", "confidence": 0.72 }
    ],
    "notes": [
      { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  grading과 일관된다.", "reason": "UI 기준과 채점 기준이 다
  르면 \" , \" 같은 입력에서 버튼 상태와 채점 결과가 불일치
  한다.", "confidence": 0.82 },
      { "claim": "hasGraded를 도입하고 score/result는
  hasGraded일 때만 노출하는 것이 UX 혼선을 줄인다.",
  "reason": "채점 전 0/N 노출 및 부분 저장 데이터 노출을 통
  제하려면 표시 기준을 단일 플래그로 고정해야 한다.",
  "confidence": 0.74 },
      { "claim": "일괄 제출은 submissions를 merge하지 말고
  gradeAll 결과로 overwrite 저장하는 편이 안전하다.",
  "reason": "merge 저장은 legacy partial을 필연적으로 만들
  고 bulk UX에서 복원/표시 충돌을 유발한다.", "confidence":
  0.78 },
      { "claim": "복원은 try/catch + nodeId 검증 +
  submissions 최소 shape 검증으로 런타임 오류를 방어하는 것
  이 권장이다.", "reason": "잘못된/legacy 데이터는
  JSON.parse 실패나 필드 누락으로 즉시 크래시/UX 꼬임을 만
  든다.", "confidence": 0.74 },
      { "claim": "채점 후 답 변경 시 결과를 초기화하거나 재
  채점 플로우를 고정해야 스테일 상태를 피할 수 있다.",
  "reason": "입력과 결과가 불일치하면 학습자가 상태를 해석
  하기 어렵고 신뢰도가 급락한다.", "confidence": 0.76 },
      { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/hasGraded) 리셋을 함께 수행하는 것이
  권장이다.", "reason": "키 삭제만 수행하면 화면에 남아있는
  상태 때문에 초기화를 체감하지 못한다.", "confidence":
  0.78 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 로직을 알아야 bulk 전환 시 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마/partial 의미 | 기
  존
  은 submissions merge로 부분 데이터가 정상 생성되어 bulk
  UX
  와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점이 필요(라벨/disabled/재채점 포함) | 높음 |
  | 6 | 미입력 판정 기준 정합화 | disabled 판정이
  normalizeNumericInput()과 불일치하면 채점과 UX가 엇갈림 |
  높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/빈 배열 포함 안정적으
  로
  계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 테스트 벡터(12종+) | 공백/콤마/0/부
  호/소수점/Infinity 등에서 기대값이 흔들려 회귀가 잦음 |
  중
  |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 문제 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성 및 결과 표시 규칙 | 문제별 정
  오/정답 표시와 점수 집계를 problemId 기준으로 정렬해야 함
  | 중 |
  |11| hasGraded 게이팅(채점 후 표시) | 채점 전 0/N 및
  partial 결과 노출 혼선을 막기 위한 표시 시점 규칙 필요 |
  중 |
  |12| 일괄 저장(전체 submissions 1회 저장) | 요구사항 3)
  저
  장 시점을 “일괄 채점 후 setItem 1회”로 전환해야 함 | 높음
  |
  |13| 복원 파이프라인(파싱/검증/legacy 정책) | 잘못된/
  legacy 데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함
  | 중 |
  |14| 다시 풀기: storage 삭제 + UI state 리셋 | 키 삭제만
  으
  로는 화면이 즉시 초기화되지 않아 state(answer/result/
  flags) 리셋이 필요 | 높음 |
  |15| 채점 후 답 변경 처리 정책 | 입력 변경 시 결과가 스테
  일해지므로 결과 초기화 또는 재채점 플로우를 고정해야 함 |
  중 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓 분리) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 로직 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | gradeNumericAnswer 유지 |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 구현
  후
  제거 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 없으면 버
  튼 활성/비활성 기준이 흔들림 | normalize 기반 allAnswered
  를 먼저 고정 |
  | 3 | 원문 disabled 판정 → gradeNumericAnswer(정규화) |
  " , " 같은 입력에서 활성/채점 결과가 불일치해 UX 붕괴 |
  normalizeNumericInput(answer).length>0로 통일 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마/검증 없이 복원하
  면 파싱 실패·필드 누락이 런타임 문제로 이어짐 | schema 정
  의 + shape validate + 예외 처리 |
  | 5 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | restored partial에서 점
  수/
  결과 노출 기준이 불명확 | hasGraded 세팅 규칙(완전 제출만
  true 등) 정의 |
  | 6 | LEARN_RESET_CLEAR_STORAGE → (UI state 유지) |
  storage만 지우면 화면에 남은 answer/result/flags가 그대로
  | 키 삭제 + state 리셋 동시 수행 |
  | 7 | LEARN_AFTER_GRADE_EDIT_POLICY 미정 → 결과 표시 유지
  | 답 변경 후 스테일 결과(입력≠결과) 상태가 발생 | 입력 변
  경 시 결과 초기화 또는 “다시 채점” 플로우 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "disabled 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_HANDLE_EMPTY_PROBLEMS", "type":
  "micro", "name_ko": "문제 0개/로딩 상태 UI 규칙",
  "domain": "UX", "rep": "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" },
  { "from": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "to":
  "LEARN_STORE_RESULT_SCHEMA_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_HANDLE_EMPTY_PROBLEMS", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from":
  "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_RESTORE_BULK", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" },
  { "from": "LEARN_AFTER_GRADE_EDIT_POLICY", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx의 submitProblem과
  StoredResult{submissions} setItem 흐름을 확인.",
  "confidence": 0.86 },
  { "claim": "disabled 판정은
  normalizeNumericInput(answer).length>0 기준으로만 '입력
  됨'을 판정해야 한다.", "reason": "grading이
  normalizeNumericInput을 사용하므로 원문 기준 disabled는
  활
  성/채점 불일치를 만든다.", "confidence": 0.82 },
  { "claim": "현재 score는 problems가 있으면 채점 전에도
  0/N이 노출될 수 있어 hasGraded 게이팅이 필요하다.",
  "reason": "score 계산은 resultByProblemId가 비어도
  {correct:0,total:N}을 반환한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 데이터는
  bulk UX에서 복원/점수/표시와 충돌하므로 정책이 필요하
  다.",
  "reason": "기존 per-problem 저장은 submissions를 merge하
  여
  부분 데이터가 정상적으로 생성된다.", "confidence":
  0.74 },
  { "claim": "다시 풀기는 localStorage 키 삭제만으로는
  충분하지 않고 UI state(answer/result/flags) 리셋이 필요하
  다.", "reason": "LearnPage는 answerByProblemId/
  resultByProblemId를 state로 유지하므로 화면이 남을 수 있
  다.", "confidence": 0.78 },
  { "claim": "일괄 제출은 setItem 1회로 전체 submissions
  를 저장해야 저장/복원/초기화 계약이 단순해진다.",
  "reason": "요구사항은 일괄 채점 후 한 번에 저장이며,
  merge
  저장은 partial을 필연적으로 만든다.", "confidence": 0.8 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_HANDLE_EMPTY_PROBLEMS,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:6c75ecb0f6###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_4541b0237a.md


  72% context left



› Request 4541b0237a: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_4541b0237a.md


    Read research_4541b0237a.md  

◦ Reviewing edge removals (4m 11s • esc to interrupt)      


› Improve documentation in @filename

  100% context left · ? for shortcuts


• Explored
  └ Search ^## (Output Format|Rules|Coverage Gap Report)\b|
^\[/
           R1 Coverage Report\]|^\[/R2 Progression
Report\]|
           ^\[/R3 Transfer Report\]|^###DONE: in
           research_4541b0237a.md
    Read research_4541b0237a.md
    Search ^\s*\[/R1 Coverage Report\] in
           research_4541b0237a.md
    Read research_4541b0237a.md

─ Worked for 4m 11s ───────────────────────────────────────

• ###BEGIN:4541b0237a###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 요약 | FE | C | bulk 전환 시 회귀/기능공백을
  추적할 기준선을 만든다 |
  | 2 | LEARN_IDENTIFY_STORAGE_KEY | localStorage 키 포맷
  식별 | FE | C | 저장/복원/초기화가 같은 키 계약에 의존하
  므로 전제 확인이 필요하다 |
  | 3 | LEARN_DOCUMENT_STORED_RESULT_SCHEMA | StoredResult/
  submissions 스키마 확인 | FE | C | bulk 저장으로 바꿔도
  호환되는 데이터 계약을 명시해야 한다 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  한다 |
  | 5 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항의 단일 진입점(채점하기/전체
  제출)을 제공한다 |
  | 6 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 미입력 판정
  predicate 정의(정규화 기반) | FE | C | disabled/채점 기준
  불일치로 인한 UX 붕괴를 방지한다 |
  | 7 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled”를
  안정적으로 계산한다 |
  | 8 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  테스트 벡터 | QA | C | 공백/콤마/부호 등에서 판정 흔들림
  을 사전에 고정한다 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 한 번의 클릭으로 모든 문제를 채점하는 동
  작을 만든다 |
  | 10 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장에 공통
  으로 쓰는 중간 표현을 만든다 |
  | 11 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 채점 전 0/N 노출 및 partial
  결과 노출 혼선을 제어한다 |
  | 12 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  결과 표시(게이팅) | FE | P | 결과 노출 시점을 고정해 UX를
  일관되게 만든다 |
  | 13 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | 상단 점수 표시를 문제별 결과에서 안정적으로 계산한
  다 |
  | 14 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 문제 카드에 정오/정답값
  을 일관되게 렌더한다 |
  | 15 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | “채점 후 1회 저장” 스냅샷 구조를
  스키마로 고정한다 |
  | 16 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | UI 상태에서
  submissions payload 생성 | FE | P | answers/results를
  StoredResult{submissions}로 직렬화한다 |
  | 17 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고 1
  회 setItem으로 저장 시점을 단순화한다 |
  | 18 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터
  shape validate | FE | C | 잘못된/누락 필드로 인한 런타임
  오류와 UX 꼬임을 방지한다 |
  | 19 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial(submissions 일부) 처리 정책 | FE | C | 기
  존 merge 저장이 만든 partial을 bulk UX에 맞게 처리한다 |
  | 20 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태를 복원한다 |
  | 21 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화의 근거를 만든다 |
  | 22 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면에 남는 answer/result/flags 잔상을 제거한다
  |
  | 23 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과)를 방지한다 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼과 disabled 규칙
  을 묶어 UX 기준을 고정한다 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | gradeAll 결과를 중간 표현
  으로 만들고 게이팅/표시를 일관화한다 |
  | 3 | STEP_PERSIST_RESTORE_FLOW | 저장/복원/legacy 처리 |
  LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 저장 계약을 먼저 고정하
  고 복원/legacy 정책을 조건부로 적용한다 |
  | 4 | STEP_RESET_EDIT_FLOW | 초기화 + 채점 후 편집 정책 |
  LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | reset과 편집 정책으로 잔
  상/스테일 상태를 제거한다 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이는 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 일괄 채점은 문제별 결과 맵 생성
  (또는 동등 표현)을 포함해야 완성 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점은 문제별 채점 결과가 있어야 집계 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 제출/저장 경로를
  알아야 제거 후 회귀를 줄일 수 있음 | 0.76 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_ADD_BULK_GRADE_BUTTON | 제거 전에 대체 진입점을 마
  련하면 기능 공백을 방지 | 0.80 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 정의가 유용 | 0.70 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | UI 이벤트를 gradeAll로 연결
  해야 UX 완성 | 0.72 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 점수 계산은 가능해도 노출은
  hasGraded일 때 권장 | 0.70 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy가 있을 때만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_GRADED_STATE_FLAG | 답 변경 시 hasGraded 초기화/재
  채점 유도 규칙이 필요 | 0.74 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정하는 편이 안정 | 0.70 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | UI의 “입력됨”
  직관과 정규화 기준이 어긋나 disabled/채점이 불일치 |
  normalizeNumericInput 기반 predicate로 disabled/채점 기준
  을 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개 상태
  에서 allAnswered가 흔들려 버튼 상태가 불안정 | problems
  길이 0/로딩 상태의 disabled 규칙을 명시하고 안정적으로 계
  산 | 0.74 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 버튼 라벨/disabled/재
  채점 상태가 분산되면 UX가 일관되지 않음 | 단일 버튼을 하
  단 고정 + derived state로 label/disabled를 결정 | 0.72 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점 중 입력 조
  회/빈값 처리/채점 호출이 섞여 인지부하 증가 |
  gradeAll(problems, answers) → resultByProblemId 반환으로
  순수 함수화 | 0.78 |
  | 5 | LEARN_BUILD_RESULT_MAP | 결과를 index 기반으로 다루
  면 문제 순서 변경 시 오표시 위험 | 항상 problem.id 키로
  resultByProblemId를 구성/조회하도록 고정 | 0.76 |
  | 6 | LEARN_GRADED_STATE_FLAG | 복원/partial 데이터에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효한 채점 결과 존재”로 정의하고 일관되게 세팅 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전에도 0/N 또
  는 결과가 보여 “이미 채점됨” 오해를 유발 | score/result
  렌더를 hasGraded로 게이트하고 채점 전에는 숨김 | 0.74 |
  | 8 | LEARN_SCORE_SUMMARY_CALC | results가 비어도 0/N이
  계산되어 채점 전 표시 혼선이 생김 | 계산은 하되 UI 노출은
  hasGraded일 때만 하도록 분리 | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | merge 저장 습관이
  남으면 partial/legacy가 계속 생겨 UX가 꼬임 | bulk는
  overwrite 스냅샷 저장으로 고정하고 schema로 명시 | 0.78 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 StoredResult{submissions}로 변환할 때 필드/형식 누락이
  발생 | gradeAll 결과를 단일 소스로 payload를 구성하고 직
  렬화 경로를 단순화 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성 및 회귀 추적이 어려움 | 채점 버튼 클릭 시
  점에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도(또는 초기
  화) | 0.74 |
  | 14 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result/flags 잔상이 남아 초기화가 체감되지 않음 | storage
  삭제와 함께 state(answer/result/hasGraded)를 초기값으로
  리셋 | 0.78 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태 발생 | 입력 변경 시 결
  과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 동시에 정
  합화한다 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서를 유연
  하게 만든다 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류를 줄인다 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터에서 hasGraded를 결정한 뒤 노출을 게이트하면
  표시 규칙이 단순해진다 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제를 차단한다 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 이후 결과 노출 여부
  를 게이트로 통제하면 스테일 상태를 예방한다 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 둔다 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | legacy/partial 판정과
  복원을 검증 단계로 매개해 런타임 꼬임을 줄인다 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 불일치를 줄
  인다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 흐름에서 bulk 저장
  으로 전환할 때 스키마를 중간 기준점으로 두면 회귀 추적이
  쉬워진다 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원/legacy 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "정규화 기준 자체보다 '입력됨 predicate'를 중간
  노드로 두면 disabled/allAnswered를 한 번에 정합화할 수 있
  어 기존 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded 정의/도입은 gradeAll과 병렬로 가능해 단일 선행
  잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 구현 중 즉시 확인 가능해 필수
  선행 잠금보다 노트가 적절", "confidence": 0.70 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 restore 구현의 필수 개념이지만
  requires 잠금으로 강제할 필요는 낮음", "confidence":
  0.68 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 단일 선행 잠금은 과
  잉", "confidence": 0.78 }
    ],
    "notes": [
      { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  \" , \" 같은 입력에서 버튼 상태와 채점 결과가 불일치한
  다.", "confidence": 0.82 },
      { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, score/result 노출은 hasGraded일 때만
  하는 것이 권장이다.", "reason": "채점 전 0/N 및 legacy
  partial 노출을 통제하려면 표시 기준을 단일 플래그로 고정
  해야 한다.", "confidence": 0.74 },
      { "claim": "per-problem 제출 제거는 bulk 경로(버튼/
  gradeAll/저장)가 준비된 뒤 진행하는 것이 권장이다.",
  "reason": "제거가 먼저면 채점/저장 경로가 사라져 기능 공
  백이 발생한다.", "confidence": 0.72 },
      { "claim": "legacy partial(submissions 일부) 데이터는
  조건부로 감지해 초기화 또는 재채점 유도 등 정책을 적용하
  는 것이 권장이다.", "reason": "기존 merge 저장으로 부분
  데이터가 정상 생성되었고, 이를 그대로 노출하면 \"채점됨\"
  오해가 생긴다.", "confidence": 0.74 },
      { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행하는 것이 권장
  이다.", "reason": "키 삭제만 수행하면 화면에 남은 상태 때
  문에 초기화가 즉시 반영되지 않는다.", "confidence":
  0.78 },
      { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)로 문자열 내부 줄바꿈 없이 출력해야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검증/병합 파이프라인을 중단시킨다.", "confidence": 0.90 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | 기존
  submitProblem/저장 merge 동작을 알아야 bulk 전환 시 기능
  공백/회귀를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 partial 의미 |
  기존 per-problem 저장은 submissions 일부만 남기는 데이터
  가
  정상 생성되어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 동작/표시가 일
  관됨 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 " , " 등에서 UX가 붕괴
  | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정
  적으로 계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", " , ",
  "0", "-0", "1,234", "+", ".", "Infinity" 등에서 기대값이
  흔들림 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/집계 기준 | 점수/결과 표시/저
  장을 problemId로 정렬하는 중간 표현이 필요 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  legacy partial 결과 노출 혼선을 막을 표시 기준이 필요 |
  중
  |
  |12| 결과/점수 표시 게이팅 규칙 | 채점 후에만 점수/정오/
  정
  답을 표시해야 UX가 일관되고 partial 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “일괄
  채점 후 한 번에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함 | 중 |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 answer/result/flags 리셋이
  필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | per-problem 제출 제거 → bulk 채점 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 구현 후 제거 |
  | 2 | 원문 disabled → 정규화 채점 | " , " 등에서 활성/비
  활
  성과 채점 기준이 엇갈려 UX 붕괴 | normalizeNumericInput
  기
  반으로 미입력 판정 통일 |
  | 3 | bulk 버튼 추가 → allAnswered 부재 | disabled 조건이
  불명확해 조기 활성/비활성이 흔들림 | problems[] 기반
  allAnswered(정규화) 먼저 고정 |
  | 4 | 저장 구현 → 복원/검증 미정 | 파싱 실패/필드 누락 시
  런타임 오류 및 상태 꼬임 | schema+shape validate+예외 처
  리
  추가 |
  | 5 | legacy partial 복원 → 결과 노출 | 부분 submissions
  가
  “채점됨”처럼 보이면 오해/혼선 발생 | partial 감지 시
  hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | 초기화(키 삭제만) → UI 잔상 | storage만 지우면
  answer/result/flags가 화면에 남음 | 키 삭제 + UI state 리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submitProblem과
  StoredResult{submissions} setItem 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled의 '입력됨' 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading이 normalizeNumericInput을 사용
  하므로 원문 기준 disabled는 채점과 불일치해 UX를 망친
  다.",
  "confidence": 0.84 },
  { "claim": "점수/정오/정답 표시는 hasGraded로 게이트해
  야 채점 전 0/N 및 partial 노출 혼선을 줄인다.", "reason":
  "현재 score는 problems가 있으면 result가 비어도 0/N을 표
  시
  할 수 있어 오해를 유발한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 처리는 조
  건부 정책이며 restore를 migration에 과잉 잠금(requires)하
  지 않는 편이 안전하다.", "reason": "migration은 legacy가
  존재할 때만 필요하고 reviewer도 requires 과잉 잠금을 지적
  했다.", "confidence": 0.72 },
  { "claim": "per-problem 제출 제거는 권장 순서이며,
  bulk 경로(버튼/gradeAll/저장)가 준비된 뒤 제거해야 기능
  공
  백을 피한다.", "reason": "제거가 먼저면 채점/저장 경로가
  사라져 사용자가 진행 불가 상태가 된다.", "confidence":
  0.72 },
  { "claim": "다시 풀기는 localStorage 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태 때문에 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검
  증/병합 파이프라인을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:4541b0237a###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_4faa8473cc.md


  73% context left



› Request 4faa8473cc: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_4faa8473cc.md


    Read research_4faa8473cc.md                            

• Designing output structure (4m 55s • esc to interrupt)   


› Improve documentation in @filename

  98% context left · ? for shortcuts


• Explored
  └ Search ^## (Output Format|Rules|Coverage Gap Report)\b|
^\[/
           R1 Coverage Report\]|^\[/R2 Progression
Report\]|
           ^###DONE: in research_4faa8473cc.md
    Search \[/R1 Coverage Report\] in
research_4faa8473cc.md
    Read research_4faa8473cc.md

─ Worked for 4m 55s ───────────────────────────────────────

• ###BEGIN:4faa8473cc###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항의 단일 진입점 제공 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 미입력 판정
  predicate 정의(정규화 기반) | FE | C | disabled/채점 기준
  불일치로 인한 UX 붕괴 방지 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled”를
  안정적으로 계산 |
  | 5 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  테스트 벡터 | QA | C | 공백/콤마/부호 등 판정 흔들림을 사
  전에 고정 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 한 번의 클릭으로 모든 문제 채점 수행 |
  | 7 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장의 공통
  중간 표현 마련 |
  | 8 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 결과 노출 시점 기준을 단일 플
  래그로 고정 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/결
  과 표시(게이팅) | FE | P | 채점 전 0/N 및 partial 노출 혼
  선 차단 |
  | 10 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | resultByProblemId 기반으로 점수 집계를 안정화 |
  | 11 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 카드에 정오/정답값을 일
  관되게 렌더 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | 저장/복원/legacy 정책의 기준 스
  키마 확정 |
  | 13 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 submissions payload로 변환 | FE | P | UI 상태를
  StoredResult{submissions}로 표현전환 |
  | 14 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고
  스냅샷 저장으로 단순화 |
  | 15 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/shape validate | FE | C | JSON 파싱 실패/필드 누락으로
  인한 런타임 오류 방지 |
  | 16 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 감지/정책 적용 | FE | C | 기존 merge 저장
  이 만든 partial을 bulk UX에 맞게 처리 |
  | 17 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태 복원 |
  | 18 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화 기반 마련 |
  | 19 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면 잔상(answer/result/flags)을 즉시 제거 |
  | 20 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과) 방지 |
  | 21 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장 | QA | C | 파싱 실패(문자열 줄바꿈 등)로
  병합 불가 문제 차단 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼 UX와 disabled
  기준을 함께 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | 채점→중간표현→게이팅→표시
  를 일관된 흐름으로 구성 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회 + legacy 조건부 처리 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 초기화 잔상 제거와 스테일
  결과 방지 정책을 묶어 적용 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 줄바꿈 없는 strict
  JSON으로 결합 검증/병합 가능 상태 보장 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 문제 전체 채점 결과가
  있어야 구성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 집계는 문제별 결과가 있어야 계산 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 기준을 먼저 고정하면 안전 | 0.70 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 클릭 이벤트를 gradeAll로 연
  결해야 UX가 완성됨 | 0.72 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 계산은 가능해도 노출은
  hasGraded일 때만 권장 | 0.70 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 6 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 7 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy 존재 시에만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 8 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정하는 편이 안정 | 0.70 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 10 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 답 변경 시 결과 초기화/재
  채점 유도에 게이팅 기준이 필요 | 0.74 |
  | 11 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | bulk 경로 준비 후 제거
  하면 기능 공백을 방지 | 0.80 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 출력 품질 검증을 단계로 분리하
  면 병합 실패를 예방 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 직관
  과 정규화 기준이 어긋나 disabled/채점 불일치 |
  normalizeNumericInput 기반 predicate로 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개에서
  allAnswered가 흔들려 버튼 상태 불안정 | problems 길이 0/
  로딩 상태 규칙을 명시 | 0.74 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 라벨/disabled/재채점
  상태가 분산되면 UX 해석이 어려움 | derived state로 label/
  disabled를 결정 | 0.70 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 입력 조
  회/빈값 처리/채점 호출이 섞여 인지부하 증가 | gradeAll을
  순수 함수로 분리해 map 반환 | 0.78 |
  | 5 | LEARN_BUILD_RESULT_MAP | index 기반 처리로 문제 순
  서/ID 불일치 시 오표시 위험 | 항상 problemId 키로
  resultByProblemId 구성 | 0.76 |
  | 6 | LEARN_GRADED_STATE_FLAG | 복원/partial에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효 결과 존재”로 정의 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전 0/N 노출로
  “이미 채점됨” 오해 발생 | score/result 렌더를 hasGraded로
  게이트 | 0.74 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK | answers/results를
  submissions 스키마로 전환할 때 누락/불일치 발생 | 스키마
  를 답안+정오 중심으로 단일화 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_SAVE_BULK | merge 저장 습관으로
  partial이 계속 생겨 UX 충돌 | gradeAll 결과로 overwrite
  스냅샷 저장 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨짐 | try/catch +
  nodeId 검증 + shape validate | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도 | 0.74 |
  | 12 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result 잔상이 남아 초기화가 체감되지 않음 | storage 삭제
  와 state 리셋을 함께 수행 | 0.78 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해 “입력≠결과” 상태 발생 | 입력 변경 시 결과
  초기화 또는 재채점 고정 | 0.76 |
  | 14 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 줄바꿈 등
  으로 patch JSON 파싱 실패가 반복됨 | 문자열 줄바꿈 금지 +
  json.loads 동등 검증 | 0.90 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 함께 정합
  화 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | STEP_BULK_SUBMIT_UI_FLOW |
  UI 추가를 allAnswered 구현과 분리해 병렬 작업이 가능 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  버튼 배치와 클릭 핸들러 연결을 단계로 묶어 점프를 완화 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 일관성 강화
  |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  표시 로직을 중간 표현에만 의존하도록 분리해 오표시를 줄임
  |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 변환 단계 추가 |
  | 7 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 저장된 데이터의 파싱/
  검증 단계를 매개로 복원 실패를 완화 |
  | 8 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 시 hasGraded 기준을 먼저 확정해 노출 규칙을 단순화 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_AND_EDIT_FLOW | reset을 하나의 플로우로 묶어
  잔상/부분 초기화를 방지 |
  | 10 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후 결과 노출을 게이
  트로 통제하면 스테일 상태를 예방 |
  | 11 | (비-strict JSON) → (병합/검증 실패) |
  LEARN_STRICT_JSON_OUTPUT_GUARD | 산출물 품질을 별도 노드
  로 두면 파싱 실패를 조기에 차단 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "answers/results를 submissions
  payload로 변환", "domain": "FE", "rep": "P",
  "confidence": 0.80 },
      { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장",
  "domain": "QA", "rep": "C", "confidence": 0.90 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
      { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 결과 존재로 파생하거나 액션에서 세팅하는 등
  대체 경로가 있어 필수 선행 잠금은 과잉", "confidence":
  0.72 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 }
    ],
    "notes": [
      { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  공백/콤마 입력에서 버튼 상태와 채점 결과가 불일치한다.",
  "confidence": 0.82 },
      { "claim": "버튼 추가와 allAnswered 구현은 병렬로 가
  능하고, 최종적으로 disabled 조건만 연결하면 된다.",
  "reason": "UI를 먼저 만들고 이후에 allAnswered 로직을 붙
  이는 경로가 자연스럽고 회귀 위험이 낮다.", "confidence":
  0.70 },
      { "claim": "legacy partial은 조건부로만 필요하므로
  requires보다 노트/권장 선행으로 관리하는 것이 적절하다.",
  "reason": "partial은 기존 merge 저장 데이터가 존재할 때만
  발생하고, 항상 필요한 선행 관계가 아니다.", "confidence":
  0.74 },
      { "claim": "score/result 노출은 hasGraded로 게이트하
  는 것이 권장이다.", "reason": "채점 전 0/N 및 부분 데이터
  노출을 방지하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
      { "claim": "reset은 localStorage 키 삭제와 UI state
  리셋을 함께 수행하는 것이 권장이다.", "reason": "키 삭제
  만 수행하면 화면에 남은 answer/result 잔상으로 인해 초기
  화가 체감되지 않는다.", "confidence": 0.78 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력되어야 한다.", "reason": "문자열
  줄바꿈은 파싱 실패를 유발해 결합 검증/병합 파이프라인을
  중단시킨다.", "confidence": 0.90 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 merge를 이해해야 bulk 전환 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 legacy partial
  의미 | 기존 merge 저장으로 부분 submissions가 정상 생성되
  어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 함 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 UX가 붕괴 | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정화
  필요 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", "0",
  "-0", "1,234", "+", ".", "Infinity" 등 기대값을 고정해야
  함 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재 단건 채점만 가
  능
  하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/단일 소스화 | 점수 집계/문제
  별
  결과 표시/저장을 동일 키(problemId)로 정렬해야 함 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  partial 결과 노출 혼선을 막을 표시 기준이 필요 | 중 |
  |12| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 표시
  해야 UX가 일관되고 legacy 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “한 번
  에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 상태 꼬임을 방지해야 함 | 중
  |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 state 리셋이 필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/근사/분수) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 준비
  후
  제거 |
  | 2 | 원문 disabled 판정 → 정규화 채점 | " , " 등에서 활
  성/비활성과 채점 기준이 엇갈려 UX 붕괴 |
  normalizeNumericInput 기반으로 미입력 판정 통일 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 불명확하
  면
  조기 활성/비활성이 흔들림 | problems[] 기준
  allAnswered(정
  규화) 먼저 고정 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증 없이 복원하면 파싱
  실패/필드 누락으로 런타임 오류 | schema+shape validate+예
  외 처리 추가 |
  | 5 | legacy partial 복원 → 결과/점수 노출 | 부분
  submissions가 “채점됨”처럼 보이면 오해/혼선 발생 |
  partial
  감지 시 hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | LEARN_RESET_CLEAR_STORAGE → UI 잔상 유지 | storage
  만
  지우면 answer/result/flags가 화면에 남음 | 키 삭제 + UI
  state 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C", "confidence": 0.8 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.84 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P", "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P", "confidence": 0.75 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체 저
  장)",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C", "confidence":
  0.72 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C", "confidence": 0.74 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.84 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.75 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submissions를 기존 값과 병합
  해 setItem하는 흐름이 확인된다.", "confidence": 0.86 },
  { "claim": "미입력 판정(disabled)은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading.ts가 normalizeNumericInput을
  사
  용하므로 원문 기준 판정은 활성/채점 불일치를 만든다.",
  "confidence": 0.84 },
  { "claim": "현재 점수 표시는 채점 전에도 0/N이 노출될
  수 있어 hasGraded 게이팅이 필요하다.", "reason": "score는
  problems가 있으면 result가 비어도 correct=0,total=N을 표
  시
  할 수 있다.", "confidence": 0.74 },
  { "claim": "legacy partial 처리는 조건부 정책이며
  restore에 과잉 잠금(requires)으로 고정하지 않는 편이 안전
  하다.", "reason": "partial은 legacy 데이터가 존재할 때만
  발생하고 reviewer도 requires 과잉 잠금을 지적했다.",
  "confidence": 0.72 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태로 인해 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 검증/
  병
  합을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:4faa8473cc###


› Improve documentation in @filename

  64% context left · ? for shortcuts


============================================================
[2026-01-08 13:31:11] RESEARCH2 (req_id: 0de4d4e8bf)
============================================================
  | 8 | LEARN_SCORE_SUMMARY_CALC | results가 비어도 0/N이
  계산되어 채점 전 표시 혼선이 생김 | 계산은 하되 UI 노출은
  hasGraded일 때만 하도록 분리 | 0.70 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | merge 저장 습관이
  남으면 partial/legacy가 계속 생겨 UX가 꼬임 | bulk는
  overwrite 스냅샷 저장으로 고정하고 schema로 명시 | 0.78 |
  | 10 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 StoredResult{submissions}로 변환할 때 필드/형식 누락이
  발생 | gradeAll 결과를 단일 소스로 payload를 구성하고 직
  렬화 경로를 단순화 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_SAVE_BULK | 저장 시점이 분산되
  면 partial 생성 및 회귀 추적이 어려움 | 채점 버튼 클릭 시
  점에만 setItem 1회 수행으로 단순화 | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨질 수 있음 | try/
  catch + nodeId 검증 + submissions shape 최소 검증으로 방
  어 | 0.78 |
  | 13 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도(또는 초기
  화) | 0.74 |
  | 14 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result/flags 잔상이 남아 초기화가 체감되지 않음 | storage
  삭제와 함께 state(answer/result/hasGraded)를 초기값으로
  리셋 | 0.78 |
  | 15 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해져 “입력≠결과” 상태 발생 | 입력 변경 시 결
  과/hasGraded 초기화 또는 “다시 채점” 플로우 고정 | 0.76 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 동시에 정
  합화한다 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 클릭 액션 연결을 단계로 분리해 구현 순서를 유연
  하게 만든다 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 채점 결과 표현과 저장
  직렬화를 분리해 partial/merge 오류를 줄인다 |
  | 4 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 데이터에서 hasGraded를 결정한 뒤 노출을 게이트하면
  표시 규칙이 단순해진다 |
  | 5 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_EDIT_FLOW | “키 삭제+상태 리셋”을 하나의 리셋
  플로우로 묶어 잔상 문제를 차단한다 |
  | 6 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 이후 결과 노출 여부
  를 게이트로 통제하면 스테일 상태를 예방한다 |
  | 7 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 구성 단계를 둔다 |
  | 8 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | legacy/partial 판정과
  복원을 검증 단계로 매개해 런타임 꼬임을 줄인다 |
  | 9 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 불일치를 줄
  인다 |
  | 10 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_STORE_RESULT_SCHEMA_BULK | 기존 흐름에서 bulk 저장
  으로 전환할 때 스키마를 중간 기준점으로 두면 회귀 추적이
  쉬워진다 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "UI 상태에서 submissions payload 생
  성", "domain": "FE", "rep": "P", "confidence": 0.80 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_FLOW", "type": "step",
  "name_ko": "저장/복원/legacy 처리", "domain": "FE",
  "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "정규화 기준 자체보다 '입력됨 predicate'를 중간
  노드로 두면 disabled/allAnswered를 한 번에 정합화할 수 있
  어 기존 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered와 독립적으로 가능하므
  로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded 정의/도입은 gradeAll과 병렬로 가능해 단일 선행
  잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires", "reason":
  "계산과 노출(게이팅)은 분리 가능하므로 requires 잠금은 과
  잉", "confidence": 0.70 },
      { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "reason": "표시 로직과 게이팅은 분리 가능하며 조합만 권
  장", "confidence": 0.72 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 구현 중 즉시 확인 가능해 필수
  선행 잠금보다 노트가 적절", "confidence": 0.70 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 restore 구현의 필수 개념이지만
  requires 잠금으로 강제할 필요는 낮음", "confidence":
  0.68 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 단일 선행 잠금은 과
  잉", "confidence": 0.78 }
    ],
    "notes": [
      { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  \" , \" 같은 입력에서 버튼 상태와 채점 결과가 불일치한
  다.", "confidence": 0.82 },
      { "claim": "hasGraded는 gradeAll 수행 또는 복원된 결
  과 존재로 결정하고, score/result 노출은 hasGraded일 때만
  하는 것이 권장이다.", "reason": "채점 전 0/N 및 legacy
  partial 노출을 통제하려면 표시 기준을 단일 플래그로 고정
  해야 한다.", "confidence": 0.74 },
      { "claim": "per-problem 제출 제거는 bulk 경로(버튼/
  gradeAll/저장)가 준비된 뒤 진행하는 것이 권장이다.",
  "reason": "제거가 먼저면 채점/저장 경로가 사라져 기능 공
  백이 발생한다.", "confidence": 0.72 },
      { "claim": "legacy partial(submissions 일부) 데이터는
  조건부로 감지해 초기화 또는 재채점 유도 등 정책을 적용하
  는 것이 권장이다.", "reason": "기존 merge 저장으로 부분
  데이터가 정상 생성되었고, 이를 그대로 노출하면 \"채점됨\"
  오해가 생긴다.", "confidence": 0.74 },
      { "claim": "reset은 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행하는 것이 권장
  이다.", "reason": "키 삭제만 수행하면 화면에 남은 상태 때
  문에 초기화가 즉시 반영되지 않는다.", "confidence":
  0.78 },
      { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)로 문자열 내부 줄바꿈 없이 출력해야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검증/병합 파이프라인을 중단시킨다.", "confidence": 0.90 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | 기존
  submitProblem/저장 merge 동작을 알아야 bulk 전환 시 기능
  공백/회귀를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 partial 의미 |
  기존 per-problem 저장은 submissions 일부만 남기는 데이터
  가
  정상 생성되어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 UI는 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 동작/표시가 일
  관됨 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 " , " 등에서 UX가 붕괴
  | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 답 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정
  적으로 계산해야 함 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", " , ",
  "0", "-0", "1,234", "+", ".", "Infinity" 등에서 기대값이
  흔들림 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재는 단건 채점만
  가
  능하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/집계 기준 | 점수/결과 표시/저
  장을 problemId로 정렬하는 중간 표현이 필요 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  legacy partial 결과 노출 혼선을 막을 표시 기준이 필요 |
  중
  |
  |12| 결과/점수 표시 게이팅 규칙 | 채점 후에만 점수/정오/
  정
  답을 표시해야 UX가 일관되고 partial 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “일괄
  채점 후 한 번에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 UX 꼬임을 방지해야 함 | 중 |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 answer/result/flags 리셋이
  필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/분수/근사) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 UI 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | per-problem 제출 제거 → bulk 채점 미구현 | 제거만
  하
  면 채점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 구현 후 제거 |
  | 2 | 원문 disabled → 정규화 채점 | " , " 등에서 활성/비
  활
  성과 채점 기준이 엇갈려 UX 붕괴 | normalizeNumericInput
  기
  반으로 미입력 판정 통일 |
  | 3 | bulk 버튼 추가 → allAnswered 부재 | disabled 조건이
  불명확해 조기 활성/비활성이 흔들림 | problems[] 기반
  allAnswered(정규화) 먼저 고정 |
  | 4 | 저장 구현 → 복원/검증 미정 | 파싱 실패/필드 누락 시
  런타임 오류 및 상태 꼬임 | schema+shape validate+예외 처
  리
  추가 |
  | 5 | legacy partial 복원 → 결과 노출 | 부분 submissions
  가
  “채점됨”처럼 보이면 오해/혼선 발생 | partial 감지 시
  hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | 초기화(키 삭제만) → UI 잔상 | storage만 지우면
  answer/result/flags가 화면에 남음 | 키 삭제 + UI state 리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C" },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C" },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C" },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C" },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C" },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P" },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체
  submissions 저장)", "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C" },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P" },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C" },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P" },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P" },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C" }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires" },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires" },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires" },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires" },
  { "from": "LEARN_SCORE_AND_RESULT_GATING", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires" },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires" },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires" }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submitProblem과
  StoredResult{submissions} setItem 흐름이 확인된다.",
  "confidence": 0.86 },
  { "claim": "disabled의 '입력됨' 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading이 normalizeNumericInput을 사용
  하므로 원문 기준 disabled는 채점과 불일치해 UX를 망친
  다.",
  "confidence": 0.84 },
  { "claim": "점수/정오/정답 표시는 hasGraded로 게이트해
  야 채점 전 0/N 및 partial 노출 혼선을 줄인다.", "reason":
  "현재 score는 problems가 있으면 result가 비어도 0/N을 표
  시
  할 수 있어 오해를 유발한다.", "confidence": 0.74 },
  { "claim": "legacy partial(submissions 일부) 처리는 조
  건부 정책이며 restore를 migration에 과잉 잠금(requires)하
  지 않는 편이 안전하다.", "reason": "migration은 legacy가
  존재할 때만 필요하고 reviewer도 requires 과잉 잠금을 지적
  했다.", "confidence": 0.72 },
  { "claim": "per-problem 제출 제거는 권장 순서이며,
  bulk 경로(버튼/gradeAll/저장)가 준비된 뒤 제거해야 기능
  공
  백을 피한다.", "reason": "제거가 먼저면 채점/저장 경로가
  사라져 사용자가 진행 불가 상태가 된다.", "confidence":
  0.72 },
  { "claim": "다시 풀기는 localStorage 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태 때문에 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검
  증/병합 파이프라인을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_SCORE_SUMMARY_CALC, LEARN_GRADED_STATE_FLAG,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:4541b0237a###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_4faa8473cc.md


  73% context left



› Request 4faa8473cc: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_4faa8473cc.md


    Read research_4faa8473cc.md                            

• Designing output structure (4m 55s • esc to interrupt)   


› Improve documentation in @filename

  98% context left · ? for shortcuts


• Explored
  └ Search ^## (Output Format|Rules|Coverage Gap Report)\b|
^\[/
           R1 Coverage Report\]|^\[/R2 Progression
Report\]|
           ^###DONE: in research_4faa8473cc.md
    Search \[/R1 Coverage Report\] in
research_4faa8473cc.md
    Read research_4faa8473cc.md

─ Worked for 4m 55s ───────────────────────────────────────

• ###BEGIN:4faa8473cc###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항의 단일 진입점 제공 |
  | 3 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 미입력 판정
  predicate 정의(정규화 기반) | FE | C | disabled/채점 기준
  불일치로 인한 UX 붕괴 방지 |
  | 4 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | “모든 문제 입력 전까지 disabled”를
  안정적으로 계산 |
  | 5 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  테스트 벡터 | QA | C | 공백/콤마/부호 등 판정 흔들림을 사
  전에 고정 |
  | 6 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 한 번의 클릭으로 모든 문제 채점 수행 |
  | 7 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장의 공통
  중간 표현 마련 |
  | 8 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 결과 노출 시점 기준을 단일 플
  래그로 고정 |
  | 9 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/결
  과 표시(게이팅) | FE | P | 채점 전 0/N 및 partial 노출 혼
  선 차단 |
  | 10 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | resultByProblemId 기반으로 점수 집계를 안정화 |
  | 11 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 카드에 정오/정답값을 일
  관되게 렌더 |
  | 12 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | 저장/복원/legacy 정책의 기준 스
  키마 확정 |
  | 13 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 submissions payload로 변환 | FE | P | UI 상태를
  StoredResult{submissions}로 표현전환 |
  | 14 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고
  스냅샷 저장으로 단순화 |
  | 15 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/shape validate | FE | C | JSON 파싱 실패/필드 누락으로
  인한 런타임 오류 방지 |
  | 16 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 감지/정책 적용 | FE | C | 기존 merge 저장
  이 만든 partial을 bulk UX에 맞게 처리 |
  | 17 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태 복원 |
  | 18 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화 기반 마련 |
  | 19 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면 잔상(answer/result/flags)을 즉시 제거 |
  | 20 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과) 방지 |
  | 21 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장 | QA | C | 파싱 실패(문자열 줄바꿈 등)로
  병합 불가 문제 차단 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼 UX와 disabled
  기준을 함께 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | 채점→중간표현→게이팅→표시
  를 일관된 흐름으로 구성 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회 + legacy 조건부 처리 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 초기화 잔상 제거와 스테일
  결과 방지 정책을 묶어 적용 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 줄바꿈 없는 strict
  JSON으로 결합 검증/병합 가능 상태 보장 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 문제 전체 채점 결과가
  있어야 구성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 집계는 문제별 결과가 있어야 계산 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 기준을 먼저 고정하면 안전 | 0.70 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 클릭 이벤트를 gradeAll로 연
  결해야 UX가 완성됨 | 0.72 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 4 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 계산은 가능해도 노출은
  hasGraded일 때만 권장 | 0.70 |
  | 5 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 6 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 7 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy 존재 시에만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 8 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_GRADED_STATE_FLAG | 복원 시 hasGraded를 저장/파생
  규칙으로 결정하는 편이 안정 | 0.70 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 10 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | 답 변경 시 결과 초기화/재
  채점 유도에 게이팅 기준이 필요 | 0.74 |
  | 11 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | bulk 경로 준비 후 제거
  하면 기능 공백을 방지 | 0.80 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 출력 품질 검증을 단계로 분리하
  면 병합 실패를 예방 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 직관
  과 정규화 기준이 어긋나 disabled/채점 불일치 |
  normalizeNumericInput 기반 predicate로 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개에서
  allAnswered가 흔들려 버튼 상태 불안정 | problems 길이 0/
  로딩 상태 규칙을 명시 | 0.74 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 라벨/disabled/재채점
  상태가 분산되면 UX 해석이 어려움 | derived state로 label/
  disabled를 결정 | 0.70 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 입력 조
  회/빈값 처리/채점 호출이 섞여 인지부하 증가 | gradeAll을
  순수 함수로 분리해 map 반환 | 0.78 |
  | 5 | LEARN_BUILD_RESULT_MAP | index 기반 처리로 문제 순
  서/ID 불일치 시 오표시 위험 | 항상 problemId 키로
  resultByProblemId 구성 | 0.76 |
  | 6 | LEARN_GRADED_STATE_FLAG | 복원/partial에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효 결과 존재”로 정의 | 0.74 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING | 채점 전 0/N 노출로
  “이미 채점됨” 오해 발생 | score/result 렌더를 hasGraded로
  게이트 | 0.74 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK | answers/results를
  submissions 스키마로 전환할 때 누락/불일치 발생 | 스키마
  를 답안+정오 중심으로 단일화 | 0.78 |
  | 9 | LEARN_LOCALSTORAGE_SAVE_BULK | merge 저장 습관으로
  partial이 계속 생겨 UX 충돌 | gradeAll 결과로 overwrite
  스냅샷 저장 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨짐 | try/catch +
  nodeId 검증 + shape validate | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도 | 0.74 |
  | 12 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result 잔상이 남아 초기화가 체감되지 않음 | storage 삭제
  와 state 리셋을 함께 수행 | 0.78 |
  | 13 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해 “입력≠결과” 상태 발생 | 입력 변경 시 결과
  초기화 또는 재채점 고정 | 0.76 |
  | 14 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 줄바꿈 등
  으로 patch JSON 파싱 실패가 반복됨 | 문자열 줄바꿈 금지 +
  json.loads 동등 검증 | 0.90 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | 정규화 자체보다 “입
  력됨 판정”을 중간에 두면 disabled/allAnswered를 함께 정합
  화 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | STEP_BULK_SUBMIT_UI_FLOW |
  UI 추가를 allAnswered 구현과 분리해 병렬 작업이 가능 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  버튼 배치와 클릭 핸들러 연결을 단계로 묶어 점프를 완화 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 계산/표시 일관성 강화
  |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  표시 로직을 중간 표현에만 의존하도록 분리해 오표시를 줄임
  |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 payload 변환 단계 추가 |
  | 7 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 저장된 데이터의 파싱/
  검증 단계를 매개로 복원 실패를 완화 |
  | 8 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 시 hasGraded 기준을 먼저 확정해 노출 규칙을 단순화 |
  | 9 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_AND_EDIT_FLOW | reset을 하나의 플로우로 묶어
  잔상/부분 초기화를 방지 |
  | 10 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SHOW_PER_PROBLEM_RESULT |
  LEARN_SCORE_AND_RESULT_GATING | 편집 후 결과 노출을 게이
  트로 통제하면 스테일 상태를 예방 |
  | 11 | (비-strict JSON) → (병합/검증 실패) |
  LEARN_STRICT_JSON_OUTPUT_GUARD | 산출물 품질을 별도 노드
  로 두면 파싱 실패를 조기에 차단 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "answers/results를 submissions
  payload로 변환", "domain": "FE", "rep": "P",
  "confidence": 0.80 },
      { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장",
  "domain": "QA", "rep": "C", "confidence": 0.90 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
      { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded는 결과 존재로 파생하거나 액션에서 세팅하는 등
  대체 경로가 있어 필수 선행 잠금은 과잉", "confidence":
  0.72 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 함께 수행이 권장되나 필수 선후 잠금은 과
  잉", "confidence": 0.78 }
    ],
    "notes": [
      { "claim": "disabled 입력됨 판정은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  공백/콤마 입력에서 버튼 상태와 채점 결과가 불일치한다.",
  "confidence": 0.82 },
      { "claim": "버튼 추가와 allAnswered 구현은 병렬로 가
  능하고, 최종적으로 disabled 조건만 연결하면 된다.",
  "reason": "UI를 먼저 만들고 이후에 allAnswered 로직을 붙
  이는 경로가 자연스럽고 회귀 위험이 낮다.", "confidence":
  0.70 },
      { "claim": "legacy partial은 조건부로만 필요하므로
  requires보다 노트/권장 선행으로 관리하는 것이 적절하다.",
  "reason": "partial은 기존 merge 저장 데이터가 존재할 때만
  발생하고, 항상 필요한 선행 관계가 아니다.", "confidence":
  0.74 },
      { "claim": "score/result 노출은 hasGraded로 게이트하
  는 것이 권장이다.", "reason": "채점 전 0/N 및 부분 데이터
  노출을 방지하려면 표시 기준을 단일 플래그로 고정해야 한
  다.", "confidence": 0.74 },
      { "claim": "reset은 localStorage 키 삭제와 UI state
  리셋을 함께 수행하는 것이 권장이다.", "reason": "키 삭제
  만 수행하면 화면에 남은 answer/result 잔상으로 인해 초기
  화가 체감되지 않는다.", "confidence": 0.78 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력되어야 한다.", "reason": "문자열
  줄바꿈은 파싱 실패를 유발해 결합 검증/병합 파이프라인을
  중단시킨다.", "confidence": 0.90 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/저장 merge를 이해해야 bulk 전환 회
  귀
  를 줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 legacy partial
  의미 | 기존 merge 저장으로 부분 submissions가 정상 생성되
  어 bulk UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 함 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 UX가 붕괴 | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정화
  필요 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", "0",
  "-0", "1,234", "+", ".", "Infinity" 등 기대값을 고정해야
  함 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재 단건 채점만 가
  능
  하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/단일 소스화 | 점수 집계/문제
  별
  결과 표시/저장을 동일 키(problemId)로 정렬해야 함 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  partial 결과 노출 혼선을 막을 표시 기준이 필요 | 중 |
  |12| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 표시
  해야 UX가 일관되고 legacy 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “한 번
  에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 상태 꼬임을 방지해야 함 | 중
  |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 state 리셋이 필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/근사/분수) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | 제거가 먼저면 채점/저장 경
  로
  가 사라져 기능 공백 발생 | bulk 버튼+gradeAll+저장 준비
  후
  제거 |
  | 2 | 원문 disabled 판정 → 정규화 채점 | " , " 등에서 활
  성/비활성과 채점 기준이 엇갈려 UX 붕괴 |
  normalizeNumericInput 기반으로 미입력 판정 통일 |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_ALL_ANSWERED_NORMALIZED | disabled 계산이 불명확하
  면
  조기 활성/비활성이 흔들림 | problems[] 기준
  allAnswered(정
  규화) 먼저 고정 |
  | 4 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증 없이 복원하면 파싱
  실패/필드 누락으로 런타임 오류 | schema+shape validate+예
  외 처리 추가 |
  | 5 | legacy partial 복원 → 결과/점수 노출 | 부분
  submissions가 “채점됨”처럼 보이면 오해/혼선 발생 |
  partial
  감지 시 hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | LEARN_RESET_CLEAR_STORAGE → UI 잔상 유지 | storage
  만
  지우면 answer/result/flags가 화면에 남음 | 키 삭제 + UI
  state 리셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C", "confidence": 0.8 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.84 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P", "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P", "confidence": 0.75 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체 저
  장)",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C", "confidence":
  0.72 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C", "confidence": 0.74 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.84 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.75 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 submissions를 기존 값과 병합
  해 setItem하는 흐름이 확인된다.", "confidence": 0.86 },
  { "claim": "미입력 판정(disabled)은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading.ts가 normalizeNumericInput을
  사
  용하므로 원문 기준 판정은 활성/채점 불일치를 만든다.",
  "confidence": 0.84 },
  { "claim": "현재 점수 표시는 채점 전에도 0/N이 노출될
  수 있어 hasGraded 게이팅이 필요하다.", "reason": "score는
  problems가 있으면 result가 비어도 correct=0,total=N을 표
  시
  할 수 있다.", "confidence": 0.74 },
  { "claim": "legacy partial 처리는 조건부 정책이며
  restore에 과잉 잠금(requires)으로 고정하지 않는 편이 안전
  하다.", "reason": "partial은 legacy 데이터가 존재할 때만
  발생하고 reviewer도 requires 과잉 잠금을 지적했다.",
  "confidence": 0.72 },
  { "claim": "다시 풀기는 localStorage 키 삭제와 UI
  state(answer/result/flags) 리셋을 함께 수행해야 한다.",
  "reason": "저장소만 지우면 화면에 남은 상태로 인해 초기화
  가 즉시 반영되지 않는다.", "confidence": 0.8 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 검증/
  병
  합을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:4faa8473cc###


› repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_0de4d4e8bf.md


  64% context left



› Request 0de4d4e8bf: 아래 파일(티켓 지시)을 읽고 결과를
  이 터미널에 Output Format대로 그대로 출력해줘. 가능하면
  repo 파일을 생성/수정하지 말고, 마지막에 마커를 그대로
  출력해. -> /mnt/c/Users/irron/Desktop/my/
  web_service_new/calculate_math/.agents/inbox/
  research_0de4d4e8bf.md


    Read research_0de4d4e8bf.md                            

◦ Proposing bridge nodes and edges (3m 38s • esc to interru


› Improve documentation in @filename

  97% context left · ? for shortcuts


• Explored
  └ Search ^## (Output Format|Rules|Coverage Gap Report)\b|
^\[/
           R1 Coverage Report\]|^\[/R2 Progression
Report\]|
           ^###DONE: in research_0de4d4e8bf.md
    Search \[/R1 Coverage Report\] in
research_0de4d4e8bf.md
    Read research_0de4d4e8bf.md

─ Worked for 3m 38s ───────────────────────────────────────

• ###BEGIN:0de4d4e8bf###

  ## Micro Skill Decomposition

  ### 분해된 Micro Skills (10~40개)

  | # | ID | name_ko | domain | rep | 분해 이유 |
  |---|----|---------|--------|-----|----------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW | 현재 per-problem 제
  출/저장 흐름 요약 | FE | C | bulk 전환 시 회귀/기능 공백
  을 줄이기 위한 기준선 |
  | 2 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 문제 카드별 제출
  버튼 제거 | FE | P | 제출 경로를 단일화해 bulk UX로 전환
  |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 하단 단일 채점하기 버
  튼 추가 | FE | P | 요구사항의 단일 진입점 제공 |
  | 4 | LEARN_HANDLE_EMPTY_PROBLEMS | 문제 0개/로딩 상태 UI
  규칙 정의 | UX | C | allAnswered/disabled의 흔들림(공집
  합/로딩)을 방지 |
  | 5 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | 미입력 판정
  predicate 정의(정규화 기반) | FE | C | disabled와 채점 기
  준 불일치로 인한 UX 붕괴 방지 |
  | 6 | LEARN_ALL_ANSWERED_NORMALIZED | allAnswered 계산(정
  규화 기반) | FE | P | 모든 문제 입력 전까지 버튼 disabled
  구현 |
  | 7 | LEARN_DISABLED_EDGECASES_12 | 입력 엣지케이스 12종
  테스트 벡터 | QA | C | 공백/콤마/부호 등 판정 흔들림을 사
  전에 고정 |
  | 8 | LEARN_BULK_GRADE_ALL_ACTION | 일괄 채점 액션(전체
  순회) | FE | P | 한 번 클릭으로 모든 문제를 채점하는 동작
  구현 |
  | 9 | LEARN_BUILD_RESULT_MAP | 문제별 결과 맵
  (resultByProblemId) 생성 | FE | P | 점수/표시/저장에 공통
  으로 쓰는 중간 표현 구축 |
  | 10 | LEARN_GRADED_STATE_FLAG | 채점 전/후 상태 플래그
  (hasGraded) 정의 | FE | C | 결과 노출 시점/복원 시점 기준
  을 단일 플래그로 고정 |
  | 11 | LEARN_SCORE_AND_RESULT_GATING | 채점 후에만 점수/
  결과 표시(게이팅) | FE | P | 채점 전 0/N 및 partial 결과
  노출 혼선 차단 |
  | 12 | LEARN_SCORE_SUMMARY_CALC | 총점 X/N 집계 로직 | FE
  | P | resultByProblemId 기반으로 점수 집계를 안정화 |
  | 13 | LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답
  표시(일괄 채점 후) | FE | P | 각 문제 카드에 정오/정답값
  을 일관되게 렌더 |
  | 14 | LEARN_STORE_RESULT_SCHEMA_BULK | bulk 저장 계약(답
  안+결과) 정의 | FE | C | “채점 후 1회 저장” 스냅샷을 스키
  마로 고정 |
  | 15 | LEARN_BUILD_SUBMISSIONS_PAYLOAD | answers/results
  를 submissions payload로 변환 | FE | P | UI state를
  StoredResult{submissions}로 표현전환 |
  | 16 | LEARN_LOCALSTORAGE_SAVE_BULK | 일괄 채점 후
  submissions를 1회 저장 | FE | P | merge 저장을 제거하고 1
  회 setItem으로 단순화 |
  | 17 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 복원 데이터 파
  싱/shape validate | FE | C | JSON 파싱 실패/필드 누락으로
  인한 런타임 오류 방지 |
  | 18 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial 감지/정책 적용 | FE | C | 기존 merge 저장
  이 만든 partial을 bulk UX에 맞게 처리 |
  | 19 | LEARN_LOCALSTORAGE_RESTORE_BULK | 재진입/새로고침
  시 답안/결과 복원 | FE | P | 동일 노드 재진입 시 학습 상
  태 복원 |
  | 20 | LEARN_RESET_CLEAR_STORAGE | 다시 풀기:
  localStorage 키 삭제 | FE | P | 저장된 결과/답안을 제거해
  초기화 기반 마련 |
  | 21 | LEARN_RESET_UI_STATE | 다시 풀기: UI state 리셋 |
  FE | P | 화면 잔상(answer/result/flags)을 즉시 제거 |
  | 22 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 수정 정
  책(결과 초기화/재채점) | UX | C | 답 변경 시 스테일 결과
  (입력≠결과) 방지 |
  | 23 | LEARN_STRICT_JSON_OUTPUT_GUARD | Graph Patch JSON
  strict JSON 보장 | QA | C | 문자열 줄바꿈 등으로 병합 불
  가가 반복되는 문제 차단 |

  ### 추가 Step Nodes (2~8개)

  | # | ID | name_ko | 포함 micro | 설명 |
  |---|----|---------|-----------|------|
  | 1 | STEP_BULK_SUBMIT_UI_FLOW | bulk 제출 UI 구성(버튼
  +disabled) | LEARN_REMOVE_PER_PROBLEM_SUBMIT,
  LEARN_ADD_BULK_GRADE_BUTTON, LEARN_HANDLE_EMPTY_PROBLEMS,
  LEARN_DEFINE_IS_ANSWERED_PREDICATE,
  LEARN_ALL_ANSWERED_NORMALIZED | 단일 버튼 UX와 disabled
  기준을 함께 고정 |
  | 2 | STEP_BULK_GRADE_RENDER_FLOW | 일괄 채점→결과/점수
  표시 | LEARN_BULK_GRADE_ALL_ACTION,
  LEARN_BUILD_RESULT_MAP, LEARN_GRADED_STATE_FLAG,
  LEARN_SCORE_AND_RESULT_GATING, LEARN_SCORE_SUMMARY_CALC,
  LEARN_SHOW_PER_PROBLEM_RESULT | 채점→중간표현→게이팅→표시
  를 일관된 흐름으로 구성 |
  | 3 | STEP_PERSIST_RESTORE_MIGRATION_FLOW | 저장/복원/
  legacy 처리 | LEARN_STORE_RESULT_SCHEMA_BULK,
  LEARN_BUILD_SUBMISSIONS_PAYLOAD,
  LEARN_LOCALSTORAGE_SAVE_BULK,
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
  LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
  LEARN_LOCALSTORAGE_RESTORE_BULK | 스키마 확정 후 저장 1
  회/복원 1회 + legacy 조건부 처리 |
  | 4 | STEP_RESET_AND_EDIT_FLOW | 초기화 + 채점 후 편집 정
  책 | LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
  LEARN_AFTER_GRADE_EDIT_POLICY | 초기화 잔상 제거와 스테일
  결과 방지 정책을 묶어 적용 |
  | 5 | STEP_STRICT_JSON_HANDOFF | 산출물 JSON strict 출력
  | LEARN_STRICT_JSON_OUTPUT_GUARD | 줄바꿈 없는 strict
  JSON으로 결합 검증/병합 가능 상태 보장 |

  ## Prerequisite Analysis

  ### 필수 선행 (requires)

  | # | From → To | 필수 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE →
  LEARN_ALL_ANSWERED_NORMALIZED | allAnswered는 “입력됨” 판
  정 기준 없이 정의 불가 | 0.82 |
  | 2 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_BUILD_RESULT_MAP | 결과 맵은 문제 전체 채점 결과가
  있어야 구성 가능 | 0.78 |
  | 3 | LEARN_BUILD_RESULT_MAP → LEARN_SCORE_SUMMARY_CALC |
  총점 집계는 문제별 결과가 있어야 계산 가능 | 0.76 |
  | 4 | LEARN_BUILD_RESULT_MAP →
  LEARN_SHOW_PER_PROBLEM_RESULT | 문제별 정오/정답 표시는
  문제별 결과가 선행 | 0.78 |
  | 5 | LEARN_GRADED_STATE_FLAG →
  LEARN_SCORE_AND_RESULT_GATING | 게이팅은 hasGraded 의미
  정의에 의존 | 0.76 |
  | 6 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | payload 필드/형식은 저
  장 계약을 따라야 함 | 0.80 |
  | 7 | LEARN_BUILD_SUBMISSIONS_PAYLOAD →
  LEARN_LOCALSTORAGE_SAVE_BULK | setItem 전에 직렬화 가능한
  payload가 필요 | 0.80 |
  | 8 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK | restore는 저장된 스키마
  를 알아야 해석 가능 | 0.80 |

  ### 권장 선행 (NOT requires, just notes)

  | # | From → To | 권장 이유 | confidence |
  |---|-----------|----------|------------|
  | 1 | LEARN_MAP_CURRENT_SUBMIT_FLOW →
  LEARN_REMOVE_PER_PROBLEM_SUBMIT | 기존 제출/저장 경로를
  알아야 제거 후 회귀를 줄일 수 있음 | 0.76 |
  | 2 | LEARN_HANDLE_EMPTY_PROBLEMS →
  LEARN_ALL_ANSWERED_NORMALIZED | 문제 0개/로딩에서 vacuous
  truth를 막아 버튼 상태가 안정됨 | 0.72 |
  | 3 | LEARN_ALL_ANSWERED_NORMALIZED →
  LEARN_ADD_BULK_GRADE_BUTTON | disabled 연결을 위해
  allAnswered 기준을 먼저 고정하면 안전 | 0.70 |
  | 4 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | 클릭 이벤트를 gradeAll로 연
  결해야 UX가 완성됨 | 0.72 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_GRADED_STATE_FLAG | gradeAll 후 hasGraded 세팅을 권
  장(표시 기준 단순화) | 0.74 |
  | 6 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SCORE_SUMMARY_CALC | 계산은 가능해도 노출은
  hasGraded일 때만 권장 | 0.70 |
  | 7 | LEARN_SCORE_AND_RESULT_GATING →
  LEARN_SHOW_PER_PROBLEM_RESULT | 결과도 hasGraded일 때만
  노출하는 편이 안정 | 0.72 |
  | 8 | LEARN_LOCALSTORAGE_VALIDATE_SHAPE →
  LEARN_LOCALSTORAGE_RESTORE_BULK | 검증은 권장이지만 기능
  구현 자체의 필수는 아님 | 0.74 |
  | 9 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL →
  LEARN_LOCALSTORAGE_RESTORE_BULK | legacy 존재 시에만 정책
  이 필요하므로 조건부 권장 | 0.74 |
  | 10 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  키 삭제만으로는 잔상이 남아 UI 리셋을 함께 권장 | 0.78 |
  | 11 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_RESET_UI_STATE | 답 변경 시 결과 초기화/재채점 유도
  를 위해 상태 리셋이 필요 | 0.72 |
  | 12 | LEARN_STRICT_JSON_OUTPUT_GUARD →
  STEP_STRICT_JSON_HANDOFF | 출력 품질 검증을 단계로 분리하
  면 병합 실패를 예방 | 0.84 |

  ## Why Students Get Stuck (막힘 이유 분석, 최소 10개)

  | # | Node | 막힘 이유 (인지부하/표현전환) | 해결책 |
  confidence |
  |---|------|---------------------------|--------|--------
  ----|
  | 1 | LEARN_DEFINE_IS_ANSWERED_PREDICATE | “입력됨” 직관
  과 정규화 기준이 어긋나 disabled/채점 불일치 |
  normalizeNumericInput 기반 predicate로 통일 | 0.82 |
  | 2 | LEARN_ALL_ANSWERED_NORMALIZED | 로딩/문제 0개에서
  allAnswered가 흔들려 버튼 상태 불안정 |
  LEARN_HANDLE_EMPTY_PROBLEMS로 0개/로딩 규칙을 명시 | 0.74
  |
  | 3 | LEARN_ADD_BULK_GRADE_BUTTON | 라벨/disabled/재채점
  상태가 암묵적이면 UX 해석이 어려움 | derived state로
  label/disabled를 결정(필요 시 “다시 채점”) | 0.70 |
  | 4 | LEARN_REMOVE_PER_PROBLEM_SUBMIT | 제거가 먼저면 채
  점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 준비 후 제거 | 0.80 |
  | 5 | LEARN_BULK_GRADE_ALL_ACTION | 순회 채점에서 입력 조
  회/채점 호출/상태 업데이트가 섞여 인지부하 증가 |
  gradeAll을 순수 함수로 분리해 결과 맵을 반환 | 0.78 |
  | 6 | LEARN_BUILD_RESULT_MAP | index 기반 처리로 문제 순
  서/ID 불일치 시 오표시 위험 | 항상 problemId 키로
  resultByProblemId 구성/조회 | 0.76 |
  | 7 | LEARN_GRADED_STATE_FLAG | 복원/partial에서
  hasGraded 의미가 모호해 결과 노출이 흔들림 | hasGraded를
  “유효한 채점 결과 존재”로 정의 | 0.74 |
  | 8 | LEARN_SCORE_AND_RESULT_GATING | 채점 전 0/N 노출로
  “이미 채점됨” 오해 발생 | score/result 렌더를 hasGraded로
  게이트 | 0.74 |
  | 9 | LEARN_STORE_RESULT_SCHEMA_BULK | answers/results를
  submissions 스키마로 전환할 때 누락/불일치 발생 | 스키마
  를 submitted+isCorrect 중심으로 단일화 | 0.78 |
  | 10 | LEARN_LOCALSTORAGE_SAVE_BULK | merge 저장 습관으로
  partial이 계속 생겨 UX 충돌 | gradeAll 결과로 overwrite
  스냅샷 저장 + setItem 1회 | 0.78 |
  | 11 | LEARN_LOCALSTORAGE_RESTORE_BULK | JSON.parse 실패/
  타 노드 데이터/형식 오류로 런타임이 깨짐 | try/catch +
  nodeId 검증 + shape validate | 0.78 |
  | 12 | LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL |
  legacy partial을 그대로 복원하면 “채점됨”처럼 보여 혼선 |
  partial 감지 시 hasGraded=false 및 재채점 유도(또는 초기
  화) | 0.74 |
  | 13 | LEARN_RESET_UI_STATE | storage만 삭제하면 answer/
  result 잔상이 남아 초기화가 체감되지 않음 | storage 삭제
  와 state(answer/result/flags) 리셋 동시 수행 | 0.78 |
  | 14 | LEARN_AFTER_GRADE_EDIT_POLICY | 채점 후 답 변경 시
  결과가 스테일해 “입력≠결과” 상태 발생 | 입력 변경 시 결과
  초기화 또는 재채점 고정 | 0.76 |
  | 15 | LEARN_STRICT_JSON_OUTPUT_GUARD | 문자열 줄바꿈 등
  으로 patch JSON 파싱 실패가 반복됨 | 문자열 내부 줄바꿈
  금지 + json.loads 동등 검증 | 0.90 |

  ## Bridge Node Suggestions (장거리 의존 끊기, 최소 10개)

  | # | Long Edge | 제안 Bridge Node | 이유 |
  |---|-----------|-----------------|------|
  | 1 | LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT →
  LEARN_ALL_ANSWERED_NORMALIZED |
  LEARN_DEFINE_IS_ANSWERED_PREDICATE | “정규화 사용”보다
  “입력됨 판정”을 중간에 두면 disabled/allAnswered 정합화가
  쉬움 |
  | 2 | LEARN_ADD_BULK_GRADE_BUTTON →
  LEARN_BULK_GRADE_ALL_ACTION | STEP_BULK_SUBMIT_UI_FLOW |
  UI 배치와 액션 연결을 단계로 묶어 구현 점프를 완화 |
  | 3 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SCORE_SUMMARY_CALC | LEARN_BUILD_RESULT_MAP | 점수
  집계를 결과 맵 중간 표현으로 연결해 불일치/누락을 줄임 |
  | 4 | LEARN_BULK_GRADE_ALL_ACTION →
  LEARN_SHOW_PER_PROBLEM_RESULT | LEARN_BUILD_RESULT_MAP |
  카드 렌더를 중간 표현에만 의존하도록 분리해 오표시를 줄임
  |
  | 5 | LEARN_STORE_RESULT_SCHEMA_BULK →
  LEARN_LOCALSTORAGE_SAVE_BULK |
  LEARN_BUILD_SUBMISSIONS_PAYLOAD | 스키마 정의에서 바로 저
  장으로 점프하지 않고 변환 단계를 추가 |
  | 6 | LEARN_LOCALSTORAGE_SAVE_BULK →
  LEARN_LOCALSTORAGE_RESTORE_BULK |
  LEARN_LOCALSTORAGE_VALIDATE_SHAPE | 저장된 데이터의 파싱/
  검증 단계를 매개로 복원 실패를 완화 |
  | 7 | LEARN_LOCALSTORAGE_RESTORE_BULK →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  복원 시 hasGraded 기준을 먼저 확정해 노출 규칙을 단순화 |
  | 8 | LEARN_RESET_CLEAR_STORAGE → LEARN_RESET_UI_STATE |
  STEP_RESET_AND_EDIT_FLOW | reset을 하나의 플로우로 묶어
  잔상/부분 초기화를 방지 |
  | 9 | LEARN_AFTER_GRADE_EDIT_POLICY →
  LEARN_SCORE_AND_RESULT_GATING | LEARN_GRADED_STATE_FLAG |
  편집 이후 결과 노출을 hasGraded 기준으로 통제하면 스테일
  상태를 예방 |
  | 10 | LEARN_REMOVE_PER_PROBLEM_SUBMIT →
  LEARN_BULK_GRADE_ALL_ACTION | LEARN_ADD_BULK_GRADE_BUTTON
  | 제거 전에 새 진입점을 확보하면 기능 공백을 방지 |
  | 11 | (비-strict JSON 산출) → (병합/검증 실패) |
  LEARN_STRICT_JSON_OUTPUT_GUARD | 산출물 품질을 별도 노드
  로 두면 파싱 실패를 조기에 차단 |

  ## Graph Patch JSON

  {
    "researcher": "R2",
    "scope": "curriculum_viewer_learning_bulk_submit_v1",
    "add_nodes": [
      { "id": "LEARN_HANDLE_EMPTY_PROBLEMS", "type":
  "micro", "name_ko": "문제 0개/로딩 상태 UI 규칙 정의",
  "domain": "UX", "rep": "C", "confidence": 0.74 },
      { "id": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "type":
  "micro", "name_ko": "미입력 판정 predicate 정의(정규화 기
  반)", "domain": "FE", "rep": "C", "confidence": 0.82 },
      { "id": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type":
  "micro", "name_ko": "answers/results를 submissions
  payload로 변환", "domain": "FE", "rep": "P",
  "confidence": 0.80 },
      { "id": "LEARN_STRICT_JSON_OUTPUT_GUARD", "type":
  "micro", "name_ko": "Graph Patch JSON strict JSON 보장",
  "domain": "QA", "rep": "C", "confidence": 0.90 },
      { "id": "STEP_BULK_SUBMIT_UI_FLOW", "type": "step",
  "name_ko": "bulk 제출 UI 구성(버튼+disabled)", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_BULK_GRADE_RENDER_FLOW", "type":
  "step", "name_ko": "일괄 채점→결과/점수 표시", "domain":
  "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_PERSIST_RESTORE_MIGRATION_FLOW",
  "type": "step", "name_ko": "저장/복원/legacy 처리",
  "domain": "FE", "rep": "C", "confidence": 0.74 },
      { "id": "STEP_RESET_AND_EDIT_FLOW", "type": "step",
  "name_ko": "초기화 + 채점 후 편집 정책", "domain": "FE",
  "rep": "C", "confidence": 0.72 },
      { "id": "STEP_STRICT_JSON_HANDOFF", "type": "step",
  "name_ko": "산출물 JSON strict 출력", "domain": "QA",
  "rep": "C", "confidence": 0.84 }
    ],
    "add_edges": [
      { "from": "LEARN_DEFINE_IS_ANSWERED_PREDICATE", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.82 },
      { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "type": "requires",
  "confidence": 0.80 },
      { "from": "LEARN_BUILD_SUBMISSIONS_PAYLOAD", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.80 }
    ],
    "remove_edges": [
      { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "reason": "정규화 사용 여부보다 입력됨 predicate를 중간에
  두면 allAnswered 정의가 가능해 기존 requires 잠금은 과
  잉", "confidence": 0.78 },
      { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "reason": "버튼 추가는 allAnswered 구현과 독립적으로 가능
  하므로 requires 잠금은 과잉", "confidence": 0.78 },
      { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "reason": "액션 구현은 UI와 병렬로 가능하므로 requires 잠
  금은 과잉", "confidence": 0.76 },
      { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires", "reason":
  "hasGraded 정의/도입은 gradeAll과 독립적으로 가능해 단일
  선행 잠금은 과잉", "confidence": 0.72 },
      { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "shape validate는 안정성 향상 요소로 권장이지
  필수 선행 잠금은 과잉", "confidence": 0.74 },
      { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "reason": "키
  삭제와 UI 리셋은 순서가 바뀌어도 가능하며 동시 수행만 권
  장", "confidence": 0.78 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "reason": "키 포맷 식별은 구현과 병렬로 확인 가능해
  requires 잠금은 과잉", "confidence": 0.70 },
      { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "reason": "restore는 키를 필요로 하지만 구현과 병렬로 결
  정 가능해 requires 잠금은 과잉", "confidence": 0.68 }
    ],
    "notes": [
      { "claim": "미입력 판정(disabled)은
  normalizeNumericInput(answer).length>0 기준으로 통일하는
  것이 권장이다.", "reason": "UI 기준과 채점 기준이 다르면
  공백/콤마 입력에서 버튼 상태와 채점 결과가 불일치한다.",
  "confidence": 0.82 },
      { "claim": "버튼 추가와 allAnswered 구현은 병렬로 가
  능하며 최종적으로 disabled 조건만 연결하면 된다.",
  "reason": "UI를 먼저 만들고 이후에 allAnswered 로직을 붙
  이는 구현 경로가 자연스럽다.", "confidence": 0.70 },
      { "claim": "legacy partial은 조건부 케이스이므로
  requires보다 노트/권장 선행으로 관리하는 것이 적절하다.",
  "reason": "partial은 기존 merge 저장 데이터가 있을 때만
  발생하고 항상 필요한 선행 관계가 아니다.", "confidence":
  0.74 },
      { "claim": "score/result 노출은 hasGraded로 게이트하
  고 복원 시 hasGraded 규칙을 명확히 하는 것이 권장이다.",
  "reason": "채점 전 0/N 및 partial 노출을 통제하려면 표시
  기준을 단일 플래그로 고정해야 한다.", "confidence":
  0.74 },
      { "claim": "Graph Patch JSON은 문자열 내부 줄바꿈 없
  이 strict JSON으로 출력되어야 한다.", "reason": "문자열
  줄바꿈은 파싱 실패를 유발해 결합 검증/병합 파이프라인을
  중단시킨다.", "confidence": 0.90 }
    ]
  }

  ## APPENDIX: R1 Coverage Report (verbatim)

  ## Coverage Gap Report

  ### 1. 누락된 기초 개념 (최소 10개)

  | # | 개념명 | 누락 이유 | 심각도 |
  |---|--------|----------|--------|
  | 1 | 현재 LearnPage 단건 제출/저장 흐름 기준선 | per-
  problem submitProblem/merge 저장을 알아야 bulk 전환 회귀
  를
  줄임 | 높음 |
  | 2 | localStorage 키 계약 식별 | 저장/복원/초기화가 동일
  키(curriculum-viewer:learn:lastResult:${nodeId})에 의존 |
  높음 |
  | 3 | StoredResult{submissions} 스키마 및 partial 의미 |
  기존 merge 저장으로 부분 submissions가 정상 생성되어 bulk
  UX와 충돌 가능 | 높음 |
  | 4 | 문제 카드별 제출 버튼 제거 범위 | 요구사항 1) 핵심
  변경인데 현재 per-problem 제출 경로가 존재 | 높음 |
  | 5 | 하단 단일 버튼(채점하기) UX/상태 정의 | bulk UX의
  단
  일 진입점(라벨/disabled/재채점)을 정의해야 함 | 높음 |
  | 6 | 미입력 판정 기준 정합화(normalize) | disabled 판정
  이
  normalizeNumericInput과 불일치하면 UX가 붕괴 | 높음 |
  | 7 | allAnswered 계산(정규화+problems[] 기준) | “모든 문
  제 입력 전까지 disabled”를 로딩/문제 수 변화 포함 안정화
  필요 | 높음 |
  | 8 | 입력 엣지케이스 벡터(12종+) | "", " ", ",", " , ",
  "0", "-0", "1,234", "+", ".", "Infinity" 등 기대값 고정
  필
  요 | 중 |
  | 9 | 일괄 채점 gradeAll 동작 정의 | 현재 단건 채점만 가
  능
  하므로 problems 전체 순회 채점 액션이 필요 | 높음 |
  |10| resultByProblemId 생성/단일 소스화 | 점수 집계/문제
  별
  표시/저장을 problemId keyed map으로 일관화해야 함 | 중 |
  |11| hasGraded(채점 전/후) 플래그 | 채점 전 0/N 노출 및
  legacy partial 결과 노출 혼선을 막을 표시 기준 필요 | 중
  |
  |12| 점수/정오/정답 표시 게이팅 | 채점 후에만 결과를 표시
  해야 UX가 일관되고 partial 혼선을 줄임 | 중 |
  |13| 일괄 저장(채점 후 1회 snapshot) | 요구사항 3) “한 번
  에 저장”으로 시점을 전환해야 함 | 높음 |
  |14| 복원 파이프라인(shape validate+정책) | 잘못된/legacy
  데이터로 인한 런타임 오류 및 상태 꼬임 방지 필요 | 중 |
  |15| 다시 풀기(키 삭제+UI state 리셋) | storage 삭제만으
  로
  는 화면이 즉시 초기화되지 않아 state 리셋이 필요 | 높음 |

  ### 2. 과잉 난이도/불필요 선행 (최소 5개)

  | # | 개념명 | 과잉 이유 | 조치 제안 |
  |---|--------|----------|----------|
  | 1 | 서버 연동/DB 저장 | Out of Scope이며 localStorage
  요
  구를 흐림 | 금지(후속 티켓) |
  | 2 | 문제 타입 확장(객관식/서술형) | 범위 외이며 UI/채
  점/
  저장 설계가 폭증 | 금지(후속 티켓) |
  | 3 | grading 정책 확장(허용오차/근사/분수) | bulk 제출
  UX
  와 무관하고 회귀 위험 증가 | 기존 gradeNumericAnswer 유지
  |
  | 4 | 문제은행/커리큘럼 JSON 스키마 변경 | 데이터 구조 변
  경은 범위 밖, 회귀 위험 큼 | 기존 스키마 유지 |
  | 5 | 전역 상태관리 도입(Redux/Zustand) | LearnPage 단일
  화면 상태로 충분 | 도입 금지 |
  | 6 | UI 대규모 리디자인/애니메이션 | 요구사항 충족과 무
  관
  하고 일정 리스크만 증가 | 최소 변경 |

  ### 3. 학습 순서상 위험한 점프 (최소 5개)

  | # | From → To | 점프 이유 | 브릿지 제안 |
  |---|-----------|----------|------------|
  | 1 | per-problem 제출 제거 → bulk 채점 미구현 | 제거가
  먼
  저면 채점/저장 경로가 사라져 기능 공백 발생 | bulk 버튼
  +gradeAll+저장 준비 후 제거 |
  | 2 | 원문 disabled 판정 → 정규화 채점 | " , " 등에서 활
  성/비활성과 채점 기준이 엇갈려 UX 붕괴 |
  normalizeNumericInput 기반으로 미입력 판정 통일 |
  | 3 | bulk 버튼 추가 → allAnswered 부재 | disabled 조건이
  불명확하면 조기 활성/비활성이 흔들림 | problems[] 기준
  allAnswered(정규화) 먼저 고정 |
  | 4 | 저장 구현 → 복원/검증 미정 | 파싱 실패/필드 누락으
  로
  런타임 오류 및 상태 꼬임 발생 | schema+shape validate+예
  외
  처리 추가 |
  | 5 | legacy partial 복원 → 결과/점수 노출 | 부분
  submissions가 “채점됨”처럼 보이면 오해/혼선 발생 |
  partial
  감지 시 hasGraded=false 및 재채점 유도 |
  | 6 | 점수 표시 → hasGraded 미도입 | 채점 전 0/N 노출은
  “이미 채점됨” 오해 유발 | hasGraded 게이팅 후 채점 후에만
  노출 |
  | 7 | 초기화(키 삭제만) → UI 잔상 | storage만 지우면
  answer/result/flags가 화면에 남음 | 키 삭제 + UI state 리
  셋 동시 수행 |

  ## Graph Patch JSON

  {
  "researcher": "R1",
  "scope": "curriculum_viewer_learning_bulk_submit_v1",
  "add_nodes": [
  { "id": "LEARN_MAP_CURRENT_SUBMIT_FLOW", "type":
  "micro", "name_ko": "현재 per-problem 제출/저장 흐름 요
  약", "domain": "FE", "rep": "C", "confidence": 0.86 },
  { "id": "LEARN_IDENTIFY_STORAGE_KEY", "type": "micro",
  "name_ko": "localStorage 키 포맷 식별", "domain": "FE",
  "rep": "C", "confidence": 0.82 },
  { "id": "LEARN_DOCUMENT_STORED_RESULT_SCHEMA", "type":
  "micro", "name_ko": "StoredResult/submissions 스키마 확
  인", "domain": "FE", "rep": "C", "confidence": 0.8 },
  { "id": "LEARN_REMOVE_PER_PROBLEM_SUBMIT", "type":
  "micro", "name_ko": "문제 카드별 제출 버튼 제거",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_ADD_BULK_GRADE_BUTTON", "type":
  "micro", "name_ko": "하단 단일 채점하기 버튼 추가",
  "domain": "FE", "rep": "P", "confidence": 0.85 },
  { "id": "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT",
  "type": "micro", "name_ko": "미입력 판정 기준을
  normalizeNumericInput과 일치", "domain": "FE", "rep":
  "C",
  "confidence": 0.84 },
  { "id": "LEARN_ALL_ANSWERED_NORMALIZED", "type":
  "micro", "name_ko": "allAnswered 계산(정규화 기반)",
  "domain": "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_DISABLED_EDGECASES_12", "type":
  "micro", "name_ko": "입력 엣지케이스 12종 테스트 벡터",
  "domain": "QA", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_BULK_GRADE_ALL_ACTION", "type":
  "micro", "name_ko": "일괄 채점 액션(전체 순회)",
  "domain":
  "FE", "rep": "P", "confidence": 0.84 },
  { "id": "LEARN_BUILD_RESULT_MAP", "type": "micro",
  "name_ko": "문제별 결과 맵(resultByProblemId) 생성",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_GRADED_STATE_FLAG", "type": "micro",
  "name_ko": "채점 전/후 상태 플래그(hasGraded) 정의",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_SCORE_SUMMARY_CALC", "type": "micro",
  "name_ko": "총점 X/N 집계 로직", "domain": "FE", "rep":
  "P", "confidence": 0.75 },
  { "id": "LEARN_SCORE_AND_RESULT_GATING", "type":
  "micro", "name_ko": "채점 후에만 점수/결과 표시(게이팅)",
  "domain": "FE", "rep": "P", "confidence": 0.74 },
  { "id": "LEARN_SHOW_PER_PROBLEM_RESULT", "type":
  "micro", "name_ko": "문제별 정오/정답 표시(일괄 채점
  후)",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_STORE_RESULT_SCHEMA_BULK", "type":
  "micro", "name_ko": "bulk 저장 시점/계약 정의(전체 저
  장)",
  "domain": "FE", "rep": "C", "confidence": 0.76 },
  { "id": "LEARN_LOCALSTORAGE_SAVE_BULK", "type":
  "micro", "name_ko": "일괄 채점 후 submissions를 1회 저
  장",
  "domain": "FE", "rep": "P", "confidence": 0.8 },
  { "id": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "type":
  "micro", "name_ko": "복원 데이터 파싱/shape validate",
  "domain": "FE", "rep": "C", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_RESTORE_BULK", "type":
  "micro", "name_ko": "재진입/새로고침 시 답안/결과 복원",
  "domain": "FE", "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL",
  "type": "micro", "name_ko": "legacy partial(submissions
  일
  부) 처리 정책", "domain": "FE", "rep": "C", "confidence":
  0.72 },
  { "id": "LEARN_RESET_CLEAR_STORAGE", "type": "micro",
  "name_ko": "다시 풀기: localStorage 키 삭제", "domain":
  "FE", "rep": "P", "confidence": 0.82 },
  { "id": "LEARN_RESET_UI_STATE", "type": "micro",
  "name_ko": "다시 풀기: UI state 리셋", "domain": "FE",
  "rep": "P", "confidence": 0.78 },
  { "id": "LEARN_AFTER_GRADE_EDIT_POLICY", "type":
  "micro", "name_ko": "채점 후 답 수정 정책(결과 초기화/재
  채
  점)", "domain": "UX", "rep": "C", "confidence": 0.74 }
  ],
  "merge_aliases": [],
  "add_edges": [
  { "from":
  "LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT", "to":
  "LEARN_ALL_ANSWERED_NORMALIZED", "type": "requires",
  "confidence": 0.84 },
  { "from": "LEARN_ALL_ANSWERED_NORMALIZED", "to":
  "LEARN_ADD_BULK_GRADE_BUTTON", "type": "requires",
  "confidence": 0.7 },
  { "from": "LEARN_ADD_BULK_GRADE_BUTTON", "to":
  "LEARN_BULK_GRADE_ALL_ACTION", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_BUILD_RESULT_MAP", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_BULK_GRADE_ALL_ACTION", "to":
  "LEARN_GRADED_STATE_FLAG", "type": "requires",
  "confidence": 0.72 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SCORE_SUMMARY_CALC", "type": "requires",
  "confidence": 0.75 },
  { "from": "LEARN_BUILD_RESULT_MAP", "to":
  "LEARN_SHOW_PER_PROBLEM_RESULT", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_GRADED_STATE_FLAG", "to":
  "LEARN_SCORE_AND_RESULT_GATING", "type": "requires",
  "confidence": 0.76 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_STORE_RESULT_SCHEMA_BULK", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.8 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_SAVE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_IDENTIFY_STORAGE_KEY", "to":
  "LEARN_RESET_CLEAR_STORAGE", "type": "requires",
  "confidence": 0.82 },
  { "from": "LEARN_LOCALSTORAGE_VALIDATE_SHAPE", "to":
  "LEARN_LOCALSTORAGE_RESTORE_BULK", "type": "requires",
  "confidence": 0.78 },
  { "from": "LEARN_RESET_CLEAR_STORAGE", "to":
  "LEARN_RESET_UI_STATE", "type": "requires", "confidence":
  0.78 }
  ],
  "remove_edges": [],
  "notes": [
  { "claim": "LearnPage는 submitProblem으로 문제별 채점
  후 submissions를 localStorage에 merge 저장한다.",
  "reason": "LearnPage.tsx에서 기존 submissions와 병합해
  setItem하는 흐름이 확인된다.", "confidence": 0.86 },
  { "claim": "미입력 판정(disabled)은
  normalizeNumericInput(answer).length>0 기준으로 통일해야
  한다.", "reason": "grading.ts가 normalizeNumericInput을
  사
  용하므로 원문 기준 판정은 불일치를 만든다.",
  "confidence":
  0.84 },
  { "claim": "점수/정답 노출은 hasGraded로 게이트해야 채
  점 전 0/N 및 partial 노출 혼선을 줄인다.", "reason": "현
  재
  score는 problems가 있으면 채점 전에도 0/N이 표시될 수 있
  다.", "confidence": 0.74 },
  { "claim": "legacy partial 처리는 조건부 정책이며
  restore에 과잉 잠금(requires)으로 고정하지 않는 편이 안전
  하다.", "reason": "partial은 legacy 데이터가 존재할 때만
  필요하고 reviewer도 requires 과잉 잠금을 지적했다.",
  "confidence": 0.72 },
  { "claim": "per-problem 제출 제거는 bulk 경로(버튼/
  gradeAll/저장)가 준비된 뒤 수행해야 한다.", "reason": "제
  거가 먼저면 사용자가 채점/저장할 경로가 사라져 기능 공백
  이
  생긴다.", "confidence": 0.72 },
  { "claim": "Graph Patch JSON은 strict JSON(json.loads
  통과)으로 문자열 내부 줄바꿈 없이 출력되어야 한다.",
  "reason": "문자열 줄바꿈은 파싱 실패를 유발해 결합 패치
  검
  증/병합을 중단시킨다.", "confidence": 0.9 }
  ]
  }

  ## Standards Tags (내부 태그)

  - 추가된 태그: LEARN_MAP_CURRENT_SUBMIT_FLOW,
    LEARN_IDENTIFY_STORAGE_KEY,
    LEARN_DOCUMENT_STORED_RESULT_SCHEMA,
    LEARN_REMOVE_PER_PROBLEM_SUBMIT,
    LEARN_ADD_BULK_GRADE_BUTTON,
    LEARN_DISABLED_USES_NORMALIZE_NUMERIC_INPUT,
    LEARN_ALL_ANSWERED_NORMALIZED,
    LEARN_DISABLED_EDGECASES_12,
    LEARN_BULK_GRADE_ALL_ACTION, LEARN_BUILD_RESULT_MAP,
    LEARN_GRADED_STATE_FLAG, LEARN_SCORE_SUMMARY_CALC,
    LEARN_SCORE_AND_RESULT_GATING,
    LEARN_SHOW_PER_PROBLEM_RESULT,
    LEARN_STORE_RESULT_SCHEMA_BULK,
    LEARN_LOCALSTORAGE_SAVE_BULK,
    LEARN_LOCALSTORAGE_VALIDATE_SHAPE,
    LEARN_LOCALSTORAGE_RESTORE_BULK,
    LEARN_LOCALSTORAGE_MIGRATION_LEGACY_PARTIAL,
    LEARN_RESET_CLEAR_STORAGE, LEARN_RESET_UI_STATE,
    LEARN_AFTER_GRADE_EDIT_POLICY
  - 수정된 태그: (없음)

  [/R1 Coverage Report]

  [/R2 Progression Report]

  ###DONE:0de4d4e8bf###


› Improve documentation in @filename

  59% context left · ? for shortcuts

